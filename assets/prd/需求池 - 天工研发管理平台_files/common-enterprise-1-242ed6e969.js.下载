(window["microFrontendproject-management"]=window["microFrontendproject-management"]||[]).push([["common-enterprise-1"],{"+B1h":function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjRweCIgaGVpZ2h0PSIyNHB4IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+ZmlsZS1pY29ucy8yNHB4L3ZpZGVvPC90aXRsZT4KICAgIDxkZWZzPgogICAgICAgIDxwYXRoIGQ9Ik01LjI1LDIgTDE1LDIgTDE1LDIgTDIxLDggTDIxLDE5Ljc1IEMyMSwyMC45OTI2NDA3IDE5Ljk5MjY0MDcsMjIgMTguNzUsMjIgTDUuMjUsMjIgQzQuMDA3MzU5MzEsMjIgMywyMC45OTI2NDA3IDMsMTkuNzUgTDMsNC4yNSBDMywzLjAwNzM1OTMxIDQuMDA3MzU5MzEsMiA1LjI1LDIgWiIgaWQ9InBhdGgtMSI+PC9wYXRoPgogICAgICAgIDxmaWx0ZXIgeD0iLTguMyUiIHk9Ii03LjUlIiB3aWR0aD0iMTE2LjclIiBoZWlnaHQ9IjExNS4wJSIgZmlsdGVyVW5pdHM9Im9iamVjdEJvdW5kaW5nQm94IiBpZD0iZmlsdGVyLTIiPgogICAgICAgICAgICA8ZmVPZmZzZXQgZHg9IjAiIGR5PSIwIiBpbj0iU291cmNlQWxwaGEiIHJlc3VsdD0ic2hhZG93T2Zmc2V0T3V0ZXIxIj48L2ZlT2Zmc2V0PgogICAgICAgICAgICA8ZmVHYXVzc2lhbkJsdXIgc3RkRGV2aWF0aW9uPSIwLjUiIGluPSJzaGFkb3dPZmZzZXRPdXRlcjEiIHJlc3VsdD0ic2hhZG93Qmx1ck91dGVyMSI+PC9mZUdhdXNzaWFuQmx1cj4KICAgICAgICAgICAgPGZlQ29sb3JNYXRyaXggdmFsdWVzPSIwIDAgMCAwIDAgICAwIDAgMCAwIDAgICAwIDAgMCAwIDAgIDAgMCAwIDAuMDUgMCIgdHlwZT0ibWF0cml4IiBpbj0ic2hhZG93Qmx1ck91dGVyMSI+PC9mZUNvbG9yTWF0cml4PgogICAgICAgIDwvZmlsdGVyPgogICAgPC9kZWZzPgogICAgPGcgaWQ9IlBhZ2UtMSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9Ikljb25zL0ZpbGUvMjRweC9WaWRlbyI+CiAgICAgICAgICAgIDxnIGlkPSJSZWN0YW5nbGUtQ29weSI+CiAgICAgICAgICAgICAgICA8dXNlIGZpbGw9ImJsYWNrIiBmaWxsLW9wYWNpdHk9IjEiIGZpbHRlcj0idXJsKCNmaWx0ZXItMikiIHhsaW5rOmhyZWY9IiNwYXRoLTEiPjwvdXNlPgogICAgICAgICAgICAgICAgPHVzZSBmaWxsPSIjNkM1MEU2IiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIHhsaW5rOmhyZWY9IiNwYXRoLTEiPjwvdXNlPgogICAgICAgICAgICA8L2c+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0xNC42NzA1MDIxLDE0LjkyNDk2NzggTDExLjE1NTg1NzcsMTcuNDU2MDk3IEMxMC42Mjg2NjExLDE3Ljg3Nzk1MTkgOS43NSwxNy40NTYwOTcgOS43NSwxNi43ODExMjkyIEw5Ljc1LDExLjcxODg3MDggQzkuNzUsMTEuMDQzOTAzIDEwLjU0MDc5NSwxMC42MjIwNDgxIDExLjE1NTg1NzcsMTEuMDQzOTAzIEwxNC42NzA1MDIxLDEzLjU3NTAzMjIgQzE1LjEwOTgzMjYsMTMuOTEyNTE2MSAxNS4xMDk4MzI2LDE0LjU4NzQ4MzkgMTQuNjcwNTAyMSwxNC45MjQ5Njc4IFoiIGlkPSJTaGFwZSIgZmlsbD0iI0ZGRkZGRiIgZmlsbC1ydWxlPSJub256ZXJvIiBvcGFjaXR5PSIwLjkwMDAwMDAzNiI+PC9wYXRoPgogICAgICAgICAgICA8cGF0aCBkPSJNMTUsMiBMMjEsOCBMMTcuMjUsOCBDMTYuMDA3MzU5Myw4IDE1LDYuOTkyNjQwNjkgMTUsNS43NSBMMTUsMiBMMTUsMiBaIiBpZD0iUmVjdGFuZ2xlLUNvcHktMyIgZmlsbD0iI0ZGRkZGRiIgb3BhY2l0eT0iMC40MDAwMDAwMDYiPjwvcGF0aD4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg=="},"+CMw":function(e,t,a){e.exports={trigger:"trigger-CKrv8If0TU","trigger-empty":"trigger-empty-2jH000EgGH",triggerEmpty:"trigger-empty-2jH000EgGH","item-date":"item-date-18R0SNo068",itemDate:"item-date-18R0SNo068","cart-down":"cart-down-n2nGMSUOtZ",cartDown:"cart-down-n2nGMSUOtZ","iteration-cart-down":"iteration-cart-down-1VTpDp3XXw",iterationCartDown:"iteration-cart-down-1VTpDp3XXw",disabled:"disabled-vNjF52fdUQ","item-time-trigger":"item-time-trigger-3gPAY7tKKX",itemTimeTrigger:"item-time-trigger-3gPAY7tKKX","time-value":"time-value-3hCvpV92bv",timeValue:"time-value-3hCvpV92bv","table-title":"table-title-Dq9MTM1STD",tableTitle:"table-title-Dq9MTM1STD","title-wrapper":"title-wrapper-3Ftx5QcAc7",titleWrapper:"title-wrapper-3Ftx5QcAc7",title:"title-2mPQpnFVNs","title-detail":"title-detail-2f4cHrspUt",titleDetail:"title-detail-2f4cHrspUt","is-sub-issue":"is-sub-issue-10WVc_wJXi",isSubIssue:"is-sub-issue-10WVc_wJXi",tag:"tag-2juijsum1J",orange:"orange-jhyPnA5lTF",red:"red-2UofKm3fjx",gray:"gray-3M0kLgiF-m",epic:"epic-2Qur7AMLEO",icon:"icon-3IZHig2zjG",sub:"sub-2nLyONaiDJ",classic:"classic-UWGkqVsvoE",detail:"detail-2s--0ghQTa","due-date":"due-date-1_BUGOUwvW",dueDate:"due-date-1_BUGOUwvW","icon-placeholder":"icon-placeholder-1zqD_OM-VN",iconPlaceholder:"icon-placeholder-1zqD_OM-VN","over-time":"over-time-2ZHS3MtEhO",overTime:"over-time-2ZHS3MtEhO","over-time-value":"over-time-value-2sWgjINwTS",overTimeValue:"over-time-value-2sWgjINwTS","over-time-tag":"over-time-tag-3CqJb4WU8v",overTimeTag:"over-time-tag-3CqJb4WU8v","over-time-tag-warning":"over-time-tag-warning-2QaIfctIo7",overTimeTagWarning:"over-time-tag-warning-2QaIfctIo7","over-time-tag-danger":"over-time-tag-danger-1EMtCLMTv2",overTimeTagDanger:"over-time-tag-danger-1EMtCLMTv2"}},"+Dhf":function(e,t,a){"use strict";a.r(t);var n=a("cDcd"),i=a.n(n),r=a("es6E"),o=a("O9Lt"),s=a.n(o),l=a("w3Wo"),c=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(t,a)};return function(t,a){if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),u=function(){return(u=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},d=function(e,t,a,n){var i,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,a,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(r<3?i(o):r>3?i(t,a,o):i(t,a))||o);return r>3&&o&&Object.defineProperty(t,a,o),o};t.default=function(e){return function(t){function a(e){var a=t.call(this,e)||this;return a.getFunctions=function(){var e=a.props,t=e.projectID,n=e.currentProject;Object(l.fetchProjectFunction)(t).then((function(e){var i=e.data;a.projectsStore.updateProjectFunctionList("".concat(n.name,"+").concat(t),i)})).finally((function(){return a.setState({loading:!1})}))},a.getProjectKey=function(e){var t=location.pathname.match(/\/p\/([^/]+)/);return t?t[1]:null===e||void 0===e?void 0:e.projectName},a.getCurrentProjectFunctions=function(){var e=a.props.projectID,t=a.getProjectKey(a.props.targetData);return r.StoreMobxApi.toJS(a.projectsStore.projectFunctionData["".concat(t,"+").concat(e)])},a.state={loading:!0},a.projectsStore=Object(r.getStore)(r.StoreName.PROJECTS),a}return c(a,t),a.prototype.render=function(){var t=this.props.currentProject,a=this.state.loading,n=this.getCurrentProjectFunctions();return t&&!a?i.a.createElement(e,u({},this.props,{currentProjectFunctions:n})):i.a.createElement(s.a,{show:!0})},a.prototype.componentDidMount=function(){this.getFunctions()},a=d([r.StoreMobxReactApi.observer],a)}(i.a.Component)}},"+JC4":function(e,t,a){e.exports={"link-container":"link-container-HiE5sijUZM",linkContainer:"link-container-HiE5sijUZM","table-title":"table-title-QXerSasek1",tableTitle:"table-title-QXerSasek1","title-wrapper":"title-wrapper-2UmywY6DKE",titleWrapper:"title-wrapper-2UmywY6DKE",title:"title-17ByYAjPUJ","title-detail":"title-detail-1ax9-h-95G",titleDetail:"title-detail-1ax9-h-95G",current:"current-2KnSQcwQhU","first-table-title":"first-table-title-1x2L9Blkzp",firstTableTitle:"first-table-title-1x2L9Blkzp","is-sub-issue":"is-sub-issue-3e_Ot6oEqd",isSubIssue:"is-sub-issue-3e_Ot6oEqd",tag:"tag-OnRxknb07m",orange:"orange-R0aQvOtO0d",red:"red-25sdUifYfu",gray:"gray-3l8hQT6n_0",epic:"epic-1Eg_rPGjj7",icon:"icon-24obWj6mLq",sub:"sub-2AO3d500Ti",classic:"classic-2GwP9Mrtrk",detail:"detail-hc4p8Zzxbo","icon-placeholder":"icon-placeholder-3Ko-3xYw_2",iconPlaceholder:"icon-placeholder-3Ko-3xYw_2","collapse-icon":"collapse-icon-kPmFNL4X5j",collapseIcon:"collapse-icon-kPmFNL4X5j",collapsed:"collapsed-3-h5ds5-YJ"}},"+STs":function(e,t,a){e.exports={"project-trigger":"project-trigger-1E54QLfo_p",projectTrigger:"project-trigger-1E54QLfo_p",icon:"icon-3zr9cA1PvW",text:"text-p0JWzJBYAU",caret:"caret-3vGdjJkWGM",disabled:"disabled-JVaaYhfBzB",active:"active-YwLUKOexq2","issue-trigger":"issue-trigger-2OUjX4zzdt",issueTrigger:"issue-trigger-2OUjX4zzdt","issue-title":"issue-title-3HHM658arJ",issueTitle:"issue-title-3HHM658arJ","issue-img":"issue-img-1_A4rNUjao",issueImg:"issue-img-1_A4rNUjao","assignee-trigger":"assignee-trigger-117g1Kx76w",assigneeTrigger:"assignee-trigger-117g1Kx76w","priority-trigger":"priority-trigger-57ZNnfuzo4",priorityTrigger:"priority-trigger-57ZNnfuzo4","issue-type-trigger":"issue-type-trigger-1KLSKyvVSa",issueTypeTrigger:"issue-type-trigger-1KLSKyvVSa","issue-type-trigger-with-text":"issue-type-trigger-with-text-1Du3ZjcSFR",issueTypeTriggerWithText:"issue-type-trigger-with-text-1Du3ZjcSFR",epic:"epic-Yjr8q9T3MC",requirement:"requirement-1QKXN9JF0r",assignment:"assignment-Rbv-UrezuC",defect:"defect-2JUzHGEuhp",item:"item-hHjaoTMMmD",content:"content-34jEfXTHcC",checked:"checked-1DzhE9Whca",focus:"focus-2K0QIZvHbm"}},"+WyF":function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjBweCIgaGVpZ2h0PSIyMHB4IiB2aWV3Qm94PSIwIDAgMjAgMjAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDUyLjUgKDY3NDY5KSAtIGh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaCAtLT4KICAgIDx0aXRsZT5maWxlLXR5cGUvaWxsdXN0cmF0b3I8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0i57y66Zm3L+ivpuaDhSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9IumZhOS7tiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTM5Ni4wMDAwMDAsIC02NjAuMDAwMDAwKSI+CiAgICAgICAgICAgIDxnIGlkPSJmaWxlLXR5cGUvaWxsdXN0cmF0b3IiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDM5Ni4wMDAwMDAsIDY2MC4wMDAwMDApIj4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0yLDMuNDYzODk1ODRlLTEzIEwxOCwzLjQ2Mzg5NTg0ZS0xMyBDMTkuMTA0NTY5NSwzLjQ2MTg2Njc4ZS0xMyAyMCwwLjg5NTQzMDUgMjAsMiBMMjAsMTggQzIwLDE5LjEwNDU2OTUgMTkuMTA0NTY5NSwyMCAxOCwyMCBMMiwyMCBDMC44OTU0MzA1LDIwIDEuMzUyNzA3NWUtMTYsMTkuMTA0NTY5NSAwLDE4IEwwLDIgQy0xLjM1MjcwNzVlLTE2LDAuODk1NDMwNSAwLjg5NTQzMDUsMy40NTcwNDMxMWUtMTMgMiwzLjQ1NTAxNDA1ZS0xMyBaIiBpZD0iUmVjdGFuZ2xlLTM3IiBmaWxsPSIjRkM5QTM4Ij48L3BhdGg+CiAgICAgICAgICAgICAgICA8cGF0aCBkPSJNOS42NzE4NzUsMTEuNjI1IEw3Ljc5Mjk2ODc1LDExLjYyNSBMNy40NjQ4NDM3NSwxMi42ODc1IEw2LDEyLjY4NzUgTDguMDg1OTM3NSw3IEw5LjM3NSw3IEwxMS40NzY1NjI1LDEyLjY4NzUgTDEwLjAwMzkwNjIsMTIuNjg3NSBMOS42NzE4NzUsMTEuNjI1IFogTTguMTIxMDkzNzUsMTAuNTY2NDA2MiBMOS4zNDM3NSwxMC41NjY0MDYyIEw4LjczMDQ2ODc1LDguNTkzNzUgTDguMTIxMDkzNzUsMTAuNTY2NDA2MiBaIE0xMy44NTE1NjI1LDEyLjY4NzUgTDEyLjQ4NDM3NSwxMi42ODc1IEwxMi40ODQzNzUsNyBMMTMuODUxNTYyNSw3IEwxMy44NTE1NjI1LDEyLjY4NzUgWiIgaWQ9IkFpIiBmaWxsPSIjRkZGRkZGIj48L3BhdGg+CiAgICAgICAgICAgIDwvZz4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg=="},"+dhI":function(e,t,a){"use strict";a.r(t);var n=a("cDcd"),i=a.n(n),r=a("K2gz"),o=a.n(r),s=a("C9Yq"),l=a.n(s);t.default=function(e){var t=e.priority,a=e.classNames;return i.a.createElement("span",{className:o()(l.a.contanier,a)},i.a.createElement("span",{className:o()(l.a.icon,l.a["priority".concat(t)])}))}},"+eiW":function(e,t,a){e.exports=a.p+"e0f3e55ee672d456b1621ad428e97293.svg"},"/Ev0":function(e,t,a){"use strict";a("I5cv");var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("bWfx"),a("INYr");var i=n(a("lSNA")),r=n(a("lwsE")),o=n(a("W8MJ")),s=n(a("PJYZ")),l=n(a("7W2i")),c=n(a("a1gu")),u=n(a("Nsbk")),d=n(a("cDcd")),f=n(a("17x9")),p=n(a("K2gz")),m=n(a("ePqy"));function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,u.default)(e);if(t){var i=(0,u.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,c.default)(this,a)}}var v=function(e){(0,l.default)(a,e);var t=h(a);function a(e){var n;return(0,r.default)(this,a),(n=t.call(this,e)).tabWrapperRef=d.default.createRef(),n.state={pageSize:e.currentPageSize,offsetLeft:void 0},n.changeTab=n.changeTab.bind((0,s.default)(n)),n}return(0,o.default)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.perPages,n=t.className,r=t.isLoading,o=this.state,s=o.offsetLeft,l=o.pageSize;return d.default.createElement("div",{className:(0,p.default)(m.default.pageTab,n),ref:this.tabWrapperRef},a.length&&a.map((function(t,a){var n;return d.default.createElement("div",{key:"tab".concat(a),className:(0,p.default)(m.default.tab,(n={},(0,i.default)(n,m.default.disabled,r),(0,i.default)(n,m.default.selected,l===t),n)),onClick:function(a){return!r&&e.changeTab(a,t)}},t)})),d.default.createElement("div",{className:(0,p.default)(m.default.tab,m.default.isActive),style:{left:"".concat(s,"px")}},l))}},{key:"changeTab",value:function(e,t){var a=this;window.localStorage.setItem("ISSUE_PAGE_SIZE",t),this.setState({pageSize:t,offsetLeft:e.target.offsetLeft},(function(){a.props.callback(t)}))}},{key:"componentDidMount",value:function(){this.initPosition()}},{key:"initPosition",value:function(){var e=this.state.pageSize,t=this.props.perPages.findIndex((function(t){return t===e}));this.setState({offsetLeft:this.tabWrapperRef.current.children[t].offsetLeft})}}]),a}(d.default.Component);v.propTypes={className:f.default.string,perPages:f.default.array,callback:f.default.func,currentPageSize:f.default.number,isLoading:f.default.bool},v.defaultProps={perPages:[20,50,100,300]};var g=v;t.default=g},"/HD1":function(e,t,a){"use strict";a.r(t),a.d(t,"createRisk",(function(){return i})),a.d(t,"updateRisk",(function(){return r})),a.d(t,"updateRiskDescription",(function(){return o})),a.d(t,"deleteRisk",(function(){return s})),a.d(t,"fetchRiskDetail",(function(){return l})),a.d(t,"fetchRisksActitvites",(function(){return c})),a.d(t,"watchRisk",(function(){return u})),a.d(t,"unWatchRisk",(function(){return d})),a.d(t,"getRiskHistory",(function(){return f})),a.d(t,"addComment",(function(){return p})),a.d(t,"deleteComment",(function(){return m})),a.d(t,"batchUpdateRisks",(function(){return h})),a.d(t,"createWorkItem",(function(){return v})),a.d(t,"updateWorkItem",(function(){return g})),a.d(t,"updateWorkItemDescription",(function(){return E})),a.d(t,"deleteWorkItem",(function(){return b})),a.d(t,"fetchWorkItemDetail",(function(){return y})),a.d(t,"fetchWorkItemActitvites",(function(){return S})),a.d(t,"addWorkItemComment",(function(){return I})),a.d(t,"getWorkItemHistory",(function(){return T})),a.d(t,"watchWorkItem",(function(){return C})),a.d(t,"unWatchWorkItem",(function(){return P})),a.d(t,"deleteWorkItemComment",(function(){return w})),a.d(t,"fetchWorkItemSplittedIssues",(function(){return D})),a.d(t,"workItemSplittingIssues",(function(){return O})),a.d(t,"workItemRemoveSplittedIssue",(function(){return R})),a.d(t,"sortWorkItem",(function(){return j})),a.d(t,"fetchSubWorkItems",(function(){return k})),a.d(t,"fetchParentWorkItems",(function(){return N})),a.d(t,"updateParentWorkItem",(function(){return A})),a.d(t,"deleteIssue",(function(){return L})),a.d(t,"getAvailableIssues",(function(){return F})),a.d(t,"getAvailableChildWorkItems",(function(){return _})),a.d(t,"relateAvailableChildWorkItems",(function(){return M})),a.d(t,"getWorkspaceAvailableIssues",(function(){return x})),a.d(t,"workspaceRemoveSplittedIssue",(function(){return B})),a.d(t,"workspaceSplittingIssues",(function(){return U}));var n=a("Z4vw"),i=function(e,t,a){return void 0===a&&(a=!1),Object(n.postJSON)("/collaboration/api/project/".concat(e,"/issues/risks"),t,a)},r=function(e,t,a,i){return void 0===i&&(i=!1),Object(n.patchJSON)("/collaboration/api/project/".concat(e,"/issues/risks/").concat(t,"/fields"),a,i)},o=function(e,t,a,i){return void 0===i&&(i=!1),Object(n.put)("/collaboration/api/project/".concat(e,"/issues/risks/").concat(t,"/description"),a,i)},s=function(e,t){return Object(n.del)("/collaboration/api/project/".concat(e,"/issues/risks/").concat(t))},l=function(e,t,a,i){return void 0===i&&(i=!1),Object(n.get)("/collaboration/api/project/".concat(e,"/issues/risks/").concat(t,"?").concat(Object(n.buildParams)(a)),i)},c=function(e,t){return Object(n.get)("/collaboration/api/project/".concat(e,"/issues/risks/").concat(t,"/activities"))},u=function(e,t){return Object(n.postJSON)("/collaboration/api/project/".concat(e,"/issues/risks/").concat(t,"/watch"))},d=function(e,t){return Object(n.postJSON)("/collaboration/api/project/".concat(e,"/issues/risks/").concat(t,"/cancel-watch"))},f=function(e,t){return Object(n.get)("/collaboration/api/project/".concat(e,"/issues/risks/").concat(t,"/description/histories"))},p=function(e){var t=e.projectName,a=e.riskCode,i=e.content,r=e.parentID;return Object(n.post)("/collaboration/api/project/".concat(t,"/issues/risks/").concat(a,"/comments"),{content:i,parentId:r})},m=function(e,t,a){return Object(n.del)("/collaboration/api/project/".concat(e,"/issues/risks/").concat(t,"/comments/").concat(a))},h=function(e,t){return Object(n.postJSON)("/collaboration/api/project/".concat(e,"/issues/risks/batch/update"),t)},v=function(e,t,a){return void 0===a&&(a=!1),Object(n.postJSON)("/collaboration/api/project/".concat(e,"/issues/work-items"),t,a)},g=function(e,t,a,i){return void 0===i&&(i=!1),Object(n.patchJSON)("/collaboration/api/project/".concat(e,"/issues/work-items/").concat(t,"/fields"),a,i)},E=function(e,t,a,i){return void 0===i&&(i=!1),Object(n.put)("/collaboration/api/project/".concat(e,"/issues/work-items/").concat(t,"/description"),a,i)},b=function(e,t){return Object(n.del)("/collaboration/api/project/".concat(e,"/issues/work-items/").concat(t))},y=function(e,t,a,i){return void 0===i&&(i=!1),Object(n.get)("/collaboration/api/project/".concat(e,"/issues/work-items/").concat(t,"?").concat(Object(n.buildParams)(a)),i)},S=function(e,t){return Object(n.get)("/collaboration/api/project/".concat(e,"/issues/work-items/").concat(t,"/activities"))},I=function(e){var t=e.projectName,a=e.workItemCode,i=e.content,r=e.parentID;return Object(n.post)("/collaboration/api/project/".concat(t,"/issues/work-items/").concat(a,"/comments"),{content:i,parentId:r})},T=function(e,t){return Object(n.get)("/collaboration/api/project/".concat(e,"/issues/work-items/").concat(t,"/description/histories"))},C=function(e,t){return Object(n.postJSON)("/collaboration/api/project/".concat(e,"/issues/work-items/").concat(t,"/watch"))},P=function(e,t){return Object(n.postJSON)("/collaboration/api/project/".concat(e,"/issues/work-items/").concat(t,"/cancel-watch"))},w=function(e,t,a){return Object(n.del)("/collaboration/api/project/".concat(e,"/issues/work-items/").concat(t,"/comments/").concat(a))},D=function(e,t){return Object(n.get)("/collaboration/api/project/".concat(e,"/issues/work-items/").concat(t,"/splitted-issues"))},O=function(e,t,a,i){return void 0===i&&(i=!1),Object(n.postJSON)("/collaboration/api/project/".concat(e,"/issues/work-items/").concat(t,"/splitted-issues/").concat(a),{},i)},R=function(e,t,a){return Object(n.del)("/collaboration/api/project/".concat(e,"/issues/work-items/").concat(t,"/splitted-issues/").concat(a))},j=function(e,t,a,i){return void 0===i&&(i=!1),Object(n.postJSON)("/collaboration/api/project/".concat(e,"/issues/work-items/").concat(t,"/sub-items/sort"),a,i)},k=function(e,t){return Object(n.get)("/collaboration/api/project/".concat(e,"/issues/work-items/").concat(t,"/sub-items"))},N=function(e,t,a){return Object(n.get)("/collaboration/api/project/".concat(e,"/issues/work-items/").concat(t,"/available-parent-work-items?").concat(Object(n.buildParams)(a)))},A=function(e,t,a,i){return void 0===i&&(i=!1),Object(n.putJSON)("/collaboration/api/project/".concat(e,"/issues/work-items/").concat(t,"/parent-work-items/").concat(a),i)},L=function(e,t,a){return Object(n.del)("/api/project/".concat(e,"/issues/").concat(t,"/").concat(a))},F=function(e,t,a,i){return void 0===i&&(i=!1),Object(n.postJSON)("/collaboration/api/project/".concat(e,"/issues/work-items/").concat(t,"/available-issues"),a,i)},_=function(e,t,a){return Object(n.get)("/collaboration/api/project/".concat(e,"/issues/work-items/").concat(t,"/available-child-work-items?").concat(Object(n.buildParams)(a)))},M=function(e,t,a){return Object(n.putJSON)("/collaboration/api/project/".concat(e,"/issues/work-items/").concat(t,"/parent-work-items/").concat(a))},x=function(e,t,a){return void 0===a&&(a=!1),Object(n.postJSON)("/api/requirements/issues/".concat(e,"/available-related-issues"),t,a)},B=function(e,t){return Object(n.postJSON)("/api/requirements/issues/".concat(e,"/cancel-issue-relate"),t)},U=function(e,t){return Object(n.postJSON)("/api/requirements/issues/".concat(e,"/issue-relate"),t)}},"/O9+":function(e,t,a){"use strict";a.r(t);var n=a("cDcd"),i=a.n(n),r=a("K2gz"),o=a.n(r),s=a("sM/k"),l=a.n(s),c=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(t,a)};return function(t,a){if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c(t,e),t.prototype.render=function(){var e=this.props,t=e.title,a=e.description,n=e.classname,r=e.icon,s=e.children;return i.a.createElement("div",{className:o()(l.a.emptyPage,n)},i.a.createElement("div",{className:o()(l.a.emptyIcon,r)}),t&&i.a.createElement("div",{className:l.a.emptyTitle},t),i.a.createElement("div",{className:l.a.emptyDescription},a),s)},t}(i.a.Component);t.default=u},"/TLM":function(e,t,a){e.exports={"loading-text":"loading-text-1VE73KL1dU",loadingText:"loading-text-1VE73KL1dU"}},"/W8C":function(e,t,a){e.exports=a.p+"e53f18058adb391d5176e57f947ff14d.svg"},"/cKC":function(e,t,a){e.exports={category:"category-2YDjG3Mhm3","category-mission":"category-mission-390sNeqIFT",categoryMission:"category-mission-390sNeqIFT","category-requirement":"category-requirement-IF28Emf2Ir",categoryRequirement:"category-requirement-IF28Emf2Ir","category-defect":"category-defect-dv9l8yVnM4",categoryDefect:"category-defect-dv9l8yVnM4","category-iteration":"category-iteration-2TWDpPMQF6",categoryIteration:"category-iteration-2TWDpPMQF6","category-epic":"category-epic-3ETCc1Wt1C",categoryEpic:"category-epic-3ETCc1Wt1C","category-iteration-black":"category-iteration-black-20ug8MRN4s",categoryIterationBlack:"category-iteration-black-20ug8MRN4s","category-sub-issue":"category-sub-issue-3DdjLNaCN_",categorySubIssue:"category-sub-issue-3DdjLNaCN_"}},"/y0v":function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a("mVeg"),i=a("cDcd"),r=a.n(i),o=a("TPfW"),s=a.n(o),l=a("K2gz"),c=a.n(l),u=(a("7FZc"),function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o}),d=(r.a.memo((function(e){var t=e.selected,a=e.disabled,i=e.open,o=a?c()(s.a.simpleTrigger,s.a.disabled):s.a.simpleTrigger;if(t&&(null===t||void 0===t?void 0:t.length)>0){var l=u(t,1)[0];return r.a.createElement("div",{className:c()([o,i?s.a.expand:""])},r.a.createElement("img",{className:s.a.avatar,src:null===l||void 0===l?void 0:l.avatar}),r.a.createElement("span",{className:s.a.name,title:null===l||void 0===l?void 0:l.name},null===l||void 0===l?void 0:l.name),r.a.createElement("div",{className:s.a.caretDown}))}return r.a.createElement("div",{className:c()([o,i?s.a.expand:""])},r.a.createElement("span",{className:s.a.defaultAvatar}),r.a.createElement("span",{className:c()([s.a.name,s.a.noAssginee])},Object(n.t)("\u672a\u6307\u5b9a")),r.a.createElement("div",{className:s.a.caretDown}))})),function(e){var t=e.setUndefined,a=e.undefinedConst;return r.a.createElement("div",{className:s.a.menuItem,onClick:t},r.a.createElement("span",{className:s.a.defaultAvatar}),r.a.createElement("span",{className:s.a.nameUndefined},Object(n.t)("\u672a\u6307\u5b9a")),a&&r.a.createElement("span",{className:s.a.checked}))});t.b=function(e){var t=e.item,a=e.selected,n=e.onSelect,o=(null===a||void 0===a?void 0:a.filter((function(e){return void 0!==e})).filter((function(e){return e.id===t.id})).length)>0,l=u(Object(i.useState)(null===a||void 0===a?void 0:a.includes(t)),2),c=l[0],d=l[1];return Object(i.useEffect)((function(){d(o)})),r.a.createElement("div",{className:s.a.menuItem,onClick:function(){d(!c),n()}},r.a.createElement("img",{className:s.a.avatar,src:t.avatar}),r.a.createElement("span",{className:s.a.name,title:t.name},t.name),c&&r.a.createElement("span",{className:s.a.checked}))}},"0+fR":function(e,t,a){},"08Wx":function(e,t,a){e.exports={"creation-wrapper":"creation-wrapper-1dRYOHcrHx",creationWrapper:"creation-wrapper-1dRYOHcrHx","creation-trigger":"creation-trigger-18mdEJi40j",creationTrigger:"creation-trigger-18mdEJi40j",disabled:"disabled-R3vcT6FZjf","dropdown-menu":"dropdown-menu-3PDuwhYIEm",dropdownMenu:"dropdown-menu-3PDuwhYIEm",item:"item-3ZqUW9CSIN","item-icon":"item-icon-36SIWhJBj5",itemIcon:"item-icon-36SIWhJBj5","item-name":"item-name-2cCLLzH5m4",itemName:"item-name-2cCLLzH5m4"}},"0YfX":function(e,t,a){"use strict";a("mVeg");var n=a("cDcd"),i=a.n(n),r=a("TPfW"),o=a.n(r),s=(a("7FZc"),function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o});t.a=function(e){var t=e.item,a=e.selected,r=e.onSelect,l=a.filter((function(e){return e.value===t.value||e.id===t.id})).length>0,c=s(Object(n.useState)(a.includes(t)),2),u=c[0],d=c[1];return Object(n.useEffect)((function(){d(l)})),i.a.createElement("div",{className:o.a.menuItem,onClick:function(){d(!u),r()}},i.a.createElement("img",{className:o.a.projectAvatar,src:t.icon}),i.a.createElement("span",{className:o.a.name,title:t.name},t.display_name),u&&i.a.createElement("span",{className:o.a.checked}))}},"0gM1":function(e,t,a){e.exports={"page-wrapper":"page-wrapper-15DjJCB2GP",pageWrapper:"page-wrapper-15DjJCB2GP","page-trigger":"page-trigger-3BQDOGcX6c",pageTrigger:"page-trigger-3BQDOGcX6c",nums:"nums-2idOtEv26p","cart-down":"cart-down-2J8wSb5755",cartDown:"cart-down-2J8wSb5755","is-expanded":"is-expanded-46I5mPbDzS",isExpanded:"is-expanded-46I5mPbDzS","page-panel":"page-panel-11rBr1JrmD",pagePanel:"page-panel-11rBr1JrmD",header:"header-mEsYUNOrK7","loading-wrapper":"loading-wrapper-1yN2J_5o2f",loadingWrapper:"loading-wrapper-1yN2J_5o2f","page-size-wrapper":"page-size-wrapper-SC5SjaJ0U3",pageSizeWrapper:"page-size-wrapper-SC5SjaJ0U3",body:"body-15hdrdC7Sy",page:"page-2l0K4o6-av","is-active":"is-active-2pDjICa5Oq",isActive:"is-active-2pDjICa5Oq",footer:"footer-1Mk8dp15T5","input-page":"input-page-3nUhLx4EHh",inputPage:"input-page-3nUhLx4EHh","btn-go":"btn-go-2Jq3u__twV",btnGo:"btn-go-2Jq3u__twV",icon:"icon-3VHaXLq1hp"}},"1Epj":function(e,t,a){"use strict";var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.fieldList=t.allChooes=t.typeFilter=t.allGroupCheck=t.GroupData=t.dataFilter=void 0;var i=n(a("lSNA"));a("RW0V"),a("f3/d");var r=n(a("EPIV")),o=function(e){return Object.keys(e).indexOf("attributes")?0:1},s=function(e,t){var a=[];return e.forEach((function(e){"CODE"!==e.key&&"ISSUE_TYPE"!==e.key&&"NAME"!==e.key&&a.push({label:React.createElement("div",{className:r.default.labelTool},e.name),value:"system"===t?e.key:e.issueFieldIds[0],key:e.key})})),a};t.dataFilter=function(e){var t=[];return e.forEach((function(e){var a,n;"system"===Object.keys(e)[o(e)]?t.push((a={},(0,i.default)(a,Object.keys(e)[o(e)],e[Object.keys(e)[o(e)]]),(0,i.default)(a,"groupAttribute",s(e.attributes,"system")),a)):t.push((n={},(0,i.default)(n,Object.keys(e)[o(e)],e[Object.keys(e)[o(e)]]),(0,i.default)(n,"groupAttribute",s(e.attributes,"custom")),n))})),t};t.GroupData=function(e){var t={};return e.forEach((function(e){var a="".concat(Object.keys(e)[Object.keys(e).indexOf("attributes")?0:1],"checkList");t[a]=[]})),t};t.allGroupCheck=function(e){var t={};return e.forEach((function(e){var a="".concat(Object.keys(e)[0],"Checked");t[a]=!1})),t};t.typeFilter=function(e){var t=[];return e.forEach((function(e){t.push(Object.keys(e)[0])})),t};t.allChooes=function(e,t){var a=[];return e.forEach((function(e){"".concat(Object.keys(e)[0])===t&&e.groupAttribute.forEach((function(e){a.push(e.value)}))})),a};t.fieldList=function(e){var t=[],a=[],n=[];return e.forEach((function(e){"system"===Object.keys(e)[o(e)]?e.attributes.forEach((function(e){"CODE"===e.key||"ISSUE_TYPE"===e.key||"NAME"===e.key?n.push({issueFieldId:e.issueFieldId,issueFieldIds:e.issueFieldIds?[e.issueFieldIds[0]]:null,key:e.key,name:e.name,selected:!0}):t.push({issueFieldId:e.issueFieldId,issueFieldIds:e.issueFieldIds?[e.issueFieldIds[0]]:null,key:e.key,name:e.name,selected:!0})})):e.attributes.forEach((function(e){a.push({issueFieldId:e.issueFieldId,issueFieldIds:[e.issueFieldIds[0]],key:e.key,name:e.name,selected:!0})}))})),{systemfield:t,customfield:a,defaultCHoose:n}}},"1YQb":function(e,t,a){"use strict";a.r(t),a.d(t,"UNSPECIFIC",(function(){return S})),a.d(t,"UNSPECIFIC_ITEM",(function(){return I})),a.d(t,"LabeledDropdowTrigger",(function(){return T}));var n=a("mVeg"),i=a("cDcd"),r=a.n(i),o=a("NIJN"),s=a.n(o),l=a("7tbW"),c=a.n(l),u=a("sEfC"),d=a.n(u),f=a("e6EU"),p=a.n(f),m=a("K2gz"),h=a.n(m),v=a("7FZc"),g=a("Fl7e"),E=a("uM7l"),b=a.n(E),y=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},S="UNSPECIFIC",I={value:S,text:Object(n.t)("\u672a\u6307\u5b9a"),id:0},T=function(e){var t=e.label,a=e.defaultText,i=e.customTriggerText,o=e.selected,s=e.valueChanged,l=e.noMatched,c=e.noMatchedText,u=e.toolTipText,d=e.list,f=e.type,m="";return m=i||(o&&o.length&&d&&d.length?d.filter((function(e){return"iterationTests"===f?o.includes(e.id):o.includes(e.value)})).map((function(e){return e.text})).join(","):l?c||Object(n.t)("\u672a\u5339\u914d"):a||Object(n.t)("\u5168\u90e8")),r.a.createElement("div",{className:p.a.trigger},t&&r.a.createElement("span",{className:p.a.title},t),r.a.createElement("span",{className:p.a.name},m),r.a.createElement("div",{className:p.a.caretDown}),!!s&&r.a.createElement(v.TooltipTrigger,{title:u},r.a.createElement("div",{className:p.a.configError})))};t.default=function(e){var t=e.className,a=e.children,o=e.isDisabled,l=e.multiple,u=e.list,f=e.value,m=e.show,v=e.hideTriggerBg,E=e.hideTriggerPadding,I=e.searchable,T=e.expanded,C=e.toggleExpand,P=e.onSelect,w=e.onInvertSelect,D=e.onClear,O=e.onReachBottom,R=e.onSearch,j=e.onClearProp,k=e.customMenuItem,N=e.unControlled,A=void 0!==N&&N,L=e.type,F=e.rootContainerId,_=void 0===F?"":F,M=e.invertabled,x=e.selectAfterClose,B=e.dropdownStyle,U=y(Object(i.useState)(Boolean(m)),2),W=U[0],Y=U[1],H=y(Object(i.useState)(f),2),V=H[0],G=H[1],K=Object(i.useRef)(null),z=Object(i.useRef)(null),q=Object(i.useRef)(null),Z=Object(i.useRef)(null),J=Object(i.useRef)(null),X=y(Object(i.useState)(!1),2),Q=X[0],$=X[1],ee=y(Object(i.useState)(0),2),te=ee[0],ae=ee[1],ne=y(Object(i.useState)(""),2),ie=ne[0],re=ne[1],oe=y(Object(i.useState)(!1),2),se=oe[0],le=oe[1],ce=y(Object(i.useState)(!1),2),ue=ce[0],de=ce[1],fe=y(Object(i.useState)(u),2),pe=fe[0],me=fe[1],he=y(Object(i.useState)(void 0),2),ve=he[0],ge=he[1];Object(i.useEffect)((function(){if(l)G(null===f||void 0===f?void 0:f.filter((function(e){return void 0!==e})));else if(Array.isArray(f)&&f.length){var e=b()(f),t=e.splice(e.length-1);G(null===t||void 0===t?void 0:t.filter((function(e){return void 0!==e})))}else G([]);if(u&&u.length)if(ie){var a=u.filter((function(e){var t;return null===(t=null===e||void 0===e?void 0:e.text)||void 0===t?void 0:t.toLowerCase().includes(ie.toLowerCase())}));me(a)}else me(u)}),[f,u,l]),Object(i.useEffect)((function(){var e=function(){if(z&&z.current){var e=z.current.scrollHeight,t=z.current.scrollTop,a=z.current.clientHeight;le(t>0),e-a===t&&O&&O(!0)}};return z&&z.current&&z.current.addEventListener("scroll",e,!0),function(){z&&z.current&&z.current.removeEventListener("scroll",e,!0)}})),Object(i.useEffect)((function(){if(ie&&u&&u.length){var e=u.filter((function(e){var t;return null===(t=null===e||void 0===e?void 0:e.text)||void 0===t?void 0:t.toLowerCase().includes(ie.toLowerCase())}));me(e)}else me(u)}),[ie]);var Ee=d()((function(e){R&&R(e)}),200),be=function(e){var t=null===V||void 0===V?void 0:V.filter((function(t){return t===e.id})),a=[];a=l?(null===t||void 0===t?void 0:t.length)>0?null===V||void 0===V?void 0:V.filter((function(t){return t!==e.id})):c()(s()(V,e.id)):c()(s()([],e)),A||G(a),P(e.id),x&&Y(!1)},ye=function(){V&&V.length&&(G([]),D&&D([]))},Se=function(){var e=u.filter((function(e){return!(f||[]).includes(null===e||void 0===e?void 0:e.value)})).map((function(e){return null===e||void 0===e?void 0:e.value}));w&&w(e)},Ie={};Q&&(Ie={top:"-".concat(te,"px")});var Te=r.a.createElement("div",{className:"".concat(h()(p.a.dropdown,t,B)," newfilter-dropdown"),style:Ie,ref:J},r.a.createElement("div",{className:p.a.menuWrapper},I&&r.a.createElement("div",{className:p.a.searchInput},r.a.createElement("span",{className:p.a.searchIcon}),r.a.createElement("input",{ref:Z,className:p.a.input,placeholder:Object(n.t)("\u641c\u7d22"),value:ie,onChange:function(e){var t=e.target.value;re(t),R&&Ee(t)}}),ie.length>0&&r.a.createElement("span",{className:p.a.close,onClick:function(){re(""),R&&Ee("")}})),D&&r.a.createElement("div",{className:se?h()(p.a.selections,p.a.scrolling):p.a.selections},l?r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:h()(p.a.text,(null===V||void 0===V?void 0:V.length)?"":p.a.textLight)},Object(n.t)("\u5df2\u9009 {{count}} \u9879",{count:(null===V||void 0===V?void 0:V.length)||0})),(null===V||void 0===V?void 0:V.length)>0&&r.a.createElement("span",{className:p.a.clear,onClick:function(){return ye()}},Object(n.t)("\u6e05\u9664\u5df2\u9009")),M&&(null===V||void 0===V?void 0:V.length)>0&&r.a.createElement("span",{className:p.a.clear,onClick:Se},Object(n.t)("\u53cd\u9009"))):r.a.createElement("span",{className:(null===V||void 0===V?void 0:V.length)>0?p.a.clearSingle:p.a.textLight,onClick:function(){return ye()}},Object(n.t)("\u6e05\u9664\u5df2\u9009\u62e9\u9879"))),r.a.createElement("div",{className:p.a.list,ref:z},!pe.length&&r.a.createElement("div",{className:p.a.noItem},Object(n.t)("\u65e0\u76f8\u5173\u6761\u76ee")),!!pe.length&&r.a.createElement("div",{className:p.a.menuList,ref:q,onMouseLeave:function(){return ge(void 0)}},pe.map((function(e,t){return r.a.createElement("div",{className:h()(p.a.menuItemWrapper,ve===t?p.a.focus:""),onMouseEnter:function(){return ge(t)},onClick:function(){return be(e)},key:"".concat(e.value,"-").concat(t)},k?k({index:t,item:e,selected:V}):function(e){var t=e.item,a="iterationTests"===L?null===V||void 0===V?void 0:V.filter((function(e){return e===t.id})).length:null===V||void 0===V?void 0:V.filter((function(e){return e===t.value})).length,n=V&&V.length&&a||!1;return r.a.createElement("div",{className:p.a.menuItem,onClick:function(){be(t)}},t.avatar&&r.a.createElement("img",{className:p.a.menuItemIcon,src:t.avatar}),r.a.createElement("span",{className:h()(p.a.menuItemName,t.value===S&&p.a.unspecific)},t.text),n&&r.a.createElement("span",{className:p.a.menuItemChecked}))}({index:t,item:e,selected:V}))})))))),Ce=Object(g.a)({Children:Te,rootContainerId:_,dropRef:K,rootClass:"".concat(p.a.dropdownWrapper," drop-pop-container")}),Pe=Ce.getPanel,we=Ce.panelRef;return Object(i.useEffect)((function(){var e,t,a;function n(e){var t=e.path||e.composedPath();t.includes(K.current)||t.includes(we.current)||Y(!1)}function i(e){if(q&&q.current&&z&&z.current){var t=q.current.children[e],a=z.current.getBoundingClientRect(),n=t.getBoundingClientRect(),i=n.top+n.height-a.top;i>a.height?z.current.scrollTop+=i-a.height:i<n.height&&(z.current.scrollTop-=n.height-i)}}function r(e){if("Escape"===e.key)Y(!1),de(!1);else if("ArrowDown"===e.key){var t=0;"undefined"===typeof ve&&(t=0),"number"===typeof ve&&pe.length&&(t=ve+1===pe.length?0:ve+1),i(t),ge(t)}else if("ArrowUp"===e.key){if("number"===typeof ve&&pe.length){var a=ve-1<0?pe.length-1:ve-1;i(a),ge(a)}}else"Enter"===e.key&&"number"===typeof ve&&pe.length&&be(pe[ve])}if(W){if(K.current&&J.current)if((null===(e=K.current)||void 0===e?void 0:e.getBoundingClientRect()).top+(null===(t=J.current)||void 0===t?void 0:t.getBoundingClientRect()).height>window.innerHeight-44){if($(!0),z&&z.current){var o=(null===(a=z.current)||void 0===a?void 0:a.getBoundingClientRect()).height;ae(o)}}else $(!1);Z.current&&Z.current.focus(),document.addEventListener("click",n),document.addEventListener("keydown",r),document.addEventListener("dragstart",n)}return function(){document.removeEventListener("click",n),document.removeEventListener("keydown",r),document.removeEventListener("dragstart",n)}}),[W,ve]),r.a.createElement("div",{className:"".concat(p.a.dropdownWrapper," newfilter-dropdown"),ref:K,onMouseOver:function(){return de(!0)},onMouseLeave:function(){return de(!1)}},r.a.createElement("div",{className:"".concat(h()(p.a.triggerWrapper,W?p.a.active:"",v&&p.a.hideTriggerBg,E&&p.a.hideTriggerPadding,o&&p.a.disabled)," newfilter-trigger"),onClick:function(){o||(C&&C(!T),Y(!W))}},a&&Object(i.cloneElement)(a,{open:W||T,selected:V,value:f,list:u}),(W||ue)&&j&&r.a.createElement("div",{className:h()(p.a.clearButton,p.a.alignTop),onClick:j})),C&&T&&r.a.createElement("div",{className:h()(p.a.dropdown,t),style:Ie,ref:J},Te),!C&&W&&Pe())}},"1kIL":function(e,t,a){e.exports=a.p+"0af529a2b46a5432a8fb078fb6206e42.svg"},"2CQ4":function(e,t,a){"use strict";var n=a("mVeg"),i=a("cDcd"),r=a.n(i),o=a("dEY8"),s=a.n(o),l=a("VE/U"),c=a("AUsL"),u=a("K2gz"),d=a.n(u),f=a("Y+p1"),p=a.n(f),m=a("WN9O"),h=a("B6Qx"),v=a.n(h),g=a("xgZS"),E=a("9+7+"),b=a("sEfC"),y=a.n(b),S=a("w2Sj"),I=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(t,a)};return function(t,a){if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),T=function(){return(T=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},C=function(e,t,a,n){var i,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,a,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(r<3?i(o):r>3?i(t,a,o):i(t,a))||o);return r>3&&o&&Object.defineProperty(t,a,o),o},P=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},w=function(e,t,a){if(a||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},D=function(e){function t(t){var a=e.call(this,t)||this;return a.getIsShowInTop=function(){var e=a.popRef.current,t=a.triggerRef.current;return t.getBoundingClientRect().y+parseFloat(getComputedStyle(t).height)+parseFloat(getComputedStyle(e).height)>window.innerHeight-20},a.getIsShowToTop=function(){var e=a.menuContainerRef.current,t=a.triggerRef.current;return t.getBoundingClientRect().y+parseFloat(getComputedStyle(t).height)+parseFloat(getComputedStyle(e).height)>window.innerHeight-20},a.stopPropagation=function(e){e.nativeEvent.stopImmediatePropagation()},a.hide=function(e){void 0===e&&(e=null);var t=!0;a.props.isTimePicker&&e&&e.composedPath().forEach((function(e){var a=e;a.classList&&a.classList.contains("cuk-datetimepicker-menu")&&(t=!1)}));t&&(a.setState({collapsed:!1}),document.removeEventListener("click",a.hide))},a.renderTreeSelect=function(){var e=a.state,t=e.isShowInTop,n=e.isShowToTop,i=e.count,o=e.checkItems,c=a.props,u=c.dropdownClassName,f=c.options,p=c.isPortal,m=c.required,h=(c.value,c.multiple),v=c.modeType,b=Object(E.transTreeNode)(f);return r.a.createElement("div",{className:d()(u,p&&s.a.customSelect,p&&s.a.customSelectPortal,p&&n&&s.a.customSelectToTop,!p&&s.a.customSelectNotPortal,!p&&t&&s.a.customSelectInTop,v===S.a.select&&s.a.fullTreeSelectDropdown),onClick:a.stopPropagation,ref:a.popRef},r.a.createElement(l.TreeSelectDropdown,{key:i,menuContainerRef:a.menuContainerRef,treeSelectProps:{className:s.a.myCls,onCheck:function(e,t){if(m&&!t.length)return Object(g.warning)("\u5fc5\u586b\u9879, \u4e0d\u80fd\u6e05\u9664"),void a.setState((function(e){return{count:e.count+1}}));a.setState({checkItems:e}),a.debounceOnchange(t)},treeData:b,multiple:h,defaultCheckedKeys:null===o||void 0===o?void 0:o.map((function(e){return e&&e.value}))},dropdownProps:{className:s.a.dropdownClass,open:open},searchable:!0,clearable:!0,onClearAllSelectedItems:function(){if(m)return Object(g.warning)("\u5fc5\u586b\u9879, \u4e0d\u80fd\u6e05\u9664"),void a.setState((function(e){return{count:e.count+1}}));a.setState({checkItems:[]}),a.debounceOnchange([])},trigger:r.a.createElement("div",null)}))},a.handleOnClearProp=function(){var e=a.props.onClearProp;e&&e()},a.state={date:null,collapsed:!!a.props.open&&a.props.open,isElemScroll:!1,isShowInTop:!1,isShowToTop:!1,checkItems:[],count:0},a.props.open&&document.addEventListener("click",a.hide),a.onToggle=a.onToggle.bind(a),a.debounceOnchange=y()(a.onChange.bind(a),1e3),a.triggerRef=Object(i.createRef)(),a.popRef=Object(i.createRef)(),a.menuContainerRef=Object(i.createRef)(),a}return I(t,e),t.prototype.componentDidMount=function(){var e=this.props,t=e.value,a=e.options;if(Array.isArray(t)&&t.length){var n=Array.from(new Set(t)).map((function(e){return Object(E.flattenTreeLastNodeList)(a||[]).find((function(t){return t.value===e}))})).filter((function(e){return null===e||void 0===e?void 0:e.isLastLeaf}));this.setState({checkItems:w([],P(n),!1)})}else this.setState({checkItems:[]})},t.prototype.UNSAFE_componentWillReceiveProps=function(e){if(!p()(e.value,this.props.value)||!p()(e.options,this.props.options))if(Array.isArray(e.value)&&e.value.length){var t=Array.from(new Set(e.value)).map((function(t){return Object(E.flattenTreeLastNodeList)(e.options||[]).find((function(e){return e.value===t}))})).filter((function(e){return null===e||void 0===e?void 0:e.isLastLeaf}));this.setState({checkItems:w([],P(t),!1)})}else this.setState({checkItems:[]})},t.prototype.onChange=function(e){!this.props.isDisabled&&this.props.onChange&&this.props.onChange(e)},t.prototype.onToggle=function(){var e=this,t=this.props,a=t.isDisabled,n=t.calculatePosition;a||this.setState({collapsed:!this.state.collapsed},(function(){n&&n({itemsHeight:303,itemsWidth:200}),e.state.collapsed?(document.addEventListener("click",e.hide),e.props.isPortal?e.setState({isShowToTop:e.getIsShowToTop()}):e.setState({isShowInTop:e.getIsShowInTop()})):document.removeEventListener("click",e.hide)}))},t.prototype.treeTirgger=function(){var e,t,a=this,n=this.state,i=n.collapsed,o=n.checkItems,l=this.props,c=l.isDisabled,u=l.isPortal,f=l.portalProps,p=l.trigger,h=l.className,g=l.modeType,E=l.label,b=l.showClose;return r.a.createElement("div",{className:d()(s.a.select,!c&&s.a.customSelect,h)},r.a.createElement("div",{ref:this.triggerRef,className:s.a.trigger},p?p({collapsed:i,onToggle:this.onToggle}):r.a.createElement("div",{className:s.a.triggerInput,title:null===(e=null===o||void 0===o?void 0:o.map((function(e){return e&&e.title})))||void 0===e?void 0:e.join(","),onClick:function(e){return e.preventDefault(),!c&&a.onToggle()}},g!==S.a.select&&E&&r.a.createElement("div",{className:s.a.label},E),o.length?r.a.createElement("div",{className:s.a.textEllipsis},null===(t=null===o||void 0===o?void 0:o.map((function(e){return e&&e.title})))||void 0===t?void 0:t.join(",")):E?r.a.createElement("div",null,"\u5168\u90e8"):r.a.createElement("div",{className:s.a.placeholder},"\u8bf7\u9009\u62e9"),r.a.createElement(v.a,{className:d()(s.a.downIcon,E&&s.a.minSize)})),b&&E&&r.a.createElement("a",{className:d()(s.a.clearButton,s.a.alignTop),onClick:this.handleOnClearProp})),r.a.createElement(r.a.Fragment,null,i&&(u&&f?r.a.createElement(m.default,T({},f,{relatedElem:this.triggerRef.current}),this.renderTreeSelect()):this.renderTreeSelect())))},t.prototype.render=function(){return r.a.createElement(r.a.Fragment,null,this.treeTirgger())},t.defaultProps={placeholder:Object(n.t)("\u8bf7\u9009\u62e9"),isDisabled:!1,isTimePicker:!1,arrowPosition:"left",needParseDate:!0,coloredDateText:!1,portalContainer:"coding-project-management-frontend"},t=C([c.a],t)}(i.Component);t.a=D},"2KQ+":function(e,t,a){"use strict";a.r(t);var n=a("cDcd"),i=a.n(n),r=a("sftu"),o=a.n(r),s=a("mVeg"),l=a("K2gz"),c=a.n(l),u=a("zmh9"),d=a.n(u),f=a("DxFu"),p=a("KPKf"),m=a("Sc0l"),h=a.n(m),v=a("z0hg"),g=a("xgZS"),E=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(t,a)};return function(t,a){if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),b=function(e){function t(t){var a=e.call(this,t)||this;return a.renderToolBar=function(){var e=a.state,t=e.moreDropdownShow,i=e.showEdits,r=a.props.changeShowEdit;return n.createElement(n.Fragment,null,i?n.createElement(d.a,{onClick:a.onEditClick,style:{marginRight:"10px"}},Object(s.t)("\u5728\u7ebf\u7f16\u8f91")):n.createElement(d.a,{onClick:function(){r(!0)},style:{marginRight:"10px"}},Object(s.t)("\u9884\u89c8")),n.createElement(d.a,{onClick:a.onDownloadClick},Object(s.t)("\u4e0b\u8f7d\u6587\u4ef6")),n.createElement("div",{className:c()([h.a.previewBtn,h.a.moreBtn,t?h.a.moreBtnActive:""]),onClick:a.toggleDel},n.createElement("div",{className:h.a.more}),t&&n.createElement("div",{className:h.a.drowdown},n.createElement("div",{className:h.a.item,onClick:a.onDelete},Object(s.t)("\u5220\u9664")))))},a.onDownloadClick=function(){var e=a.props.current,t=e.type,n=e.size,i=e.url,r=n>p.MIN_DOWNLOAD_FILES_SIZE;(p.TYPE.FOLDER!==t||!r&&0!==n)&&i&&window.open(i)},a.onEditClick=function(){var e=a.props.current.fileType;/(doc|dot|wps|wpt|docx|dotx|docm|dotm|xls|xlt|et|xIsx|xltx|xlsm|xltm|ppt|pptx|pptm|ppsx|ppsm|pps|potx|potm|dpt|dps|pdf)/.test(String(e))?a.props.changeShowEdit(!1):Object(g.warning)("\u201c\u5728\u7ebf\u7f16\u8f91\u201c\u529f\u80fd\u4e0d\u652f\u6301\u8be5\u7c7b\u578b\u6587\u4ef6")},a.onDelete=function(){var e=a.props,t=e.currentId,n=e.currentFileId;(0,e.onHandleDelAttachment)(+t,n)},a.toggleDel=function(){var e=a.state.moreDropdownShow;document.removeEventListener("click",a.hideDel,!1),e?a.hideDel():(a.showDel(),document.addEventListener("click",a.hideDel,!1))},a.hideDel=function(){a.setState({moreDropdownShow:!1})},a.showDel=function(){a.setState({moreDropdownShow:!0})},a.state={moreDropdownShow:!1,editUrl:"",showEdits:!0},a}return E(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.showEdit!==this.props.showEdit&&this.setState({showEdits:e.showEdit})},t.prototype.getStaticFile=function(e){var t=e.name,n=t&&t.replace(/.+\./,"").toUpperCase(),i=e.isModao?"modao":f.FILE_TYPE_MAP.get(n)||"others";return a("9skM")("./".concat(i,".svg"))},t.prototype.render=function(){var e=this.props,t=e.current,a=e.onClose,i="MODAO"===t.thirdType;return n.createElement("div",{className:h.a.viewerFileBar},n.createElement("div",{className:h.a.attachmentsItemLogo,style:{backgroundImage:"url("+this.getStaticFile(t)+")"}}),n.createElement("div",{className:h.a.viewerFileName},n.createElement("span",{title:t.name},t.name)),!i&&t.size&&n.createElement("div",{className:h.a.viewerFileSize},n.createElement("span",null,"\xb7 ",Object(v.formatSize)(t.size))),n.createElement("div",{className:h.a.viewerFileAction},!i&&this.renderToolBar(),n.createElement("div",{className:h.a.previewBtn},n.createElement("div",{className:h.a.close,onClick:a}))))},t}(n.Component),y=a("6cNi"),S=a.n(y),I=a("D0tD"),T=a.n(I),C=a("eNR4"),P=a("30Wv"),w=a.n(P),D=a("2oPZ"),O=a("g84+"),R=a.n(O),j=a("L/oC"),k=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(t,a)};return function(t,a){if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),N=function(e){function t(t){var a=e.call(this,t)||this;return a.state={html:""},a}return k(t,e),t.prototype.fetchMarkdownPreview=function(e){var t=this,a=this.props,n=a.enterpriseGlobalKey,i=a.currentProjectName;return Object(j.getMarkdownPreview)(n,i,e).then((function(e){var a=e.data;t.setState({html:a})}))},t.prototype.render=function(){var e=this,t=this.state.html,a=this.props.fileId;return i.a.createElement(D.a,{className:O.filePreview,fileId:a,version:"11",fetchPromise:function(t){return e.fetchMarkdownPreview(t)},fileTypeName:Object(s.t)("Markdown \u6587\u4ef6")},i.a.createElement("div",{className:O.filePreviewMarkdown},i.a.createElement(w.a,{html:t})))},t}(n.Component),A=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(t,a)};return function(t,a){if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),L=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderVideoPlayer=function(){var e=t.props.file;return i.a.createElement("video",{src:"".concat(e.url,"?t=").concat((new Date).getTime()),height:"90%",controls:!0,preload:"auto"})},t}return A(t,e),t.prototype.render=function(){var e=this.props.file.fileId;return i.a.createElement(D.a,{className:O.filePreview,fileId:e,version:"11",fetchPromise:function(){return Promise.resolve()},fileTypeName:Object(s.t)("\u89c6\u9891\u6587\u4ef6")},this.renderVideoPlayer())},t}(n.Component),F=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(t,a)};return function(t,a){if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),_=function(e){function t(t){var a=e.call(this,t)||this;return a.state={cosPreviewUrl:""},a}return F(t,e),t.prototype.fetchDownloadUrl=function(e){var t=this,a=this.props,n=a.projectID;return(a.showEdit?Object(j.getOfficePreview)(n,e):Object(j.getOfficeEdit)(n,e)).then((function(e){t.setState({cosPreviewUrl:e.data})}))},t.prototype.render=function(){var e=this,t=this.state.cosPreviewUrl,a=this.props,n=a.file.fileId,r=a.showEdit;return i.a.createElement(D.a,{showEdit:r,className:O.filePreview,fileId:n,version:"11",fileTypeName:Object(s.t)("Office \u6587\u4ef6"),fetchPromise:function(t){return e.fetchDownloadUrl(t)}},i.a.createElement("iframe",{className:O.filePreviewOffice,src:t,frameBorder:"0",allowFullScreen:!0}))},t}(n.Component),M=a("CDXi"),x=a("TT2u"),B=a.n(x),U=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(t,a)};return function(t,a){if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),W=function(e){function t(t,a){return e.call(this,t,a)||this}return U(t,e),t.prototype.render=function(){return i.a.createElement(i.a.Fragment,null,this.renderPreview())},t.prototype.renderDownloadIcon=function(){var e,t=this.props.current,a=t.fileType,n=t.url,r=a&&a.length||0,o=r>10?10:r,s=c()(((e={})["file-type-size-".concat(o)]=o,e));return i.a.createElement("div",{className:R.a.filePreview},i.a.createElement("a",{href:n,target:"_blank"},i.a.createElement("div",{className:R.a.previewDownload},i.a.createElement("h3",{className:s,title:a},a),i.a.createElement(S.a,null))))},t.prototype.renderFolder=function(){return i.a.createElement("div",{className:R.a.filePreview},i.a.createElement("img",{width:"200",src:T.a,alt:"folder"}))},t.prototype.renderPreview=function(){var e=this.props.current,t=e.type;return p.TYPE.FOLDER===t?this.renderFolder():t||"MODAO"!==e.thirdType?t?Object(C.isSupportedVideoFile)(e.fileType)?this.renderVideoPreview():Object(C.isOfficeFile)(e.fileType)?this.renderOfficePreview():this.renderDownloadIcon():null:this.renderModaoIframe()},t.prototype.renderModaoIframe=function(){var e=this.props.current;if(e.link){var t=/\s*<iframe src="([^"]*)"/.exec(e.link),a=t?t[1]:null;return a?i.a.createElement("div",{className:R.a.previewContainer},i.a.createElement("iframe",{src:a,width:"100%",height:"100%",frameBorder:"no",allowFullScreen:!0})):void 0}},t.prototype.renderOfficePreview=function(){var e=this.props,t=e.current,a=e.enterpriseGlobalKey,n=e.currentProjectName,r=e.currentId,o=e.showEdit;return i.a.createElement("div",{className:R.a.previewContainer},i.a.createElement(_,{showEdit:o,projectID:r,file:t,enterpriseGlobalKey:a,currentProjectName:n}))},t.prototype.renderPdfPreview=function(){var e=this.props,t=e.current,a=e.enterpriseGlobalKey,n=e.currentProjectName;return i.a.createElement(M.a,{file:t,enterpriseGlobalKey:a,currentProjectName:n})},t.prototype.renderMarkdownPreview=function(){var e=this.props,t=e.current,a=e.enterpriseGlobalKey,n=e.currentProjectName;return i.a.createElement(N,{fileId:t.fileId,enterpriseGlobalKey:a,currentProjectName:n})},t.prototype.renderVideoPreview=function(){var e=this.props,t=e.current,a=e.currentId,n=e.enterpriseGlobalKey,r=e.currentProjectName;return i.a.createElement(L,{file:t,enterpriseGlobalKey:n,currentProjectName:r,projectID:a})},t.defaultProps={renaming:!1,editing:!1},t}(n.Component),Y=B()(W),H=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(t,a)};return function(t,a){if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),V=function(e){function t(t){var a=e.call(this,t)||this;return a.handleKeydown=a.handleKeydown.bind(a),a}return H(t,e),t.prototype.handleKeydown=function(e){var t=e.key,a=e.keyIdentifier;switch(t||a){case"ArrowRight":case"ArrowDown":case"Right":case"Down":return this.props.onNext();case"ArrowLeft":case"ArrowUp":case"Left":case"Up":return this.props.onPreview();default:return!0}},t.prototype.componentDidMount=function(){document.addEventListener("keydown",this.handleKeydown)},t.prototype.componentWillUnmount=function(){document.removeEventListener("keydown",this.handleKeydown)},t.prototype.render=function(){return null},t}(n.Component),G=a("Y+p1"),K=a.n(G),z=a("Logu"),q=a.n(z),Z=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(t,a)};return function(t,a){if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),J=function(e){function t(t){var a=e.call(this,t)||this;return a.onSwitchPreview=function(e){var t=a.props.previewFiles,n=t[e];n&&a.setState({current:n,showEdit:!0},(function(){var e=a.state.current.isModao?-a.state.current.fileId:a.state.current.fileId,n=a.props.browserRouter,i=window.location,r=i.origin,o=i.href.replace(/\/preview\/([+-]?\w+)/,"/preview/".concat(e)).replace(r,"");n.replace(o),a.previewFile(Number(e),t)}))},a.state={previous:0,current:{type:"",name:"",isUploaded:!1,size:0,fileId:-101},next:0,showEdit:!0},a}return Z(t,e),t.prototype.changeShowEdit=function(e){this.setState({showEdit:e})},t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=e.currentFileId,a=e.previewFiles;t===this.props.currentFileId&&K()(a,this.props.previewFiles)||this.previewFile(parseInt(t,10),a)},t.prototype.componentDidMount=function(){var e=this.props,t=e.currentFileId,a=e.previewFiles;this.previewFile(parseInt(t,10),a)},t.prototype.handleEscape=function(e){e.stopPropagation(),this.props.onFileViewerHide(!1)},t.prototype.previewFile=function(e,t){if(e){var a=t.map((function(e){return{fileId:e.fileId,isThirdType:!!e.thirdType}})),n=this.getCurrFileIndex(e,a),i=t[n];if(-1===n)throw new Error("File(".concat(e,") not found!"));var r=n-1,o=n+1;this.setState({current:i,previous:r,next:o})}},t.prototype.getCurrFileIndex=function(e,t){return t.findIndex((function(t){return t.fileId===Math.abs(e)&&!!(e<0&&t.isThirdType||e>0&&!t.isThirdType)}))},t.prototype.renderSwitcher=function(){var e=this,t=this.state,a=t.previous,n=t.next,r=this.props.previewFiles.length,o=i.a.createElement(V,{onPreview:function(){return e.onSwitchPreview(a)},onNext:function(){return e.onSwitchPreview(n)},key:"preview-navigator"});return[a>=0?i.a.createElement("div",{className:q.a.previousButton,onClick:function(){return e.onSwitchPreview(a)}}):null,n<r?i.a.createElement("div",{className:q.a.nextButton,onClick:function(){return e.onSwitchPreview(n)}}):null,o]},t.prototype.render=function(){var e=this,t=this.props,a=t.isShown,n=t.currentId,r=t.enterpriseGlobalKey,s=t.currentProjectName,l=t.onHandleDelAttachment,c=t.onFileViewerHide,u=this.state,d=u.current,f=u.showEdit;return i.a.createElement(o.a,{show:a,className:q.a.fileViewer,onHide:function(){return c(!1)},onEscapeKeyDown:this.handleEscape},i.a.createElement("div",{className:q.a.viewerBody},i.a.createElement(b,{showEdit:f,changeShowEdit:function(t){return e.changeShowEdit(t)},current:d,currentId:n,currentFileId:Number(d.fileId),onClose:function(){return c(!1)},onHandleDelAttachment:l}),this.renderSwitcher(),i.a.createElement(Y,{showEdit:f,current:this.state.current,currentId:n,enterpriseGlobalKey:r,currentProjectName:s})))},t}(n.Component);t.default=B()(J)},"2RjC":function(e,t,a){"use strict";var n=a("mVeg"),i=a("cDcd"),r=a.n(i),o=a("K2gz"),s=a.n(o),l=a("k7+O"),c=a.n(l),u=a("g84+"),d=a.n(u),f=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(t,a)};return function(t,a){if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),p=function(e){function t(t){var a=e.call(this,t)||this;return a.navigateInputChange=function(e){var t=a.props,n=t.totalPage,i=t.onPageChange;if(n&&i){var r=Number(e.target.value);r>n&&(r=n),Number.isNaN(r)&&(r=1),a.setState({current:r},(function(){a.state.current&&0!==a.state.current&&i(a.state.current)}))}},a.onNavKeyDown=function(e){return 37!==e.keyCode&&39!==e.keyCode},a.scaleChange=function(e,t){var n=a.props.onScaleChange,i=a.state,r=i.zoomingRage,o=i.defaultScale,s=null===t||void 0===t?void 0:t.slice(0,t.length-1),l={type:"click",scale:0},c=Number(null===r||void 0===r?void 0:r.slice(0,r.length-1))/100;e&&!t&&("-"===e&&c>.1?l.scale=-.1:"+"===e&&(l.scale=.1),c+=l.scale),!e&&t&&(l.type="select","auto"!==t?l.scale=Number(s)/100:"auto"===t&&(l.scale=o),c=l.scale),n(l),a.setState({zoomingRage:"".concat((100*c).toFixed(0),"%")})},a.state={zoomingRage:"100%",zoomingSelect:!1,isFullscreen:!1,pageInputActive:!1,current:1,defaultScale:0},a.handleFullscreenChange=a.handleFullscreenChange.bind(a),a}return f(t,e),t.getDerivedStateFromProps=function(e,t){var a,n=e.type,i=e.file,r=e.canvasHeight,o=e.canvasWidth,s=e.scale,l=1;if(0===t.defaultScale){if("pdf"===n&&r&&o){var c=i.getViewport(1);l=Math.min(r/c.height,o/c.width),a=null===e||void 0===e?void 0:e.currentPageNumber}return{current:a,defaultScale:l,zoomingRage:"".concat((100*s).toFixed(0),"%")}}return null},t.prototype.handleFullscreenChange=function(){var e=this,t=this.props.onFullscreenChange;t&&this.setState({isFullscreen:c.a.isFullscreen},(function(){t(e.state.isFullscreen)}))},t.prototype.componentDidMount=function(){c.a.enabled&&document.addEventListener(c.a.raw.fullscreenchange,this.handleFullscreenChange)},t.prototype.componentWillUnmount=function(){c.a.enabled&&document.removeEventListener(c.a.raw.fullscreenchange,this.handleFullscreenChange)},t.prototype.render=function(){var e=this,t=this.props,a=t.currentPageNumber,i=t.totalPage,o=t.pageItemsShow,l=t.onPageChange,u=t.getFullscreen,f=this.state,p=f.zoomingSelect,m=f.zoomingRage,h=f.isFullscreen,v=f.pageInputActive,g=f.current,E=this.scaleChange,b="".concat(a,"/").concat(i);return r.a.createElement("div",{className:d.a.fileInnerNavigator},r.a.createElement("div",{className:s()([d.a.squire,d.a.letting]),onClick:function(){return E("-")}}),r.a.createElement("div",{className:s()([d.a.squire,d.a.rate]),onMouseEnter:function(){return e.setState({zoomingSelect:!0})}},r.a.createElement("div",{className:d.a.zoomRage},m),r.a.createElement("div",{className:s()([p?d.a.zooming:d.a.zoomingHide]),onMouseLeave:function(){return e.setState({zoomingSelect:!1})}},["50%","100%","200%"].map((function(t){return r.a.createElement("div",{className:d.a.item,key:t,onClick:function(){return e.setState({zoomingSelect:!1,zoomingRage:t},(function(){E("",e.state.zoomingRage)}))}},t)})),r.a.createElement("div",{className:d.a.horizontalSplit}),r.a.createElement("div",{className:d.a.item,onClick:function(){return E("","auto")}},Object(n.t)("\u81ea\u9002\u5e94\u7a97\u53e3\u5927\u5c0f")))),r.a.createElement("div",{className:s()([d.a.squire,d.a.enlarge]),onClick:function(){return E("+")}}),l&&a&&i&&r.a.createElement("div",{className:s()(o?d.a.show:d.a.hide)},r.a.createElement("div",{className:d.a.split}),r.a.createElement("div",{className:s()([d.a.squire,d.a.arrowUp]),onClick:function(){return l(Math.max(a-1,1))}}),r.a.createElement("div",{className:s()([d.a.squire,d.a.navigatorNums])},!v&&r.a.createElement("div",{onClick:function(){return e.setState({pageInputActive:!0})}},b),v&&r.a.createElement("input",{className:d.a.navigateInput,value:g,onChange:this.navigateInputChange,onBlur:function(){return e.setState({pageInputActive:!1})},onKeyDown:this.onNavKeyDown,min:1})),r.a.createElement("div",{className:s()([d.a.squire,d.a.arrowDown]),onClick:function(){return l(Math.min(a+1,i))}})),r.a.createElement("div",{className:d.a.split}),r.a.createElement("div",{className:s()([d.a.squire,h?d.a.minimize:d.a.maximize]),onClick:function(){return c.a.toggle(u&&u())}}))},t.defaultProps={pageItemsShow:!1},t}(i.Component);t.a=p},"2jHd":function(e,t,a){e.exports=a.p+"67c753ac895e49c8343b9f5331ad218a.svg"},"2oPZ":function(e,t,a){"use strict";var n=a("mVeg"),i=a("cDcd"),r=a.n(i),o=a("K2gz"),s=a.n(o),l=a("wVLe"),c=a.n(l),u=a("8sHq"),d=a.n(u),f=a("/TLM"),p=a.n(f),m=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(t,a)};return function(t,a){if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),h=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},v=function(e,t,a){if(a||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},g=function(e){function t(t){var a=e.call(this,t)||this;return a.state={loading:!0,success:!1,error:!1},a.handleRefreshImage=a.handleRefreshImage.bind(a),a.handleLoadingDone=a.handleLoadingDone.bind(a),a.handleError=a.handleError.bind(a),a.handleSuccess=a.handleSuccess.bind(a),a}return m(t,e),t.prototype.startFetch=function(){for(var e,t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];(e=this.props).fetchPromise.apply(e,v([],h(t),!1)).catch(this.handleError).then(this.handleSuccess).finally(this.handleLoadingDone)},t.prototype.handleLoadingDone=function(){this.setState({loading:!1})},t.prototype.handleSuccess=function(){this.setState({success:!0})},t.prototype.handleError=function(){this.setState({error:!0})},t.prototype.handleRefreshImage=function(){var e=this;this.setState({error:!1,loading:!0,success:!1},(function(){var t=e.props.fileId,a=(new Date).getTime();e.startFetch(t,a)}))},t.prototype.componentDidMount=function(){var e=this.props.fileId;this.startFetch(e)},t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=e.fileId,a=e.version,n=e.showEdit,i=this.props,r=i.fileId,o=i.version,s=i.showEdit;r===t&&o===a&&s===n||this.startFetch(t)},t.prototype.renderStatus=function(){var e=this.state,t=e.loading;if(e.error)return r.a.createElement("a",{onClick:this.handleRefreshImage},r.a.createElement(d.a,null)," ",Object(n.t)("\u52a0\u8f7d\u5931\u8d25\uff0c\u70b9\u51fb\u91cd\u65b0\u52a0\u8f7d"));if(!t)return null;var a=this.props.fileTypeName,i=void 0===a?"":a,o=null!==i.charAt(0).trim().match(/[A-Za-z]/)?" ".concat(i):i;return r.a.createElement("div",{className:p.a.loadingText},r.a.createElement(c.a,null)," ",Object(n.t)("\u6b63\u5728\u52a0\u8f7d"),o,"...")},t.prototype.renderFile=function(){var e=this.state,t=e.loading,a=e.error,n=e.success;return this.props.invisible&&!n?r.a.createElement("div",null,this.props.children):t||a?null:this.props.children},t.prototype.render=function(){var e=this.props.className,t=s()(e);return r.a.createElement("div",{className:t},this.renderStatus(),this.renderFile())},t.defaultProps={invisible:!1,loadingPosition:"center"},t}(i.Component);t.a=g},"2yod":function(e,t,a){e.exports=a.p+"b3ac3f2a129d305fbb2dbdb2c0023c17.svg"},"3RH6":function(e,t,a){"use strict";a("I78e"),a("Btvt"),a("ioFf"),a("HEwt"),a("XfO3"),a("yt8O"),a("rGqo"),Object.defineProperty(t,"__esModule",{value:!0}),t.removeWatermark=t.watermarkService=t.onRemove=t.removeSimpleWatermark=t.simpleWatermark=t.getText=void 0,a("f3/d"),a("KKXr");var n=a("mVeg");function i(e,t){var a="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=function(e,t){if(!e)return;if("string"===typeof e)return r(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return r(e,t)}(e))||t&&e&&"number"===typeof e.length){a&&(e=a);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,l=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return s=e.done,e},e:function(e){l=!0,o=e},f:function(){try{s||null==a.return||a.return()}finally{if(l)throw o}}}}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}t.getText=function(e){var t="";try{t=e.phone?"".concat(e.name," ").concat(e.phone.substr(e.phone.length-4)):"".concat(e.name," ").concat(e.email.split("@")[0])}catch(a){t="".concat(e.name)}return t};var o=function(e){var t=e.container,a=void 0===t?"container":t,i=e.width,r=void 0===i?250:i,o=e.height,s=void 0===o?250:o,l=e.content,c=void 0===l?(0,n.t)("\u8bf7\u52ff\u5916\u4f20"):l,u=e.zIndex,d=void 0===u?9999:u,f=e.relative,p=void 0===f||f,m=document.getElementById(a),h='<svg xmlns="http://www.w3.org/2000/svg" width="'.concat(r,'" height="').concat(s,'">\n                    <text x="10%" y="10%"\n                    text-anchor="center"\n                    fill="rgba(184, 184, 184, 0.2)"\n                    transform="rotate(-20 150, 100)"\n                    style="font-size: ',12,'px; font-family: PingFang-SC,Tahoma,Verdana,STHeiTi,simsun,sans-serif;">\n                    ').concat(c,'\n                </text>\n                    <text x="45%" y="80%"\n                    text-anchor="center"\n                    fill="rgba(184, 184, 184, 0.2)"\n                    transform="rotate(-20 150, 100)"\n                    style="font-size: ',12,'px; font-family: PingFang-SC,Tahoma,Verdana,STHeiTi,simsun,sans-serif;">\n                    ').concat(c,"\n                </text>\n\t\t\t</svg>"),v="data:image/svg+xml;base64,".concat(window.btoa(unescape(encodeURIComponent(h)))),g=document.createElement("div");g.setAttribute("style","position:absolute;top:-40px;left:0;width:100%;height:100%;z-index:".concat(d,";pointer-events:none;background-repeat:repeat;background-image:url('").concat(v,"');")),g.setAttribute("id","".concat(a,"-wm-record")),p||(m.style.position="relative"),m&&g.id!==m.firstChild.id&&m.insertBefore(g,m.firstChild)};t.simpleWatermark=o;var s=function(e){var t=document.getElementById("".concat(e,"-wm-record"));t&&t.remove()};t.removeSimpleWatermark=s;var l={attributes:!0,childList:!0,subtree:!0},c=function(e,t){if(e){var a=e.parentNode;if(a){var n=new MutationObserver((function(a){var r,o=i(a);try{for(o.s();!(r=o.n()).done;){var s=r.value;"attributes"===s.type&&("wm-detail-wm-record"===s.target.id&&null===s.previousSibling&&e.remove(),"wm-spec-wm-record"===s.target.id&&null===s.previousSibling&&e.remove(),"wm-record-wm-record"===s.target.id&&null===s.previousSibling&&e.remove());var l,c=i(s.removedNodes);try{for(c.s();!(l=c.n()).done;){l.value===e&&(n.disconnect(),t())}}catch(u){c.e(u)}finally{c.f()}}}catch(u){o.e(u)}finally{o.f()}}));n.observe(a,l)}}};t.onRemove=c;t.watermarkService=function e(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(void 0!==t)try{var r=JSON.parse(t),s=r.issue;if(s)if(i){o({container:"wm-record",content:a});var l=document.getElementById("wm-record-wm-record");c(l,(function(){e(t,a,n,i)}))}else if(o({container:n?"wm-detail":"wm-spec",content:a}),n){var u=document.getElementById("wm-detail-wm-record");c(u,(function(){e(t,a,n)}))}else{var d=document.getElementById("wm-spec-wm-record");c(d,(function(){e(t,a,n)}))}}catch(f){return null}return null};t.removeWatermark=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];s(t?"wm-record":e?"wm-detail":"wm-spec")}},"3ZF0":function(e,t,a){e.exports={avatar:"avatar-3SlyaJc1Fg","default-avatar":"default-avatar-ZTUskIgWzD",defaultAvatar:"default-avatar-ZTUskIgWzD"}},"48O2":function(e,t,a){e.exports={"table-wrapper":"table-wrapper-3Rqqr7BN_l",tableWrapper:"table-wrapper-3Rqqr7BN_l","workbench-table-wrapper":"workbench-table-wrapper-3gXUB7Euci",workbenchTableWrapper:"workbench-table-wrapper-3gXUB7Euci","header-cell":"header-cell-15XybXYP6S",headerCell:"header-cell-15XybXYP6S",cell:"cell-2q4BKqzFwt","sticky-box-shadow":"sticky-box-shadow-3CVlX6Xy4N",stickyBoxShadow:"sticky-box-shadow-3CVlX6Xy4N","sticky-box-background":"sticky-box-background-33TEMU9f61",stickyBoxBackground:"sticky-box-background-33TEMU9f61","resize-column":"resize-column-3Lv8VwLQKa",resizeColumn:"resize-column-3Lv8VwLQKa",loading:"loading-WF6dM-NW5F","issue-type-name":"issue-type-name-2J788FrVOB",issueTypeName:"issue-type-name-2J788FrVOB","no-padding":"no-padding-3jQw6-uiog",noPadding:"no-padding-3jQw6-uiog","anomaly-mark":"anomaly-mark-32eLR-F11T",anomalyMark:"anomaly-mark-32eLR-F11T","empty-search-container":"empty-search-container-OPAO-CTK0V",emptySearchContainer:"empty-search-container-OPAO-CTK0V","empty-title":"empty-title-kRBjXEeoLy",emptyTitle:"empty-title-kRBjXEeoLy","empty-tip":"empty-tip-1DA8WmWXwu",emptyTip:"empty-tip-1DA8WmWXwu","empty-table-container":"empty-table-container-1C7hAL1Bu6",emptyTableContainer:"empty-table-container-1C7hAL1Bu6",header:"header-2eHBj6itXb","workbench-table-header":"workbench-table-header-3LYa3l5zpb",workbenchTableHeader:"workbench-table-header-3LYa3l5zpb","with-filter":"with-filter-1tZlZMwkRR",withFilter:"with-filter-1tZlZMwkRR","setting-icon":"setting-icon-3OH7wN4eC2",settingIcon:"setting-icon-3OH7wN4eC2","table-setting":"table-setting-2mdgptUjQP",tableSetting:"table-setting-2mdgptUjQP","setting-shadow":"setting-shadow-g9oLWdN1GU",settingShadow:"setting-shadow-g9oLWdN1GU","collapse-icon":"collapse-icon-25M46Tr0pv",collapseIcon:"collapse-icon-25M46Tr0pv",collapsed:"collapsed-15_PodRKDX",title:"title-1cCXNf0jQF","filter-Icon":"filter-Icon-1qi1EDqWnC",filterIcon:"filter-Icon-1qi1EDqWnC",cursor:"cursor-2BkTSuVExr","setting-cell":"setting-cell-2ZQnZhJ2eg",settingCell:"setting-cell-2ZQnZhJ2eg","with-sort":"with-sort-1iwSzybPIs",withSort:"with-sort-1iwSzybPIs","sort-Icon":"sort-Icon-2z2G5qx_bY",sortIcon:"sort-Icon-2z2G5qx_bY","header-cell-filter":"header-cell-filter-2vv9dXGATk",headerCellFilter:"header-cell-filter-2vv9dXGATk",invert:"invert-1wxYHyPgQi",sorted:"sorted-32hg5biCGx","cell-root":"cell-root-1sWpWQZSSO",cellRoot:"cell-root-1sWpWQZSSO","toggle-size":"toggle-size-3VCEpqg2-2",toggleSize:"toggle-size-3VCEpqg2-2","divide-line":"divide-line-xRySeGjKNa",divideLine:"divide-line-xRySeGjKNa","sticky-wrapper":"sticky-wrapper--CZi92xDnU",stickyWrapper:"sticky-wrapper--CZi92xDnU","sticky-trigger":"sticky-trigger-1qLeroTH88",stickyTrigger:"sticky-trigger-1qLeroTH88",active:"active-3JBdExLu7Z"}},"4Fdf":function(e,t,a){"use strict";a.r(t);var n=a("cDcd"),i=a.n(n),r=a("es6E"),o=a("mVeg"),s=a("w3Wo"),l=a("V/h/"),c=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(t,a)};return function(t,a){if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),u=function(){return(u=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},d=function(e,t,a,n){return new(a||(a=Promise))((function(i,r){function o(e){try{l(n.next(e))}catch(t){r(t)}}function s(e){try{l(n.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,s)}l((n=n.apply(e,t||[])).next())}))},f=function(e,t){var a,n,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(l){return function(s){if(a)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(a=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(l){s=[6,l],n=0}finally{a=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},p=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},m=function(e,t,a){if(a||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},h=function(e){return function(t){function a(){var e=null!==t&&t.apply(this,arguments)||this;return e.state={epicIssueFieldsData:{epicSchemeFieldArchives:{},epicCreationFieldIDs:[],epicUpdateFieldIDs:[]},requirementIssueFieldsData:{requirementUpdateFieldIDs:[],requirementCreationFieldIDs:[],requirementSchemeFieldArchives:{}},assignmentIssueFieldsData:{assignmentSchemeFieldArchives:{},assignmentUpdateFieldIDs:[],assignmentCreationFieldIDs:[]},bugIssueFieldsData:{bugSchemeFieldArchives:{},bugCreationFieldIDs:[],bugUpdateFieldIDs:[]},subtaskIssueFieldsData:{subtaskSchemeFieldArchives:{},subtaskCreationFieldIDs:[],subtaskUpdateFieldIDs:[]},riskIssueFieldsData:{riskSchemeFieldArchives:{},riskCreationFieldIDs:[],riskUpdateFieldIDs:[]},workItemIssueFieldsData:{workItemSchemeFieldArchives:{},workItemCreationFieldIDs:[],workItemUpdateFieldIDs:[]},releaseIssueFieldsData:{releaseSchemeFieldArchives:{},releaseCreationFieldIDs:[],releaseUpdateFieldIDs:[]}},e.formActivity=document.querySelector('[data-frontend-module-container="coding-frontend-activity"]'),e.getProjectName=function(t){var a=e.props.currentProject;if(a)return a.name;var n=location.pathname.match(/\/p\/([^/]+)/);return n?n[1]:t.projectName},e.handleErrorFromActivity=function(t){8081===t.code&&e.formActivity&&(alert(Object(o.t)("\u914d\u7f6e\u65b9\u6848\u6709\u66f4\u65b0\uff0c\u9875\u9762\u5c06\u81ea\u52a8\u5237\u65b0\uff01")),location.reload())},e.getEpicScheme=function(t){return d(e,void 0,void 0,(function(){var e,a,n,i;return f(this,(function(r){switch(r.label){case 0:e=this.props.issueTypeDetail,a=this.state.epicIssueFieldsData,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(s.fetchIssueTypesScheme)(this.getProjectName(),null===e||void 0===e?void 0:e.id,t?"CREATE":"DETAIL",this.formActivity)];case 2:return n=r.sent().data,this.setState({epicIssueFieldsData:Object(l.default)(a,(function(e){var a=n.schemeFields.reduce((function(e,t){var a,n=e.archives,i=e.ids;return{archives:u(u({},n),(a={},a[t.issueFieldId]=t,a)),ids:m(m([],p(i),!1),[t.issueFieldId],!1)}}),{archives:{},ids:[]}),i=a.archives,r=a.ids;e.epicSchemeFieldArchives=u(u({},e.epicSchemeFieldArchives||{}),i),e[t?"epicCreationFieldIDs":"epicUpdateFieldIDs"]=r}))}),[3,4];case 3:return i=r.sent(),this.handleErrorFromActivity(i),[2,i];case 4:return[2]}}))}))},e.getRequirementScheme=function(t){return d(e,void 0,void 0,(function(){var e,a,n,i;return f(this,(function(r){switch(r.label){case 0:e=this.props.issueTypeDetail,a=this.state.requirementIssueFieldsData,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(s.fetchIssueTypesScheme)(this.getProjectName(),null===e||void 0===e?void 0:e.id,t?"CREATE":"DETAIL",this.formActivity)];case 2:return n=r.sent().data,this.setState({requirementIssueFieldsData:Object(l.default)(a,(function(e){var a=n.schemeFields.reduce((function(e,t){var a,n=e.archives,i=e.ids;return{archives:u(u({},n),(a={},a[t.issueFieldId]=t,a)),ids:m(m([],p(i),!1),[t.issueFieldId],!1)}}),{archives:{},ids:[]}),i=a.archives,r=a.ids;e.requirementSchemeFieldArchives=u(u({},e.requirementSchemeFieldArchives||{}),i),e[t?"requirementCreationFieldIDs":"requirementUpdateFieldIDs"]=r}))}),[3,4];case 3:return i=r.sent(),this.handleErrorFromActivity(i),[2,i];case 4:return[2]}}))}))},e.getAssignmentScheme=function(t){return d(e,void 0,void 0,(function(){var e,a,n,i;return f(this,(function(r){switch(r.label){case 0:e=this.props.issueTypeDetail,a=this.state.assignmentIssueFieldsData,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(s.fetchIssueTypesScheme)(this.getProjectName(),null===e||void 0===e?void 0:e.id,t?"CREATE":"DETAIL",this.formActivity)];case 2:return n=r.sent().data,this.setState({assignmentIssueFieldsData:Object(l.default)(a,(function(e){var a=n.schemeFields.reduce((function(e,t){var a,n=e.archives,i=e.ids;return{archives:u(u({},n),(a={},a[t.issueFieldId]=t,a)),ids:m(m([],p(i),!1),[t.issueFieldId],!1)}}),{archives:{},ids:[]}),i=a.archives,r=a.ids;e.assignmentSchemeFieldArchives=u(u({},e.assignmentSchemeFieldArchives||{}),i),e[t?"assignmentCreationFieldIDs":"assignmentUpdateFieldIDs"]=r}))}),[3,4];case 3:return i=r.sent(),this.handleErrorFromActivity(i),[2,i];case 4:return[2]}}))}))},e.getBugScheme=function(t){return d(e,void 0,void 0,(function(){var e,a,n,i,r,o,c;return f(this,(function(d){switch(d.label){case 0:e=this.props,a=e.issueTypeDetail,n=e.currentProjectCooperateSettings.ISSUE_TYPES,i=this.state.bugIssueFieldsData,r=null===a||void 0===a?void 0:a.id,a.id||(r=n.find((function(e){return"DEFECT"===e.issueType})).id),d.label=1;case 1:return d.trys.push([1,3,,4]),[4,Object(s.fetchIssueTypesScheme)(this.getProjectName(),r,t?"CREATE":"DETAIL",this.formActivity)];case 2:return o=d.sent().data,this.setState({bugIssueFieldsData:Object(l.default)(i,(function(e){var a=o.schemeFields.reduce((function(e,t){var a,n=e.archives,i=e.ids;return{archives:u(u({},n),(a={},a[t.issueFieldId]=t,a)),ids:m(m([],p(i),!1),[t.issueFieldId],!1)}}),{archives:{},ids:[]}),n=a.archives,i=a.ids;e.bugSchemeFieldArchives=u(u({},e.bugSchemeFieldArchives||{}),n),e[t?"bugCreationFieldIDs":"bugUpdateFieldIDs"]=i}))}),[3,4];case 3:return c=d.sent(),this.handleErrorFromActivity(c),[2,c];case 4:return[2]}}))}))},e.getSubtaskScheme=function(t){return d(e,void 0,void 0,(function(){var e,a,n,i;return f(this,(function(r){switch(r.label){case 0:e=this.props.issueTypeDetail,a=this.state.subtaskIssueFieldsData,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(s.fetchIssueTypesScheme)(this.getProjectName(),null===e||void 0===e?void 0:e.id,t?"CREATE":"DETAIL",this.formActivity)];case 2:return n=r.sent().data,this.setState({subtaskIssueFieldsData:Object(l.default)(a,(function(e){var a=n.schemeFields.reduce((function(e,t){var a,n=e.archives,i=e.ids;return{archives:u(u({},n),(a={},a[t.issueFieldId]=t,a)),ids:m(m([],p(i),!1),[t.issueFieldId],!1)}}),{archives:{},ids:[]}),i=a.archives,r=a.ids;e.subtaskSchemeFieldArchives=u(u({},e.subtaskSchemeFieldArchives||{}),i),e[t?"subtaskCreationFieldIDs":"subtaskUpdateFieldIDs"]=r}))}),[3,4];case 3:return i=r.sent(),this.handleErrorFromActivity(i),[2,i];case 4:return[2]}}))}))},e.getRiskScheme=function(t){return d(e,void 0,void 0,(function(){var e,a,n;return f(this,(function(i){switch(i.label){case 0:e=this.props.issueTypeDetail,a=this.state.riskIssueFieldsData,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,Object(s.fetchIssueTypesScheme)(this.getProjectName(),null===e||void 0===e?void 0:e.id,t?"CREATE":"DETAIL")];case 2:return n=i.sent().data,this.setState({riskIssueFieldsData:Object(l.default)(a,(function(e){var a=n.schemeFields.reduce((function(e,t){var a,n=e.archives,i=e.ids;return{archives:u(u({},n),(a={},a[t.issueFieldId]=t,a)),ids:m(m([],p(i),!1),[t.issueFieldId],!1)}}),{archives:{},ids:[]}),i=a.archives,r=a.ids;e.riskSchemeFieldArchives=u(u({},e.riskSchemeFieldArchives||{}),i),e[t?"riskCreationFieldIDs":"riskUpdateFieldIDs"]=r}))}),[3,4];case 3:return[2,i.sent()];case 4:return[2]}}))}))},e.getWorkItemScheme=function(t){return d(e,void 0,void 0,(function(){var e,a,n;return f(this,(function(i){switch(i.label){case 0:e=this.props.issueTypeDetail,a=this.state.workItemIssueFieldsData,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,Object(s.fetchIssueTypesScheme)(this.getProjectName(),null===e||void 0===e?void 0:e.id,t?"CREATE":"DETAIL")];case 2:return n=i.sent().data,this.setState({workItemIssueFieldsData:Object(l.default)(a,(function(e){var a=n.schemeFields.reduce((function(e,t){var a,n=e.archives,i=e.ids;return{archives:u(u({},n),(a={},a[t.issueFieldId]=t,a)),ids:m(m([],p(i),!1),[t.issueFieldId],!1)}}),{archives:{},ids:[]}),i=a.archives,r=a.ids;e.workItemSchemeFieldArchives=u(u({},e.workItemSchemeFieldArchives||{}),i),e[t?"workItemCreationFieldIDs":"workItemUpdateFieldIDs"]=r}))}),[3,4];case 3:return[2,i.sent()];case 4:return[2]}}))}))},e.getReleaseScheme=function(t){return d(e,void 0,void 0,(function(){var e,a,n;return f(this,(function(i){switch(i.label){case 0:e=this.props.issueTypeDetail,a=this.state.releaseIssueFieldsData,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,Object(s.fetchIssueTypesScheme)(this.getProjectName(),null===e||void 0===e?void 0:e.id,t?"CREATE":"DETAIL")];case 2:return n=i.sent().data,this.setState({releaseIssueFieldsData:Object(l.default)(a,(function(e){var a=n.schemeFields.reduce((function(e,t){var a,n=e.archives,i=e.ids;return{archives:u(u({},n),(a={},a[t.issueFieldId]=t,a)),ids:m(m([],p(i),!1),[t.issueFieldId],!1)}}),{archives:{},ids:[]}),i=a.archives,r=a.ids;e.releaseSchemeFieldArchives=u(u({},e.releaseSchemeFieldArchives||{}),i),e[t?"releaseCreationFieldIDs":"releaseUpdateFieldIDs"]=r}))}),[3,4];case 3:return[2,i.sent()];case 4:return[2]}}))}))},e}return c(a,t),a.prototype.render=function(){var t=this.state,a=t.epicIssueFieldsData,n=t.requirementIssueFieldsData,r=t.assignmentIssueFieldsData,o=t.bugIssueFieldsData,s=t.subtaskIssueFieldsData,l=t.riskIssueFieldsData,c=t.workItemIssueFieldsData,d=t.releaseIssueFieldsData;return i.a.createElement(e,u({},this.props,{epicIssueFieldsData:a,getEpicScheme:this.getEpicScheme,requirementIssueFieldsData:n,getRequirementScheme:this.getRequirementScheme,assignmentIssueFieldsData:r,getAssignmentScheme:this.getAssignmentScheme,bugIssueFieldsData:o,getBugScheme:this.getBugScheme,subtaskIssueFieldsData:s,getSubtaskScheme:this.getSubtaskScheme,riskIssueFieldsData:l,getRiskScheme:this.getRiskScheme,workItemIssueFieldsData:c,getWorkItemScheme:this.getWorkItemScheme,releaseIssueFieldsData:d,getReleaseScheme:this.getReleaseScheme}))},a}(i.a.Component)},v=a("aHEs"),g=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(t,a)};return function(t,a){if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),E=function(){return(E=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},b=function(e,t,a,n){var i,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,a,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(r<3?i(o):r>3?i(t,a,o):i(t,a))||o);return r>3&&o&&Object.defineProperty(t,a,o),o};t.default=function(e){return function(t){function a(e){var a=t.call(this,e)||this;return a.getLabels=function(){var e=a.props.projectID,t=a.getProjectName(a.props.targetData);a.labelStore.getCurrentProjectLabels(t,e)},a.addLabel=function(e,t,n,i){var r=a.getProjectName(a.props.targetData);a.labelStore.addLabel(r,e,t,n,i)},a.getRequirementTypes=function(e){if(e)0===e.code&&a.setState({requirementTypes:e.data});else{var t=a.getProjectName(a.props.targetData);Object(v.fetchRequirementTypes)(t).then((function(e){var t=e.data;a.setState({requirementTypes:t})}))}},a.getBugTypes=function(e){if(e)0===e.code&&a.setState({bugTypes:e.data});else{var t=a.getProjectName(a.props.targetData);Object(v.fetchDefectTypes)(t).then((function(e){var t=e.data;a.setState({bugTypes:t})}))}},a.getSourceTypes=function(e){var t;void 0===e&&(e=void 0);var n=a.getProjectName(a.props.targetData);e?0===e.code&&a.setState({sourceTypes:null===(t=e.data)||void 0===t?void 0:t.map((function(e){return E(E({},e),{value:e.id,text:e.name})}))}):Object(v.fetchSourceTypesOld)(n).then((function(e){var t=e.data;a.setState({sourceTypes:t.map((function(e){return E(E({},e),{value:e.id,text:e.name})}))})}))},a.getModuleSchemes=function(){var e=a.getProjectName(a.props.targetData);a.issuesStore.getModuleSchemes(a.props.projectID,e)},a.getProjectName=function(e){var t,n,i,r;if(null===(t=a.props)||void 0===t?void 0:t.fromDM)return null===(r=null===(i=null===(n=a.props)||void 0===n?void 0:n.dmData)||void 0===i?void 0:i.targetProject)||void 0===r?void 0:r.name;if(e&&e.useOwnProjectName&&e.projectName)return null===e||void 0===e?void 0:e.projectName;var o=location.pathname.match(/\/p\/([^/]+)/);return o?o[1]:e.projectName},a.getLabelList=function(){var e=a.getProjectName(a.props.targetData);return r.StoreMobxApi.toJS(a.labelStore.labelData[e])||[]},a.getModuleList=function(){var e=a.getProjectName(a.props.targetData);return r.StoreMobxApi.toJS(a.issuesStore.moduleSchemes[e])||[]},a.state={requirementTypes:[],bugTypes:[],sourceTypes:[]},a.issuesStore=Object(r.getStore)(r.StoreName.ISSUES),a.labelStore=Object(r.getStore)(r.StoreName.LABELS),a.memberStore=Object(r.getStore)(r.StoreName.MEMBERS),a.projectsStore=Object(r.getStore)(r.StoreName.PROJECTS),a}return g(a,t),a.prototype.render=function(){var t=this.state,a=t.requirementTypes,n=t.bugTypes,r=t.sourceTypes,o=this.getModuleList(),s=this.getLabelList(),l=this.props,c=l.epicIssueFieldsData,u=l.requirementIssueFieldsData,d=l.assignmentIssueFieldsData,f=l.bugIssueFieldsData,p=l.subtaskIssueFieldsData,m=l.riskIssueFieldsData,h=l.workItemIssueFieldsData,v=l.releaseIssueFieldsData;return i.a.createElement(e,E({},this.props,{labels:s,requirementTypes:a,bugTypes:n,sourceTypes:r,moduleSchemes:o,bugSchemeFieldArchives:f.bugSchemeFieldArchives,bugCreationFieldIDs:f.bugCreationFieldIDs,bugUpdateFieldIDs:f.bugUpdateFieldIDs,assignmentSchemeFieldArchives:d.assignmentSchemeFieldArchives,assignmentCreationFieldIDs:d.assignmentCreationFieldIDs,assignmentUpdateFieldIDs:d.assignmentUpdateFieldIDs,requirementSchemeFieldArchives:u.requirementSchemeFieldArchives,requirementCreationFieldIDs:u.requirementCreationFieldIDs,requirementUpdateFieldIDs:u.requirementUpdateFieldIDs,epicSchemeFieldArchives:c.epicSchemeFieldArchives,epicCreationFieldIDs:c.epicCreationFieldIDs,epicUpdateFieldIDs:c.epicUpdateFieldIDs,subtaskSchemeFieldArchives:p.subtaskSchemeFieldArchives,subtaskCreationFieldIDs:p.subtaskCreationFieldIDs,subtaskUpdateFieldIDs:p.subtaskUpdateFieldIDs,riskSchemeFieldArchives:m.riskSchemeFieldArchives,riskCreationFieldIDs:m.riskCreationFieldIDs,riskUpdateFieldIDs:m.riskUpdateFieldIDs,workItemSchemeFieldArchives:h.workItemSchemeFieldArchives,workItemCreationFieldIDs:h.workItemCreationFieldIDs,workItemUpdateFieldIDs:h.workItemUpdateFieldIDs,releaseSchemeFieldArchives:v.releaseSchemeFieldArchives,releaseCreationFieldIDs:v.releaseCreationFieldIDs,releaseUpdateFieldIDs:v.releaseUpdateFieldIDs,addLabel:this.addLabel,getRequirementTypes:this.getRequirementTypes,getBugTypes:this.getBugTypes,getSourceTypes:this.getSourceTypes,getModuleSchemes:this.getModuleSchemes,getBugScheme:this.props.getBugScheme,getAssignmentScheme:this.props.getAssignmentScheme,getRequirementScheme:this.props.getRequirementScheme,getEpicScheme:this.props.getEpicScheme,getSubtaskScheme:this.props.getSubtaskScheme,getRiskScheme:this.props.getRiskScheme,getWorkItemScheme:this.props.getWorkItemScheme,getReleaseScheme:this.props.getReleaseScheme}))},a.prototype.componentDidMount=function(){this.getLabels()},a=b([h,r.StoreMobxReactApi.observer],a)}(i.a.Component)}},"4KOf":function(e,t,a){e.exports=a.p+"e34b1290a4de00c751af0fb95867c778.svg"},"5CaM":function(e,t,a){"use strict";a("XXMN");var n=a("cDcd"),i=a.n(n),r=a("mVeg"),o=a("Clsu"),s=a("DJc2"),l=a.n(s),c=a("BqJP"),u=a("5JFE"),d=a("TGxl"),f=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},p=u.Layout.Sider;t.a=function(e){var t=e.onFixedToggle,a=f(Object(n.useState)(!1),2),s=a[0],u=a[1],m=Object(d.d)();return i.a.createElement(p,{width:"220",className:l.a.leftSider},i.a.createElement("div",{className:l.a.schemeSider},i.a.createElement("div",{className:l.a.sliderTitle},i.a.createElement("span",{className:l.a.schemeTitle},Object(r.t)("\u7b5b\u9009\u5668")),!1),i.a.createElement("div",{className:l.a.schemeSiderMain},i.a.createElement(c.a,{schemeType:"left"})),i.a.createElement("div",{className:l.a.fixedToTop,onClick:t},i.a.createElement("span",{className:l.a.iconPop}),Object(r.t)("\u6298\u53e0\u8fdb\u4e0b\u62c9\u83dc\u5355")),s?i.a.createElement(o.a,{getContainer:function(){return m.current},visable:s,onClose:function(){return u(!1)}}):null))}},"5WBM":function(e,t,a){e.exports={item:"item-1ZIMjOoVAs","last-child":"last-child-3_QwIddHKQ",lastChild:"last-child-3_QwIddHKQ","item-project":"item-project-mKjMbnjQpw",itemProject:"item-project-mKjMbnjQpw","item-divider":"item-divider-2iR2tav32E",itemDivider:"item-divider-2iR2tav32E","item-icon":"item-icon-2f66no4bc1",itemIcon:"item-icon-2f66no4bc1","item-code":"item-code-29f1vvYvFF",itemCode:"item-code-29f1vvYvFF","item-name":"item-name-gbNkXK9c47",itemName:"item-name-gbNkXK9c47","item-date":"item-date-2K7-svSxrh",itemDate:"item-date-2K7-svSxrh","item-priority":"item-priority-1SZieTzojO",itemPriority:"item-priority-1SZieTzojO","item-status":"item-status-GFhv4LMPF5",itemStatus:"item-status-GFhv4LMPF5","item-assignee":"item-assignee-yckVg-aVh6",itemAssignee:"item-assignee-yckVg-aVh6","to-right":"to-right-2u-fi0pUfC",toRight:"to-right-2u-fi0pUfC","item-arrow":"item-arrow-1l61W8S_iP",itemArrow:"item-arrow-1l61W8S_iP"}},"5hMc":function(e,t,a){e.exports={wrapper:"wrapper-sCb1qECm0H","input-before":"input-before-2pedP4t01N",inputBefore:"input-before-2pedP4t01N","input-after":"input-after-1elrC85cUo",inputAfter:"input-after-1elrC85cUo","input-clear":"input-clear-3wB-KGodfK",inputClear:"input-clear-3wB-KGodfK","input-cancel":"input-cancel-MX2IS6Mvt2",inputCancel:"input-cancel-MX2IS6Mvt2",panel:"panel-v-iUrWaJGG","panel-container":"panel-container-2ZRYnx3ort",panelContainer:"panel-container-2ZRYnx3ort",item:"item-fsjBOoKNjP","item-empty":"item-empty-3TYdzp597B",itemEmpty:"item-empty-3TYdzp597B","item-icon":"item-icon-1ZY3ArRz9z",itemIcon:"item-icon-1ZY3ArRz9z","item-code":"item-code-1kmkdidQb4",itemCode:"item-code-1kmkdidQb4","item-name":"item-name-1Qxx55x8yW",itemName:"item-name-1Qxx55x8yW"}},"5kHG":function(e,t,a){e.exports={root:"root-3SBHWaypEM",id:"id-2joLJzgx_i",current:"current-N3Z9kjXiMl"}},"5kKY":function(e,t,a){"use strict";a.r(t),a.d(t,"Trigger",(function(){return p})),a.d(t,"ItemDropdown",(function(){return g}));var n=a("cDcd"),i=a.n(n),r=a("faye"),o=a("EFit"),s=a.n(o),l=a("K2gz"),c=a.n(l),u=a("WN9O"),d=function(){return(d=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},f=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},p=function(e){var t=e.children,a=e.popup,o=e.visible,l=e.onVisibleChange,p=e.getContainer,m=e.disabled,h=e.isPortal,v=void 0!==h&&h,g=e.portalProps,E=e.portalContainer,b=e.portalAlign,y=e.disabledBottomSpace,S=e.controlUpdatePos,I=e.popupDefaultWidth,T=f(Object(n.useState)(!1),2),C=T[0],P=T[1],w=function(){return void 0===o?C:o},D=Object(n.useCallback)((function(){P(!1),l&&l(!1)}),[]);Object(n.useEffect)((function(){return w()&&window.addEventListener("click",D),function(){window.removeEventListener("click",D)}}),[w()]);var O,R=Object(n.useRef)(null),j=Object(n.useRef)(null),k=Object(n.useRef)(null);if(v&&g&&j)O=i.a.createElement(u.default,d({},g,{relatedElem:j.current}),a);else if(E&&w()){var N=R.current,A=E(),L=A.getBoundingClientRect(),F=j.current,_=F.getBoundingClientRect(),M={zIndex:1051};"number"===typeof b.top&&(M.top=_.top-L.top+A.scrollTop+b.top,_.top+_.height+((null===N||void 0===N?void 0:N.getBoundingClientRect().height)||0)+(y||0)>window.innerHeight&&(M.top=M.top-_.height-((null===N||void 0===N?void 0:N.getBoundingClientRect().height)||0))),"number"===typeof b.right&&(M.right=L.right-_.right+b.right),"number"===typeof b.left&&(M.left=_.left-L.left+b.left),b.toRight&&(M.left=_.left-L.left-(((null===N||void 0===N?void 0:N.clientWidth)||I||200)-((null===F||void 0===F?void 0:F.clientWidth)||0)));var x=Object(n.cloneElement)(a,{key:a.key,className:c()(s.a.popup,a.props.className),style:d({position:"absolute"},M),ref:R});if(k.current)O=Object(r.createPortal)(x,k.current);else{var B=A.firstChild;k.current=document.createElement("div"),k.current.style.height="0",k.current.style.position="relative",A.insertBefore(k.current,B),O=Object(r.createPortal)(x,k.current)}}else O=Object(n.cloneElement)(a,{key:a.key,className:c()(s.a.popup,a.props.className),ref:R});Object(n.useEffect)((function(){S&&(v&&g&&j||setTimeout((function(){var e=R.current;if(E&&w()&&e){var t=E(),a=t.getBoundingClientRect(),n=j.current.getBoundingClientRect(),i=parseFloat(e.style.top);"number"===typeof b.top&&(i=n.top-a.top+t.scrollTop+b.top,n.top+n.height+((null===e||void 0===e?void 0:e.getBoundingClientRect().height)||0)+(y||0)>window.innerHeight&&(i=i-n.height-((null===e||void 0===e?void 0:e.getBoundingClientRect().height)||0))),e.style.top="".concat(i,"px")}}),0))}),[S]),Object(n.useEffect)((function(){!w()&&E&&k.current&&(E().removeChild(k.current),k.current=null)}),[w()]);var U=Object(n.useCallback)((function(){if(p&&p()){var e=R.current,t=p();if(e&&t){var a=e.getBoundingClientRect(),n=t.getBoundingClientRect(),i=getComputedStyle(e);(a.top<n.top||a.bottom>n.bottom)&&(e.style.bottom=i.getPropertyValue("top"),e.style.top="auto"),(a.left<n.left||a.right>n.right)&&(e.style.left=i.getPropertyValue("right"),e.style.right="auto")}}}),[]);return Object(n.useEffect)((function(){w()&&p&&p()&&U()}),[w()]),Object(n.cloneElement)(t,{className:c()(s.a.wrapper,t.props.className),onClick:function(e){e.stopPropagation(),document.body.click(),m||(P(!w()),l&&l(!w()))},ref:j},[w()&&O,t.props.children])},m=a("Dihu"),h=a.n(m),v=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},g=Object(n.memo)((function(e){var t=e.options,a=e.onSelect,r=e.getContainer,o=e.visible,s=e.onVisibleChange,l=e.popupClassName,u=e.popupStyle,d=e.isPortal,f=void 0!==d&&d,m=e.portalProps,g=e.portalContainer,E=e.portalAlign,b=e.candidate,y=v(Object(n.useState)(!1),2),S=y[0],I=y[1],T=function(){return void 0===o?S:o},C=Object(n.useCallback)((function(e){I(e),s&&s(e)}),[]);return i.a.createElement(p,{visible:T(),onVisibleChange:C,getContainer:r,portalContainer:g,isPortal:f,portalProps:m,portalAlign:E,popup:i.a.createElement("div",{className:c()(h.a.popup,l),style:u},t.map((function(e){var t;return e.link?i.a.createElement("a",{target:"_blank",key:e.id,href:e.link.path,className:h.a.option},e.name):"divider"===e.type?i.a.createElement("div",{key:e.id,className:h.a.divider}):i.a.createElement("div",{key:e.id,className:c()(h.a.option,"delete"===e.type&&h.a.optionDelete,e.className),onClick:function(){return a(e)},"data-container":!0,"data-title":"requirement"===(null===(t=null===b||void 0===b?void 0:b.meta)||void 0===t?void 0:t.iconType)?"\u4ea7\u54c1\u9700\u6c42-".concat(e.name):"".concat(e.name)},e.name)})))},i.a.createElement("div",{className:c()(h.a.trigger,T()&&h.a.triggerActive)}))}))},"6bhj":function(e,t,a){"use strict";a.r(t),a.d(t,"TABLE_SETTINGS",(function(){return d.c})),a.d(t,"SELECTOR",(function(){return d.b})),a.d(t,"FieldType",(function(){return d.a})),a.d(t,"TableRowHeight",(function(){return d.d}));var n=a("mVeg"),i=a("dtw8"),r=a("cDcd"),o=a.n(r),s=a("QkVN"),l=a.n(s),c=a("BkRI"),u=a.n(c),d=a("z6Fr"),f=a("K2gz"),p=a.n(f),m=a("f0Wu"),h=a.n(m),v=a("7bn+"),g=a("AjCu"),E=a("A5Gp"),b=a("nuIr"),y=a("KUqB"),S=a("5kHG"),I=a.n(S),T=Object(r.memo)((function(e){var t,a,n,s,l=e.id,c=e.data,u=(e.isCurrent,e.stopLink),d=e.showIcon,f=void 0!==d&&d,p=Object(r.useMemo)((function(){var e,t,a,n,i,r,o,s,l,d,f,p,m,h,v,g,E,y="";if(c.type===b.ISSUE_TYPE.SUB_TASK?(c.parent||c.parentCode)&&(y="subtasks"):y=c.type===b.ISSUE_TYPE.DEFECT?"bug-tracking":c.type===b.ISSUE_TYPE.ASSIGNMENT?"assignments":"".concat(c.type&&"string"===typeof c.type?c.type.toLowerCase():c.type,"s"),"requirement"===c.issueType)return"/p/".concat(null===(e=c.project)||void 0===e?void 0:e.name,"/requirements/issues/").concat(c.code,"/detail");if("mission"===c.issueType)return"/p/".concat(null===(t=c.project)||void 0===t?void 0:t.name,"/assignments/issues/").concat(c.code,"/detail");if("sub_task"===c.issueType)return"/p/".concat(null===(a=c.project)||void 0===a?void 0:a.name,"/subtasks/issues/").concat(c.code,"/detail");if("MERGE"===c.issueType)return"/p/".concat(null===(n=c.project)||void 0===n?void 0:n.name,"/d/").concat(null===(i=null===c||void 0===c?void 0:c.depot)||void 0===i?void 0:i.name,"/git/merge/").concat(c.code);if("PROGRAM_TASK"===c.issueType)return"/p/".concat(null===(r=c.project)||void 0===r?void 0:r.name,"/program/plan?tab=task&id=").concat(c.gid);if("TEST_PLAN"===c.issueType)return"/p/".concat(null===(o=c.project)||void 0===o?void 0:o.name,"/testing/planning").concat("\u591a\u8f6e\u6b21\u6d4b\u8bd5"===c.testType?"/multi":"","/").concat(c.code,"?page=1&per_page=15&archived=0&name=&iterationCodes=");if("CASE_REVIEW"===c.issueType)return"/p/".concat(null===(s=c.project)||void 0===s?void 0:s.name,"/testing/case-reviews/").concat(c.code);if("TEST_REPORT"===c.issueType)return"/p/".concat(null===(l=null===c||void 0===c?void 0:c.project)||void 0===l?void 0:l.name,"/testing/reports/detail/").concat(c.code);if("BUILD"===c.issueType)return"/p/".concat(null===(d=null===c||void 0===c?void 0:c.project)||void 0===d?void 0:d.name,"/ci/job?id=").concat(c.code);if("OA_APPROVE"===c.issueType)return c.itIssueUrl;if("PROCESS_CENTER"===c.issueType){var S=["OTHER_ISSUE_CHANGE_AUDIT","OTHER_PLAN_CHANGE_AUDIT"].includes(c.itemCode)?"?type=other":"";return"/p/".concat(null===(f=c.program)||void 0===f?void 0:f.name,"/flow/initiate/detail/").concat(c.code).concat(S)}if("PROCESS_CENTER_NEW_GENERATION"===c.issueType){S=["OTHER_ISSUE_CHANGE_AUDIT","OTHER_PLAN_CHANGE_AUDIT"].includes(c.itemCode)?"?type=other":"";return"/p/".concat(null===(p=c.program)||void 0===p?void 0:p.name,"/flow/initiate/detail/").concat(c.code).concat(S)}return"PROCESS_CENTER_STABLE_STATE_SECOND"===c.issueType?"/p/".concat(c.program.name,"/flow/initiate?stageId=").concat(c.stageId):"ISSUE_IMPACT_LEVEL_AUDIT"===c.issueType?"/requiremanage/requireEffectReview/".concat(c.code):"risk"===c.issueType?"/p/".concat(null===(m=c.project)||void 0===m?void 0:m.name,"/program/risks/").concat(c.code,"/detail"):c.type===b.ISSUE_TYPE.RISK?"/p/".concat(null===(h=c.project)||void 0===h?void 0:h.name,"/program/").concat(y,"/").concat(c.code,"/detail"):c.type===b.ISSUE_TYPE.WORK_ITEM?"/p/".concat(null===(v=c.project)||void 0===v?void 0:v.name,"/program/plan/work-items/").concat(c.code,"/detail"):"EDITION"===c.issueType?"/p/".concat(null===(g=c.project)||void 0===g?void 0:g.name,"/editions/").concat(c.code):"EDITION_TESTING"===c.issueType?"/p/".concat(c.project.name,"/editions/").concat(c.editionId,"/").concat(c.code,"/EditionTestDetail"):"TEST_AUDIT"===c.issueType?"/p/".concat(c.project.name,"/design/test-review/test-detail?auditId=").concat(c.code):"WORK_HOUR_FILLING"===c.issueType?"/user/programs/approval-hours?todoId=".concat(c.code):"COLLABORATION_APPROVE"===c.issueType?c.url:u?"":"/p/".concat(null===(E=c.project)||void 0===E?void 0:E.name,"/").concat(y,"/issues/").concat(c.code,"/detail")}),[c]);return o.a.createElement("div",{className:I.a.root},f&&((null===(t=null===c||void 0===c?void 0:c.issueTypeDetail)||void 0===t?void 0:t.iconType)||(null===(a=null===c||void 0===c?void 0:c.issueTypeDetail)||void 0===a?void 0:a.type))&&o.a.createElement(y.default,{type:(null===(n=null===c||void 0===c?void 0:c.issueTypeDetail)||void 0===n?void 0:n.iconType)||(null===(s=null===c||void 0===c?void 0:c.issueTypeDetail)||void 0===s?void 0:s.type)}),"OA_APPROVE"===(null===c||void 0===c?void 0:c.issueType)?o.a.createElement(i.Link,{to:p,target:"_blank",className:I.a.id,"data-container":!0,"data-title":"IT\u9700\u6c42\u7533\u8bf7-\u9700\u6c42\u5b9e\u65bd-\u5165\u53e3-\u5de5\u4f5c\u53f0"},"#",l):o.a.createElement(i.Link,{to:p,target:"_blank",className:I.a.id},"#",l))})),C=a("7FZc"),P=a("qD4R"),w=a("+JC4"),D=a.n(w),O=a("xgZS"),R=function(){return(R=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},j=function(e){var t,a,i=e.index,r=e.titleData,s=e.mode,l=e.organizedIssues,c=e.tableViewType,u=e.collapsedIssueCodes,d=e.onToggle,f=e.detailPath,m=e.setActiveHash,h=e.browserRouter,v=e.showDetail,g=e.isCurrent,E=e.openNewDetail,S=e.tableScene,I=e.showIcon,T=void 0===I||I,w=r;"TREE"===c&&(w=R(R({},l.issues[r.code]),r));var j=0;if(w.subTasks&&w.subTasks.length){var k=w.subTasks.filter((function(e){return e.issueStatus&&e.issueStatus.type===b.ISSUE_STATUS_TYPES.COMPLETED}));j=k?k.length:0}var N=f?f(w):"",A=u.includes(w.code),L=window.location.pathname.match(/\/p\/([^/]+)/);return o.a.createElement("div",{className:D.a.linkContainer,onClick:function(){var e,t,a,n,i,r,o,s,l,c,u=w.type,d=w.issueTypeDetail,f=w.issueType;if(!E&&u)return h&&h.push(N),v&&v(R(R({},w),{projectName:w.project.name,projectId:w.project.id,type:w.type,code:w.code})),m&&m(w);if("requirement"===f)window.open("/p/".concat(w.project.name,"/requirements/issues/").concat(w.code,"/detail"),"_blank");else if("MERGE"===f)window.open("/p/".concat(null===(e=w.project)||void 0===e?void 0:e.name,"/d/").concat(null===(t=null===w||void 0===w?void 0:w.depot)||void 0===t?void 0:t.name,"/git/merge/").concat(w.code),"_blank");else if("risk"===f)window.open("/p/".concat(w.project.name,"/program/risks/").concat(w.code,"/detail"),"_blank");else if("EDITION"===f)window.open("/p/".concat(null===(a=w.project)||void 0===a?void 0:a.name,"/editions/").concat(w.code),"_blank");else if("PROGRAM_TASK"===f)window.open("/p/".concat(null===(n=w.project)||void 0===n?void 0:n.name,"/program/plan?tab=task&id=").concat(w.gid),"_blank");else if("OA_APPROVE"===f)window.open(w.itIssueUrl,"_blank");else if("TEST_PLAN"===f)window.open("/p/".concat(null===(i=w.project)||void 0===i?void 0:i.name,"/testing/planning").concat("\u591a\u8f6e\u6b21\u6d4b\u8bd5"===w.testType?"/multi":"","/").concat(w.code,"?page=1&per_page=15&archived=0&name=&iterationCodes="),"_blank");else if("CASE_REVIEW"===f)window.open("/p/".concat(null===(r=w.project)||void 0===r?void 0:r.name,"/testing/case-reviews/").concat(w.code),"_blank");else if("PROCESS_CENTER"===f){var p=["OTHER_ISSUE_CHANGE_AUDIT","OTHER_PLAN_CHANGE_AUDIT"].includes(w.itemCode)?"?type=other":"";window.open("/p/".concat(null===(o=w.program)||void 0===o?void 0:o.name,"/flow/initiate/detail/").concat(w.code).concat(p))}else if("PROCESS_CENTER_NEW_GENERATION"===f){p=["OTHER_ISSUE_CHANGE_AUDIT","OTHER_PLAN_CHANGE_AUDIT"].includes(w.itemCode)?"?type=other":"";window.open("/p/".concat(null===(s=w.program)||void 0===s?void 0:s.name,"/flow/initiate/detail/").concat(w.code).concat(p))}else if("PROCESS_CENTER_STABLE_STATE_SECOND"===f)window.open("/p/".concat(w.program.name,"/flow/initiate?stageId=").concat(w.stageId),"_blank");else if("ISSUE_IMPACT_LEVEL_AUDIT"===f)window.open("/requiremanage/requireEffectReview/".concat(w.code));else if("TEST_REPORT"===f)window.open("/p/".concat(null===(l=null===w||void 0===w?void 0:w.project)||void 0===l?void 0:l.name,"/testing/reports/detail/").concat(w.code),"_blank");else if("BUILD"===f)window.open("/p/".concat(null===(c=null===w||void 0===w?void 0:w.project)||void 0===c?void 0:c.name,"/ci/job?id=").concat(w.code),"_blank");else if("SUB_TASK"===u||"requirement"===(null===d||void 0===d?void 0:d.type))window.open("/p/".concat(w.project.name,"/requirements/issues/").concat(w.code),"_blank");else if("EDITION_TESTING"===f)window.open("/p/".concat(w.project.name,"/editions/").concat(w.editionId,"/").concat(w.code,"/EditionTestDetail"),"_blank");else if("TEST_AUDIT"===f)window.open("/p/".concat(w.project.name,"/design/test-review/test-detail?auditId=").concat(w.code),"_blank");else if("WORK_HOUR_FILLING"===f)window.open("/user/programs/approval-hours?todoId=".concat(w.code),"_blank");else if("COLLABORATION_APPROVE"===f)w.url&&window.open(w.url,"_blank");else{if("biz_intention"===S)return v&&v(w),m&&m(w);if(!w.isRequirementCanOpen)return void Object(O.warning)("\u5f53\u524d\u7528\u6237\u65e0\u8be5\u4ea7\u54c1\u9700\u6c42\u6743\u9650");window.open("/requiremanage?requirementCode=".concat(w.code),"_blank")}}},o.a.createElement("div",{className:p()(D.a.tableTitle,0===i&&D.a.firstTableTitle,g&&D.a.current)},o.a.createElement("div",{className:D.a.titleWrapper},"TREE"===c&&((null===(t=l.childIssueCodes[w.code])||void 0===t?void 0:t.length)?o.a.createElement(o.a.Fragment,null,!!w.depth&&Array(w.depth-1).fill("").map((function(e,t){return o.a.createElement("div",{className:p()(D.a.iconPlaceholder),key:"holder_".concat(t).concat(e)})})),o.a.createElement("div",{className:p()(D.a.collapseIcon,A&&D.a.collapsed),onClick:function(e){e.stopPropagation(),d(w.code)}})):Array(w.depth).fill("").map((function(e,t){return o.a.createElement("div",{className:p()(D.a.iconPlaceholder,!w.subTaskShow&&D.a.collapsed),key:"holder_".concat(t).concat(e)})}))),o.a.createElement("div",{className:D.a.title},T&&o.a.createElement(y.default,{type:null===(a=null===w||void 0===w?void 0:w.issueTypeDetail)||void 0===a?void 0:a.iconType}),o.a.createElement("div",{className:D.a.titleDetail,title:w.name||w.title},w.name||w.title),(w.isChild||"LIST"===c&&(!!w.parentCode||!!w.parent||w.isChild))&&o.a.createElement(C.TooltipTrigger,{title:Object(n.t)("\u8be5\u4e8b\u9879\u4e3a\u5b50\u4e8b\u9879")},o.a.createElement("div",{className:D.a.isSubIssue})),o.a.createElement(P.default,{localUrl:L,issue:w}))),"SCRUM"===s&&w.subTasks&&!!w.subTasks.length&&(E?o.a.createElement(C.TooltipTrigger,{title:Object(n.t)("\u5305\u542b {{count}}  \u4e2a\u7528\u6237\u6545\u4e8b\uff0c\u5176\u4e2d {{completed}}  \u4e2a\u5df2\u5b8c\u6210",{count:w.childCount,completed:w.childCompletedCount})},o.a.createElement("div",{className:p()(D.a.tag,D.a.classic)},o.a.createElement("div",{className:D.a.icon}),o.a.createElement("div",{className:D.a.detail},w.childCompletedCount,"/",w.childCount))):o.a.createElement(C.TooltipTrigger,{title:Object(n.t)("{{finished}}/{{total}} \u4e2a\u5b50\u5de5\u4f5c\u9879\u5df2\u5b8c\u6210",{finished:j,total:w.subTasks.length})},o.a.createElement("div",{className:p()(D.a.tag,D.a.sub)},o.a.createElement("div",{className:D.a.icon}),o.a.createElement("div",{className:D.a.detail},j,"/",w.subTasks.length)))),"CLASSIC"===s&&!!w.childCount&&o.a.createElement(C.TooltipTrigger,{title:Object(n.t)("\u5305\u542b {{count}}  \u4e2a\u5b50\u4e8b\u9879\uff0c\u5176\u4e2d {{completed}}  \u4e2a\u5df2\u5b8c\u6210",{count:w.childCount,completed:w.childCompletedCount})},o.a.createElement("div",{className:p()(D.a.tag,D.a.classic)},o.a.createElement("div",{className:D.a.icon}),o.a.createElement("div",{className:D.a.detail},w.childCompletedCount,"/",w.childCount))),"SCRUM"===s&&w.epic&&w.epic.name&&o.a.createElement("div",{title:w.epic.name,className:p()(D.a.tag,D.a.epic)},o.a.createElement("div",{className:D.a.icon}),o.a.createElement("div",{className:D.a.detail},w.epic.name))))},k=a("MiOB"),N=a("+CMw"),A=a.n(N),L=a("DgMC"),F=function(e){var t,a,n=e.type,i=e.value,r=e.format,s=e.isCompleted,l=e.data,c=e.suffix;return o.a.createElement(o.a.Fragment,null,"default"===n&&i&&o.a.createElement("div",{className:p()(A.a.tableTime,A.a.dueDate),title:i?h()(i).format(r||"YYYY/MM/DD"):""},h()(i).format(r||"YYYY/MM/DD")),"overtime"===n&&i&&o.a.createElement("div",{className:A.a.overTime,title:i?h()(i).format(r||"YYYY/MM/DD"):""},o.a.createElement("div",{className:A.a.overTimeValue}," ",h()(i).format(r||"YYYY/MM/DD")," "),"COMPLETED"!==(null===(t=null===l||void 0===l?void 0:l.issueStatus)||void 0===t?void 0:t.type)&&"TO_TIME_OUT"===(null===l||void 0===l?void 0:l.expireStatus)&&o.a.createElement("div",{className:p()(A.a.overTimeTag,A.a.overTimeTagWarning)},"\u5373\u5c06\u8d85\u65f6"),"COMPLETED"!==(null===(a=null===l||void 0===l?void 0:l.issueStatus)||void 0===a?void 0:a.type)&&"TIME_OUT"===(null===l||void 0===l?void 0:l.expireStatus)&&o.a.createElement("div",{className:p()(A.a.overTimeTag,A.a.overTimeTagDanger)},"\u5df2\u8d85\u65f6")),"timeFormat"===n&&i&&o.a.createElement("div",{className:p()(A.a.tableTime,A.a.dueDate),title:i||""},i),"label"===n&&i&&o.a.createElement("div",{className:p()(A.a.tag,A.a.dueDate,A.a[Object(L.parseDueDate)(h()(i).utcOffset(480),s,c).color]),title:i?Object(L.parseDueDate)(h()(i).utcOffset(480),s,c).formatDate:""},Object(L.parseDueDate)(h()(i).utcOffset(480),s,c).text),!i&&o.a.createElement(o.a.Fragment,null))},_=function(e){var t=e.type,a=e.value,i=e.data,r=e.format,s=e.isPortal,l=e.portalProps,c=e.onChange,u=e.disabled,d=e.suffix,f=Object(L.getIsCompleted)(i,d);return o.a.createElement(o.a.Fragment,null,!s&&F({type:t,value:a,format:r,isCompleted:f,data:i,suffix:d}),s&&l&&o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:p()([A.a.itemTimeTrigger,u&&A.a.disabled])},o.a.createElement(k.default,{className:p()([A.a.itemDate,u&&A.a.disabled]),value:a,onChange:function(e){return c&&c({dueDate:h()(e).isValid()?h()(e).format("YYYY-MM-DD"):""})},placeholder:Object(n.t)("\u672a\u6307\u5b9a"),calculatePosition:function(){},toRight:!0,toTop:!0,isPortal:s,portalProps:l,trigger:function(e){return function(e,t){var a=t.onToggle;return o.a.createElement("div",{className:p()([A.a.trigger,!e&&A.a.timeEmpty]),onClick:function(){if(!u)return a()}},e&&F({type:"label",value:e,format:r,isCompleted:f,data:i,suffix:d}),!u&&!e&&o.a.createElement("div",{className:p()([A.a.triggerEmpty]),title:e?Object(L.parseDueDate)(h()(e).utcOffset(480),f,d).formatDate:""},"\u9009\u62e9".concat(d,"\u65e5\u671f")),!u&&o.a.createElement("div",{className:A.a.cartDown}))}(a,e)},isDisabled:u}))))};_.defaultProps={type:"default"};var M=_,x=a("6Mal"),B=a("L8Eh"),U=a("iTKN"),W=a("Lg9n"),Y=a.n(W),H=function(e){var t=e.value,a=void 0===t?"":t,n=e.className,i=e.jumpToApprove,r=e.data;return i?o.a.createElement("div",{className:p()(Y.a.root,n),title:a,onClick:function(){return i&&i(r)},"data-container":!0,"data-title":"IT\u9700\u6c42\u7533\u8bf7-\u9700\u6c42\u5b9e\u65bd-\u5165\u53e3-\u9700\u6c42\u6c60"},o.a.createElement("span",null,a)):o.a.createElement("div",{className:p()(Y.a.root,n),title:a},o.a.createElement("span",null,a))},V=a("yTHi"),G=a("RvEQ"),K=a.n(G),z=function(e){var t=e.value,a=void 0===t?[]:t;return o.a.createElement("div",{className:K.a.root},a.map((function(e){return o.a.createElement(V.a,{className:K.a.tag,key:e.id,id:e.id,item:e,name:e.name,color:e.color,canClose:!1})})))},q=a("ooH1"),Z=a("Ylr9"),J=a.n(Z),X=function(){return(X=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Q=function(e){var t=e.recordHours,a=void 0===t?0:t,n=e.remainingHours,i=void 0===n?0:n;return o.a.createElement("div",{className:J.a.root},o.a.createElement(q.a,X({className:J.a.wrapper},{recordHours:a,remainingHours:i})))},$=a("KY5o"),ee=function(){return(ee=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},te=function(e){var t=e.recordHours,a=void 0===t?0:t,n=e.remainingHours,i=void 0===n?0:n;return o.a.createElement("div",{className:J.a.root},o.a.createElement($.a,ee({className:J.a.wrapper},{recordHours:a,remainingHours:i})))},ae=a("TsYS"),ne=a("mFAe"),ie=a("ah5l"),re=a.n(ie),oe=function(){return(oe=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},se=function(e){var t,a,n,i=e.disabled,s=e.onChange,l=e.data,c=e.itemsWidth,u=Object(r.useCallback)((function(e){var t,a,n,r,s,c,u,d,f=e.expanded,m={QUEUED:{type:"TODO",name:"\u961f\u5217\u4e2d"},INITIALIZING:{type:"PROCESSING",name:"\u521d\u59cb\u5316"},RUNNING:{type:"PROCESSING",name:"\u6784\u5efa\u4e2d"},UNSTABLE:{type:"PROCESSING",name:"\u4e0d\u7a33\u5b9a"},SUCCEED:{type:"COMPLETED",name:"\u6784\u5efa\u6210\u529f"},FAILED:{type:"COMPLETED",name:"\u6784\u5efa\u5931\u8d25"},TIMEOUT:{type:"COMPLETED",name:"\u6784\u5efa\u8d85\u65f6"},ABORTED:{type:"COMPLETED",name:"\u6784\u5efa\u4e2d\u6b62"},CANMERGE:{type:"PROCESSING",name:"\u53ef\u5408\u5e76"},ACCEPTED:{type:"COMPLETED",name:"\u540c\u610f\u5408\u5e76"},CANNOTMERGE:{type:"COMPLETED",name:"\u4e0d\u53ef\u5408\u5e76"},REFUSED:{type:"COMPLETED",name:"\u62d2\u7edd\u5408\u5e76"},PROCESS:{type:"PROCESSING",name:"\u8fdb\u884c\u4e2d"},UN_INTRODUCE:{type:"TODO",name:"\u5f85\u6f84\u6e05"},BIZ_MANAGER_CONFIRM:{type:"PROCESSING",name:"\u4ea7\u54c1\u7ecf\u7406\u6f84\u6e05\u786e\u8ba4"},RELEVANT_APPROVAL:{type:"PROCESSING",name:"\u4e1a\u52a1\u7ecf\u7406\u548c\u5176\u4ed6\u4eba\u5458\u4f1a\u7b7e"},USING_INTRODUCE:{type:"COMPLETED",name:"\u5df2\u6f84\u6e05"},0:{type:"TODO",name:"\u672a\u5f00\u59cb"},1:{type:"PROCESSING",name:"\u8fdb\u884c\u4e2d"},2:{type:"COMPLETED",name:"\u5df2\u53d1\u5e03"},3:{type:"COMPLETED",name:"\u5df2\u5e9f\u5f03"},100:{type:"PROCESSING",name:"\u7814\u53d1\u4e2d"},101:{type:"COMPLETED",name:"\u5f85\u6295\u4ea7\u51c6\u5907"},102:{type:"COMPLETED",name:"\u5f85\u53d1\u5e03"}},h=(null===(a=m[null===(t=null===l||void 0===l?void 0:l.issueStatus)||void 0===t?void 0:t.type])||void 0===a?void 0:a.type)||(null===(n=null===l||void 0===l?void 0:l.issueStatus)||void 0===n?void 0:n.type)||(null===l||void 0===l?void 0:l.status);"PROCESS"===h&&(l.defaultIssueStatusType="PROCESS"),["TODO","PROCESSING","COMPLETED"].includes(h)||(h=null!==(r=null===l||void 0===l?void 0:l.defaultIssueStatusType)&&void 0!==r?r:"PROCESSING");var v=oe(oe({},l.issueStatus),{type:h,name:(null===(c=m[null===(s=null===l||void 0===l?void 0:l.issueStatus)||void 0===s?void 0:s.type])||void 0===c?void 0:c.name)||(null===(u=null===l||void 0===l?void 0:l.issueStatus)||void 0===u?void 0:u.name)||(null===(d=m[h])||void 0===d?void 0:d.name)});return o.a.createElement("div",{className:p()([re.a.statusBox,i?re.a.disabled:"",f?re.a.expanded:""])},o.a.createElement(ne.default,{status:v}),!i&&o.a.createElement("span",{className:re.a.icon},o.a.createElement("div",{className:re.a.cartDown})))}),[l,i]);return o.a.createElement("div",{className:re.a.root},o.a.createElement(ae.default,{disabled:i,className:re.a.dropdown,projectID:null===(t=null===l||void 0===l?void 0:l.project)||void 0===t?void 0:t.id,project:null===l||void 0===l?void 0:l.project,issueCode:(null===l||void 0===l?void 0:l.code)||(null===l||void 0===l?void 0:l.id),trigger:u,value:l.issueStatus,constantHeight:44,detailType:null===(a=l.issueTypeDetail)||void 0===a?void 0:a.type,onSelect:function(e){return s(e)},itemsWidth:c,systemId:null===(n=l.systemDTO)||void 0===n?void 0:n.systemId,itemInfo:l}))},le=a("eXGp"),ce=a.n(le),ue=function(e){var t=e.project;return t?o.a.createElement("div",{className:ce.a.root,title:t.display_name},o.a.createElement(i.Link,{className:ce.a.link,target:"_blank",to:"/p/".concat(t.name,"/all/issues")},o.a.createElement("div",{className:p()(ce.a.avatar,t.pmType&&ce.a.isProgram)},o.a.createElement("img",{src:t.avatar||t.icon||""})),o.a.createElement("span",null,t.display_name))):null},de=a("X2ZP"),fe=a.n(de),pe=function(e){var t=e.project,a=e.iteration;return(null===a||void 0===a?void 0:a.code)&&t?o.a.createElement("div",{className:fe.a.root,title:a.name},o.a.createElement(i.Link,{className:fe.a.link,target:"_blank",to:"/p/".concat(null===t||void 0===t?void 0:t.name,"/iterations/").concat(a.code,"/issues")},o.a.createElement("span",null,null===a||void 0===a?void 0:a.name))):null},me=a("S0Yh"),he=a.n(me),ve=a("fwPQ"),ge=a.n(ve),Ee=function(e){var t=e.progress;return null!==t&&t>=0?o.a.createElement("div",{className:ge.a.wrapper},o.a.createElement(he.a,{disabled:!0,progress:t||0})):null},be=a("MS49"),ye=a.n(be),Se=function(e){var t=e.data.program;return(null===t||void 0===t?void 0:t.name)?o.a.createElement("div",{className:ye.a.root,title:t.display_name},o.a.createElement(i.Link,{className:ye.a.link,target:"_blank",to:t.name?"/p/".concat(t.name,"/info"):""},o.a.createElement("div",{className:ye.a.avatar},t.icon&&o.a.createElement("img",{src:t.icon})),o.a.createElement("span",null,t.display_name))):null},Ie=a("Xc6h"),Te=a.n(Ie),Ce=a("k/a0"),Pe=a.n(Ce),we=function(e){var t=e.value,a=e.isPortal,i=e.portalProps,r=e.onChange,s=e.disabled,l=Math.floor(h()(t).endOf("days").diff(h()(),"days",!0));return o.a.createElement(o.a.Fragment,null,!a&&function(e){var t,a=e.value,n=Math.floor(h()(a).endOf("days").diff(h()(),"days",!0));return o.a.createElement("div",{className:p()(Pe.a.root,(t={},t[Pe.a.isToday]=0===n,t[Pe.a.isNearExpiration]=n>0&&n<3,t[Pe.a.isOver]=n<0,t))},o.a.createElement("div",{className:Pe.a.content},n<0&&o.a.createElement("div",{className:Pe.a.isOverIcon},o.a.createElement(Te.a,null)),o.a.createElement("span",null,a)))}({value:t}),a&&i&&o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:p()([Pe.a.planDateTrigger,s&&Pe.a.disabled])},o.a.createElement(k.default,{className:p()([Pe.a.itemDate,s&&Pe.a.disabled]),value:t,onChange:function(e){r&&r({planDate:h()(e).isValid()?h()(e).format("YYYY-MM-DD"):""})},placeholder:Object(n.t)("\u672a\u6307\u5b9a"),calculatePosition:function(){},toRight:!0,toTop:!0,isPortal:a,portalProps:i,trigger:function(e){return function(e,t){var a,n=t.onToggle;return o.a.createElement("div",{className:p()(Pe.a.root,(a={},a[Pe.a.isToday]=0===l,a[Pe.a.isNearExpiration]=l>0&&l<=3,a[Pe.a.isOver]=l<0,a)),onClick:function(){if(!s)return n()}},o.a.createElement("div",{className:Pe.a.content},l<0&&o.a.createElement("div",{className:Pe.a.isOverIcon},o.a.createElement(Te.a,null)),o.a.createElement("span",null,e)),!s&&o.a.createElement("span",{className:Pe.a.icon},o.a.createElement("div",{className:Pe.a.cartDown})))}(t,e)},isDisabled:s}))))},De=a("OTim"),Oe=a("5JFE"),Re=a("D3Zx"),je=a.n(Re),ke=function(e){var t=e.items,a=e.listText,n=e.showNumber;if(!t||0===(null===t||void 0===t?void 0:t.length))return null;var i=(null===t||void 0===t?void 0:t.length)<=n,r=(null===t||void 0===t?void 0:t.slice(0,n))||[],s=(null===t||void 0===t?void 0:t.slice(n,t.length))||[],l=s.length;return o.a.createElement("div",{className:p()(je.a.label)},r.map((function(e){return o.a.createElement("div",{key:e.id},o.a.createElement("div",{className:je.a.tag},e.name))})),o.a.createElement(Oe.Tooltip,{placement:"bottomRight",overlayClassName:je.a.tooltip,getPopupContainer:function(){return document.getElementById("workbenchContainer")},title:!i&&o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:je.a.text},a),o.a.createElement("div",{className:je.a.titleContainer},o.a.createElement("div",null,s.map((function(e){return o.a.createElement("div",{key:e.name,className:je.a.member,title:e.name},e.name)})))))},!i&&o.a.createElement("div",{className:p()(je.a.expand,i&&je.a.disabled)},o.a.createElement("span",{className:je.a.addIcon}),o.a.createElement("span",null,l),o.a.createElement("span",{className:je.a.downIcon}))))},Ne=a("LvDl"),Ae=a("bx+P"),Le=a.n(Ae),Fe={passed:"\u901a\u8fc7",retest:"\u91cd\u6d4b",blocked:"\u53d7\u963b",failed:"\u5931\u8d25",untested:"\u672a\u6d4b",passedCount:"\u901a\u8fc7",retestCount:"\u91cd\u6d4b",blockedCount:"\u53d7\u963b",failedCount:"\u5931\u8d25",untestedCount:"\u672a\u6d4b",passed_count:"\u901a\u8fc7",retest_count:"\u91cd\u6d4b",blocked_count:"\u53d7\u963b",failed_count:"\u5931\u8d25",untested_count:"\u672a\u6d4b",waiting:"\u672a\u5f00\u59cb",testing:"\u8fdb\u884c\u4e2d",completed:"\u5df2\u5b8c\u6210"},_e=function(e){var t=e.type,a=e.value;return o.a.createElement("div",{className:Le.a.progressCell},o.a.createElement("span",{className:p()(Le.a.square,Le.a[t.replace(/Count|_.*$/,"")])}),Fe[t],o.a.createElement("span",{className:Le.a.total},a))},Me=function(e){var t=e.title,a=void 0===t?"\u8fed\u4ee3\u8fdb\u5ea6":t,n=e.progress,i=e.totalProgress;return o.a.createElement("div",{className:Le.a.panel},o.a.createElement("div",{className:Le.a.statistic},a," ",i,"%"),o.a.createElement("div",{className:Le.a.progress},Object(Ne.map)(n,(function(e,t){return o.a.createElement(_e,{key:t,type:t,value:e})}))))},xe=function(e){var t=e.percent,a=e.type;return o.a.createElement("div",{className:p()(Le.a.bar,Le.a[a.replace(/_.*$/,"").replace("Count","")]),style:{width:"".concat(t,"%")}})};function Be(e){var t=e.title,a=e.progress,n=e.passedKey,i=e.passedCountKeys,r=Object.keys(a).reduce((function(e,t){return e+a[t]}),0),s=0,l=!1;Object(Ne.isArray)(i)&&(l=!0,s=Object.values(Object(Ne.pick)(a,i)).reduce((function(e,t){return Number(e||0)+Number(t)}),0)||0);var c=Math.floor(100*(a[n]/r||0)),u=Math.floor(100*(s/r||0));return o.a.createElement("div",{className:Le.a.progressWrapper},o.a.createElement(C.TooltipTrigger,{placement:"top",getContainer:function(){return document.getElementById("workbenchContainer")},title:o.a.createElement(Me,{title:t,progress:a,totalProgress:l?u:c})},o.a.createElement("div",{className:Le.a.barGroup},function(){var e=[];return 0===r?o.a.createElement(xe,{type:"untested",percent:100}):(Object.keys(a).forEach((function(t){0!==a[t]&&e.push(o.a.createElement(xe,{key:t,type:t,percent:a[t]/r*100}))})),e)}())),o.a.createElement("div",{className:Le.a.totalProgress},c,"%"))}var Ue=a("NIJN"),We=a.n(Ue),Ye=a("9+7+"),He=a("TFOv"),Ve=a.n(He),Ge=a("DTVk"),Ke=[Ge.IssueType.requirement,Ge.IssueType.assignment,Ge.IssueType.bug],ze=a("BKNj"),qe=a("vih4"),Ze=a.n(qe),Je=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},Xe=function(e,t,a){if(a||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},Qe=Object(r.memo)((function(e){var t=e.value,a=e.items,i=e.active,r=e.disabled,s=e.initialSelectedItem,l=void 0===s?[]:s,c=e.isMultiple,u=e.label,d=e.removable,f=e.onRemove,m=e.valueChanged,h=e.noMatched,v=e.toolTipText,g=e.placeholder,E=void 0===g?Object(n.t)("\u672a\u6307\u5b9a"):g,b=function(){var e,n=a;if(Array.isArray(l)?n=Object(Ne.uniqBy)(Xe(Xe([],Je(a),!1),Je(l),!1),"id"):"object"===typeof l&&l&&(n=Object(Ne.uniqBy)(Xe(Xe([],Je(a),!1),[l],!1),"id")),c)e=t.map((function(e){var t;return null===(t=n.find((function(t){return(null===t||void 0===t?void 0:t.id)===e})))||void 0===t?void 0:t.text})).filter((function(e){return!!e}));else{var i=n.find((function(e){return e.id===t}));e=i?[i.text]:[]}return e.join(",")};return o.a.createElement("div",{className:p()(Ze.a.trigger,Ze.a.filterTrigger,i&&Ze.a.active,r&&Ze.a.disabled),title:b()},u&&o.a.createElement("div",{className:p()(Ze.a.label)},u),o.a.createElement("div",{className:Ze.a.content},h?o.a.createElement("div",{className:Ze.a.content},Object(n.t)("\u672a\u5339\u914d")):(c?(null===t||void 0===t?void 0:t.length)>0:t)?o.a.createElement("div",{className:Ze.a.content},b()):o.a.createElement("div",{className:p()(Ze.a.content,Ze.a.placeholder)},E)),o.a.createElement("span",{className:p()(Ze.a.caret)}),d&&o.a.createElement("span",{className:p()(Ze.a.removeButton,i&&Ze.a.show),onClick:f}),!!m&&o.a.createElement(C.TooltipTrigger,{title:v},o.a.createElement("div",{className:Ze.a.configError})))})),$e=a("9EjZ"),et=a("y4qj"),tt=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},at=function(e,t,a){if(a||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},nt=Object(r.memo)((function(e){var t=e.value,a=e.items,i=e.active,r=e.disabled,s=e.initialSelectedItem,l=void 0===s?[]:s,c=e.isMultiple,u=e.label,d=e.removable,f=e.onRemove,m=e.valueChanged,h=e.noMatched,v=e.toolTipText,g=e.placeholder,E=function(){var e,n=a;if(Array.isArray(l)?n=Object(Ne.uniqBy)(at(at([],tt(a),!1),tt(l),!1),"id"):"object"===typeof l&&l&&(n=Object(Ne.uniqBy)(at(at([],tt(a),!1),[l],!1),"id")),c)e=t.map((function(e){var t;return null===(t=n.find((function(t){return(null===t||void 0===t?void 0:t.id)===e})))||void 0===t?void 0:t.text})).filter((function(e){return!!e}));else{var i=n.find((function(e){return e.id===t}));e=i?[i.text]:[]}return e.join(",")};return o.a.createElement("div",{className:p()(Ze.a.trigger,Ze.a.filterTrigger,i&&Ze.a.active,r&&Ze.a.disabled),title:E()},u&&o.a.createElement("div",{className:p()(Ze.a.label)},u),o.a.createElement("div",{className:Ze.a.content},h?Object(n.t)("\u672a\u5339\u914d"):(c?(null===t||void 0===t?void 0:t.length)>0:t)?E():g||Object(n.t)("\u5168\u90e8")),o.a.createElement("span",{className:p()(Ze.a.caret)}),d&&o.a.createElement("span",{className:p()(Ze.a.removeButton,i&&Ze.a.show),onClick:f}),!!m&&o.a.createElement(C.TooltipTrigger,{title:v},o.a.createElement("div",{className:Ze.a.configError})))})),it=a("6T/w"),rt=a("hL64"),ot=a("8By3"),st=Object(r.memo)((function(e){var t=e.value,a=e.items,n=e.initialSelectedItem,i=e.active,r=e.disabled,s=e.isMultiple,l=function(){return s?(null===t||void 0===t?void 0:t.length)>0:!!t},c=function(){return l()?function(){var e;if(l()){if(s){var i=(null===n||void 0===n?void 0:n.length)?a.concat(n):a;e=(r=t.map((function(e){return i.find((function(t){return t.id===e||t.id===e.id}))}))).map((function(e){return e.name})).join(",")}else{var r;e=null===(r=n||a.find((function(e){return e.id===t})))||void 0===r?void 0:r.text}return e}}():o.a.createElement("span",{style:{color:"#b8c0cb"}},"\u672a\u6307\u5b9a")};return o.a.createElement("div",{className:p()(Ze.a.tableCell,Ze.a.trigger,i&&Ze.a.active,r&&Ze.a.disabled),title:c()},o.a.createElement("div",{className:Ze.a.content},c()),o.a.createElement("span",{className:p()(Ze.a.caret)}))})),lt=function(){return(lt=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},ct=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(a[n[i]]=e[n[i]])}return a},ut=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},dt=function(e){switch(e){case U.ComponentType.TABLE_CELL:return st;case U.ComponentType.FORM:return $e.a;case U.ComponentType.ICON:return et.a;case U.ComponentType.FILTER:return nt;case U.ComponentType.BUTTON:return it.a;case U.ComponentType.FLAT_TYPE:return rt.a;default:return Qe}},ft=function(e){var t=e.value,a=e.items,n=e.onClear,i=ct(e,["value","items","onClear"]),s=ut(Object(r.useState)([]),2),l=s[0],c=s[1],u=ut(Object(r.useState)(null),2),d=u[0],f=u[1];return o.a.createElement(ze.default,lt({},i,{isMultiple:!1,value:t,items:d?l:a,isFilter:e.componentType===U.ComponentType.FILTER,searchable:!0,onSearch:function(e){f(e);var t=a.filter((function(t){return String(t.text).includes(e)}));c(t)},clearable:e.clearable,onClear:function(){f(null),c([]),n&&n()},Trigger:dt(e.componentType),triggerExtraProps:e.triggerExtraProps,itemExtraProps:e.itemExtraProps,item:ot.a}))},pt=function(){return(pt=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},mt=["waiting","testing","completed"],ht=["passedCount","retestCount","blockedCount","failedCount"],vt={passed:"\u901a\u8fc7",retest:"\u91cd\u6d4b",blocked:"\u53d7\u963b",failed:"\u5931\u8d25",untested:"\u672a\u6d4b",passedCount:"\u901a\u8fc7",retestCount:"\u91cd\u6d4b",blockedCount:"\u53d7\u963b",failedCount:"\u5931\u8d25",untestedCount:"\u672a\u6d4b",passed_count:"\u901a\u8fc7",retest_count:"\u91cd\u6d4b",blocked_count:"\u53d7\u963b",failed_count:"\u5931\u8d25",untested_count:"\u672a\u6d4b",waiting:"\u672a\u5f00\u59cb",testing:"\u8fdb\u884c\u4e2d",completed:"\u5df2\u5b8c\u6210"},gt={TODO:"\u672a\u5f00\u59cb",PROCESSING:"\u8fdb\u884c\u4e2d",COMPLETED:"\u5df2\u5b8c\u6210"},Et=Object(r.memo)((function(e){var t=e.mode,a=e.projectPath,i=e.locationQuery,s=e.organizedIssues,l=e.collapsedIssueCodes,c=e.tableViewType,u=e.tableFieldPreference,f=e.data,m=e.index,b=e.stickyPostionArr,y=e.isLast,S=void 0!==y&&y,I=e.isTableSetting,C=void 0!==I&&I,P=e.key,w=e.onDataChange,D=e.onToggle,O=e.isSelect,R=e.disabled,k=e.isSticky,N=void 0!==k&&k,A=e.onSelectData,L=e.selectedData,F=e.detailPath,_=e.tableScrollLeft,W=e.setActiveHash,Y=e.browserRouter,V=e.showDetail,G=e.isPortal,K=e.portalProps,q=e.tbodyRef,Z=e.isCurrent,J=e.idKey,X=e.stopLink,$=e.openNewDetail,ee=Object(r.useMemo)((function(){var e;return pt(pt(pt({},C?{right:"0px"}:{left:"".concat(N?b[m]+(m>0?E.DEFAULT_TR_PADDING:0):"","px")}),N?{zIndex:_>0?E.DEFAULT_INDEX+10:E.DEFAULT_INDEX-1}:{}),{width:"".concat(null===(e=null===u||void 0===u?void 0:u.data)||void 0===e?void 0:e.width,"px"),paddingLeft:0===m?"":void 0})}),[C,u,b,_]),ae=function(e){if(w)return w(f,e)},ie=function(e,t){var a,n=[],i=f.participant&&Object(Ne.isArray)(f.participant)?f.participant:[];e&&(n=i.find((function(t){return t.id===e.id}))?i.filter((function(t){return e.id!==t.id})):We()(i,e));var r=((a={})[t]=n.map((function(e){return e.id})),a);if(w)return w(f,r)},re=Object(r.useCallback)((function(){var e,r,g,E,b,y,S,I,C,P,w,O,k,N,A,L,_,ee,re,oe,le,ce,de,fe,me,he,ve,ge,be,ye,Ie,Te,Ce,Pe,Oe,Re,je,Ae,Le,Fe,_e,Me,xe,Ue,We,He,Ge,ze,qe,Ze,Je,Xe,Qe,$e;if(null===(e=u.data)||void 0===e?void 0:e.render)return u.data.render(f,!!Z);if(!u.data.accessor)return null;if(u.type===d.a.custom){var et=u.issueFieldIds,tt=null!==(r=f.customFields)&&void 0!==r?r:{},at=Object.keys(tt).map((function(e){return Number(e)})),nt=null===et||void 0===et?void 0:et.find((function(e){return at.indexOf(e)>-1})),it=tt[nt&&nt],rt=(null===(g=null===u||void 0===u?void 0:u.data)||void 0===g?void 0:g.options)?null===(E=null===u||void 0===u?void 0:u.data)||void 0===E?void 0:E.options[nt]:void 0,ot=window.location.pathname.match(/\/p\/([^/]+)/);switch(null===u||void 0===u?void 0:u.componentType){case v.PROPERTY_TYPE_CONSTANTS.SELECT_MEMBER_MULTI:return it?o.a.createElement(B.default,{componentType:U.ComponentType.TABLE_CELL,disabled:!0,isMultiple:!0,value:null===it||void 0===it?void 0:it.map((function(e){return e.id})),triggerExtraProps:{initialSelectedItem:it},parentRef:q}):null;case v.PROPERTY_TYPE_CONSTANTS.SELECT_MEMBER_SINGLE:return it?o.a.createElement(B.default,{componentType:U.ComponentType.TABLE_CELL,disabled:!0,value:null===it||void 0===it?void 0:it.id,triggerExtraProps:{initialSelectedItem:it},parentRef:q}):null;case v.PROPERTY_TYPE_CONSTANTS.TEXT_DATE:return ot&&"requirement"===(null===(b=null===f||void 0===f?void 0:f.issueTypeDetail)||void 0===b?void 0:b.type)&&"\u8ba1\u5212\u63d0\u6d4b\u65e5\u671f"===u.name?o.a.createElement(M,{value:it?h()(it).valueOf():it,data:f,type:"label",suffix:"\u63d0\u6d4b"}):o.a.createElement(M,{value:it?h()(it).valueOf():it});case v.PROPERTY_TYPE_CONSTANTS.TEXT_DATETIME:return o.a.createElement(M,{value:it?h()(it).valueOf():it,format:"YYYY/MM/DD HH:mm"});case v.PROPERTY_TYPE_CONSTANTS.TEXT_DECIMAL:case v.PROPERTY_TYPE_CONSTANTS.TEXT_INTEGER:case v.PROPERTY_TYPE_CONSTANTS.TEXT_MULTI_LINE:case v.PROPERTY_TYPE_CONSTANTS.TEXT_SINGLE_LINE:return o.a.createElement(H,{value:it});case v.PROPERTY_TYPE_CONSTANTS.SELECT_MULTI:return o.a.createElement(H,{value:null===it||void 0===it?void 0:it.map((function(e){var t;return null===(t=null===rt||void 0===rt?void 0:rt.find((function(t){return t.value===e})))||void 0===t?void 0:t.title})).join("\uff0c")});case v.PROPERTY_TYPE_CONSTANTS.SELECT_SINGLE:return o.a.createElement(H,{value:(null===(y=null===rt||void 0===rt?void 0:rt.find((function(e){return e.value===it})))||void 0===y?void 0:y.title)||""});case v.PROPERTY_TYPE_CONSTANTS.SELECT_ITERATION_SINGLE:return o.a.createElement(H,{value:null===it||void 0===it?void 0:it.name});case v.PROPERTY_TYPE_CONSTANTS.SELECT_ITERATION_MULTI:return o.a.createElement(H,{value:null===it||void 0===it?void 0:it.map((function(e){return e.name})).join("\uff0c")});case v.PROPERTY_TYPE_CONSTANTS.SELECT_TREE_MULTI:return o.a.createElement(H,{value:Array.isArray(it)?null===(C=null===(I=null===(S=Array.from(new Set(it)))||void 0===S?void 0:S.map((function(e){return Object(Ye.flattenTreeLastNodeList)(rt||[]).find((function(t){return t.value===e}))})))||void 0===I?void 0:I.filter((function(e){return e&&(null===e||void 0===e?void 0:e.isLastLeaf)})).map((function(e){return e.title})))||void 0===C?void 0:C.join(","):""})}}else switch(u.type){case d.a.id:return window.location.pathname.indexOf("biz-intention")>0?o.a.createElement(H,{value:(null===f||void 0===f?void 0:f.id)||"",className:p()(Ve.a.issueTypeName,Ve.a.noPadding)}):o.a.createElement(T,{id:f[J?"ID"===J?"code":"gid":u.data.accessor],stopLink:X,data:f,showIcon:u.data.showIcon});case d.a.code:return o.a.createElement(T,{id:f[u.data.accessor],data:f,isCurrent:Z});case d.a.title:return o.a.createElement(j,{setActiveHash:W,index:m,detailPath:F,openNewDetail:$,titleData:f,mode:t,projectPath:a,locationQuery:i,organizedIssues:s,collapsedIssueCodes:l,tableViewType:c,onToggle:D,browserRouter:Y,showDetail:V,isCurrent:Z,showIcon:u.data.showIcon});case d.a.type:return o.a.createElement(H,{value:f[u.data.accessor]||""});case d.a.creator:return o.a.createElement(B.default,{componentType:U.ComponentType.TABLE_CELL,disabled:!0,value:null===(P=f[u.data.accessor])||void 0===P?void 0:P.id,triggerExtraProps:{initialSelectedItem:f[u.data.accessor]},parentRef:q});case d.a.assignee:return"workbench_assignee_multiple"===u.data.accessor?o.a.createElement(B.default,{componentType:U.ComponentType.TABLE_CELL,disabled:R,inProject:!0,isMultiple:!0,projectID:null===(w=null===f||void 0===f?void 0:f.project)||void 0===w?void 0:w.id,value:(null===(O=f.assignees)||void 0===O?void 0:O.map((function(e){return e.id})))||[],sliceLength:3,onSelect:function(e){return ie(e,"assignee")},onClear:function(){return ie(null,"assignee")},triggerExtraProps:{initialSelectedItem:f.assignees||[]},parentRef:q}):o.a.createElement(B.default,{componentType:U.ComponentType.TABLE_CELL,disabled:R,inProject:!0,projectID:null===(k=null===f||void 0===f?void 0:f.project)||void 0===k?void 0:k.id,value:null===(N=f[u.data.accessor])||void 0===N?void 0:N.id,sliceLength:3,onSelect:function(e){return ae&&ae({assignee:e.value})},onClear:function(){return ae&&ae({assignee:0})},triggerExtraProps:{initialSelectedItem:f[u.data.accessor]},parentRef:q});case d.a.watcher:return o.a.createElement(B.default,{componentType:U.ComponentType.TABLE_CELL,disabled:!0,isMultiple:!0,value:null===(A=f.watchers)||void 0===A?void 0:A.map((function(e){return e.id})),triggerExtraProps:{initialSelectedItem:f.watchers},parentRef:q});case d.a.priority:if("biz_intention"===(null===(L=null===f||void 0===f?void 0:f.issueTypeDetail)||void 0===L?void 0:L.type)){var st=Array.from({length:100},(function(e,t){return t})).map((function(e){return{id:e+1,value:e+1,text:e+1}}));return o.a.createElement(ft,{value:f[u.data.accessor],componentType:U.ComponentType.TABLE_CELL,items:st,clearable:!0,placeholder:Object(n.t)("\u672a\u6307\u5b9a"),searchPlaceholder:Object(n.t)("\u5feb\u901f\u7b5b\u9009"),dataInited:!0,onSelect:function(e){ae({priority:e.id})},onSearch:function(e,t){return t.filter((function(t){return t.text.indexOf(e)>-1}))},onClear:function(){ae({priority:0})},isPortal:G,portalProps:K,dropdownStyle:Ve.a.priority,triggerStyle:Ve.a.priority,panelCustomStyle:Ve.a.priority})}return o.a.createElement(x.default,{componentType:U.ComponentType.TABLE_CELL,tableCell:!0,disabled:R,value:f[u.data.accessor],onSelect:function(e){var t=e.id;return ae({priority:t})},triggerExtraProps:{withoutText:!!((null===(_=null===u||void 0===u?void 0:u.data)||void 0===_?void 0:_.width)&&(null===(ee=null===u||void 0===u?void 0:u.data)||void 0===ee?void 0:ee.width)<60),disabledBgColor:!(!R||!u.data.disabledBgColor)},isPortal:G,portalProps:K});case d.a.iteration:case d.a.iterationsys:return o.a.createElement(pe,{project:null===f||void 0===f?void 0:f.project,iteration:f.iteration||f.issueIterationDTO});case d.a.label:return o.a.createElement(z,{value:f.labels});case d.a.hourRecord:return f.recordedHours||f.remainingHours?["REQUIREMENT","MISSION","DEFECT"].includes(null===(re=null===f||void 0===f?void 0:f.issueTypeDetail)||void 0===re?void 0:re.issueType)&&"prd_issue"!==(null===(oe=null===f||void 0===f?void 0:f.issueTypeDetail)||void 0===oe?void 0:oe.type)?o.a.createElement(Q,{recordHours:f.recordedHours?f.recordedHours/8:f.recordedHours,remainingHours:((null===f||void 0===f?void 0:f.workingHours)?Math.round((null===f||void 0===f?void 0:f.workingHours)/8*100)/100:null===f||void 0===f?void 0:f.workingHours)-(f.recordedHours?f.recordedHours/8:f.recordedHours)}):o.a.createElement(te,{recordHours:f.recordedHours,remainingHours:f.remainingHours}):o.a.createElement(o.a.Fragment,null);case d.a.workingHours:case d.a.rigisteredHours:return o.a.createElement(H,{value:f[u.data.accessor]>0?"".concat(Math.round(f[u.data.accessor]/8*100)/100||0," ").concat(Object(n.t)("\u5929")):""});case d.a.createdAt:return"workbench_createdAt"===u.data.accessor?o.a.createElement(M,{value:f.createDate,data:f,format:"YYYY/MM/DD"}):"workbench_atMe_createdAt"===u.data.accessor?o.a.createElement(M,{value:f.createdAt,data:f,format:"YYYY/MM/DD HH:mm"}):"workbench_test_audit_createdAt"===u.data.accessor?o.a.createElement(H,{value:f.auditCreateTime}):o.a.createElement(M,{value:f.createdAt,data:f,format:"YYYY/MM/DD HH:mm"});case d.a.dueDate:return o.a.createElement(M,{value:f.dueDate,data:f,type:"label",disabled:R,onChange:ae,isPortal:G,portalProps:K});case d.a.updatedAt:return o.a.createElement(M,{value:f[u.data.accessor],data:f,format:"YYYY/MM/DD HH:mm"});case d.a.startDate:return o.a.createElement(M,{value:f[u.data.accessor],data:f});case d.a.status:return o.a.createElement(se,{data:f,disabled:R,onChange:ae});case d.a.defectKind:return o.a.createElement(H,{value:f.issueDefectKinds?f.issueDefectKinds.map((function(e){return e.name})).join():""});case d.a.defectSource:return o.a.createElement(H,{value:null===(le=f.issueDefectSource)||void 0===le?void 0:le.name});case d.a.defectPhase:return o.a.createElement(H,{value:null===(ce=f.issueDefectPhase)||void 0===ce?void 0:ce.name});case d.a.system:return o.a.createElement(H,{value:(null===(de=f.systemDTO)||void 0===de?void 0:de.systemName)||""});case d.a.GROUP_TEAM:return o.a.createElement(H,{value:(null===(fe=null===f||void 0===f?void 0:f.groupTeam)||void 0===fe?void 0:fe.groupTeamName)||(null===(me=null===f||void 0===f?void 0:f.groupTeamDto)||void 0===me?void 0:me.groupTeamName)||""});case d.a.milestone:return o.a.createElement(H,{value:(null===(he=null===f||void 0===f?void 0:f.milestone)||void 0===he?void 0:he.name)||""});case d.a.inprogram:return o.a.createElement(H,{value:(null===(ve=null===f||void 0===f?void 0:f.program)||void 0===ve?void 0:ve.display_name)||""});case d.a.EDITION:return o.a.createElement(H,{value:(null===(ge=f.editionDTO)||void 0===ge?void 0:ge.editionName)||""});case d.a.plan_testing_date:return o.a.createElement(H,{value:"9999-01-01"===f.planTestingDate?"":f.planTestingDate});case d.a.planDate:return"9999-01-01"===f.planDate?"":"workbench_planDate"===u.data.accessor?o.a.createElement(we,{value:f.planDate,disabled:!0,isPortal:G,portalProps:K,onChange:ae}):o.a.createElement(M,{value:f.planDate&&h()(f.planDate).isValid()?h()(f.planDate).valueOf():f.planDate,data:f,type:"overtime"});case d.a.edition_type:return o.a.createElement(H,{value:f.editionType});case d.a.edition_status:return o.a.createElement(H,{value:f.editionStatus});case d.a.edition_no:return o.a.createElement(H,{value:f.editionNo});case d.a.issue_type:return o.a.createElement(H,{value:gt[f.issueTypeName]||f.issueTypeName});case d.a.requirement_type:return o.a.createElement(H,{value:null===(be=f.projectRequirementType)||void 0===be?void 0:be.name});case d.a.approver:return o.a.createElement(H,{value:null!==(Ce=null!==(Ie=null===(ye=null===f||void 0===f?void 0:f.launcher)||void 0===ye?void 0:ye.name)&&void 0!==Ie?Ie:null===(Te=null===f||void 0===f?void 0:f.creater)||void 0===Te?void 0:Te.name)&&void 0!==Ce?Ce:""});case d.a.initiate_time:return o.a.createElement(H,{value:"9999-01-01"===(f.createDate||f.createdAt)?"":f.createDate||f.createdAt});case d.a.approval_reviewer:return"workbench_approval_reviewer_single"===u.data.accessor?o.a.createElement(H,{value:null!==(Oe=null===(Pe=null===f||void 0===f?void 0:f.teamLeader)||void 0===Pe?void 0:Pe.name)&&void 0!==Oe?Oe:""}):o.a.createElement("div",{style:{padding:"0 12px",overflow:"hidden"}},o.a.createElement(ke,{items:(null===(Re=f.reviewerList)||void 0===Re?void 0:Re.filter((function(e){return null===e||void 0===e?void 0:e.name})))||[],listText:Object(n.t)("\u66f4\u591a\u5ba1\u6279/\u8bc4\u5ba1\u4eba"),showNumber:2}));case d.a.plan_production_date:return o.a.createElement(H,{value:"9999-01-01"===f.planProductionDate?"":f.planProductionDate});case d.a.begin_at:return o.a.createElement(H,{value:"9999-01-01"===f.beginAt?"":f.beginAt});case d.a.end_at:return o.a.createElement(H,{value:"9999-01-01"===f.endAt?"":f.endAt});case d.a.audit_initiate_time:return o.a.createElement(H,{value:"9999-01-01"===f.auditInitiateTime?"":h()(f.auditInitiateTime).format("YYYY-MM-DD HH:mm:ss")});case d.a.module:return o.a.createElement(H,{value:(null===(je=f.projectModule)||void 0===je?void 0:je.name)||(null===(Ae=f.module)||void 0===Ae?void 0:Ae.name)});case d.a.project:return o.a.createElement(ue,{project:f.project});case d.a.program:return o.a.createElement(Se,{data:f});case d.a.progress:return o.a.createElement(Ee,{progress:f.progress});case d.a.process:return o.a.createElement("div",{style:{padding:"0 12px"}},o.a.createElement(ne.default,{status:f.processStatus}));case d.a.audit_result:return o.a.createElement("div",{style:{padding:"0 12px"}},o.a.createElement(ne.default,{status:f.resultStatus}));case d.a.plan_complete_time:return o.a.createElement(H,{value:f.planCompleteTime});case d.a.audit_end_time:return o.a.createElement(H,{value:f.auditEndTime});case d.a.relate_systems:return o.a.createElement(H,{value:f.relateSystemList});case d.a.relate_editions:return o.a.createElement(H,{value:f.relateEditionList});case d.a.proposer:return o.a.createElement(B.default,{componentType:U.ComponentType.TABLE_CELL,disabled:!0,value:null===(Le=f.proposer)||void 0===Le?void 0:Le.id,triggerExtraProps:{initialSelectedItem:f.proposer},parentRef:q});case d.a.plan_join_user:return o.a.createElement(B.default,{componentType:U.ComponentType.TABLE_CELL,disabled:R,inProject:!0,isMultiple:!0,projectID:null===(Fe=null===f||void 0===f?void 0:f.project)||void 0===Fe?void 0:Fe.id,value:(null===(_e=f.planJoinUserList)||void 0===_e?void 0:_e.map((function(e){return e.id})))||[],sliceLength:3,onSelect:function(e){return ie(e,"planJoinUserList")},onClear:function(){return ie(null,"planJoinUserList")},triggerExtraProps:{initialSelectedItem:f.planJoinUserList||[]},parentRef:q});case d.a.real_join_user:return o.a.createElement(B.default,{componentType:U.ComponentType.TABLE_CELL,disabled:R,inProject:!0,isMultiple:!0,projectID:null===(Me=null===f||void 0===f?void 0:f.project)||void 0===Me?void 0:Me.id,value:(null===(xe=f.realJoinUser)||void 0===xe?void 0:xe.map((function(e){return e.id})))||[],sliceLength:3,onSelect:function(e){return ie(e,"realJoinUser")},onClear:function(){return ie(null,"realJoinUser")},triggerExtraProps:{initialSelectedItem:f.realJoinUser||[]},parentRef:q});case d.a.promoter:return o.a.createElement(B.default,{componentType:U.ComponentType.TABLE_CELL,disabled:R,inProject:!0,projectID:null===(Ue=null===f||void 0===f?void 0:f.project)||void 0===Ue?void 0:Ue.id,value:null===(We=null===f||void 0===f?void 0:f.promoter)||void 0===We?void 0:We.id,sliceLength:3,onSelect:function(e){return ae&&ae({promoter:e.value})},onClear:function(){return ae&&ae({promoter:0})},triggerExtraProps:{initialSelectedItem:f.promoter,disabledBgColor:!(!R||!u.data.disabledBgColor)},parentRef:q,isPortal:G,portalProps:K});case d.a.review_initiate_time:return o.a.createElement(H,{value:f.auditInitiateTime||f.reviewInitiateTime});case d.a.plan_reviewer_users:return o.a.createElement(B.default,{componentType:U.ComponentType.TABLE_CELL,disabled:!0,isMultiple:!0,value:null===(He=f.planReviewerUsers)||void 0===He?void 0:He.map((function(e){return e.id})),triggerExtraProps:{initialSelectedItem:f.planReviewerUsers}});case d.a.real_reviewer_users:var lt=(null===(Ge=f.realReviewerUsers)||void 0===Ge?void 0:Ge.length)>0?f.realReviewerUsers:f.planReviewerUsers;return o.a.createElement(B.default,{componentType:U.ComponentType.TABLE_CELL,disabled:!0,isMultiple:!0,value:null===lt||void 0===lt?void 0:lt.map((function(e){return e.id})),triggerExtraProps:{initialSelectedItem:lt}});case d.a.review_initiator:return o.a.createElement(H,{value:null!==(qe=null===(ze=(null===f||void 0===f?void 0:f.creator)||(null===f||void 0===f?void 0:f.reviewInitiator))||void 0===ze?void 0:ze.name)&&void 0!==qe?qe:""});case d.a.review_commission_user:return o.a.createElement(H,{value:null!==(Je=null===(Ze=null===f||void 0===f?void 0:f.reviewCommissionUser)||void 0===Ze?void 0:Ze.name)&&void 0!==Je?Je:""});case d.a.test_time:return o.a.createElement(H,{value:f.testingCount});case d.a.recent_test_time:return o.a.createElement(H,{value:f.recentlyTesting});case d.a.story_point:return o.a.createElement(De.default,{componentType:U.ComponentType.TABLE_CELL,tableCell:!0,disabled:R||!Ke.includes(null===f||void 0===f?void 0:f.type),value:f.storyPoint,onSelect:function(e){return ae&&ae({storyPoint:e})},onClear:function(){return ae&&ae({storyPoint:-1})}});case d.a.participant:return o.a.createElement(B.default,{componentType:U.ComponentType.TABLE_CELL,disabled:!0,isMultiple:!0,value:null===(Xe=f.participants)||void 0===Xe?void 0:Xe.map((function(e){return e.id})),triggerExtraProps:{initialSelectedItem:f.participants},parentRef:q});case d.a.release:return o.a.createElement(H,{value:null===(Qe=f.releaseNames)||void 0===Qe?void 0:Qe.join("\u3001")});case d.a.test_pass_rate:return o.a.createElement(Be,{title:"\u6d4b\u8bd5\u8fdb\u5ea6",passedKey:"passedCount",passedCountKeys:ht,progress:Object(Ne.pick)(Object(Ne.omit)(f,mt),Object.keys(vt))});case d.a.include_rounds:return o.a.createElement(H,{value:f.includingRounds});case d.a.my_association:return o.a.createElement(H,{value:f.myAssociation||f.association});case d.a.stage:return o.a.createElement(H,{value:f.stage||f.stageName});case d.a.proposer_dept:return o.a.createElement(H,{value:null===($e=f.proposerDept)||void 0===$e?void 0:$e.orgName});case d.a.proposed_date:return o.a.createElement(M,{value:f.proposedDate,data:f,format:"YYYY/MM/DD HH:mm"});case d.a.host_team:return o.a.createElement(H,{value:f.hostTeamName});case d.a.host_group_team:return o.a.createElement(H,{value:f.hostGroupTeamName});case d.a.auxiliary_team:return o.a.createElement(H,{value:f.auxiliaryTeamName});case d.a.auxiliary_group_team:return o.a.createElement(H,{value:f.auxiliaryGroupTeamName});default:return o.a.createElement("div",null)}}),[f,u,Z]);return o.a.createElement("td",{key:P,style:ee,className:p()([N&&!C?Ve.a.sticky:"",C?Ve.a.tableSetting:""])},O?o.a.createElement("div",{className:Ve.a.cell},o.a.createElement(g.a,{onChange:function(){return A(f)},checked:L.some((function(e){return e===f.id||e===f.code}))})):S?o.a.createElement("div",{className:Ve.a.cell}):o.a.createElement("div",{className:p()([Ve.a.cell,0===m?Ve.a.firstCell:""])},re()))})),bt=function(){return(bt=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},yt=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(a[n[i]]=e[n[i]])}return a},St=Object(r.memo)((function(e){var t,a=e.mode,n=e.projectPath,i=e.locationQuery,r=e.organizedIssues,s=e.collapsedIssueCodes,l=e.tableViewType,c=e.rowPreference,u=e.displayType,f=e.data,m=e.stickyPostionArr,h=e.withTableContext,v=e.onToggle,g=e.onDataChange,E=e.disabled,b=e.stickyIndex,y=e.onSelectData,S=e.selectedData,I=e.detailPath,T=e.tableScrollLeft,C=e.activeHash,P=e.setActiveHash,w=e.browserRouter,D=e.showDetail,O=e.permissionCheck,R=e.isPortal,j=e.portalProps,k=e.tbodyRef,N=e.idKey,A=e.className,L=e.openNewDetail,F=e.withTableSetting,_=yt(e,["mode","projectPath","locationQuery","organizedIssues","collapsedIssueCodes","tableViewType","rowPreference","displayType","data","stickyPostionArr","withTableContext","onToggle","onDataChange","disabled","stickyIndex","onSelectData","selectedData","detailPath","tableScrollLeft","activeHash","setActiveHash","browserRouter","showDetail","permissionCheck","isPortal","portalProps","tbodyRef","idKey","className","openNewDetail","withTableSetting"]),M=C==="".concat(null===(t=null===f||void 0===f?void 0:f.project)||void 0===t?void 0:t.id,"-").concat(f.code);return o.a.createElement("tr",bt({className:p()([u===d.d.loose?Ve.a.loose:Ve.a.tight,M?Ve.a.active:""],A&&Ve.a[A])},_),c.map((function(e,t){var u,p,C;return o.a.createElement(Et,{setActiveHash:P,tableScrollLeft:T,detailPath:I,selectedData:S,isSticky:t<=b,disabled:E||!1===f.allowUpdate||!(!O||O(f.type,f.projectId)),mode:a,openNewDetail:L,projectPath:n,locationQuery:i,organizedIssues:r,collapsedIssueCodes:s,tableViewType:l,withTableContext:h,data:f,isSelect:!(e.type!==d.a.custom||!e.data.isSelect),isLastSticky:!(!(null===(u=null===e||void 0===e?void 0:e.data)||void 0===u?void 0:u.isSticky)||(null===(C=null===(p=c[t+1])||void 0===p?void 0:p.data)||void 0===C?void 0:C.isSticky)),isTableSetting:e.data.accessor===d.c,isLast:t===c.length-1&&F,tableFieldPreference:e,index:t,stickyPostionArr:m,onDataChange:g,key:e.type===d.a.custom?e.issueFieldId:e.type,onToggle:v,onSelectData:y,browserRouter:w,showDetail:D,isPortal:R,portalProps:j,tbodyRef:k,isCurrent:M,idKey:N})})))})),It=a("VFNB"),Tt=a.n(It),Ct=Object(r.memo)((function(e){var t=e.rowPreference,a=e.displayType,n=e.rowIndex;return o.a.createElement("tr",{className:a===d.d.loose?Ve.a.loose:Ve.a.tight},t.map((function(e,t){var a;return o.a.createElement("td",{key:e.type===d.a.custom?e.issueFieldId:e.type,style:{width:"".concat(null===(a=null===e||void 0===e?void 0:e.data)||void 0===a?void 0:a.width,"px")}},o.a.createElement("div",{className:p()([Tt.a.loadingTrunk,0===t?Tt.a.first:""]),style:{width:"".concat(Math.max(Math.abs(80*Math.sin(n)),40),"%")}}))})))})),Pt=a("sEfC"),wt=a.n(Pt),Dt=a("48O2"),Ot=a.n(Dt),Rt=a("T+Ca"),jt=a.n(Rt),kt=function(){return(kt=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Nt=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},At=function(e){var t,a=e.allCollapse,i=e.treeTitleHeader,s=e.tableCellPreference,l=e.stickyPostionArr,c=e.key,d=e.index,f=e.isLast,m=void 0!==f&&f,h=e.isTableSetting,v=void 0!==h&&h,b=e.setResizeLineLeft,y=e.updateTableSetting,S=e.onSickyChange,I=e.tableRef,T=e.onSort,P=e.setCurrentSort,w=e.currentSort,D=e.showTableSetting,O=e.isSelect,R=e.onToggleAll,j=e.disableTableSetting,k=e.isSticky,N=void 0!==k&&k,A=e.onSelectAllData,L=e.selectedData,F=e.whetherSelectAll,_=e.headerCellProjectType,M=e.idKey,x=e.onToggleIdGid,B=e.filterKey,U=e.renderFilter,W=Nt(Object(r.useState)(1),2),Y=W[0],H=W[1],V=Nt(Object(r.useState)(!1),2),G=V[0],K=V[1],z=Nt(Object(r.useState)(!1),2),q=z[0],Z=z[1],J=Nt(Object(r.useState)(0),2),X=J[0],Q=J[1],$=Nt(Object(r.useState)(!1),2),ee=$[0],te=$[1],ae=Object(r.useRef)(null),ne=Object(r.useMemo)((function(){var e;return kt(kt({},v?{right:"0px"}:{left:N?"".concat(l[d]+(d>0?E.DEFAULT_TR_PADDING:0),"px"):void 0}),{zIndex:N?E.DEFAULT_INDEX+2:void 0,width:"".concat(null===(e=s.data)||void 0===e?void 0:e.width,"px")})}),[v,s,l]);Object(r.useLayoutEffect)((function(){w!==d&&(H(1),K(!1))}),[w]);var ie=Object(r.useCallback)((function(){if(!j){if(ae.current){var e=ae.current.getBoundingClientRect(),t=e.width,a=e.left;b(a+t)}document.body.style.userSelect="none",Z(!q)}}),[j]),re=Object(r.useCallback)((function(){if(!j&&ae.current){var e=ae.current.getBoundingClientRect(),t=e.width,a=e.left;b(a+t)}}),[j]);Object(r.useLayoutEffect)((function(){var e=wt()((function(e){var t,a;if(ae.current){var n=ae.current.getBoundingClientRect().left,i=0===d?E.DEFAULT_TR_PADDING:0,r=Math.max(n+((null===(t=s.data)||void 0===t?void 0:t.minWidth)||E.DEFAULT_CELL_MIN_WIDTH)+i,e.clientX),o=Math.max(r-n-i,(null===(a=s.data)||void 0===a?void 0:a.minWidth)||E.DEFAULT_CELL_MIN_WIDTH);Q(o),b(r)}})),t=function(){var e=u()(s);e.data.width=X,y(e,{width:X}),Z(!1),document.body.style.userSelect="initial"};return q?(window.addEventListener("mouseup",t),window.addEventListener("mousemove",e)):(window.removeEventListener("mousemove",e),window.removeEventListener("mouseup",t)),function(){window.removeEventListener("mousemove",e),window.removeEventListener("mouseup",t)}}),[q,X]),Object(r.useEffect)((function(){var e;function t(){var e;if(I.current&&I.current.querySelector("tbody")){var t=((null===(e=I.current.querySelector("tbody"))||void 0===e?void 0:e.getBoundingClientRect().width)||0)-(I.current.getBoundingClientRect().width+I.current.scrollLeft)>E.DEFAULT_TR_PADDING;te(t)}}return t(),null===(e=null===I||void 0===I?void 0:I.current)||void 0===e||e.addEventListener("scroll",t),function(){var e;null===(e=null===I||void 0===I?void 0:I.current)||void 0===e||e.addEventListener("scroll",t)}}),[]);var oe;return o.a.createElement("th",{key:c,style:ne,className:p()([v?Ot.a.tableSetting:"",v&&ee?Ot.a.settingShadow:""]),ref:ae},O?o.a.createElement("div",{className:p()([Ot.a.headerCell])},o.a.createElement(g.a,{disabled:j,onChange:function(){return A(!F)},checked:F,indeterminate:!F&&L.length>0})):v?o.a.createElement("div",{className:p()([Ot.a.headerCell,Ot.a.settingCell])},o.a.createElement("div",{className:Ot.a.settingIcon,onClick:D})):o.a.createElement("div",{className:Ot.a.cellRoot},(null===B||void 0===B?void 0:B.includes("".concat(s.type)))?o.a.createElement("div",{className:p()([Ot.a.withFilter])},U(s)):o.a.createElement("div",{className:p()([Ot.a.headerCell,(null===(t=s.data)||void 0===t?void 0:t.sort)?Ot.a.withSort:"",G?Ot.a.sorted:"",-1===Y?Ot.a.invert:"","ID/GID"===s.name?Ot.a.cursor:""]),onClick:function(){var e;if(!j&&(null===(e=s.data)||void 0===e?void 0:e.sort)&&T){var t=1===Y?-1:1;P(d),H(t),K(!0),T(s,t)}else"ID/GID"===s.name&&x&&x()}},i&&R&&o.a.createElement("div",{className:p()(Ot.a.collapseIcon,a&&Ot.a.collapsed),onClick:R}),o.a.createElement("div",{className:Ot.a.title,title:s.name+(s.unit?" (".concat(s.unit,")"):"")},"PROJECT"===(oe=s).type?function(){switch(_){case E.PROJECT_CELL_NAME.PROJECT:return Object(n.t)("\u7814\u53d1\u7a7a\u95f4");case E.PROJECT_CELL_NAME.PROGRAM:return Object(n.t)("\u9879\u76ee");case E.PROJECT_CELL_NAME.ALL:return Object(n.t)("\u7814\u53d1\u7a7a\u95f4/\u9879\u76ee\u7ba1\u7406");default:return Object(n.t)("\u7814\u53d1\u7a7a\u95f4")}}():"ID/GID"===oe.name&&M?M:oe.name,"ID/GID"===s.name&&o.a.createElement(jt.a,null)),"ID/GID"!==s.name&&o.a.createElement("div",{className:Ot.a.sortIcon}),s.data.canSticky&&o.a.createElement("div",{className:Ot.a.stickyWrapper},o.a.createElement(C.TooltipTrigger,{title:N?Object(n.t)("\u53d6\u6d88\u56fa\u5b9a{{name}}",{name:s.name}):Object(n.t)("\u56fa\u5b9a{{name}}",{name:s.name})},o.a.createElement("div",{className:p()([Ot.a.stickyTrigger,N?Ot.a.active:""]),onClick:function(e){if(e.stopPropagation(),!j){var t=u()(s);t.data.isSticky=!s.data.isSticky,S(t,t.data.isSticky,d)}}})))),!m&&o.a.createElement("div",{className:Ot.a.toggleSize,onMouseDown:ie,onMouseOver:re,onMouseLeave:function(){return b(0)}},o.a.createElement("div",{className:Ot.a.divideLine}))))},Lt=function(){return(Lt=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Ft=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},_t=function(e){var t=e.allCollapse,a=e.tableViewType,n=e.headerPreference,i=e.stickyPostionArr,s=e.setResizeLineLeft,l=e.updateTableSetting,c=e.onSickyChange,u=e.tableRef,f=e.onSort,m=e.showTableSetting,h=e.onToggleAll,v=e.disableTableSetting,g=e.stickyIndex,E=e.onSelectAllData,b=e.selectedData,y=e.whetherSelectAll,S=e.headerCellProjectType,I=e.idKey,T=e.onToggleIdGid,C=e.renderFilter,P=e.className,w=e.filterKey,D=Ft(Object(r.useState)(0),2),O=D[0],R=D[1];return o.a.createElement("tr",{className:p()(Ot.a.header,P&&Ot.a[P])},n.map((function(e,r){var p,P,D;return o.a.createElement(At,Lt({key:e.type===d.a.custom?e.issueFieldId:e.type,allCollapse:t,treeTitleHeader:"TREE"===a&&e.type===d.a.title,isLastSticky:!(!(null===(p=null===e||void 0===e?void 0:e.data)||void 0===p?void 0:p.isSticky)||(null===(D=null===(P=n[r+1])||void 0===P?void 0:P.data)||void 0===D?void 0:D.isSticky)),isSticky:r<=g,isSelect:!(e.type!==d.a.custom||!e.data.isSelect),isTableSetting:e.type===d.a.custom&&e.data.accessor===d.c,isLast:r===n.length-1},{currentSort:O,setCurrentSort:R,index:r,stickyPostionArr:i,setResizeLineLeft:s,updateTableSetting:l,onSickyChange:c,tableRef:u,onSort:f,showTableSetting:m,selectedData:b,whetherSelectAll:y},{disableTableSetting:v,tableCellPreference:e,onToggleAll:h,onSelectAllData:E,headerCellProjectType:S,idKey:I,onToggleIdGid:T,renderFilter:C,filterKey:w}))})))},Mt=a("c7k8"),xt=a("iR1w"),Bt=a("JELi"),Ut=a.n(Bt),Wt=function(){return(Wt=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Yt=function(){return/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)},Ht=function(e){return e.replace(/\_(\w)/g,(function(e,t){return t.toUpperCase()}))},Vt=function(e,t){return e.map((function(e){var a={};return a=t&&((null===t||void 0===t?void 0:t.type)===d.a.custom&&e.type===d.a.custom?t.issueFieldId===e.issueFieldId:(null===t||void 0===t?void 0:t.type)===e.type)?{isSticky:t.data.isSticky,width:t.data.width===t.data.defaultWidth?void 0:t.data.width}:{isSticky:e.data.isSticky,width:e.data.width===e.data.defaultWidth?void 0:e.data.width},Wt(Wt({},e),{data:JSON.stringify(Object.keys(a).reduce((function(e,t){return a[t]&&(e[t]=a[t]),e}),{}))})}))},Gt=o.a.createContext({sheetData:[],activeColumns:[],stickyPostionArr:[],tableSize:{tableWidth:0,stickyWidth:0},disableTableSetting:!1,updateTableSetting:function(){},onSickyChange:function(){},stickyIndex:-1,selectedData:[],isAllCollapse:!1,toggleAllSubTaskCollapseIcon:function(){},tableViewType:"List",whetherSelectAll:!1,scrollTop:0,isScrolling:!1}),Kt=a("EUlY"),zt=a("jubm"),qt=a.n(zt),Zt=function(){return(Zt=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Jt=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(a[n[i]]=e[n[i]])}return a},Xt=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},Qt=function(e,t,a){if(a||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},$t=function(e){var t=e.mode,a=void 0===t?"SCRUM":t,i=e.projectPath,s=void 0===i?"":i,c=e.locationQuery,f=e.tableViewType,m=void 0===f?"LIST":f,h=e.list,v=e.tableSetting,g=e.scrollEnd,b=e.sortable,y=void 0!==b&&b,S=e.onSort,I=e.updateTableSettings,T=e.withTableSetting,C=void 0===T||T,P=e.needVirtualized,w=void 0!==P&&P,D=e.extraConfig,O=void 0===D?{}:D,R=e.onDataChange,j=e.showTableSetting,k=e.needSelect,N=e.issueScheme,A=e.disabled,L=void 0!==A&&A,F=e.disableTableSetting,_=void 0!==F&&F,M=e.onSelect,x=e.onSelectAll,B=e.selectedData,U=void 0===B?[]:B,W=e.detailPath,Y=e.whetherSelectAll,H=void 0!==Y&&Y,V=e.isLoading,G=e.activeHash,K=e.setActiveHash,z=e.browserRouter,q=e.showDetail,Z=e.permissionCheck,J=e.isPortal,X=e.onToggleSetData,Q=e.router,$=e.headerCellProjectType,ee=void 0===$?E.PROJECT_CELL_NAME.PROJECT:$,te=e.emptyShow,ae=e.idKey,ne=e.onToggleIdGid,ie=e.renderFilter,re=e.className,oe=e.headerClassName,se=e.rowClassName,le=e.filterKey,ce=e.openNewDetail,ue=Object(r.useRef)(null),de=Object(r.useRef)(null),fe=Object(r.useRef)(!1),pe=Xt(Object(r.useState)(0),2),me=pe[0],he=pe[1],ve=Xt(Object(r.useState)(0),2),ge=ve[0],Ee=ve[1],be=Xt(Object(r.useState)(!1),2),ye=be[0],Se=be[1],Ie=Xt(Object(r.useState)([]),2),Te=Ie[0],Ce=Ie[1],Pe=Xt(Object(r.useState)([]),2),we=Pe[0],De=Pe[1],Oe=Xt(Object(r.useState)(!1),2),Re=Oe[0],je=Oe[1],ke=Xt(Object(r.useState)(-1),2),Ne=ke[0],Ae=ke[1],Le=Xt(Object(r.useState)(!1),2),Fe=Le[0],_e=Le[1],Me=Xt(Object(r.useState)(0),2),xe=Me[0],Be=Me[1];Object(r.useEffect)((function(){X&&X(we)}),[we]);var Ue=Object(r.useMemo)((function(){var e,t=Object(Kt.organizeIssues)(h);return Object.keys(null!==(e=null===t||void 0===t?void 0:t.issues)&&void 0!==e?e:{}).map((function(e){t.issues[e].iteration=t.iterations[t.issues[e].iterationCode]})),t}),[m,h]),We=Object(r.useMemo)((function(){var e={issues:Ue.issues,childIssueCodes:Ue.childIssueCodes,collapseStatus:Te.reduce((function(e,t){return e[t]=!0,e}),{})};return"SCRUM"===a||(e.entryCodes=Ue.rootIssueCodes),e}),[m,h,a]);Object(r.useEffect)((function(){if(h&&(h.length>0||te))if("LIST"===m)De(h);else{var e=Object(Kt.getIssueNodeList)(We);De(e.map((function(e){return l()(e,Ue.issues[e.code])}))),je(Boolean(Te.length))}}),[m,h,te]);var Ye=function(e){return!e.some((function(e){return e.matchedSubTaskCount>0&&e.subTaskShow}))},He=function(e){var t=u()(Te);if("TREE"===m){if(Te.includes(e)){var a=t.findIndex((function(t){return t===e}));t.splice(a,1)}else t.push(e);var n=Object(Kt.getIssueNodeList)(Zt(Zt({},We),{collapseStatus:t.reduce((function(e,t){return e[t]=!0,e}),{})}));return Ce(t),De(n.map((function(e){return l()(e,Ue.issues[e.code])}))),void je(n.length===Ue.rootIssueCodes.length)}var i=u()(we),r=i.find((function(t){return t.code===e})),o=i.findIndex((function(t){return t.code===e}));if(r.subTaskShow){i[o].subTaskShow=!1;n=i.splice(o+1,r.matchedSubTaskCount);t=t.concat(n.map((function(e){return Number(e.code)}))),Ce(t),De(i),je(Ye(i))}else{i[o].subTaskShow=!0;var s=r.subTasks.map((function(e){return e.code}));t=t.filter((function(e){return!s.includes(e)})),Ce(t),i.splice.apply(i,Qt([o+1,0],Xt(r.subTasks),!1)),De(i),je(Ye(i))}},Ve=Object(r.useMemo)((function(){Se(!1);var e=v.fields.map((function(e){return function(e){var t,a,n,i,r=e.setting,o=e.settingData,s=e.issueScheme,l=e.extraConfig,c=e.sortable,u=void 0!==c&&c,f={};return r.type===d.a.custom&&s&&(null===(t=r.issueFieldIds)||void 0===t||t.map((function(e){return s&&s[e]?f[e]=s[e].issueField.options:""}))),Wt(Wt({},r),{data:Wt(Wt(Wt({accessor:r.type===d.a.custom?"customFields.".concat(r.issueFieldId):Ht(r.type.toLocaleLowerCase()),width:E.DEFAULT_WIDTH[r.type.toLocaleUpperCase()]||100,defaultWidth:E.DEFAULT_WIDTH[r.type.toLocaleUpperCase()]||100,minWidth:E.MIN_WIDTH[r.type.toLocaleUpperCase()]||80,canSticky:E.STICKY_TYPE.some((function(e){return e===r.type})),sort:u&&!E.EXCLUDE_SORTABLE_TYPE.some((function(e){return e===r.type.toLocaleUpperCase()}))},r.type===d.a.custom&&s?{componentType:r.issueFields,options:f,width:E.DEFAULT_WIDTH[null===(a=s[r.issueFieldId])||void 0===a?void 0:a.issueField.componentType]||100,defaultWidth:E.DEFAULT_WIDTH[null===(n=s[r.issueFieldId])||void 0===n?void 0:n.issueField.componentType]||100,minWidth:E.MIN_WIDTH[null===(i=s[r.issueFieldId])||void 0===i?void 0:i.issueField.componentType]||80}:{}),o),l[r.type===d.a.custom?"customFields.".concat(r.issueFieldId):Ht(r.type.toLocaleLowerCase())])})}({setting:e,settingData:e.data?JSON.parse(e.data):{},issueScheme:N,extraConfig:O,sortable:y})})),t=["OA_STATUS","PROPOSER","OA_CURRENT_APPROVER"];return Q.location.pathname.indexOf("production-problem")>-1?e.filter((function(e){return!t.includes(e.type)})):e}),[v,N]),Ge=Object(r.useMemo)((function(){var e=Ve.filter((function(e){return e.visible}));return k&&e.unshift({type:d.a.custom,issueFieldId:-1,name:Object(n.t)("\u9009\u62e9"),visible:!0,sort:0,data:{width:28,isSticky:!0,isSelect:!0,accessor:d.b}}),Ae(Ut()(e,(function(e){return!!e.data.isSticky}))),C&&e.push({type:d.a.custom,issueFieldId:0,name:Object(n.t)("\u8868\u683c\u8bbe\u7f6e"),visible:!0,sort:0,data:{isSetting:!0,width:40,isSticky:!0,accessor:d.c}}),e}),[Ve,k]),Ke=function(e,t){var a=e.filter((function(e){return e.id===t.id&&e.name===t.name}));return a.length>0?a[0]:null},ze=Object(r.useMemo)((function(){return function(e,t){return e.reduce((function(e,a,n){return e.tableWidth+=a.data.width||0,n<=t&&(e.stickyWidth+=a.data.width||0),e}),{tableWidth:2*E.DEFAULT_TR_PADDING,stickyWidth:E.DEFAULT_TR_PADDING})}(Ge,Ne)}),[Ge,Ne]),qe=Object(r.useMemo)((function(){return(e=Ge).reduce((function(t,a,n){var i,r;return t.push(n>0?((null===(r=null===(i=e[n-1])||void 0===i?void 0:i.data)||void 0===r?void 0:r.width)||0)+t[n-1]:0),t}),[]);var e}),[Ge]),Ze=Object(r.useCallback)((function(e){return o.a.createElement(Gt.Consumer,null,(function(t){return o.a.createElement(e,Zt({},t))}))}),[]),Je=Object(r.useCallback)((function(e){if(ue.current){var t=!ye&&0!==e;Se(t),t&&Ee(Math.max(E.DEFAULT_TR_PADDING,Math.min(e-(ue.current.getBoundingClientRect().left||0),Math.max(ze.tableWidth,ue.current.getBoundingClientRect().width))))}}),[ye]),Xe=function(e){M&&M(e)},Qe=function(e){x&&x(e)},$e=Object(r.useMemo)((function(){return Object(r.forwardRef)((function(e,t){var a=e.children,n=e.onScroll,i=Jt(e,["children","onScroll"]);return o.a.createElement("table",Zt({ref:t},i,{onScroll:function(e){n(e),function(){var e;ue.current&&he(null===(e=ue.current)||void 0===e?void 0:e.scrollLeft)}()}}),o.a.createElement(Gt.Consumer,null,(function(e){var t=e.tableSize,a=e.activeColumns,n=e.stickyPostionArr,i=e.disableTableSetting,r=e.updateTableSetting,s=e.onSickyChange,l=e.stickyIndex,c=e.selectedData,u=e.isAllCollapse,d=e.toggleAllSubTaskCollapseIcon,f=e.whetherSelectAll,p=e.tableViewType,m=e.scrollTop,h=e.isScrolling,v=e.headerCellProjectType;return o.a.createElement("thead",{style:Zt({minWidth:"".concat(t.tableWidth,"px")},Yt()?{position:h?"sticky":"initial"}:{})},o.a.createElement("tr",{style:Yt()?h?{}:{position:"absolute",top:m}:{}},o.a.createElement(_t,{headerCellProjectType:v,whetherSelectAll:f,allCollapse:u,selectedData:c,stickyIndex:l,tableViewType:p,disableTableSetting:i,tableRef:ue,onSickyChange:s,setResizeLineLeft:Je,headerPreference:a,stickyPostionArr:n,onSort:S,updateTableSetting:r,showTableSetting:j,onToggleAll:d,onSelectAllData:Qe,idKey:ae,onToggleIdGid:ne,renderFilter:ie,className:oe,filterKey:le})))})),a)}))}),[ae]),et=Object(r.useMemo)((function(){return Object(r.forwardRef)((function(e,t){var a=e.children,n=e.style,i=Jt(e,["children","style"]);return o.a.createElement(Gt.Consumer,null,(function(e){var r=e.tableSize;return o.a.createElement("tbody",Zt({ref:t},i,{style:Zt(Zt({},n),{minWidth:"".concat(r.tableWidth,"px")})}),a)}))}))}),[]),tt=Object(r.useCallback)((function(e){var t,n,i=e.data,r=e.index,s=e.style,l=i.itemData,c=i.activeColumns,u=i.tableSetting,d=i.stickyPostionArr,f=i.disabled,p=i.stickyIndex,m=i.selectedData,h=i.toggle,v=i.toggledArr,g=i.projectPath,E=i.locationQuery,b=i.isPortal,y=i.tableViewType,S=i.organizedIssues,I=i.tableScrollLeft,T=i.activeHash,C=i.browserRouter,P=i.detailPath,w=i.tbodyRef,D=i.withTableSetting;return o.a.createElement(St,{permissionCheck:Z,setActiveHash:K,activeHash:T,detailPath:P,onSelectData:Xe,stickyIndex:p,mode:a,disabled:f,openNewDetail:ce,projectPath:g,locationQuery:E,organizedIssues:S,collapsedIssueCodes:v,tableViewType:y,index:r,style:s,key:"".concat(null===(n=null===(t=l[r])||void 0===t?void 0:t.project)||void 0===n?void 0:n.id).concat(l[r].id||l[r].code),data:l[r],displayType:u.displayType,rowPreference:c,stickyPostionArr:d,onDataChange:R,withTableContext:Ze,onToggle:h,selectedData:m,showDetail:q,tableScrollLeft:I,browserRouter:C,isPortal:b,portalProps:{portalWrapStyle:{zIndex:2e3},isScroll:fe.current,resetIsScroll:function(){fe.current=!1}},tbodyRef:w,idKey:ae,className:se,withTableSetting:D})}),[ae]),at=wt()((function(){g&&g()}),500),nt=Xt(Object(r.useState)(),2),it=nt[0],rt=nt[1],ot=Object(r.useCallback)((function(e){return function(t){"forward"===t.scrollDirection&&de.current&&(t.scrollOffset+e)/de.current.getBoundingClientRect().height>.9&&at(),Yt()&&t.scrollOffset!==xe&&(_e(!0),it&&window.clearTimeout(it),rt(setTimeout((function(){_e(!1)}),150)),Be(t.scrollOffset))}}),[xe,it]);return o.a.createElement(Gt.Provider,{value:{sheetData:we,activeColumns:Ge,tableSize:ze,stickyPostionArr:qe,disableTableSetting:_,updateTableSetting:function(e,t){if(Se(!1),I){var a=Vt(Ve,e);I(a,e,t,Ke(a,e))}},onSickyChange:function(e,t){if(I){var a=Vt(Ve,e);I(a,e,{isSticky:t},Ke(a,e))}},stickyIndex:Ne,selectedData:U,isAllCollapse:Re,toggleAllSubTaskCollapseIcon:function(){if("TREE"===m){var e=[];Re||(e=Object.keys(Ue.issues).map((function(e){return Ue.issues[e].code})));var t=Object(Kt.getIssueNodeList)(Zt(Zt({},We),{collapseStatus:e.reduce((function(e,t){return e[t]=!0,e}),{})}));return je(!Re),Ce(e),void De(t.map((function(e){return l()(e,Ue.issues[e.code])})))}var a=u()(we),n=[];if(Ye(we))De(a.reduce((function(e,t){var a=t.subTasks||[];return t.matchedSubTaskCount=a.length,t.matchedSubTaskCount&&(t.subTaskShow=!0),Qt(Qt(Qt([],Xt(e),!1),[t],!1),Xt(a),!1)}),[]));else{var i=a.filter((function(e){return"SUB_TASK"===e.type&&n.push(e.code),"SUB_TASK"!==e.type})).map((function(e){return e.matchedSubTaskCount&&(e.subTaskShow=!1),e}));De(i)}Ce(n),je(!Ye(we))},whetherSelectAll:H,tableViewType:m,scrollTop:xe,isScrolling:Fe,headerCellProjectType:ee}},o.a.createElement("div",{className:p()(qt.a.tableWrapper,re&&qt.a[re])},o.a.createElement(Mt.AutoSizer,null,(function(e){var t=e.height,a=e.width,n=(v.displayType===d.d.loose?E.TR_HEIGHT.LOOSE:E.TR_HEIGHT.TIGHT)*we.length;return o.a.createElement(o.a.Fragment,null,ze.stickyWidth>E.DEFAULT_TR_PADDING&&me>0&&o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:qt.a.stickyBoxShadow,style:{width:ze.stickyWidth-1}},t>n?o.a.createElement("div",{className:qt.a.stickyBoxBackground,style:{marginTop:40+n,height:t-n-40-10}}):null)),V&&o.a.createElement("table",{className:qt.a.loading},new Array(Math.round(t/(v.displayType===d.d.loose?E.TR_HEIGHT.LOOSE:E.TR_HEIGHT.TIGHT))).fill(1).map((function(e,t){return function(e){return o.a.createElement(Ct,{rowIndex:e,key:e,rowPreference:Ge,displayType:v.displayType})}(t)}))),o.a.createElement(xt.FixedSizeList,Zt({},w||we.length>30?{overscanCount:20}:{overscanCount:we.length},{outerRef:ue,outerElementType:$e,innerRef:de,innerElementType:et,width:a,height:t,itemData:{itemData:we,activeColumns:Ge,stickyPostionArr:qe,tableSize:ze,tableSetting:v,disabled:L,stickyIndex:Ne,onSelectData:Xe,selectedData:U,toggledArr:Te,toggle:He,projectPath:s,locationQuery:c,tableViewType:m,organizedIssues:Ue,tableScrollLeft:me,activeHash:G,isScrollRef:fe,browserRouter:z,isPortal:J,detailPath:W,tbodyRef:de},itemCount:we.length,itemSize:v.displayType===d.d.loose?E.TR_HEIGHT.LOOSE:E.TR_HEIGHT.TIGHT,onScroll:ot(t)}),tt))})),ye&&o.a.createElement("div",{className:qt.a.resizeColumn,style:{left:ge-2}})))};$t.defaultProps={tableViewType:"LIST"};var ea=Object(r.memo)(Object(i.withRouter)($t));t.default=ea},"6ri6":function(e,t,a){e.exports={"attachments-item":"attachments-item-1ejutUZFL2",attachmentsItem:"attachments-item-1ejutUZFL2","is-image":"is-image-2K6sgdjYQJ",isImage:"is-image-2K6sgdjYQJ","is-disabled":"is-disabled-Zea0TCCeQo",isDisabled:"is-disabled-Zea0TCCeQo","attachments-item-cover":"attachments-item-cover-1pOOL2x6gc",attachmentsItemCover:"attachments-item-cover-1pOOL2x6gc","attachments-item-img":"attachments-item-img-3XUDt-8RBF",attachmentsItemImg:"attachments-item-img-3XUDt-8RBF","attachments-item-progress":"attachments-item-progress-207BTk6aEF",attachmentsItemProgress:"attachments-item-progress-207BTk6aEF","attachments-item-wrapper":"attachments-item-wrapper-3W8snySeRJ",attachmentsItemWrapper:"attachments-item-wrapper-3W8snySeRJ","attachments-item-title":"attachments-item-title-1A7CPhKa6O",attachmentsItemTitle:"attachments-item-title-1A7CPhKa6O","attachments-item-bar":"attachments-item-bar-1rggzm0rPk",attachmentsItemBar:"attachments-item-bar-1rggzm0rPk","attachments-item-logo":"attachments-item-logo-3xyoTzX_JE",attachmentsItemLogo:"attachments-item-logo-3xyoTzX_JE","attachments-modao-logo":"attachments-modao-logo-3F8vUHcxF7",attachmentsModaoLogo:"attachments-modao-logo-3F8vUHcxF7","attachments-codesign-logo":"attachments-codesign-logo-29eoqAJVxX",attachmentsCodesignLogo:"attachments-codesign-logo-29eoqAJVxX","attachments-tencent-meeting-logo":"attachments-tencent-meeting-logo-17d6kapySm",attachmentsTencentMeetingLogo:"attachments-tencent-meeting-logo-17d6kapySm","attachments-item-size":"attachments-item-size-2HWd4zAdEG",attachmentsItemSize:"attachments-item-size-2HWd4zAdEG","attachments-item-action":"attachments-item-action-691xpMSLpA",attachmentsItemAction:"attachments-item-action-691xpMSLpA",cancel:"cancel-2CuzyjUtIp",del:"del-1DtKtpoLtA"}},"6yKH":function(e,t,a){"use strict";a.r(t);var n=a("cDcd"),i=a.n(n),r=a("uelK"),o=a.n(r),s=a("dBa0"),l=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(a[n[i]]=e[n[i]])}return a},c=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o};t.default=function(e){var t,a=e.context,u=Object(r.useSlot)({identity:s.SLOTS.COLLABORATION_DETAIL_ATTRIBUTE_BUTTON_ONE}).config,d=c(Object(n.useMemo)((function(){var e=a||{};return[e.projectId,l(e,["projectId"])]}),[null===a||void 0===a?void 0:a.projectId]),2),f=d[0],p=d[1];return u?i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{style:{borderTop:"1px solid rgba(0, 0, 0, 0.04)",marginTop:"16px 8px 0 8px"}}),i.a.createElement(o.a,{identity:null===(t=u.slot)||void 0===t?void 0:t.identity,buttonProps:{style:{marginTop:"16px"}},context:p,project:{id:f}})):null}},"79W0":function(e,t,a){"use strict";a("RW0V"),a("ioFf"),a("0l/t"),a("mYba"),a("jm62");var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.SUB_TASK=t.BASE_ISSUE_TYPES=t.LOG_TYPE=t.SUBITEM_ACTIONS=t.FIELD_TYPE=t.ACTION=void 0;var i=n(a("lSNA")),r=a("nuIr");function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){(0,i.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}t.ACTION={UPDATE_SUBTASK_SCHEME:"SUBTASKS.GET.SUBTASK_SCHEME",UPDATE_HIDDEN_FILE_DIRS:"SUBTASKS.GET.HIDDEN_FILE_DIRS",UPDATE_SUBTASK_STATUS:"SUBTASKS.GET.SUBTASK_STATUS"};var l=s({},r.BASE_FIELD_TYPE);t.FIELD_TYPE=l;t.SUBITEM_ACTIONS={REMOVEASSOCIATE:"REMOVEASSOCIATE",DELETE:"DELETE",UPGRADE:"UPGRADE"};var c=s({},r.LOG_TYPE);t.LOG_TYPE=c;var u=s({},r.ISSUE_TYPE);t.BASE_ISSUE_TYPES=u;t.SUB_TASK="SUB_TASK"},"8By3":function(e,t,a){"use strict";var n=a("cDcd"),i=a.n(n),r=a("iTKN"),o=a("K2gz"),s=a.n(o),l=a("IuC+"),c=a.n(l);t.a=Object(n.memo)((function(e){var t=e.value,a=e.item,n=e.isMultiple,o=e.onSelect,l=e.focused,u=function(){return n?Array.isArray(a.id)?t.some((function(e){return a.id.some((function(t){return t===e}))})):t.some((function(e){return e===a.id})):a.id===t};return i.a.createElement("div",{className:s()(c.a.item,u()&&c.a.checked,l&&c.a.focus,a.disabled&&c.a.disable),title:a.text,onClick:function(){a.disabled||o(a)}},i.a.createElement("div",{className:s()(c.a.content,a.id===r.UNSPECIFIC&&c.a.unspecific,a.disabled&&c.a.disable)},a.text),u()&&i.a.createElement("span",{className:s()(c.a.checked)}))}))},"8ZF6":function(e,t,a){"use strict";var n=a("mVeg"),i=a("cDcd"),r=a.n(i),o=a("7FZc"),s=a("7tbW"),l=a.n(s),c=a("K2gz"),u=a.n(c),d=a("vih4"),f=a.n(d);t.a=Object(i.memo)((function(e){var t=e.value,a=e.constValue,i=e.items,s=e.initialSelectedItem,c=e.active,d=e.disabled,p=e.label,m=e.removable,h=e.onRemove,v=e.valueChanged,g=e.noMatched,E=Object(n.t)("\u90e8\u5206\u7814\u53d1\u7a7a\u95f4/\u9879\u76ee\u7ba1\u7406\u4e0d\u5b58\u5728\u6216\u65e0\u6743\u9650\uff0c\u76f8\u5173\u4e8b\u9879\u4e0d\u4f1a\u663e\u793a\u5728\u641c\u7d22\u7ed3\u679c\u4e2d"),b=function(){if(g)return Object(n.t)("\u672a\u5339\u914d");var e=l()(null===t||void 0===t?void 0:t.map((function(e){var t;return null===(t=(s||i).find((function(t){return Array.isArray(t.id)?t.id.some((function(t){return t===e})):t.id===e})))||void 0===t?void 0:t.text})))||[];return(null===a||void 0===a?void 0:a.length)>0&&(e=["\u672a\u6307\u5b9a"].concat(e)),e.join(",")||Object(n.t)("\u5168\u90e8")};return r.a.createElement("div",{className:"newfilter-trigger trigger-w100 ".concat(u()(f.a.trigger,f.a.filterTrigger,c&&f.a.active,d&&f.a.disabled)),title:b()},p&&r.a.createElement("div",{className:"newfilter-hidden ".concat(u()(f.a.label))},p),r.a.createElement("div",{className:u()(f.a.content)},b()),r.a.createElement("span",{className:u()(f.a.caret)}),m&&r.a.createElement("span",{className:u()(f.a.removeButton,c&&f.a.show),onClick:h}),!!v&&r.a.createElement(o.TooltipTrigger,{title:E},r.a.createElement("div",{className:f.a.configError})))}))},"8lvN":function(e,t,a){"use strict";a("I5cv"),a("ioFf"),a("mYba"),a("jm62"),a("EK0E");var n=a("TqRt"),i=a("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(a("o0o1"));a("dRSK"),a("Z2Ku"),a("f3/d"),a("Btvt"),a("VRzm"),a("bWfx"),a("0l/t"),a("hhXQ"),a("CX2u"),a("XfO3"),a("yt8O"),a("rGqo"),a("INYr"),a("RW0V");var o,s,l,c=n(a("RIqP")),u=n(a("lSNA")),d=n(a("yXPU")),f=n(a("lwsE")),p=n(a("W8MJ")),m=n(a("PJYZ")),h=n(a("7W2i")),v=n(a("a1gu")),g=n(a("Nsbk")),E=a("mVeg"),b=pe(a("cDcd")),y=n(a("17x9")),S=n(a("V/h/")),I=n(a("Zsd2")),T=n(a("E+oP")),C=n(a("Y+p1")),P=n(a("zqxM")),w=a("qS/1"),D=a("7bn+"),O=a("nuIr"),R=a("DgMC"),j=a("DgMC"),k=a("xgZS"),N=a("Z4vw"),A=a("DKcV"),L=a("V+QM"),F=a("w3Wo"),_=a("aHEs"),M=a("82Y3"),x=a("h74D"),B=n(a("mSbZ")),U=n(a("uk0h")),W=n(a("htee")),Y=n(a("4Fdf")),H=n(a("sftu")),V=n(a("KUqB")),G=n(a("aWB4")),K=n(a("Th6D")),z=pe(a("NI22")),q=n(a("SLo4")),Z=n(a("z0hg")),J=n(a("SUhN")),X=n(a("QPj7")),Q=a("885C"),$=n(a("T8xO")),ee=n(a("L8Eh")),te=n(a("ai0/")),ae=n(a("OTim")),ne=n(a("XLbL")),ie=(n(a("M/Qn")),a("LC46")),re=n(a("K2gz")),oe=n(a("1hCk")),se=n(a("246l")),le=a("NI22"),ce=a("YstK"),ue=a("LvDl"),de=n(a("q18W"));function fe(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(fe=function(e){return e?a:t})(e)}function pe(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!==typeof e)return{default:e};var a=fe(t);if(a&&a.has(e))return a.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=r?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}return n.default=e,a&&a.set(e,n),n}function me(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function he(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?me(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):me(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function ve(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,g.default)(e);if(t){var i=(0,g.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,v.default)(this,a)}}var ge=(0,x.connect)((function(e){var t,a=e.APP,n=a.enterprise,i=a.user,r=e.CURRENT_USER_ENTERPRISE_PERMISSION_NAMESPACE_FOR_REDUX_STORE;return{user:i,enterpriseGlobalKey:n.key,ramOnline:null===r||void 0===r||null===(t=r.ramStatus)||void 0===t?void 0:t.ramOnline}}))(o=(0,B.default)(o=(0,U.default)(o=(0,W.default)(o=(0,Y.default)((l=s=function(e){(0,h.default)(a,e);var t=ve(a);function a(e){var n,i,o,s,l;(0,f.default)(this,a),(l=t.call(this,e)).validateDefect=function(e,t){var a,n=l.state.attributes,i=null===(a=l.props.assignmentSchemeFieldArchives[e])||void 0===a?void 0:a.issueField,r=["\u81f4\u547d","\u4e25\u91cd"],o=!!i&&i.options.find((function(e){return e.value===t&&r.includes(e.name)}));return!(!i||"\u7f3a\u9677\u4e25\u91cd\u7a0b\u5ea6"!==i.name||!o||n.defectKindIds.length&&n.defectPhaseId)&&((0,k.warning)((0,E.t)("\u8bf7\u5148\u586b\u5199\u201c\u5f15\u5165\u7f3a\u9677\u9636\u6bb5\u201d\u548c\u201c\u7f3a\u9677\u7c7b\u578b\u201d")),!0)},l.checkDescriptionPageId=(0,d.default)(r.default.mark((function e(){var t,a,n,i,o;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,z.isBlockType)(l.state.editorType)){e.next=2;break}return e.abrupt("return");case 2:return t=l.props,a=t.defectCode,n=t.currentProject,e.next=5,(0,F.checkDescriptionPageId)(n.id,a);case 5:i=e.sent,o=i.data,l.initCreatePage(o.pageId),l.setState({showDescriptionPlaceholder:!1});case 9:case"end":return e.stop()}}),e)}))),l.initCreatePage=function(){var e=(0,d.default)(r.default.mark((function e(t){var a,n,i,o,s,c,u,d,f,p,m,h;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=l.props,n=a.currentProject,i=a.issueTypeDetail,o=a.currentProjectCooperateSettings,s=l.state,c=s.name,u=s.editorType,(0,z.isBlockType)(u)){e.next=4;break}return e.abrupt("return",Promise.resolve());case 4:if(d=o.ISSUE_TYPES.find((function(e){return"MISSION"===e.issueType})),t){e.next=12;break}return e.next=8,(0,_.fetchMarkdownTemplate)(n.name,i.id||d.id);case 8:return f=e.sent,p=f.data,l.setState({initEditorData:{pageId:p.pageId,pageDraftId:p.draftId,historyId:p.historyId},editorAutoFocus:!!c,showDescriptionPlaceholder:!1}),e.abrupt("return",Promise.resolve());case 12:return m=l.props.currentProject.id,(h={module:ce.PROPERTY_ISSUES_COPY_CONSTANTS_ENUM.COLLABORATION,function:ce.PROPERTY_ISSUES_COPY_CONSTANTS_ENUM.DESCRIPTION,scopeType:ce.PROPERTY_ISSUES_COPY_CONSTANTS_ENUM.PROJECT,scopeId:m,projectId:m}).pageId=t,e.abrupt("return",(0,le.createPageDraft)(h).then((function(e){var t=e.data;l.setState({initEditorData:{pageId:t.pageId,pageDraftId:t.pageDraftId,historyId:t.historyId}})})));case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),l.copyCreatePage=function(){var e=(0,d.default)(r.default.mark((function e(t){var a,n,i,o;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=l.props.currentProject,n=l.state.editorType,(0,z.isBlockType)(n)){e.next=4;break}return e.abrupt("return",Promise.resolve());case 4:return e.next=6,(0,F.copyMarkdownTemplate)(a.id,t);case 6:return i=e.sent,o=i.data,l.setState({initEditorData:{pageId:o.pageId,pageDraftId:o.draftId,historyId:o.historyId}}),e.abrupt("return",Promise.resolve());case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),l.onEpicChange=function(e){l.setState({localEpicCode:e})},l.handleAttentionChange=function(e){l.changeAttributes({type:"watchers",value:e})},l.onDescriptionChange=function(e){if(!e.isEmpty){var t="".concat(l.props.currentProject.name,"_").concat(l.props.issueTypeDetail.issueType,"_").concat(l.props.issueTypeDetail.id,"_CREATOR");(0,z.setIssueDescriptionDraft)(t,l.state.initEditorData)}},l.onDescriptionScroll=function(){l.getAttachmentsStickyState()},l.onUpdateStateAndStorage=function(e,t){l.setState({autoNext:e,autoCopyNext:t},(function(){localStorage.setItem("ASSIGNMENT_CREATION_AUTO_NEXT",e),localStorage.setItem("ASSIGNMENT_CREATION_AUTO_COPY_NEXT",t)}))},l.onEditorTypeChange=function(e){if((0,M.setPreferEditorType)(e),l.setState({editorType:e}),(0,z.isBlockType)(e))l.initCreatePage();else{var t="".concat(l.props.currentProject.name,"_").concat(l.props.issueTypeDetail.issueType,"_").concat(l.props.issueTypeDetail.id,"_CREATOR");(0,z.setIssueDescriptionDraft)(t);var a={pageId:l.state.initEditorData.pageId,pageDraftId:l.state.initEditorData.pageDraftId,module:"collaboration",function:"description",scopeType:"project",scopeId:l.props.currentProject.id};(0,z.delPageDraft)(a).then((function(){return l.setState({initEditorData:null})}))}},l.onCancel=function(){l.props.closeHandle()},l.removeDraft=function(){var e,t;null!==(e=l.editorRef)&&void 0!==e&&null!==(t=e.current)&&void 0!==t&&t.removeDraft&&l.editorRef.current.removeDraft()},l.onAttrScroll=function(){l.setState({isElemScroll:!0})},l.fetchParentRequirements=function(e){var t=l.props.currentProject;(0,F.fetchParentWithoutCode)(t.name,{keyword:e}).then((function(e){l.setState({availableRequirements:e.data})}))},l.quickSave=function(e){l.state.isMac?e.metaKey&&"Enter"===e.key&&l.onSubmit():e.ctrlKey&&"Enter"===e.key&&l.onSubmit()},l.startEditing=function(e){l.state.isMac?e.metaKey||"Enter"!==e.key||l.setState({showDescriptionPlaceholder:!1}):e.ctrlKey||"Enter"!==e.key||l.setState({showDescriptionPlaceholder:!1})},l.showEpicDropdown=function(){var e=l.props,t=e.currentProjectCooperateSettings,a=e.epicCode;return t&&t.EPIC===O.MODULE_SWITCH.OPENED&&"SCRUM"===t.COOPERATE_MODE&&!a},l.getHeights=function(){var e=Math.max(320,Math.min(680,document.body.clientHeight-120-300)),t=Math.max(320,Math.min(460,document.body.clientHeight-120-300));l.setState({maxMainBodyHeight:e,editorMinHeight:t},l.getAttachmentsStickyState)},l.getAttachmentsStickyState=function(){var e,t=null===(e=l.bodyRef)||void 0===e?void 0:e.current;l.setState({attachmentsSticky:t&&t.scrollTop+t.offsetHeight<t.scrollHeight&&t.scrollHeight>t.clientHeight})},l.titleInputFocus=function(){var e,t;null===(e=l.inputRef)||void 0===e||null===(t=e.current)||void 0===t||t.focus()},l.combineThirdLinks=function(){var e=l.state,t=e.attachments,a=e.thirdLinks;if(a){var n=a.map((function(e){if(e.name)return e;var t=e.isModao,a=e.isCodesign,n="";return t&&(n=e.modao.title||(0,E.t)("\u58a8\u5200\u9644\u4ef6")),a&&(n=e.codesign.title),he(he({},e),{},{noUpload:!0,isModao:t,isCodesign:a,name:n,createdAt:e.timestamp})})),i=[].concat((0,c.default)(t),(0,c.default)(n));l.setState({allAttachments:l.sortAttachments(i)})}else l.setState({allAttachments:l.sortAttachments(t)})},l.sortAttachments=function(e){var t=(0,c.default)(e);return t.sort((function(e,t){return e.timestamp-t.timestamp})),t},l.onAddThirdLink=function(e){l.hideImportOutResourcePicker(),l.setState({thirdLinks:[].concat((0,c.default)(l.state.thirdLinks),(0,c.default)(e))},l.combineThirdLinks)},l.showImportOutResourcePicker=function(){l.setState({isShowImportOutResourcePicker:!0})},l.hideImportOutResourcePicker=function(){l.setState({isShowImportOutResourcePicker:!1})};var u=e.detailInfoState,p=e.assignee,h=e.name,v=e.hasOwnProperty.call("detailInfoState");return l.state={name:v?u.name:h,autoNext:"true"===localStorage.getItem("ASSIGNMENT_CREATION_AUTO_NEXT"),autoCopyNext:"true"===localStorage.getItem("ASSIGNMENT_CREATION_AUTO_COPY_NEXT"),isPending:!1,isLoading:!0,attributes:{assignee:v?null===p||void 0===p?void 0:p.id:void 0,priority:void 0,startDate:void 0,dueDate:void 0,workingHours:void 0,requirementType:void 0,projectModule:void 0,labels:[],watchers:[],progress:void 0,fields:{},programId:(null===e||void 0===e||null===(n=e.dmData)||void 0===n?void 0:n.programPropId)||void 0,wuKongReloadId:void 0,defectSourceId:void 0,systemsId:(null===e||void 0===e||null===(i=e.dmData)||void 0===i?void 0:i.systemsPropId)||void 0,defectKindIds:[],defectPhaseId:void 0,estimatedWorkHour:void 0,participants:[]},releaseList:e.releaseInfo?[e.releaseInfo]:[],releaseIds:e.releaseInfo?[e.releaseInfo.id]:[],isReloading:!1,iterationCode:e.iteration?"COMPLETED"===e.iteration.status&&e.parent&&e.parent.code?0:null===e||void 0===e||null===(o=e.iteration)||void 0===o?void 0:o.code:null===u||void 0===u||null===(s=u.iteration)||void 0===s?void 0:s.code,epicCode:e.epicCode,iterationList:[],localEpicCode:void 0,storyPoint:void 0,isElemScroll:!1,parentRequirement:e.parent,availableRequirements:[],isMac:(0,R.isMac)(),initEditorData:null,showDescriptionPlaceholder:!0,editorAutoFocus:!0,attachmentsSticky:!1,maxMainBodyHeight:0,editorMinHeight:0,editorType:(0,M.getPreferEditorType)(),fullscreen:!1,allAttachments:[],attachments:[],isShowImportOutResourcePicker:!1,thirdLinks:[],showButton:!1,toLeft:0,editionId:void 0},l.inputRef=b.default.createRef(),l.bodyRef=b.default.createRef(),l.editorRef=b.default.createRef(),l.sideRef=b.default.createRef(),l.setDefaultValues=l.setDefaultValues.bind((0,m.default)(l)),l.onTitleChange=l.onTitleChange.bind((0,m.default)(l)),l.onSubmit=l.onSubmit.bind((0,m.default)(l)),l.resetFormData=l.resetFormData.bind((0,m.default)(l)),l.resetPartialFormData=l.resetPartialFormData.bind((0,m.default)(l)),l.onAutoFlagChange=l.onAutoFlagChange.bind((0,m.default)(l)),l.onAutoCopyFlagChange=l.onAutoCopyFlagChange.bind((0,m.default)(l)),l.onUpdateStateAndStorage=l.onUpdateStateAndStorage.bind((0,m.default)(l)),l.onIterationChange=l.onIterationChange.bind((0,m.default)(l)),l.changeAttributes=l.changeAttributes.bind((0,m.default)(l)),l.wrapperRef=b.default.createRef(),l.listRef=b.default.createRef(),l.moveContent=l.moveContent.bind((0,m.default)(l)),l.handleDeleteAttachment=l.handleDeleteAttachment.bind((0,m.default)(l)),l.onFileDropSuccess=l.onFileDropSuccess.bind((0,m.default)(l)),l.onFileDropFail=l.onFileDropFail.bind((0,m.default)(l)),l.onFileDropDelete=l.onFileDropDelete.bind((0,m.default)(l)),l.onFileDropCancel=l.onFileDropCancel.bind((0,m.default)(l)),l.fileUpload=l.fileUpload.bind((0,m.default)(l)),l}return(0,p.default)(a,[{key:"renderAttachmentSection",value:function(){var e=this,t=this.state,a=t.attachments,n=t.allAttachments,i=t.isShowImportOutResourcePicker,r=t.showButton,o=t.toLeft,s=this.props,l=s.enterpriseGlobalKey,c=s.currentProject,u=s.user,d=c.name,f=c.id;return b.default.createElement("div",{className:oe.default.attachementSectionContainer},b.default.createElement("div",{className:oe.default.sectionHeader},b.default.createElement("span",{className:oe.default.title},(0,E.t)("\u9644\u4ef6")),b.default.createElement("span",{className:oe.default.dividerLine}),b.default.createElement(q.default,{onHandleAttachments:this.fileUpload,currentAttachmentNum:a.length,attachmentLimit:n.length>=20},b.default.createElement("a",{className:oe.default.uploadButton},(0,E.t)("\u672c\u5730\u4e0a\u4f20"))),b.default.createElement("div",{className:oe.default.importOutResourceWrap},b.default.createElement(J.default,{onHandleAttachments:this.onAddThirdLink,isShowPicker:i,onShow:this.showImportOutResourcePicker,onHide:this.hideImportOutResourcePicker,attachmentLimit:n.length>=20}))),b.default.createElement("div",{className:oe.default.attachmentSection},n.length?b.default.createElement("div",{className:(0,re.default)(oe.default.attachmentWrapper,r&&oe.default.rightBorder,o<0&&oe.default.leftBorder),ref:this.wrapperRef},b.default.createElement("div",{className:oe.default.attachmentList,ref:this.listRef,style:{left:"".concat(o,"px")}},!!n.length&&b.default.createElement(Q.ThemeConsumer,null,(function(t){var a=t.hiddenFolderDirs;return n.map((function(t){return b.default.createElement("div",{className:oe.default.attachmentItem,key:t.fileId},b.default.createElement(Z.default,{attachment:t,enterpriseGlobalKey:l,currentProjectName:d,currentProjectId:f,dir:a[O.HIDDEN_FILE_TYPE.ASSIGEMENTS].file_id,uploadFileSuccess:e.onFileDropSuccess,uploadFileFailed:e.onFileDropFail,uploadFileDelete:e.onFileDropDelete,uploadFileCancel:e.onFileDropCancel,allowPreview:!1,userId:u.id}))}))})))):b.default.createElement("div",{className:oe.default.sectionPlaceholder},(0,E.t)("\u5c1a\u672a\u6dfb\u52a0\u9644\u4ef6")),r&&b.default.createElement("a",{className:oe.default.next,onClick:this.moveContent}),o<0&&b.default.createElement("a",{className:oe.default.pre,onClick:function(){return e.moveContent(!1)}})))}},{key:"render",value:function(){var e,t=this,a=this.state,n=a.name,i=a.autoNext,r=a.autoCopyNext,o=a.isLoading,s=a.attributes,l=a.isReloading,c=a.iterationCode,u=a.iterationList,d=a.localEpicCode,f=a.storyPoint,p=a.parentRequirement,m=a.availableRequirements,h=a.isMac,v=a.initEditorData,g=a.showDescriptionPlaceholder,y=a.editorAutoFocus,S=a.attachmentsSticky,I=a.maxMainBodyHeight,T=a.editorMinHeight,C=a.isPending,P=this.props,w=(P.enterpriseGlobalKey,P.currentProject),D=P.show,R=P.isShowCreateNext,j=P.assignmentSchemeFieldArchives,k=P.assignmentCreationFieldIDs,N=P.user,L=P.currentProjectCooperateSettings,F=P.isPermissible,_=P.labels,M=P.addLabel,x=P.requirementTypes,B=P.bugTypes,U=P.sourceTypes,W=P.moduleSchemes,Y=P.issueTypeDetail,q=(P.ramOnline,L&&L.ITERATION&&L.ITERATION===O.MODULE_SWITCH.OPENED),Z=F([{function:A.ProjectPermissionFunction.PROJECT_ITERATION,action:A.ProjectPermissionAction.UPDATE}]),J=this.getAssigneeFieldWhetherRequired(j,k,ce.BASE_FIELD_TYPE.ASSIGNEE),X=this.getAssigneeFieldWhetherRequired(j,k,ce.BASE_FIELD_TYPE.PARTICIPANT),Q=L&&L.STORY_POINT===O.MODULE_SWITCH.OPENED,ie=L&&L.STORY_POINT_TYPE===O.STORY_POINT_TYPE.TSHIRT,le={id:N.id,value:N.id,text:N.name,name:N.name,name_pinyin:N.name_pinyin,avatar:N.avatar,media:N.avatar},fe=L&&L.REQUIREMENT&&L.REQUIREMENT===O.MODULE_SWITCH.OPENED,pe="CLASSIC"===L.COOPERATE_MODE;return b.default.createElement(H.default,{className:(0,re.default)(oe.default.wrapper),show:D,outsideClickCloseable:!1,keyboard:!1,enforceFocus:!1},b.default.createElement("span",{className:(0,re.default)(oe.default.closeButton),onClick:this.onCancel}),o&&b.default.createElement("div",{className:oe.default.modalLoading}),!o&&b.default.createElement("div",{className:oe.default.main},b.default.createElement("div",{className:oe.default.mainHeader},b.default.createElement("div",{className:oe.default.headerInfoSection},b.default.createElement("span",{style:{marginRight:"8px"}},(0,E.t)("\u521b\u5efa")),b.default.createElement(V.default,{type:Y.iconType}),b.default.createElement("span",null,Y.name),this.showEpicDropdown()&&b.default.createElement(b.default.Fragment,null,b.default.createElement("span",{className:oe.default.dividerLine}),b.default.createElement(G.default,{currentProject:w,value:d,onSelect:this.onEpicChange})),b.default.createElement("div",{className:oe.default.attentionWrapper},b.default.createElement(K.default,{type:"MISSION",projectID:w.id,watchers:s.watchers||[],onChange:this.handleAttentionChange,user:le,action:"create",suffixText:(0,E.t)("\u4eba\u5173\u6ce8\u4e2d"),showTooltip:!0}))),b.default.createElement("div",{className:oe.default.headerTitleSection},b.default.createElement("input",{className:oe.default.titleInput,ref:this.inputRef,autoFocus:!0,placeholder:"".concat((0,E.t)("\u8f93\u5165\u4e8b\u9879\u6807\u9898\uff08")).concat(h?"\u2318":"Ctrl").concat((0,E.t)(" + Enter \u53ef\u5feb\u901f\u521b\u5efa\uff09")),value:n,onChange:this.onTitleChange}))),b.default.createElement("div",{className:oe.default.mainBody,style:{maxHeight:"".concat(I,"px")},ref:this.bodyRef,onScroll:this.onDescriptionScroll},g?b.default.createElement("div",{className:oe.default.descriptionPlaceholder,style:{height:"".concat(T,"px")},onClick:function(){return t.setState({showDescriptionPlaceholder:!1})}},(0,E.t)("\u6309\u56de\u8f66\u6216\u70b9\u6b64\u5f00\u59cb\u7f16\u8f91\u63cf\u8ff0")):b.default.createElement("div",{className:oe.default.editorContainer},b.default.createElement(z.default,{type:this.state.editorType,readOnly:this.state.isPending,isEditing:!0,autofocus:y,container:this.bodyRef.current,currentProject:w,initEditorData:v,richClientSaveUuid:"ASSIGNMENT_EDITOR_CREATOR",onEditorChange:this.onDescriptionChange,isDisabled:C,canChangeType:!0,onEditorTypeChangeCallback:function(e){return t.onEditorTypeChange(e)},onFullScreenCallback:function(e){return t.setState({fullscreen:e})},onLoad:function(e){if(e.isError){if((0,z.isBlockType)(t.state.editorType)&&e.isDraftIdNotExist){var a="".concat(w.name,"_").concat(Y.issueType,"_").concat(Y.id,"_CREATOR");(0,z.setIssueDescriptionDraft)(a),t.setState({initEditorData:null},t.initCreatePage)}}else t.getAttachmentsStickyState()},className:(0,re.default)(oe.default.customSectionZindex,!this.state.fullscreen&&oe.default.editorHeight),ref:this.editorRef}))),b.default.createElement("div",{className:(0,re.default)(oe.default.mainFooter,S&&oe.default.sticky)},this.renderAttachmentSection(),b.default.createElement("div",{className:oe.default.operationsWrapper},b.default.createElement("div",{disabled:l,className:(0,re.default)(oe.default.operationButton,!h&&oe.default.wider,se.default.newButton,se.default.primary,se.default.h32,l&&se.default.disabled),onClick:this.onSubmit,"data-container":!0,"data-title":"\u521b\u5efa".concat(Y.name,"-\u786e\u5b9a")},(0,E.t)("\u521b\u5efa"),b.default.createElement("span",{className:oe.default.key},h?"\u2318":"Ctrl"),b.default.createElement("span",{className:(0,re.default)(oe.default.key,oe.default.enter)})),b.default.createElement("div",{className:(0,re.default)(oe.default.operationButton,se.default.newButton,se.default.default,se.default.h32),"data-container":!0,"data-title":"\u521b\u5efa".concat(Y.name,"-\u53d6\u6d88"),onClick:this.onCancel},(0,E.t)("\u53d6\u6d88")),R&&b.default.createElement(b.default.Fragment,null,b.default.createElement("span",{className:oe.default.switch},b.default.createElement($.default,{checked:i,onChange:this.onAutoFlagChange}),b.default.createElement("span",{className:oe.default.switchText},(0,E.t)("\u7ee7\u7eed\u521b\u5efa\u4e0b\u4e00\u4e2a"))),b.default.createElement("span",{className:oe.default.switch},b.default.createElement($.default,{checked:r,onChange:this.onAutoCopyFlagChange}),b.default.createElement("span",{className:oe.default.switchText},(0,E.t)("\u590d\u5236\u5e76\u65b0\u5efa\u4e0b\u4e00\u4e2a"))))))),!o&&b.default.createElement("div",{className:oe.default.aside,onScroll:this.onAttrScroll,ref:this.sideRef},b.default.createElement("div",{className:oe.default.asideContent},b.default.createElement("div",{className:oe.default.issuePropertyContainer},b.default.createElement("div",{className:oe.default.issuePropertySection},b.default.createElement("label",null,(0,E.t)("\u5904\u7406\u4eba"),J&&b.default.createElement("span",{className:oe.default.highlight},"*")),b.default.createElement(ee.default,{inProject:!0,projectID:w.id,value:s.assignee||null,clearable:!J,onSelect:function(e){t.changeAttributes({type:"assignee",value:e});var a=s.participants;a.some((function(t){return t.id===e.id}))||setTimeout((function(){t.changeAttributes({type:"participants",value:(0,ue.concat)(a,e)})}))},onClear:function(){return t.changeAttributes({type:"assignee"})},triggerExtraProps:{initialSelectedItem:(null===s||void 0===s?void 0:s.defaultAssignee)||this.props.assignee}})),b.default.createElement("div",{className:oe.default.issuePropertySection},b.default.createElement("label",null,(0,E.t)("\u53c2\u4e0e\u4eba"),X&&b.default.createElement("span",{className:oe.default.highlight},"*")),b.default.createElement(ee.default,{inProject:!0,projectID:w.id,value:s.participants.map((function(e){return e.id})),clearable:!X,isMultiple:!0,onSelect:function(e){var a=s.participants,n=[];n=a.find((function(t){return t.id===e.id}))?a.filter((function(t){return e.id!==t.id})):(0,ue.concat)(a,e),t.changeAttributes({type:"participants",value:n})},onClear:function(){return t.changeAttributes({type:"participants"})},triggerExtraProps:{initialSelectedItem:s.participants||[]}})),pe&&fe&&b.default.createElement("div",{className:oe.default.issuePropertySection},b.default.createElement("label",null,(0,E.t)("\u6240\u5c5e\u9700\u6c42")),b.default.createElement(te.default,{requireCode:!0,type:p&&p.issueTypeDetail||null,placeholder:(0,E.t)("\u672a\u5173\u8054\u9700\u6c42"),clearPlaceholder:(0,E.t)("\u6e05\u9664\u5df2\u9009"),projectPath:w.project_path,searchable:!0,value:p&&p.code||0,items:m,selectedItem:p,isBase:!0,onSearch:function(e){t.fetchParentRequirements(e)},onSelect:function(e){var a;t.setState({parentRequirement:e,iterationCode:null===(a=e.iteration)||void 0===a?void 0:a.code})},onClear:function(){var e;t.setState({parentRequirement:void 0,iterationCode:null===(e=t.props.iteration)||void 0===e?void 0:e.code})},portalProps:{toRight:!0,popDropdownMenuWidth:280,portalWrapStyle:{zIndex:1049,width:"280px"},isScroll:this.state.isElemScroll,resetIsScroll:function(){t.setState({isElemScroll:!1})}}})),q&&b.default.createElement("div",{className:oe.default.issuePropertySection},b.default.createElement("label",null,(0,E.t)("\u6240\u5c5e\u8fed\u4ee3")),b.default.createElement(te.default,{type:{issueType:"sprint",iconType:"sprint"},searchable:!0,searchPlaceholder:(0,E.t)("\u5feb\u901f\u7b5b\u9009"),clearPlaceholder:(0,E.t)("\u79fb\u51fa\u8fed\u4ee3"),placeholder:(0,E.t)("\u672a\u89c4\u5212\u8fdb\u8fed\u4ee3"),value:c,items:u,isBase:!0,onSelect:this.onIterationChange,onClear:function(){return t.onIterationChange()},projectPath:w.project_path,disabled:p&&!!p.code||!Z,portalProps:{toRight:!0,popDropdownMenuWidth:280,portalWrapStyle:{zIndex:1049,width:"280px"},isScroll:this.state.isElemScroll,resetIsScroll:function(){t.setState({isElemScroll:!1})}}})),Q&&b.default.createElement("div",{className:oe.default.issuePropertySection},b.default.createElement("label",null,(0,E.t)("\u6545\u4e8b\u70b9")),b.default.createElement(ae.default,{useSize:ie,value:f,onSelect:function(e){t.setState({storyPoint:e>-1?e:void 0})},onClear:function(){t.setState({storyPoint:void 0})}})),(!this.props.issueTypeDetail.type||"mission"===this.props.issueTypeDetail.type)&&b.default.createElement(de.default,{status:"isCreate",getVersion:function(e){return t.setState({editionId:e})},boxStyle:oe.default.issuePropertySection,projectId:w.id,isSetDropdownPanelWidth:!0,onChange:this.changeAttributes,planDateCustomID:null===(e=Object.values(j).find((function(e){var t;return"\u8ba1\u5212\u4e0a\u7ebf\u65e5\u671f"===(null===(t=e.issueField)||void 0===t?void 0:t.name)})))||void 0===e?void 0:e.issueFieldId})),b.default.createElement("div",{className:(0,re.default)(oe.default.issuePropertyContainer,oe.default.hasNoBorder)},b.default.createElement(ne.default,{isCreate:!0,schemeFieldArchives:j,fieldIds:k,issueType:"MISSION",onChange:this.changeAttributes,customAttributes:s,labels:_,requirementTypes:x,bugTypes:B,sourceTypes:U,moduleSchemes:W,addLabel:M,projectID:w.id,currentProject:w,isPermissible:F,portalProps:{toRight:!0,portalWrapStyle:{zIndex:1099},isScroll:this.state.isElemScroll,resetIsScroll:function(){t.setState({isElemScroll:!1})}},parentRef:this.sideRef})))))}},{key:"componentDidMount",value:function(){var e=this,t=this.props,a=t.currentProject,n=t.issueTypeDetail,i=t.defectCode,r=this.state,o=r.name,s=r.editorType;document.addEventListener("keydown",this.quickSave),document.addEventListener("keydown",this.startEditing),window.addEventListener("resize",this.getHeights),this.getBasicInfo().then((function(){var t=e.props,a=t.assignmentSchemeFieldArchives,n=t.assignmentCreationFieldIDs;e.setDefaultValues(a,n),e.getHeights()})).finally((function(){if((0,z.isBlockType)(s)){var t=(0,z.getIssueDescriptionDraft)("".concat(a.name,"_").concat(n.issueType,"_").concat(n.id,"_CREATOR"));if(!i&&!t)return void e.initCreatePage().then((function(){e.setState({isLoading:!1})}));if(!i&&t)return void e.setState({isLoading:!1,initEditorData:{pageId:t.pageId,pageDraftId:t.pageDraftId,historyId:t.historyId},editorAutoFocus:!!o,showDescriptionPlaceholder:!1})}e.setState({isLoading:!1,editorAutoFocus:!!o,showDescriptionPlaceholder:!1})}))}},{key:"componentDidUpdate",value:function(e,t){if(t.isReloading!==this.state.isReloading){var a=this.props,n=a.assignmentSchemeFieldArchives,i=a.assignmentCreationFieldIDs,r=e.assignmentSchemeFieldArchives,o=e.assignmentCreationFieldIDs;if(!(0,C.default)(n,r)&&!(0,C.default)(i,o)){var s=(0,P.default)(i,o);this.setDefaultValues(n,s)}}t.allAttachments.length!==this.state.allAttachments.length&&this.whetherShowMoveButton(),t.editorType!==this.state.editorType&&(0,z.isBlockType)(this.state.editorType)&&!this.state.initEditorData&&this.initCreatePage()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.quickSave),document.removeEventListener("keydown",this.startEditing),window.removeEventListener("resize",this.getHeights)}},{key:"getBasicInfo",value:function(){return Promise.all([this.getIterationList(),this.fetchParentRequirements(),this.props.getBugTypes(),this.props.getRequirementTypes(),this.props.getModuleSchemes(),this.props.getAssignmentScheme(!0)].concat((0,c.default)(this.props.defectCode?[this.checkDescriptionPageId()]:[])))}},{key:"getIterationList",value:function(){var e=this,t=this.props.currentProject;(0,F.fetchIterationList)(t.id).then((function(t){e.setState({iterationList:e.formatIterationList(t.data)})}))}},{key:"formatIterationList",value:function(e){return e.map((function(e){return{value:e.code,text:e.name,progress:{finished:e.completedCount,processing:e.processingCount,unstart:e.waitProcessCount}}}))}},{key:"onTitleChange",value:function(e){this.setState({name:e.target.value})}},{key:"onAutoFlagChange",value:function(e){this.onUpdateStateAndStorage(e,!e&&this.state.autoCopyNext)}},{key:"onAutoCopyFlagChange",value:function(e){this.onUpdateStateAndStorage(!e&&this.state.autoNext,e)}},{key:"onSubmit",value:function(){var e=(0,d.default)(r.default.mark((function e(){var t,a,n,i,o,s,l,c,u,d,f,p,m,h,v,g,b,y,S,C,P,O,R,A,F,_,M,x,B,U,W,Y,H,V,G,K,q,Z,J,Q,$,ee,te,ae,ne,re,oe,se,le,ce,ue,de,fe,pe,me,ve,ge,Ee,be,ye,Se,Ie,Te=this;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=this.props.currentProject,l=s.id,c=s.project_path,u=s.name,d=this.props,f=d.isShowCreateNext,p=d.assignmentSchemeFieldArchives,m=d.assignmentCreationFieldIDs,h=d.closeHandle,v=d.callback,g=d.createWithTargetCode,b=d.callbackWithData,y=d.txcPostId,S=d.issueTypeDetail,C=d.fromDM,P=d.dmCallback,O=this.state,R=O.name,A=O.autoNext,F=O.autoCopyNext,_=O.isPending,M=O.allAttachments,x=O.attachments,B=O.parentRequirement,U=O.iterationCode,W=O.epicCode,Y=O.localEpicCode,H=O.storyPoint,V=O.attributes,G=V.assignee,K=V.priority,q=V.startDate,Z=V.dueDate,J=V.workingHours,Q=V.labels,$=V.watchers,ee=V.fields,te=V.requirementType,ae=V.projectModule,ne=V.progress,re=V.wuKongReloadId,oe=V.programId,se=V.systemsId,le=V.defectKindIds,ce=V.defectPhaseId,ue=V.defectSourceId,de=V.estimatedWorkHour,fe=V.participants,pe=O.thirdLinks,me=O.initEditorData,ve=O.releaseIds,ge=O.editorType,Ee=O.editionId,null===(t=this.editorRef)||void 0===t||!t.current||!(0,z.isBlockType)(ge)){e.next=12;break}return e.prev=4,e.next=7,(0,ie.getBlockEditorFinished)(this.editorRef.current);case 7:e.next=12;break;case 9:return e.prev=9,e.t0=e.catch(4),e.abrupt("return",(0,k.warning)((0,E.t)("\u66f4\u65b0\u63cf\u8ff0\u8d85\u65f6")));case 12:if(!_){e.next=14;break}return e.abrupt("return");case 14:if(!(0,T.default)((0,I.default)(R))){e.next=17;break}return(0,k.warning)((0,E.t)("\u4efb\u52a1\u6807\u9898\u4e0d\u80fd\u4e3a\u7a7a")),e.abrupt("return");case 17:if(128,!((0,I.default)(R).length>128)){e.next=21;break}return(0,k.warning)((0,E.t)("\u4efb\u52a1\u540d\u79f0\u6700\u591a\u652f\u6301{{count}}\u4f4d",{count:128})),e.abrupt("return");case 21:if(!(be=m.find((function(e){var t=p[e],a=t.required,n=t.issueField.type;if(a){var i;switch(n){case w.FIELD_TYPE.ASSIGNEE:i=G;break;case w.FIELD_TYPE.PROGRESS:i=ne;break;case w.FIELD_TYPE.PRIORITY:i=K;break;case w.FIELD_TYPE.START_DATE:i=q;break;case w.FIELD_TYPE.DUE_DATE:i=Z;break;case w.FIELD_TYPE.WORKING_HOURS:i=J;break;case w.FIELD_TYPE.LABEL:i=Q;break;case w.FIELD_TYPE.WATCHER:i=$;break;case w.FIELD_TYPE.REQUIREMENT_TYPE:i=te;break;case w.FIELD_TYPE.MODULE:i=ae;break;case w.FIELD_TYPE.INPROGRAM:i=oe;break;case w.FIELD_TYPE.DEFECT_KIND:i=le;break;case w.FIELD_TYPE.DEFECT_PHASE:i=ce;break;case w.FIELD_TYPE.DEFECT_SOURCE:i=ue;break;case w.FIELD_TYPE.WUKONG_RELOAD:i=re;break;case w.FIELD_TYPE.SYSTEM:i=se;break;case w.FIELD_TYPE.PARTICIPANT:i=fe;break;default:i=ee[e]}return!(Array.isArray(i)?i.length:null!==i&&void 0!==i)}return!1})))){e.next=25;break}return(0,k.warning)("".concat((0,E.t)("\u8bf7\u586b\u5199")).concat(p[be].issueField.name)),e.abrupt("return");case 25:if(!(x.length&&x.findIndex((function(e){return e.fileId<0}))>-1)){e.next=28;break}return(0,k.warning)((0,E.t)("\u6709\u9644\u4ef6\u6b63\u5728\u4e0a\u4f20\uff0c\u8bf7\u7a0d\u540e\u63d0\u4ea4")),e.abrupt("return");case 28:this.setState({isPending:!0}),ye=Object.keys(ee).filter((function(e){return void 0!==ee[e]})).map((function(e){var t=p[e].issueField.componentType;return t===D.PROPERTY_TYPE_CONSTANTS.SELECT_ITERATION_MULTI||t===D.PROPERTY_TYPE_CONSTANTS.SELECT_MEMBER_MULTI?{id:e,content:ee[e].map((function(e){return e.id}))}:t===D.PROPERTY_TYPE_CONSTANTS.SELECT_ITERATION_SINGLE||t===D.PROPERTY_TYPE_CONSTANTS.SELECT_MEMBER_SINGLE?{id:e,content:ee[e].id}:{id:e,content:ee[e]}})),Se=(0,X.default)(M,pe).map((function(e){return he(he({createdAt:e.createdAt},e.modao),e.codesign)})),Ie=(0,z.isBlockType)(ge)?he(he({},me),{},{descriptionType:z.EditorType.BLOCK}):{content:(null===(a=this.editorRef)||void 0===a||null===(n=a.current)||void 0===n?void 0:n.getRichContent())||"",slateRaw:(null===(i=this.editorRef)||void 0===i||null===(o=i.current)||void 0===o?void 0:o.getRichContent("raw"))||"",descriptionType:z.EditorType.MARKDOWN},(0,L.createAssignment)(l,{iterationCode:U||0,epicCode:W||Y&&Y.code,parentCode:B?B.code:0,storyPoint:H,name:(0,I.default)(R),fileIds:x.map((function(e){return e.fileId})),thirdLinks:Se,customFieldValueMap:ye.length?ye:null,assignee:G,priority:K,startDate:q,dueDate:Z,workingHours:J,labelIds:Q,watchers:$.map((function(e){return e.id})),requirementTypeId:te,projectModuleId:ae,targetSortCode:g,progress:ne,txcPostId:y,issueTypeId:S.id,kmPage:Ie,releaseIds:ve,programId:oe,wuKongReloadId:re,estimatedWorkHour:de,defectKindIds:le,defectPhaseId:ce,defectSourceId:ue,systemsId:se,editionId:Ee,participants:fe.map((function(e){return e.id}))},!0).then((function(e){var t=e.data,a="".concat(u,"_").concat(S.issueType,"_").concat(S.id,"_CREATOR");(0,z.setIssueDescriptionDraft)(a),(0,k.success)((0,E.t)("{{name}} #{{code}} \u521b\u5efa\u6210\u529f\uff0c\u70b9\u51fb\u67e5\u770b{{name}}\uff01",{code:t.code,name:S.name}),{link:"".concat(c,"/assignments/issues/").concat(t.code,"/detail")}),Te.removeDraft(),C&&P(null,t.issueStatusId,U,t),v&&v(null,t.issueStatusId,U),b&&b(t),f&&A?Te.resetFormData():f&&F?Te.resetPartialFormData(t.id):h()}),(function(e){var t=e.code,a=e.data,n=e.msg;if(8026===t)m.findIndex((function(e){return e===a.issueField.issueFieldId}))<0?((0,k.danger)((0,E.t)("\u521b\u5efa\u9875\u5c5e\u6027\u5df2\u53d8\u66f4\uff0c\u8bf7\u68c0\u67e5\u5fc5\u586b\u5c5e\u6027\u5e76\u518d\u6b21\u63d0\u4ea4\u3002")),Te.setState({isReloading:!0},(function(){Promise.all([Te.props.getAssignmentScheme(),Te.props.getAssignmentScheme(!0)]).then((function(){Te.setState({isReloading:!1})}))}))):(0,k.danger)((0,N.getErrorMessage)(n));else{if((0,j.configPlanNotToastMsg)(t))return;(0,k.danger)((0,N.getErrorMessage)(n))}})).finally((function(){Te.setState({isPending:!1})}));case 33:case"end":return e.stop()}}),e,this,[[4,9]])})));return function(){return e.apply(this,arguments)}}()},{key:"onIterationChange",value:function(e){this.setState({iterationCode:e?e.value:void 0})}},{key:"changeAttributes",value:function(e){var t=e.isCustom,a=e.type,n=e.value,i=e.issueFieldId,r=this.state.attributes;if(!this.validateDefect(i,n)){var o;switch(a){case"assignee":o={assignee:n?n.value:null,defaultAssignee:n};break;case"participants":o={participants:n||[]};break;case"programId":o={programId:null!==n&&void 0!==n&&n.id?n.id:n};break;case"defectKindIds":o={defectPhaseId:customValue,defectKindIds:n};break;case"defectPhaseId":o={defectPhaseId:n,defectKindIds:[]};break;case"workingHours":o={workingHours:null===n||void 0===n?void 0:n.workingHours,estimatedWorkHour:n};break;default:o=(0,u.default)({},a,n)}this.setState({attributes:he(he({},r),t?{fields:he(he({},r.fields),{},(0,u.default)({},i,n))}:o)})}}},{key:"getAssigneeFieldWhetherRequired",value:function(e,t,a){if(!e||!t.length||!a)return!1;var n=t.find((function(t){return e[t].issueField.type===a}));return!!n&&e[n].required}},{key:"setDefaultValues",value:function(e,t){var a=this.state.attributes,n=this.props.user,i={id:n.id,value:n.id,text:n.name,name:n.name,name_pinyin:n.name_pinyin,avatar:n.avatar,media:n.avatar};this.setState({attributes:(0,S.default)(a,(function(a){a.participants=[i],t&&t.forEach((function(t){var r=e[t],o=r.needDefault,s=r.value,l=r.userMap,u=r.iterationMap,d=r.issueField,f=d.type,p=d.componentType;if(o&&null!==s)switch(f){case w.FIELD_TYPE.ASSIGNEE:"VARIABLE"===s.type?(a.assignee=n.id,a.defaultAssignee=i):"CONSTANT"===s.type&&(a.assignee=s.value,a.defaultAssignee=l[s.value]);break;case w.FIELD_TYPE.PRIORITY:a.priority=s.value;break;case w.FIELD_TYPE.START_DATE:a.startDate=s.value;break;case w.FIELD_TYPE.DUE_DATE:a.dueDate=s.value;break;case w.FIELD_TYPE.WORKING_HOURS:a.workingHours=s.value;break;case w.FIELD_TYPE.LABEL:a.labels=s.value;break;case w.FIELD_TYPE.WATCHER:"VARIABLE"===s.type?a.watchers=(0,c.default)("CREATOR"===s.value?[i]:[]):a.watchers=s.value.map((function(e){return l[e]}));break;case w.FIELD_TYPE.REQUIREMENT_TYPE:a.requirementType=s.value;break;case w.FIELD_TYPE.MODULE:a.projectModule=s.value;break;case w.FIELD_TYPE.PROGRESS:a.progress=s.value;break;case w.FIELD_TYPE.WUKONG_RELOAD:a.wuKongReloadId=s.value;break;case w.FIELD_TYPE.DEFECT_KIND:a.defectKindIds=s.value;break;case w.FIELD_TYPE.DEFECT_PHASE:a.defectPhaseId=s.value;break;case w.FIELD_TYPE.PARTICIPANT:a.participants=s.value&&s.value.length?s.value.map((function(e){return l[e]})):[];break;case w.FIELD_TYPE.INPROGRAM:a.programId=s.value;break;default:p===D.PROPERTY_TYPE_CONSTANTS.SELECT_MEMBER_SINGLE||p===D.PROPERTY_TYPE_CONSTANTS.SELECT_MEMBER_MULTI?"VARIABLE"===s.type?a.fields[t]=i:Array.isArray(s.value)?a.fields[t]=s.value.map((function(e){return l[e]})):a.fields[t]=l[s.value]:p===D.PROPERTY_TYPE_CONSTANTS.SELECT_ITERATION_SINGLE||p===D.PROPERTY_TYPE_CONSTANTS.SELECT_ITERATION_MULTI?Array.isArray(s.value)?a.fields[t]=s.value.map((function(e){return u[e]})):a.fields[t]=u[s.value]:a.fields[t]=s.value}}))}))})}},{key:"resetFormData",value:function(){var e,t,a,n=this,i=this.props,r=i.assignmentCreationFieldIDs,o=i.assignmentSchemeFieldArchives,s=i.iteration,l=i.isShowCreateNext,c=i.detailInfoState,u=this.state.autoNext;this.setState({name:"",storyPoint:void 0,attachments:[],thirdLinks:[],isPending:!1,attributes:{assignee:void 0,priority:void 0,startDate:void 0,dueDate:void 0,projectModule:void 0,requirementType:void 0,re:void 0,workingHours:void 0,labels:[],watchers:[],fields:{},progress:void 0,wuKongReloadId:void 0,defectKindIds:[],defectPhaseId:void 0,defectSourceId:void 0,systemsId:void 0,participants:[]},iterationCode:this.props.iteration?"COMPLETED"===this.props.iteration.status&&this.props.parent&&this.props.parent.code?0:null===(e=this.props)||void 0===e||null===(t=e.iteration)||void 0===t?void 0:t.code:null===c||void 0===c||null===(a=c.iteration)||void 0===a?void 0:a.code,localEpicCode:void 0,parentRequirement:this.props.parent,initEditorData:null,editorAutoFocus:!0,editionId:void 0},(function(){n.setDefaultValues(o,r),n.setState({iterationCode:s&&"COMPLETED"!==s.status&&s.code||void 0}),n.combineThirdLinks(),l&&u&&(n.initCreatePage(),n.setState({showDescriptionPlaceholder:!0}),n.titleInputFocus())}))}},{key:"resetPartialFormData",value:function(e){var t=this,a=this.props.isShowCreateNext,n=this.state,i=n.autoCopyNext,r=n.attributes;this.setState({name:"",attachments:[],thirdLinks:[],isPending:!1,attributes:he(he({},r),{},{workingHours:void 0,estimatedWorkHour:void 0}),initEditorData:null},(function(){t.combineThirdLinks(),a&&i&&(t.copyCreatePage(e),t.titleInputFocus())}))}},{key:"fileUpload",value:function(e){var t=this.state.attachments;this.setState({attachments:[].concat((0,c.default)(t),(0,c.default)(e))},this.combineThirdLinks)}},{key:"handleDeleteAttachment",value:function(e,t){var a=this;(0,F.delAttachment)(e,t).then((function(){a.setState({attachments:(0,S.default)(a.state.attachments,(function(e){var a=e.findIndex((function(e){return e.fileId===t}));e.splice(a,1)}))},a.combineThirdLinks)}))}},{key:"onFileDropSuccess",value:function(e){var t=this;this.setState((function(t){return{attachments:(0,S.default)(t.attachments,(function(t){var a;if(t.find((function(t){return t.fileId===e.fileId}))){(0,k.success)("".concat(e.name).concat((0,E.t)(" \u6587\u4ef6\u5df2\u66f4\u65b0!")));var n=t.findIndex((function(t){return t.timestamp===e.timestamp}));t.splice(n,1),a=t.findIndex((function(t){return t.fileId===e.fileId}))}else a=t.findIndex((function(t){return t.timestamp===e.timestamp}));t[a]=he(he({},t[a]),e)}))}})),this.setState((function(){t.combineThirdLinks()}))}},{key:"onFileDropFail",value:function(e){var t=e.timestamp;this.setState({attachments:(0,S.default)(this.state.attachments,(function(e){var a=e.findIndex((function(e){return e.timestamp===t}));e.splice(a,1)}))})}},{key:"onFileDropDelete",value:function(e){var t=e.fileId,a=e.isModao,n=e.isCodesign,i=this.props.currentProject.id;a||n?this.setState({thirdLinks:this.state.thirdLinks.filter((function(e){return e.fileId!==t}))},this.combineThirdLinks):this.handleDeleteAttachment(i,t)}},{key:"onFileDropCancel",value:function(e){var t=e.timestamp,a=e.isModao,n=e.isCodesign;a||n?this.setState({thirdLinks:this.state.thirdLinks.filter((function(e){return e.timestamp!==t}))},this.combineThirdLinks):this.setState({attachments:(0,S.default)(this.state.attachments,(function(e){var a=e.findIndex((function(e){return e.timestamp===t}));e.splice(a,1)}))},this.combineThirdLinks)}},{key:"whetherShowMoveButton",value:function(){if(this.wrapperRef.current&&this.listRef.current){var e=this.wrapperRef.current.getBoundingClientRect().width,t=this.listRef.current.getBoundingClientRect().width;this.setState({showButton:t>e})}}},{key:"moveContent",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.wrapperRef.current&&this.listRef.current){var t=this.state.toLeft,a=this.wrapperRef.current.getBoundingClientRect(),n=a.width,i=this.listRef.current.getBoundingClientRect(),r=i.width,o=r+t-n;e?o<=n?this.setState({toLeft:t+-1*o,showButton:!1}):this.setState({toLeft:t-n}):o<=n?this.setState({toLeft:0,showButton:!0}):this.setState({toLeft:t+n})}}}]),a}(b.Component),s.propTypes=he(he({show:y.default.bool,isShowCreateNext:y.default.bool,closeHandle:y.default.func,callback:y.default.func,txcPostId:y.default.string,currentProject:y.default.shape({id:y.default.number.isRequired,name:y.default.string,owner_user_name:y.default.string}),user:y.default.object,labels:y.default.array,addLabel:y.default.func,moduleSchemes:y.default.array,parent:y.default.object,assignmentSchemeFieldArchives:y.default.object,assignmentCreationFieldIDs:y.default.array,getAssignmentScheme:y.default.func,requirementTypes:y.default.array,bugTypes:y.default.array,enterpriseGlobalKey:y.default.string,currentPathname:y.default.string,customRouteKey:y.default.string,isDetail:y.default.bool,getBugTypes:y.default.func,getRequirementTypes:y.default.func,getModuleSchemes:y.default.func,iteration:y.default.object,epicCode:y.default.number,name:y.default.string,currentProjectCooperateSettings:y.default.object,createWithTargetCode:y.default.number},A.WithProjectPermissionProps),{},{callbackWithData:y.default.func,releaseInfo:y.default.object,ramOnline:y.default.bool,fromDM:y.default.bool,dmData:y.default.object,dmCallback:y.default.func,dmErrorCallback:y.default.func}),s.defaultProps={isShowCreateNext:!0},o=l))||o)||o)||o)||o)||o;t.default=ge},"8r0r":function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a("cDcd"),i=a.n(n),r=a("DbF1"),o=a("qPyV"),s=a.n(o),l=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},c=function(e){return e.map((function(e){return{id:e.id,value:e.id,display_name:e.display_name,name:e.name,icon:e.icon,description:e.description}}))},u=i.a.createContext({});t.b=function(e){var t=e.children,a=l(Object(n.useState)([]),2),o=a[0],d=a[1],f=l(Object(n.useState)(1),2),p=f[0],m=f[1],h=l(Object(n.useState)(!0),2),v=h[0],g=h[1],E=l(Object(n.useState)(""),2),b=E[0],y=E[1],S=function(e){v&&Object(r.c)(p,20,e).then((function(e){var t=e.data,a=t.list,n=t.totalPage,i=c(a);d(s()(o.concat(i),"id")),p<n?m(p+1):g(!1)}))};return Object(n.useEffect)((function(){S()}),[]),i.a.createElement(u.Provider,{value:{projects:o,loadMore:function(){S(b)},onSearch:function(e){e&&(m(1),y("")),y(e),Object(r.c)(1,100,e).then((function(e){var t=e.data.list,a=c(t);d(a)}))}}},t)}},"9Aei":function(e,t,a){"use strict";a("I5cv"),a("mYba"),a("jm62"),a("EK0E");var n=a("TqRt"),i=a("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(a("o0o1")),o=n(a("pVnL")),s=n(a("yXPU")),l=n(a("QILm")),c=n(a("RIqP")),u=n(a("lSNA")),d=n(a("lwsE")),f=n(a("W8MJ")),p=n(a("PJYZ")),m=n(a("7W2i")),h=n(a("a1gu")),v=n(a("Nsbk"));a("f3/d"),a("0l/t"),a("Btvt"),a("VRzm"),a("dRSK"),a("XfO3"),a("yt8O"),a("rGqo"),a("bWfx"),a("L9s1"),a("Z2Ku"),a("INYr"),a("CX2u"),a("pIFo"),a("tUrg"),a("0mN4"),a("hhXQ"),a("RW0V"),a("ioFf"),a("HEwt"),a("T39b"),a("OG14");var g,E,b,y,S=a("mVeg"),I=St(a("cDcd")),T=a("h74D"),C=n(a("17x9")),P=a("dtw8"),w=n(a("P5Jw")),D=a("YzRi"),O=a("w3Wo"),R=a("sWxF"),j=a("7FZc"),k=n(a("TsYS")),N=n(a("WE/Q")),A=n(a("28Uz")),L=n(a("QYLJ")),F=n(a("qCZF")),_=n(a("AVuq")),M=n(a("Yzhn")),x=n(a("g2Cx")),B=n(a("V/h/")),U=n(a("wd/R")),W=n(a("Y+p1")),Y=n(a("NIJN")),H=n(a("BkRI")),V=a("FaIw"),G=a("xgZS"),K=n(a("qLOp")),z=n(a("8+Mu")),q=n(a("2KQ+")),Z=n(a("KUqB")),J=a("nuIr"),X=n(a("XLbL")),Q=n(a("4qC0")),$=n(a("GoyQ")),ee=n(a("UB5X")),te=n(a("Z0cm")),ae=n(a("ai0/")),ne=n(a("K2gz")),ie=a("Z4vw"),re=a("DKcV"),oe=a("FpRC"),se=n(a("2CT0")),le=n(a("L8Eh")),ce=n(a("Th6D")),ue=n(a("n1Xv")),de=n(a("1+AE")),fe=n(a("Zsd2")),pe=n(a("wCj3")),me=a("DgMC"),he=n(a("XiRy")),ve=a("x+BT"),ge=n(a("OTim")),Ee=n(a("u5of")),be=a("885C"),ye=n(a("A97/")),Se=n(a("TT2u")),Ie=a("5DNL"),Te=a("3RH6"),Ce=a("AwMv"),Pe=n(a("fRA5")),we=a("aHEs"),De=n(a("mSbZ")),Oe=n(a("htee")),Re=n(a("4Fdf")),je=n(a("uk0h")),ke=n(a("+Dhf")),Ne=a("jzjO"),Ae=n(a("begU")),Le=n(a("0Zwn")),Fe=n(a("W0/N")),_e=n(a("HtPo")),Me=n(a("CF/V")),xe=n(a("oIiO")),Be=n(a("Qkhu")),Ue=n(a("qPyV")),We=n(a("H8cV")),Ye=n(a("7hiy")),He=n(a("AoGB")),Ve=n(a("HwxY")),Ge=n(a("KIkv")),Ke=a("7bn+"),ze=n(a("Zrey")),qe=n(a("X5YD")),Ze=n(a("xMGB")),Je=a("17N+"),Xe=(n(a("M/Qn")),a("LvkV")),Qe=a("9+7+"),$e=a("lGCG"),et=n(a("WKBZ")),tt=n(a("cHah")),at=n(a("DDpV")),nt=n(a("QWzU")),it=n(a("6yKH")),rt=a("cUHt"),ot=a("nuIr"),st=n(a("Q95R")),lt=(n(a("IZvD")),n(a("ZYwa"))),ct=a("LvDl"),ut=a("DgMC"),dt=n(a("yTui")),ft=n(a("kgDq")),pt=n(a("Se5f")),mt=n(a("GMsc")),ht=n(a("q18W")),vt=n(a("Mh+3")),gt=St(a("Mdvu")),Et=a("AMAM"),bt=["name"];function yt(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(yt=function(e){return e?a:t})(e)}function St(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!==typeof e)return{default:e};var a=yt(t);if(a&&a.has(e))return a.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=r?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}return n.default=e,a&&a.set(e,n),n}function It(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Tt(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?It(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):It(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Ct(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,v.default)(e);if(t){var i=(0,v.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,h.default)(this,a)}}var Pt=(g=(0,T.connect)((function(e){var t,a,n,i;return{enterpriseGlobalKey:e.APP.enterprise.globalKey,enterpriseName:e.APP.enterprise.name,watermark:e.APP.enterprise.watermark,payed:e.APP.enterprise.payed,type:null===e||void 0===e||null===(t=e.APP)||void 0===t||null===(a=t.enterprise)||void 0===a?void 0:a.type,user:e.APP.user,ramOnline:null===(n=e.CURRENT_USER_ENTERPRISE_PERMISSION_NAMESPACE_FOR_REDUX_STORE)||void 0===n||null===(i=n.ramStatus)||void 0===i?void 0:i.ramOnline}})),(0,P.withRouter)(E=g(E=(0,De.default)(E=(0,ke.default)(E=(0,Oe.default)(E=(0,je.default)(E=(0,Re.default)(E=(0,Se.default)(E=(0,Ie.FlashAnchorDecorator)(E=(0,He.default)((y=b=function(e){(0,m.default)(a,e);var t=Ct(a);function a(e){var n;return(0,d.default)(this,a),(n=t.call(this,e)).getFunctionFlags=function(){var e=n.props.currentProjectFunctions;return{codeManagementOpen:e.some((function(e){return e.code===Xe.KEY_CONFIG.CODE_MANAGEMENT&&"1"===e.value})),testManagementOpen:e.some((function(e){return e.code===Xe.KEY_CONFIG.TEST_MANAGEMENT&&"1"===e.value})),issueReviewOpen:Qe.enableIssueReview}},n.elemShow=function(){var e=n.props.currentProjectCooperateSettings,t=e.COOPERATE_MODE,a=e.txcAuthorized;n.dataLoad=(0,Fe.default)({elemInOrder:[a&&"feedBack","SCRUM"===t&&!n.state.detailInfoState.parent&&"subTask","associateTestCase","CLASSIC"===t&&"blockingRelation","switchQuestion","codeRepo","reference","logs","comment"].filter((function(e){return e})),onRenderItem:function(e,t,a,i){n.setState({isRender:Tt({},i),isRenderAll:t},(function(){a(),t&&n.setState({controlCaculatePos:Date.now()})}))}}),n.dataLoad("comment")},n.isDeleteInFilePreview=!1,n.titleInputRef=I.default.createRef(),n.scrollRef=I.default.createRef(),n.renderParentsInfo=function(){var e=n.state,t=e.tooltipTitle,a=e.detailInfoState,i=n.props,r=i.projectPath,o=i.currentProjectCooperateSettings,s=o&&o.EPIC&&o.EPIC===J.MODULE_SWITCH.OPENED,l="".concat(r,"/bug-tracking/issues/").concat(a.code,"/detail");return I.default.createElement("div",{className:K.default.detailId},s&&a.epic&&I.default.createElement(j.TooltipTrigger,{title:"".concat((0,S.t)("\u6240\u5c5e\u53f2\u8bd7\uff1a#")).concat(a.epic.code," ").concat(a.epic.name)},I.default.createElement(P.Link,{to:"".concat(r,"/epics/issues/").concat(a.epic.code,"/detail"),className:(0,ne.default)(K.default.code,K.default.number)},I.default.createElement(Z.default,{type:"epic"}),"#",a.epic.code)),s&&a.epic&&I.default.createElement("span",{className:K.default.codeIdDivideLine},"/"),I.default.createElement("span",{className:(0,ne.default)(K.default.code,K.default.lastId,K.default.lastNumber)},I.default.createElement(P.Link,{to:l,className:(0,ne.default)(K.default.code,K.default.number)},I.default.createElement(Z.default,{type:a.issueTypeDetail.iconType}),"#",a.code),I.default.createElement(j.TooltipTrigger,{title:t,onVisibleChange:n.onVisibleChange},I.default.createElement(w.default,{text:"".concat(window.location.origin).concat(r,"/bug-tracking/issues/").concat(a.code,"/detail")},I.default.createElement("div",{className:K.default.copyIcon,onClick:n.onCopyClick})))),I.default.createElement("div",{className:(0,ne.default)(K.default.code,K.default.lastId,K.default.lastNumber),style:{marginLeft:20,fontWeight:600}},"|",I.default.createElement("span",{style:{color:"red",margin:"0 5px"}},"GID"),"#",a.id,I.default.createElement(j.TooltipTrigger,{title:t,onVisibleChange:n.copyGID},I.default.createElement(w.default,{text:a.id},I.default.createElement("div",{className:K.default.copyIcon,onClick:n.onCopyClick})))))},n.copyGID=function(){n.setState({tooltipTitle:(0,S.t)("\u590d\u5236")})},n.renderTitle=function(e,t,a,i){var r=n.state,o=r.detailInfoState,s=r.inputFocus;return I.default.createElement(dt.default,{value:o.name,ref:!a&&n.titleInputRef,onBlur:function(){n.setState({inputFocus:!1}),n.submitTitleChange()},onChange:function(e){return n.setState({detailInfoState:Tt(Tt({},o),{},{name:e})})},viewLine:i,onPressEnter:n.submitTitleChange,initFocus:s,onFocus:function(){return n.setState({inputFocus:!0})}})},n.renderScrollTitle=function(e,t){var a=n.state,i=a.inputFocus,r=a.detailInfoState;return i?I.default.createElement(I.default.Fragment,null,n.renderTitle(e,!0,t)):I.default.createElement("div",{className:K.default.scrolledTitleWrap},I.default.createElement("div",{className:(0,ne.default)(K.default.titleIconWrap,n.state.noHoverIcon&&K.default.noHoverIcon)},I.default.createElement(Z.default,{type:r.issueTypeDetail.iconType}),I.default.createElement("div",{className:K.default.breadcrumb},n.renderParentsInfo())),n.renderTitle(e,!0,t,1))},n.getLinkfragment=function(){var e=n.state.detailInfoState,t=n.props,a=t.projectPath,i=t.location.pathname,r=t.params.epicCode,o=t.iterationCode,s=(0,me.currentListPath)(i);return r?"".concat(a,"/epics/issues/").concat(e.epic.code,"/detail/subissues/"):-1!==s.indexOf("iterations")?"".concat(a,"/iterations/").concat(o,"/issues/"):-1!==s.indexOf("releases")?"".concat(a,"/releases/").concat(o,"/issues/"):"".concat(a,"/").concat(s,"/issues/")},n.onBtnClick=function(e){n["".concat(e.toLowerCase(),"BtnClicked")]&&n["".concat(e.toLowerCase(),"BtnClicked")]()},n.getEditComp=function(e){n.editComp=e},n.editStatusChanged=function(e,t){n.setState(Tt({isDesEditing:e,isShowItemPlaceholder:Tt(Tt({},n.state.isShowItemPlaceholder),{},{description:void 0!==t?t:!e})},e?{}:{isDescriptionBtnFixed:!1}),(function(){n.setState({controlCaculatePos:Date.now()})}))},n.handleBlockingRelationVisibleChange=function(e){n.setState({isBlockingRelationVisible:e,isShowItemPlaceholder:Tt(Tt({},n.state.isShowItemPlaceholder),{},{blockingRelation:e})})},n.getDelDefectInfo=function(){var e=n.props.currentProject,t=n.state.detailInfoState;return new Promise((function(a){return(0,O.fetchDeleteIssue)(e.id,t.id).then((function(e){var t=e.data;a(t)}))}))},n.scrollToAttechment=function(){var e,t;null!==(e=n.scrollRef)&&void 0!==e&&e.current&&null!==(t=n.attechmentRef)&&void 0!==t&&t.current&&n.headerRef.current&&(0,oe.scrollIntoView)(n.scrollRef.current,n.attechmentRef.current,-n.headerRef.current.offsetHeight)},n.handleReviewListChanged=function(){n.fetchIssueReviewList((function(e){0!==e.length?oe.scrollIntoView&&n.setState({activeLogTab:"approval"},(function(){(0,oe.scrollRelatedToTopMenu)("issue-review-list",0,n.scrollRef.current)})):n.setState({activeLogTab:"activity"})})),setTimeout((function(){n.getActivityList()}),1e3)},n.getCodeRepoSetting=function(){var e=n.props.currentProject,t=n.state.detailInfoState;return(0,R.fetchRepoSettingInfo)(e.name,t.issueTypeDetail.id).then((function(e){var t=e.data.find((function(e){return"RELATE_VCS"===e.configName}));t&&"ON"===t.configValue?(n.setState({codeRepoRelationOpened:!0}),n.getAssociatedCodeRepos()):n.dataLoad("codeRepo")}))},n.getCodeRepos=function(e){var t=n.props,a=t.enterpriseGlobalKey,i=t.currentProject,r=n.state,o=r.associatedCodeRepos,s=r.codeRepoList,l=r.attributes;e?n.setState({availableCodeRepos:s.filter((function(t){return t.name.toLowerCase().includes(e.toLowerCase())&&!o.some((function(e){return e.id===t.id}))}))}):l.systemsId?Promise.all([(0,R.fetchAvailableCodeRepos)(a,i.name),(0,R.fetchExternalAvailableCodeRepos)(l.systemsId)]).then((function(e){var t=[],a=[];e.forEach((function(e,n){0===(null===e||void 0===e?void 0:e.code)&&(0===n?t=(0,c.default)(e.data):a=e.data.map((function(e){return{id:e.depotId,name:e.depotName,vcsType:"git"}})))}));var i=(0,We.default)(t,a,"id");n.setState({codeRepoList:i,availableCodeRepos:i.filter((function(e){return!o.some((function(t){return t.id===e.id}))}))})})):(0,R.fetchAvailableCodeRepos)(a,i.name).then((function(e){var t=e.data;n.setState({codeRepoList:t,availableCodeRepos:t.filter((function(e){return!o.some((function(t){return t.id===e.id}))}))})}))},n.onUpdateCodeRepos=function(e){var t=n.state.associatedCodeRepos,a=(0,H.default)(t);e.forEach((function(e){var t=e.name,n=(0,l.default)(e,bt),i=a.findIndex((function(e){return e.name===t}));-1!==i&&(a[i]=Tt(Tt({},a[i]),n))})),n.setState({associatedCodeRepos:a})},n.associateCodeRepo=function(e){var t=n.props.currentProject,a=n.state.detailInfoState.code;(0,R.associateCodeRepo)(t.name,a,e).then((function(){(0,G.success)((0,S.t)("\u66f4\u65b0\u6210\u529f")),n.getAssociatedCodeRepos().then((function(){return n.getCodeRepos()}))}))},n.cancelAssociateCodeRepo=function(e){var t=n.props.currentProject,a=n.state.detailInfoState.code;(0,R.cancelAssociateCodeRepo)(t.name,a,e).then((function(){(0,G.success)((0,S.t)("\u66f4\u65b0\u6210\u529f")),n.getAssociatedCodeRepos().then((function(){return n.getCodeRepos()}))}))},n.cancelCodeRepo=function(){var e=n.state.isShowItemPlaceholder;n.setState({isShowItemPlaceholder:Tt(Tt({},e),{},{codeRepo:!1})})},n.handleWorkItemRelationVisibleChange=function(e){n.setState({isWorkItemCreationVisible:e,isShowItemPlaceholder:Tt(Tt({},n.state.isShowItemPlaceholder),{},{workItem:e})})},n.insideProgramCheck=function(e){var t=n.props.currentProject;return e?(0===e.code&&e.data.length>0&&n.getAssociatedWorkItems(),void n.dataLoad("workItem")):(0,R.whetherInProgram)(t.id).then((function(e){e.data.length>0&&n.getAssociatedWorkItems()})).finally((function(){n.dataLoad("workItem")}))},n.workItemRelationChanged=function(){n.getAssociatedWorkItems(),n.getActivityList()},n.cancelWorkItem=function(){return n.setState({isShowItemPlaceholder:Tt(Tt({},n.state.isShowItemPlaceholder),{},{workItem:!1})})},n.referencesBtnClicked=function(){"activity"===n.state.activeLogTab?n.changeActivityTabAndShow():n.setState({activeLogTab:"activity"},(function(){n.setCommentPosition((function(){setTimeout((function(){n.changeActivityTabAndShow()}),0)}))}))},n.changeActivityTabAndShow=function(){"WITHOUT_COMMENT"===n.state.activitiesTab?n.setState({activitiesTab:"ALL",isShowItemPlaceholder:Tt(Tt({},n.state.isShowItemPlaceholder),{},{reference:!0})},(function(){n.changeTabFn(["ALL"]),n.setCommentPosition((function(){n.doShowReference()}))})):n.doShowReference()},n.doShowReference=function(){n.props.autoToggleComment(n.state.detailInfoState.code,!0)},n.scrollToBottom=function(e){(0,oe.scrollRelatedToTopMenu)("bottom",0,n.scrollRef.current,e)},n.getNotUploadElems=function(){var e=n.state,t=e.isDesEditing,a=e.isCommentEditing;return[t&&n.editComp.containerRef.current,a&&n.commentEditorRef&&n.commentEditorRef.current]},n.dragEnterDes=function(e){n.dragEnter(e,"des")},n.dragEnterComment=function(e){n.dragEnter(e,"comment")},n.dragEnter=function(e,t){e.preventDefault(),e.stopPropagation(),n["des"===t?"intoDesCount":"intoCommentCount"]++},n.dragLeaveDes=function(e){n.dragLeave(e,"des")},n.dragLeaveComment=function(e){n.dragLeave(e,"comment")},n.dragLeave=function(e,t){e.preventDefault(),e.stopPropagation();var a="des"===t?"intoDesCount":"intoCommentCount";n[a]--,0===n[a]&&n.setState({notUpload:!1})},n.mouseLeaveDes=function(){n.mouseLeave("des")},n.mouseLeaveComment=function(){n.mouseLeave("comment")},n.renderActivity=function(e){var t=n.state,a=t.isInited,i=t.activities,r=t.detailInfoState,o=t.activitiesTab,s=t.isCommentSticky,l=n.props,c=l.isDetail,u=l.currentProject,d=l.user,f=l.projectPath,p=l.domID;return I.default.createElement(_.default,{isInited:a,scrollRef:n.scrollRef,isDetail:c,currentProject:u,user:d,activities:i,projectPath:f,domID:p,flashAnchor:n.props.flashAnchor,itemType:"DEFECT",code:r.code,onPublishChildComment:n.postComment,editCommentCallback:n.handleEditCommentCallback,onDeleteComment:n.deleteComment,handleViewRecord:n.viewRecord,activeTab:[o],changeTab:function(e){return n.setState({activitiesTab:e},n.setCommentPosition)},getChangeTabFn:function(e){n.changeTabFn=e},isCommentSticky:s,hideTitle:e,handleEditComment:function(e){return n.setState({isEdittingCommentModalVisible:e})}})},n.changeActivityLogTab=function(e){n.fetchManHourRecords(),n.setState({activeLogTab:e.value},(function(){n.setCommentPosition(),"approval"===e.value&&n.fetchIssueReviewList((function(e){0===e.length&&n.setState({activeLogTab:"activity"})}))}))},n.getDropdownPortalToRight=function(){return!n.props.isDetail&&!n.state.isFullScreen},n.formatTypeText=function(e){var t=n.state,a=t.iterationConfirmParams,i=t.isIterationConfirmText,r=t.detailInfoState,o="";if(null===r.iteration&&a&&a.status===Ke.ITERATION_STATUS.PROCESSING&&(o=i.MoveIn[e]),r.iteration&&[Ke.ITERATION_STATUS.WAIT_PROCESS,Ke.ITERATION_STATUS.PROCESSING,Ke.ITERATION_STATUS.COMPLETED].includes(r.iteration.status)&&a&&[Ke.ITERATION_STATUS.WAIT_PROCESS,Ke.ITERATION_STATUS.PROCESSING,Ke.ITERATION_STATUS.COMPLETED].includes(a.status)){if(r.iteration&&r.iteration.status===Ke.ITERATION_STATUS.PROCESSING&&a&&a.status===Ke.ITERATION_STATUS.PROCESSING)return o=i.ToTarget[e];if(r.iteration&&r.iteration.status===Ke.ITERATION_STATUS.PROCESSING)return o=i.MoveOut[e];if(a&&a.status===Ke.ITERATION_STATUS.PROCESSING)return o=i.MoveIn[e]}return void 0===a&&r.iteration&&r.iteration.status===Ke.ITERATION_STATUS.PROCESSING&&(o=i.MoveOut[e]),o},n.doScroll=function(){if(!n.state.inputFocus){var e=n.scrollRef.current.scrollTop,t=n.state.isScrolled;e>100&&!t?n.setState({isScrolled:!0}):e<=100&&n.setState({isScrolled:!1})}},n.onAttrScroll=function(){n.setState({isElemScroll:!0})},n.getFeedBackList=function(){var e=n.props.issueCode,t=n.props.currentProject.id;(0,O.fetchFeedBackList)(t,{issueCode:e}).then((function(e){n.setState({feedBackList:e.data}),n.dataLoad("feedBack")}))},n.blockingRelationChanged=function(){n.fetchBlockingRelationList(),n.getActivityList(),n.props.refreshCallback&&n.props.refreshCallback()},n.fetchManHourRecords=function(e){var t=n.props,a=t.currentProject.id,i=t.detailInfo.code;if(!e)return(0,R.getManhourHistories)(a,i).then((function(e){var t=e.data;n.setState({manHourRecords:t})}));0===e.code&&n.setState({manHourRecords:e.data})},n.fetchManHourRecordsAndFetchSpecData=(0,s.default)(r.default.mark((function e(){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.fetchManHourRecords();case 2:return e.next=4,n.changeAttributes({type:""});case 4:case"end":return e.stop()}}),e)}))),n.deleteManhourRecord=function(e,t){var a=n.props.currentProject.id;return(0,R.delManHourHistory)(a,e.id,t).then((0,s.default)(r.default.mark((function e(){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.fetchManHourRecordsAndFetchSpecData();case 1:case"end":return e.stop()}}),e)}))))},n.getConvertedList=function(){return new Promise((function(e){var t=n.props,a=t.detailInfo,i=t.currentProject.id;(0,D.fetchConvertedTarget)(a.id,i).then((function(t){var a=t.data;if(a&&a.length){var i=a[0],r={title:i.sourceName,targetType:i.sourceType,targetProjectName:i.sourceProjectName,iconType:i.sourceIconType,statusName:i.sourceIssueStatus.name,statusId:i.sourceIssueStatus.id,statusType:i.sourceIssueStatus.type,code:i.sourceCode,id:i.sourceId,deletedAt:-1};n.setState({switchIssueList:[r]})}e()}))}))},n.caculateDetailEleHeight=function(){return new Promise((function(e){n.doCaculate(-1,e)}))},n.doCaculate=function(e,t){if(n.detailBodyRef.current){var a=n.detailBodyRef.current.offsetHeight;a!==e?setTimeout((function(){n.doCaculate(a,t)}),300):t(a)}},n.setCommentPosition=function(){var e=(0,s.default)(r.default.mark((function e(t){var a,i,o,s,l;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n.scrollRef&&n.scrollRef.current&&n.hiddenHeaderRef.current&&n.detailBodyRef.current)){e.next=7;break}return e.next=3,n.caculateDetailEleHeight();case 3:o=e.sent,s=n.scrollRef.current.offsetHeight-n.hiddenHeaderRef.current.offsetHeight,l=(null===(a=n.commentEditorRef)||void 0===a||null===(i=a.current)||void 0===i?void 0:i.offsetHeight)||140,n.setState(Tt({isCommentSticky:o+l>=s},o+l<s?{isDescriptionBtnFixed:!1,isCommentAbsBottom:!1}:{}),(function(){if(n.state.isCommentSticky&&(setTimeout((function(){var e=n.hiddenHeaderRef.current.offsetHeight+(n.detailBodyRef.current.offsetHeight<s?s:n.detailBodyRef.current.offsetHeight);n.setState({isCommentAbsBottom:n.scrollRef.current.offsetHeight-e>=0,minHeight:s})}),0),n.state.isDesEditing)){var e=n.editorRef.current.offsetHeight+24,a=n.scrollRef.current.offsetHeight-n.hiddenHeaderRef.current.offsetHeight-44;n.setState({isDescriptionBtnFixed:e>=a})}"function"===typeof t&&t()}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.updateRelatedRequirement=function(e){var t=n.props,a=t.currentProject,i=t.issueCode;return(0,R.updateRelatedRequirement)(a.id,i,e).then((function(){(0,G.success)((0,S.t)("\u66f4\u65b0\u6210\u529f")),n.getActivityList(),n.getRequirements()}))},n.renewDescription=function(e){var t=e.historyId,a=e.issueLogId,i=e.description,r=n.props.currentProject,o=n.state.detailInfoState;return(0,O.rollbackDescription)(r.id,o.code,a).then((function(){n.setState({historyId:t,description:i,isDescriptionEmpty:!i.replace(/\n|\s/g,"")}),n.getActivityList(),n.getResourceReference()})).then((function(){gt.default.emit(gt.EventBusType.BlockDesc,gt.EventBusKeys.revertHistoryBlockDesc)}))},n.handleAttentionChange=function(e){n.changeAttributes({type:"watchers",value:e})},n.handleSelfChange=function(e){var t=n.props,a=t.currentProject,i=t.user,r=n.state,o=r.detailInfoState,s=r.watchers;e?(0,O.watchIssue)(a.id,o.code).then((function(){n.setState({watchers:[].concat((0,c.default)(s),[i])}),(0,G.success)((0,S.t)("\u66f4\u65b0\u6210\u529f")),n.callback(),n.getActivityList()})):(0,O.unwatchIssue)(a.id,o.code).then((function(){n.setState({watchers:(0,c.default)(s.filter((function(e){return e.id!==i.id})))}),(0,G.success)((0,S.t)("\u66f4\u65b0\u6210\u529f")),n.callback(),n.getActivityList()}))},n.getSubTasksList=function(e){var t=n.props,a=t.currentProject.id,i=t.issueCode;if(!e)return(0,D.fetchSubtasksList)(a,i).then((function(e){var t=e.data;n.setState({subTasks:t}),n.dataLoad("subTask")})).catch((function(e){(0,G.warning)((0,ie.getErrorMessage)(e.msg)),n.dataLoad("subTask")}));0===e.code?(n.setState({subTasks:e.data}),n.dataLoad("subTask")):n.dataLoad("subTask")},n.getRequirements=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=n.props,a=t.currentProject.id,i=t.issueCode;return(0,R.getAvailableRequirements)(a,i,{keyword:e}).then((function(e){var t=e.data;n.setState({availableRequirements:t})})).catch((function(e){(0,G.warning)((0,ie.getErrorMessage)(e.msg))}))},n.handleSubTasksCallback=function(){n.setState({isCreateSubTasksVisible:!0,subTasksInput:""},(function(){(0,oe.scrollRelatedToTopMenu)("subtask-elem",200,n.scrollRef.current),n.subtaskInputRef.current&&n.subtaskInputRef.current.focus()}))},n.handleSubTasksInput=function(e){n.setState({subTasksInput:e.target.value})},n.handleSubTasksInputCancel=function(){n.setState({isCreateSubTasksVisible:!1,subTasksInput:"",isShowItemPlaceholder:Tt(Tt({},n.state.isShowItemPlaceholder),{},{subtask:!1})})},n.handleSubTasksInputCreate=(0,ct.debounce)((function(){var e,t=n.props.currentProject.id,a=n.props.projectPath,i=n.state,r=i.subTasksInput,o=i.detailInfoState;r?(0,R.fastCreateIssue)(t,{name:(0,fe.default)(r),parentCode:o.code,priority:1,issueType:"SUB_TASK",issueDescriptionType:null!==(e=o.issueDescriptionType)&&void 0!==e?e:getPreferEditorType()},!0).then((function(e){var t=e.data;(0,G.success)((0,S.t)("\u5b50\u5de5\u4f5c\u9879 #{{code}} \u521b\u5efa\u6210\u529f\uff0c\u70b9\u51fb\u67e5\u770b\u5b50\u5de5\u4f5c\u9879\uff01",{code:t.code}),{link:"".concat(a,"/subtasks/issues/").concat(t.code,"/detail")}),n.actionCallback()}),(function(e){var t=e.code;(0,ut.configPlanNotToastMsg)(t)||8011!==t&&n.handleSubTasksInputFullCreate()})).finally((function(){n.setState({isPending:!1})})):(0,G.warning)((0,S.t)("\u8bf7\u8f93\u5165\u5b50\u5de5\u4f5c\u9879\u6807\u9898"))}),300),n.handleSubTasksInputFullCreate=function(){n.setState({subTasksInputVisible:!0})},n.cancelCreationModal=function(){n.setState({subTasksInputVisible:!1})},n.actionCallback=function(){var e=n.props.isDetail;n.getSubTasksList(),n.getActivityList(),n.setState({subTasksInput:""}),e||n.props.updateCallback()},n.handleSort=function(e,t){var a=n.props.currentProject.id,i=n.state.detailInfoState;(0,D.sortSubtask)(a,i.code,{subTaskCode:e,beforeCode:t}).then((function(){(0,G.success)("".concat((0,S.t)("\u6392\u5e8f\u6210\u529f\uff01"))),n.props.refreshCallback&&n.props.refreshCallback(),n.getSubTasksList(i.code)}),(function(e){var t=e.msg;(0,G.danger)((0,ie.getErrorMessage)(t)),n.getSubTasksList(i.code)})).finally((function(){n.setState({isPending:!1})}))},n.onParentUpdate=function(){var e=n.props,t=e.projectPath,a=e.location.pathname,i=e.browserRouter,r=e.updateCallback,o=n.state.detailInfoState;"function"===typeof r&&(/detail\/subissues/.test(a)?i.push("".concat(t,"/epics/issues/").concat(o.epic.code,"/detail")):n.getActivityList(),r())},n.showRequirementSelector=function(e,t){n.setState({parentSelectorStatus:e,isParentModified:!!t,currentSubTask:t||null})},n.onIsFullWidthChange=function(e){n.setState({isFullWidth:e})},n.fetchTestCase=function(e){var t=n.props.currentProject,a=n.state.detailInfoState.code;(0,D.fetchTestCase)(t.id,a,{code:a,keyword:e}).then((function(e){var t=e.data;n.setState({availableTestCase:t})}))},n.associateTestCase=function(e){var t=n.props.currentProject,a=n.state.detailInfoState.code;(0,D.associateTestCase)(t.id,a,{caseId:e}).then((function(){(0,G.success)((0,S.t)("\u66f4\u65b0\u6210\u529f")),n.fetchAssociatedTestCase(),n.fetchTestCase()}))},n.cancelAssociateTestCase=function(e){var t=n.props.currentProject,a=n.state.detailInfoState.code;(0,D.cancelAssociateTestCase)(t.id,a,e).then((function(){(0,G.success)((0,S.t)("\u66f4\u65b0\u6210\u529f")),n.fetchAssociatedTestCase(),n.fetchTestCase()}))},n.cancelChooseTestCase=function(){return n.setState({isShowItemPlaceholder:Tt(Tt({},n.state.isShowItemPlaceholder),{},{associateTestCase:!1})})},n.toggleFullScreenStatus=function(){var e=!n.state.isFullScreen;n.setState({isFullScreen:e}),(0,Je.setIsSlideFullScreen)(e),n.props.onFullScreenChange&&n.props.onFullScreenChange(e)},n.handleFullScreenKey=function(e){n.state.isDesEditing||e.target===document.body&&"f"===e.key.toLowerCase()&&n.toggleFullScreenStatus()},n.state={tooltipTitle:(0,S.t)("\u590d\u5236\u94fe\u63a5"),noHoverIcon:!1,useOld:!1,detailInfoState:e.detailInfo,references:{},activities:[],subTasks:[],description:e.detailInfo.descriptionMarkup,markdown:e.detailInfo.description,slateRaw:e.detailInfo.slateRaw,showCopyModal:!1,attachmentsState:n.combineThirdLinks(e.detailInfo.files,e.detailInfo.thirdLinks),isFilePreviewVisible:void 0,previewFileID:void 0,attributes:{assignee:void 0,priority:void 0,requirementType:void 0,startDate:void 0,dueDate:void 0,projectModule:void 0,workingHours:void 0,estimatedWorkHour:void 0,labels:[],watchers:[],fields:{},progress:void 0,defectSourceId:void 0,wuKongReloadId:void 0,serialNum:void 0,rblkhxgProperty:void 0,rblsjxgProperty:void 0,systemsId:void 0,participants:[],programId:0,selectedProgram:{},milestone:void 0,groupTeamId:void 0,defectKindIds:[],defectPhaseId:void 0,softwareUnitDTO:[]},defectSource:e.detailInfo.defectSource,assignee:e.detailInfo.assignee,watchers:e.detailInfo.watchers||[],iterationList:[],versionList:[],relationTests:[],citedSources:{},citingSources:{},isInited:!1,isHistoryRecordVisible:!1,currentLogId:void 0,isCreateSubTasksVisible:!1,subTasksInput:"",subTasksInputVisible:!1,parentSelectorStatus:!1,isRequirementCreationModalVisible:!1,convertRequirementInfo:null,currentSubTask:null,showSideslip:!1,isSensitive:!1,showDeleteModal:!1,isShowApproveCreate:!1,issueReviewList:[],activitiesTab:"ALL",activeLogTab:"activity",isCommentSticky:!1,isCommentAbsBottom:!1,isScrolled:!1,inputFocus:!1,availableRequirements:[],isDesEditing:!1,isFullScreen:(0,Je.getIsSlideFullScreen)(),isFullWidth:!0,isShowItemPlaceholder:{description:!0,subtask:!1,associateTestCase:!1,workItem:!1,codeRepo:!1,reference:!1,blockingRelation:!1},isRender:{feedBack:!1,subTask:!1,workItem:!1,codeRepo:!1,blockingRelation:!1,reference:!1,logs:!1,comment:!1,associateTestCase:!1,switchQuestion:!1},isRenderAll:!1,manHourRecords:[],delFileId:void 0,showDeleteConfirmModal:!1,isElemScroll:!1,scrollControl:Date.now(),relateRequirementSearchStr:"",feedBackList:[],associatedTestCase:[],availableTestCase:[],isAssociatedTestCaseFocus:!1,isTestManageOpen:!1,isTestManageLoaded:!0,codeRepoRelationOpened:!1,associatedCodeRepos:[],availableCodeRepos:[],isAssociatedCodeRepoFocus:!1,inProgram:!1,isWorkItemCreationVisible:!1,associatedWorkItems:[],availableWorkItems:[],isAssociatedWorkItemFocus:!1,isEdittingCommentModalVisible:!1,willCreateRequirementIssueType:{},switchIssueList:[],isIterationConfirm:!1,iterationConfirmParams:null,isIterationConfirmText:{MoveOut:{title:"\u786e\u8ba4\u79fb\u51fa\u8fed\u4ee3",desc:"\u4e8b\u9879\u79fb\u51fa\u8fed\u4ee3\uff0c\u4f1a\u9020\u6210\u8fed\u4ee3\u5b8c\u6210\u7387\u4e0b\u964d\uff0c\u662f\u5426\u786e\u8ba4\u79fb\u51fa\u5f53\u524d\u8fed\u4ee3?"},MoveIn:{title:"\u786e\u8ba4\u79fb\u5165\u8fed\u4ee3",desc:"\u4e8b\u9879\u79fb\u5165\u8fed\u4ee3\u540e\uff0c\u4f1a\u6c38\u4e45\u7b97\u4f5c\u8fed\u4ee3\u4e8b\u9879\u57fa\u6570\uff0c\u4f1a\u5f71\u54cd\u8fed\u4ee3\u5b8c\u6210\u7387\u7684\u8ba1\u7b97\uff0c\u662f\u5426\u786e\u8ba4\u79fb\u5165\u5f53\u524d\u8fed\u4ee3?"},ToTarget:{title:"\u786e\u8ba4\u79fb\u51fa\u8fed\u4ee3",desc:"\u4e8b\u9879\u79fb\u51fa\u5f53\u524d\u8fed\u4ee3\uff0c\u4f1a\u9020\u6210\u5f53\u524d\u8fed\u4ee3\u5b8c\u6210\u7387\u4e0b\u964d\u3002\u540c\u65f6\uff0c\u4e8b\u9879\u4f1a\u79fb\u5165\u65b0\u7684\u8fed\u4ee3\u540e\uff0c\u4f1a\u6c38\u4e45\u7b97\u4f5c\u65b0\u8fed\u4ee3\u4e8b\u9879\u57fa\u6570\uff0c\u4f1a\u5f71\u54cd\u65b0\u8fed\u4ee3\u5b8c\u6210\u7387\u7684\u8ba1\u7b97\uff0c\u662f\u5426\u786e\u8ba4\u6b64\u64cd\u4f5c?"}},controlHideButtonActionMore:0,controlHideOptionMore:0,codeManagementOpen:!1,testManagementOpen:!1,pageId:e.detailInfo.pageId||void 0,historyId:void 0,isDescriptionEmpty:!e.detailInfo.description.replace(/\n|\s/g,""),controlCaculatePos:0,isDescriptionBtnFixed:!1,identity:"",slotVisible:!1,showCopyIssues:!1},n.onVisibleChange=n.onVisibleChange.bind((0,p.default)(n)),n.onCopyClick=n.onCopyClick.bind((0,p.default)(n)),n.getActivityList=n.getActivityList.bind((0,p.default)(n)),n.postComment=n.postComment.bind((0,p.default)(n)),n.deleteComment=n.deleteComment.bind((0,p.default)(n)),n.onNameChange=n.onNameChange.bind((0,p.default)(n)),n.toggleCopyModal=n.toggleCopyModal.bind((0,p.default)(n)),n.deleteIssue=n.deleteIssue.bind((0,p.default)(n)),n.callback=n.callback.bind((0,p.default)(n)),n.updateIssue=n.updateIssue.bind((0,p.default)(n)),n.onStatusChange=n.onStatusChange.bind((0,p.default)(n)),n.submitTitleChange=n.submitTitleChange.bind((0,p.default)(n)),n.updateIssueDescription=n.updateIssueDescription.bind((0,p.default)(n)),n.handleDeleteAttachment=n.handleDeleteAttachment.bind((0,p.default)(n)),n.onFileDropSuccess=n.onFileDropSuccess.bind((0,p.default)(n)),n.onFileDropDelete=n.onFileDropDelete.bind((0,p.default)(n)),n.onFileDropCancel=n.onFileDropCancel.bind((0,p.default)(n)),n.onFileDropFail=n.onFileDropFail.bind((0,p.default)(n)),n.fileUpload=n.fileUpload.bind((0,p.default)(n)),n.filePreviewHide=n.filePreviewHide.bind((0,p.default)(n)),n.previewItem=n.previewItem.bind((0,p.default)(n)),n.handleDelInPreviewFile=n.handleDelInPreviewFile.bind((0,p.default)(n)),n.changeAttributes=n.changeAttributes.bind((0,p.default)(n)),n.getIterationList=n.getIterationList.bind((0,p.default)(n)),n.getVersionList=n.getVersionList.bind((0,p.default)(n)),n.onIterationChange=n.onIterationChange.bind((0,p.default)(n)),n.getResourceReference=n.getResourceReference.bind((0,p.default)(n)),n.onRemoveReference=n.onRemoveReference.bind((0,p.default)(n)),n.toggleRecord=n.toggleRecord.bind((0,p.default)(n)),n.viewRecord=n.viewRecord.bind((0,p.default)(n)),n.handleRemoveEpic=n.handleRemoveEpic.bind((0,p.default)(n)),n.handleModifyParentIssue=n.handleModifyParentIssue.bind((0,p.default)(n)),n.convertIntoRequirement=n.convertIntoRequirement.bind((0,p.default)(n)),n.toggleRequirementCreationModal=n.toggleRequirementCreationModal.bind((0,p.default)(n)),n.handleConvertRequirementCallback=n.handleConvertRequirementCallback.bind((0,p.default)(n)),n.openSlideslip=n.openSlideslip.bind((0,p.default)(n)),n.closeSlideslip=n.closeSlideslip.bind((0,p.default)(n)),n.fetchManHourRecordsAndFetchSpecData=n.fetchManHourRecordsAndFetchSpecData.bind((0,p.default)(n)),n.handleDeleteAttachmentConfirm=n.handleDeleteAttachmentConfirm.bind((0,p.default)(n)),n.handleEditCommentCallback=n.handleEditCommentCallback.bind((0,p.default)(n)),n.commentEditorRef=null,n.intoDesCount=0,n.intoCommentCount=0,n.commentStickyContainerRef=null,n.onScroll=n.onScroll.bind((0,p.default)(n)),n.desComp=null,n.headerRef=I.default.createRef(),n.hiddenHeaderRef=I.default.createRef(),n.detailBodyRef=I.default.createRef(),n.desComp=null,n.attechmentRef=I.default.createRef(),n.subtaskInputRef=I.default.createRef(),n.editorRef=I.default.createRef(),n.changeTabFn=null,n.elemShow(),n.handleIterationChangeConfirm=n.handleIterationChangeConfirm.bind((0,p.default)(n)),n}return(0,f.default)(a,[{key:"combineThirdLinks",value:function(e,t){if(!t)return e;var a=t.map((function(e){var t="MODAO"===e.thirdType,a="CODESIGN"===e.thirdType,n=t?e.title||(0,S.t)("\u58a8\u5200\u9644\u4ef6"):a?e.title:"";return Tt(Tt({},e),{},{isModao:t,isCodesign:a,fileId:e.id,name:n,preview:t&&e.link})})),n=[].concat((0,c.default)(e),(0,c.default)(a));return n.sort((function(e,t){return(e.createdAt||e.created_at)-(t.createdAt||t.created_at)})),n}},{key:"headerRender",value:function(e){var t=this,a=this.state,n=a.detailInfoState,i=a.watchers,r=a.isDesEditing,s=a.isFullWidth,l=a.inputFocus,c=a.isFullScreen,u=!e&&this.state.isScrolled,d=this.props,f=d.projectPath,p=d.isDetail,m=d.issueList,h=d.isPermissible,v=d.user,g=d.location.query,E=d.currentProject,b=d.currentProjectCooperateSettings,y=d.browserRouter,T=d.callFrom,C=(d.issueCode,d.params.epicCode,d.zipRes),P=d.detailInfo,w=E.name,D="outer"===T,O=m&&m.find((function(e){return e.code===n.code})),R=m&&m.findIndex((function(e){return e.code===n.code}))+1,k=1===R,N=R===(m&&m.length),L=h([{function:re.ProjectPermissionFunction.PROJECT_ISSUE,action:re.ProjectPermissionAction.UPDATE}]),F=this.getLinkfragment(),_=null,M=null;if(C&&C.data){var x=C.data;if(x[vt.default.getParentDetail]&&x[vt.default.getParentDetail].data){var B,U=null===(B=x[vt.default.getParentDetail])||void 0===B?void 0:B.data;_=null===U||void 0===U?void 0:U.issueExtend,M=null===U||void 0===U?void 0:U.type}}var W={DESCRIPTION:L,UPLOAD:L,SUBTASK:L,LINK_WORK_ITEM:this.state.inProgram&&L,LINK_TEST_CASE:this.state.testManagementOpen&&L,LINK_CODE_REPO:this.state.codeRepoRelationOpened&&L,RELATION:L,REFERENCES:!0,ISSUE_REVIEW:this.state.issueReviewOpen&&L,IS_RISK:!_||0===_.isRisk,ISSUE_TYPE_RISK:"sub_task"!==M},Y=b.COOPERATE_MODE,H=Tt(Tt({},r?{DESCRIPTION:""}:{}),n.iteration&&"COMPLETED"===n.iteration.status&&"SCRUM"===Y?{SUBTASK:(0,S.t)("\u8fed\u4ee3\u5df2\u5b8c\u6210\uff0c\u65e0\u6cd5\u6dfb\u52a0\u5b50\u5de5\u4f5c\u9879")}:{}),V={};e&&(V.position="static",V.visibility="hidden");var G={};Qe.KA_DEFECT_COPY_SWITCH&&(G.copyFunction=this.toggleCopyModal);var z={};Qe.KA_ISSUE_COPY_COMMITID_SWITCH&&(z.copyCommit="bug:".concat(w," #").concat(n.code," ").concat(n.name));var q=(0,rt.getSlotContext)(P,E.id);return I.default.createElement("div",{className:(0,ne.default)(K.default.specHeader,p&&K.default.detail,u&&!r&&K.default.fixed,u&&K.default.noBorder,this.state.inputFocus&&u&&K.default.scrollFocus),ref:e?this.hiddenHeaderRef:this.headerRef,style:V},I.default.createElement("div",{className:(0,ne.default)(K.default.main,u?K.default.fixed:"",c?K.default.fullScreenMain:"",p?K.default.detail:"")},I.default.createElement("div",{className:(0,ne.default)(K.default.headerPanelMenuWrapper,l&&K.default.focus)},this.renderParentsInfo(),I.default.createElement("div",{className:(0,ne.default)(K.default.menus,u&&l&&K.default.hide)},I.default.createElement(ce.default,{type:"DEFECT",projectID:E.id,watchers:i||[],onChange:this.handleAttentionChange,user:v,showTooltip:!0,readOnly:!L,handleSelfChange:this.handleSelfChange}),!p&&!D&&m&&O&&I.default.createElement("div",{className:K.default.divideLine}),!p&&!D&&m&&O&&I.default.createElement("div",{className:"".concat(K.default.preButton," ").concat(k&&K.default.disabled),title:(0,S.t)("\u4e0a\u4e00\u4e2a\u4e8b\u9879"),onClick:function(){if(!k){var e=m[R-2].code;y.push({pathname:"".concat(F).concat(e),query:Tt({},g)})}}}),!p&&!D&&m&&O&&I.default.createElement("div",{className:"".concat(K.default.nextButton," ").concat(N&&K.default.disabled),title:(0,S.t)("\u4e0b\u4e00\u4e2a\u4e8b\u9879"),onClick:function(){if(!N){var e=m[R].code;y.push({pathname:"".concat(F).concat(e),query:Tt({},g)})}}}),I.default.createElement("div",{className:K.default.divideLine}),!p&&I.default.createElement(j.TooltipTrigger,{title:this.state.isFullScreen?(0,S.t)("\u5207\u6362\u5230\u4fa7\u680f(F)"):(0,S.t)("\u5168\u5c4f(F)")},I.default.createElement("div",{className:this.state.isFullScreen?K.default.cancelFullScreenBtn:K.default.toFullScreenBtn,onClick:this.toggleFullScreenStatus})),!p&&I.default.createElement(j.TooltipTrigger,{title:(0,S.t)("\u5728\u65b0\u6807\u7b7e\u9875\u6253\u5f00")},I.default.createElement("div",{className:K.default.openNewLink,onClick:function(){window.open("".concat(f,"/bug-tracking/issues/").concat(n.code,"/detail"),"_blank")}})),I.default.createElement(A.default,(0,o.default)({type:"DEFECT",copyFunction:this.toggleCopyModal,deleteFunction:this.deleteIssue,hasParent:!!n.parent,handleEpic:this.showRequirementSelector,hasEpic:!!n.epic,handleRemoveEpic:this.handleRemoveEpic,currentProject:E,currentProjectCooperateSettings:b,convertIntoRequirement:this.convertIntoRequirement,isShowFullWidthOption:p||!p&&this.state.isFullScreen,issueTypeDetail:n.issueTypeDetail,viewDescriptionVersion:function(){return t.setState({isHistoryRecordVisible:!0})},projectID:E.id,isPermissible:h,copyTitle:n.name,copyLink:"".concat(window.location.origin).concat(f,"/bug-tracking/issues/").concat(n.code,"/detail"),isFullWidth:s,onIsFullWidthChange:this.onIsFullWidthChange,controlHideMore:this.state.controlHideOptionMore},G,z,{slotCallback:function(e){return t.setState({identity:e,slotVisible:!0})},onClickTrigger:function(){t.setState({controlHideButtonActionMore:Date.now()})},fetchCustomTip:this.getDelDefectInfo})))),this.renderTitle(L,!1,e),(!u||u&&!l)&&I.default.createElement(Ae.default,{getActivityList:this.getActivityList,projectType:Y,isDisabled:H,issueType:J.ISSUE_TYPE.DEFECT,issueCode:n.code,issueStatus:n.issueStatus.type,issueStatusName:n.issueStatus.name,projectID:E.id,isShow:W,noThirdLink:!0,onBtnClick:this.onBtnClick,uploadProps:{disabled:!L,currentAttachmentNum:this.state.attachmentsState.length,onHandleAttachments:this.fileUpload},showReward:!1,posType:u,isLoaded:this.isBtnActionLoaded(),controlHideMore:this.state.controlHideButtonActionMore,slotContext:q,onClickTrigger:function(){t.setState({controlHideOptionMore:Date.now()})},onChangeIsRisk:function(){return t.changeAttributes({type:""})},gid:P.id,callback:this.props.updateCallback})))}},{key:"initAttributesData",value:function(e){var t,a,n,i,r,o,s=this.state.attributes;this.setState({attributes:Tt(Tt({},s),{},{assignee:e.assignee&&e.assignee.id||void 0,priority:void 0!==e.priority?e.priority:void 0,defectKindIds:e.defectKinds&&e.defectKinds.length&&e.defectKinds.map((function(e){return e.id+""}))||[],defectPhaseId:e.defectPhase&&e.defectPhase.id+""||void 0,defectType:e.defectType&&e.defectType.id||void 0,startDate:e.startDate||void 0,dueDate:e.dueDate||void 0,projectModule:e.projectModule&&e.projectModule.id||void 0,requirementType:e.requirementType&&e.requirementType.id||void 0,labels:e.labels&&!!e.labels.length&&e.labels.map((function(e){return e.id}))||[],watchers:e.watchers&&!!e.watchers.length&&e.watchers.map((function(e){return e.id}))||[],fields:e.issueSchemeFields||{},workingHours:e.workingHours,estimatedWorkHour:(null===e||void 0===e?void 0:e.estimatedWorkHour)||void 0,progress:e.progress,defectSourceId:(null===e||void 0===e||null===(t=e.defectSource)||void 0===t?void 0:t.id)||void 0,wuKongReloadId:e.wuKongReloadValue,serialNum:e.serialNum,rblkhxgProperty:null===(a=e.rblkhxgProperty)||void 0===a?void 0:a.id,rblsjxgProperty:null===(n=e.rblsjxgProperty)||void 0===n?void 0:n.id,systemsId:null===(i=e.systemDTO)||void 0===i?void 0:i.systemId,participants:e.participants||[],programId:null===e||void 0===e?void 0:e.programId,milestone:null===(r=e.milestone)||void 0===r?void 0:r.id,selectedProgram:e.program,groupTeamId:null===(o=e.groupTeam)||void 0===o?void 0:o.id,softwareUnitDTO:null===e||void 0===e?void 0:e.softwareUnitDTO}),assignee:e.assignee,watchers:e.watchers||[],defectSource:e.defectSource})}},{key:"isBtnActionLoaded",value:function(){return this.state.isTestManageLoaded}},{key:"descriptionBtnClicked",value:function(){var e=this,t=this.editComp;t.show().then((function(){e.setState({isShowItemPlaceholder:Tt(Tt({},e.state.isShowItemPlaceholder),{},{description:!1})},(function(){var a,n,i;null!==(a=e.scrollRef)&&void 0!==a&&a.current&&null!==(n=t.containerRef)&&void 0!==n&&n.current&&null!==(i=e.headerRef)&&void 0!==i&&i.current&&(0,oe.scrollIntoView)(e.scrollRef.current,t.containerRef.current,-e.headerRef.current.offsetHeight-26),t.onHandle()}))}))}},{key:"subtaskBtnClicked",value:function(){var e=this;this.setState({isCreateSubTasksVisible:!0,subTasksInput:"",isShowItemPlaceholder:Tt(Tt({},this.state.isShowItemPlaceholder),{},{subtask:!0})},(function(){(0,oe.scrollRelatedToTopMenu)("subtask-elem",200,e.scrollRef.current),e.subtaskInputRef.current&&e.subtaskInputRef.current.focus()}))}},{key:"relationBtnClicked",value:function(){var e=this;this.setState({isBlockingRelationVisible:!0,controlFocus:Date.now(),isShowItemPlaceholder:Tt(Tt({},this.state.isShowItemPlaceholder),{},{blockingRelation:!0})},(function(){(0,oe.scrollRelatedToTopMenu)("block-relation-input",200,e.scrollRef.current)}))}},{key:"fetchIssueReviewList",value:function(e){var t=this,a=this.props,n=a.currentProject,i=a.detailInfo;(0,$e.fetchIssueReviewList)(n.id,i.code).then((function(a){var n=a.data;t.setState({issueReviewList:n},(function(){e&&e(n)}))}))}},{key:"issue_reviewBtnClicked",value:function(){this.setState({isShowApproveCreate:!0})}},{key:"link_code_repoBtnClicked",value:function(){var e=this;(0,oe.scrollRelatedToTopMenu)("associated-code-repo",200,this.scrollRef.current),this.setState({isShowItemPlaceholder:Tt(Tt({},this.state.isShowItemPlaceholder),{},{codeRepo:!0})},(function(){return e.setState({isAssociatedCodeRepoFocus:!0})}))}},{key:"getAssociatedCodeRepos",value:function(){var e=this,t=this.props.currentProject,a=this.state.detailInfoState.code;return(0,R.fetchExternalAssociatedCodeRepos)(t.id,a).then((function(t){var a=t.data;e.setState({associatedCodeRepos:a.map((function(e){return Tt(Tt({},e),{},{vcsType:"git"})}))})})).finally((function(){return e.dataLoad("codeRepo")}))}},{key:"link_work_itemBtnClicked",value:function(){var e=this;this.setState({isWorkItemCreationVisible:!0,controlFocus:Date.now(),isShowItemPlaceholder:Tt(Tt({},this.state.isShowItemPlaceholder),{},{workItem:!0})},(function(){(0,oe.scrollRelatedToTopMenu)("work-item-relation-input",200,e.scrollRef.current)}))}},{key:"getAssociatedWorkItems",value:function(){var e=this,t=this.props.currentProject,a=this.state.detailInfoState.code;return(0,R.fetchAssociatedWorkItems)(t.name,a).then((function(t){var a=t.data;e.setState({associatedWorkItems:a})})).finally((function(){return e.dataLoad("workItem")}))}},{key:"link_test_caseBtnClicked",value:function(){var e=this;(0,oe.scrollRelatedToTopMenu)("associated-test-case",200,this.scrollRef.current),this.setState({isShowItemPlaceholder:Tt(Tt({},this.state.isShowItemPlaceholder),{},{associateTestCase:!0})},(function(){return e.setState({isAssociatedTestCaseFocus:!0})}))}},{key:"mouseLeave",value:function(e){this["des"===e?"intoDesCount":"intoCommentCount"]=0,this.setState({notUpload:!1})}},{key:"render",value:function(){var e,t,a=this,n=this.props,i=n.params,r=n.currentProject,s=n.user,l=n.enterpriseGlobalKey,c=n.enterpriseName,u=n.expanded,d=n.isDetail,f=n.isPermissible,p=n.projectPath,m=n.domID,h=n.autoshowComment,v=n.currentProjectCooperateSettings,g=n.location,E=n.targetData,b=n.bugSchemeFieldArchives,y=n.detailInfo,T=r.name,C=r.id,P=this.state,w=P.citedSources,D=P.citingSources,O=P.detailInfoState,R=P.showCopyModal,j=P.attachmentsState,k=P.isFilePreviewVisible,A=P.previewFileID,_=P.activities,B=P.description,U=P.markdown,W=P.slateRaw,Y=P.relationTests,H=P.isInited,V=P.isHistoryRecordVisible,G=P.currentLogId,Z=P.subTasks,X=P.isCreateSubTasksVisible,Q=P.subTasksInput,$=P.subTasksInputVisible,ee=P.parentSelectorStatus,te=P.isParentModified,ae=P.currentSubTask,ie=P.isRequirementCreationModalVisible,oe=P.convertRequirementInfo,le=P.showSideslip,ce=P.activitiesTab,fe=P.isCommentSticky,me=P.isFullWidth,ve=P.isShowItemPlaceholder,ge=P.isRender,Se=P.isRenderAll,Ie=P.activeLogTab,Te=P.blockBeforeList,Ce=P.blockAfterList,we=P.isBlockingRelationVisible,De=P.manHourRecords,Oe=P.showDeleteConfirmModal,Re=P.feedBackList,je=P.isEdittingCommentModalVisible,ke=P.willCreateRequirementIssueType,Ne=P.isWorkItemCreationVisible,Ae=P.pageId,Fe=P.historyId,Ue=P.isDescriptionEmpty,We=P.minHeight,He=P.isDescriptionBtnFixed,Ge=P.identity,Ke=P.slotVisible,Je=P.switchIssueList,Xe=(0,rt.getSlotContext)(y,C),$e=f([{function:re.ProjectPermissionFunction.PROJECT_ISSUE,action:re.ProjectPermissionAction.UPDATE}]),it=void 0!==b&&Object.values(b).filter((function(e){return"HOUR_RECORD"===e.issueField.type})).length>0,ct=v&&v.COOPERATE_MODE,ut=this.state.subTasksInputVisible,dt=this.state.notUpload&&(this.state.isDesEditing||this.state.isCommentEditing)||ut||je,pt=v.ISSUE_TYPES.find((function(e){return"SUB_TASK"===e.issueType})),mt=fe?{minHeight:"".concat(We,"px"),position:"relative"}:{position:"relative"},ht=this.state.issueReviewOpen&&this.state.issueReviewList.length>0,vt=[];ge.logs&&vt.push({text:(0,S.t)("\u6d3b\u52a8\u65e5\u5fd7"),value:ot.MATTER_TABS_TYPE.ACTIVITY}),it&&vt.push({text:(0,S.t)("\u5de5\u65f6\u65e5\u5fd7"),value:ot.MATTER_TABS_TYPE.WORK}),ht&&vt.push({text:(0,S.t)("\u5ba1\u6279"),value:ot.MATTER_TABS_TYPE.APPROVAL});var gt=ge.comment&&Ie!==ot.MATTER_TABS_TYPE.WORK&&Ie!==ot.MATTER_TABS_TYPE.APPROVAL&&_.length>0&&ce!==ot.ACTIVITIES_TAB.WITHOUT_COMMENT;return I.default.createElement(Le.default,{currentAttachmentNum:j.length,onHandleAttachments:this.fileUpload,notUpload:dt,notUploadElems:this.getNotUploadElems(),onIntoUploadElems:function(){return a.setState({notUpload:!0})}},I.default.createElement(Ve.default.Provider,{value:{scrollControl:this.state.scrollControl}},I.default.createElement("div",{className:K.default.specWrapper,onScroll:this.onAttrScroll},I.default.createElement("div",{className:(0,ne.default)(K.default.specDetail,d?K.default.isDetail:"",me&&K.default.isFullWidth)},this.headerRender(),this.headerRender(!0),I.default.createElement("div",{className:K.default.specMain,ref:this.scrollRef},I.default.createElement("div",{style:mt,className:(0,ne.default)(K.default.detailWrapper,d&&K.default.isDetail)},I.default.createElement("div",{className:"".concat(K.default.detailBody," ").concat(!u&&K.default.isSingleColumned," ").concat(d&&K.default.isDetail," ").concat(me&&K.default.isFullWidth),ref:this.detailBodyRef,onClick:function(){a.setState({controlHideButtonActionMore:Date.now()})}},I.default.createElement("div",{className:"".concat(K.default.mainWrapper," ").concat(u&&K.default.mainExpanded)},I.default.createElement("div",{onDragEnter:this.dragEnterDes,onDragLeave:this.dragLeaveDes,onMouseLeave:this.mouseLeaveDes,ref:this.editorRef},I.default.createElement(F.default,{editorType:y.issueDescriptionType,issueId:y.id,isInited:H,scrollRef:this.scrollRef,readOnly:!$e,code:O.code,autoSaveKey:"".concat(T,"_ISSUE_DETAIL_DESCRIPTION-").concat(O.code),updateDescription:this.updateIssueDescription,refreshActivity:function(){return a.getActivityList()},updatePageId:function(e){return a.setState({pageId:e})},historyId:Fe,currentProject:r,markdown:U,slateRaw:W,description:B,flashAnchor:this.props.flashAnchor,domID:m,enterpriseGlobalKey:l,getThis:this.getEditComp,editStatusChanged:this.editStatusChanged,isShowPlaceholder:Ue&&ve.description,location:g,userId:s.id,pageId:Ae,setCommentPosition:this.setCommentPosition,onLoad:function(e){a.dataLoad("description"),e&&a.setState({isDescriptionEmpty:e.isEmpty})},isDescriptionBtnFixed:He})),j.length>0&&I.default.createElement("div",{className:K.default.sectionWrapper,ref:this.attechmentRef},I.default.createElement(be.ThemeConsumer,null,(function(e){var t=e.hiddenFolderDirs;return I.default.createElement(z.default,{expanded:u,disabled:!$e,attachments:j,enterpriseGlobalKey:l,currentProjectName:T,currentProjectID:C,currentAttachmentNum:j.length,issueCode:O.code,onHandleAttachments:a.fileUpload,uploadFileSuccess:a.onFileDropSuccess,uploadFileFailed:a.onFileDropFail,uploadFileDelete:a.onFileDropDelete,uploadFileCancel:a.onFileDropCancel,dir:t&&t[J.HIDDEN_FILE_TYPE.DEFECTS]&&t[J.HIDDEN_FILE_TYPE.DEFECTS].file_id,previewItemHandle:a.previewItem,userID:s.id})}))),ge.feedBack&&I.default.createElement("div",{className:K.default.sectionWrapper},I.default.createElement(Ye.default,{feedBackList:Re})),"SCRUM"===ct&&!O.parent&&ge.subTask&&(Z.length>0||ve.subtask)&&I.default.createElement("div",{className:K.default.sectionWrapper},I.default.createElement(ue.default,{params:i,parentType:"bug-tracking",isDetail:d,isRequirementDeletable:!0,projectID:C,currentProject:r,requirementCode:O.code,subItems:Z,isChild:!!O.parentId,handleCreate:this.showTargetModal,callback:this.actionCallback,handleAssociate:this.handleSubTasksCallback,handleSort:this.handleSort,handleModifyParent:this.showRequirementSelector,isPermissible:f,projectPath:p,isEditing:X,iterationFinished:O&&O.iteration&&O.iteration.status&&"COMPLETED"===O.iteration.status,isFullScreen:!d&&this.state.isFullScreen}),X&&I.default.createElement(de.default,{id:"subtask-elem",ref:this.subtaskInputRef,placeholder:(0,S.t)("\u5b50\u5de5\u4f5c\u9879\u6807\u9898\uff08\u6309\u56de\u8f66\u5feb\u901f\u521b\u5efa\uff0cShift + \u56de\u8f66\u5b8c\u6574\u521b\u5efa\uff09"),className:K.default.subtaskCreationInput,value:Q,onChange:this.handleSubTasksInput,onCancel:this.handleSubTasksInputCancel,onCreate:this.handleSubTasksInputCreate,onFullCreate:this.handleSubTasksInputFullCreate,currentProject:r,currentProjectCooperateSettings:v})),Y&&Y.length>0&&I.default.createElement("div",{className:K.default.sectionWrapper},I.default.createElement(L.default,{projectPath:p,relationTests:Y,isPermissible:f})),this.state.testManagementOpen&&ge.associateTestCase&&(this.state.associatedTestCase.length>0||ve.associateTestCase)&&I.default.createElement("div",{className:K.default.sectionWrapper},I.default.createElement(ze.default,{projectPath:p,allowUpdate:$e,list:this.state.associatedTestCase,searchResList:this.state.availableTestCase,isFocus:this.state.isAssociatedTestCaseFocus,onFocusChanged:function(e){return a.setState({isAssociatedTestCaseFocus:e})},onSearch:this.fetchTestCase,onAssociate:this.associateTestCase,onCancelAssociate:this.cancelAssociateTestCase,onCancel:this.cancelChooseTestCase,isDetail:d})),"CLASSIC"===ct&&ge.blockingRelation&&(Te.length>0||Ce.length>0||ve.blockingRelation)&&I.default.createElement("div",{className:K.default.sectionWrapper},I.default.createElement(Pe.default,{projectID:C,issueCode:O.code,scrollTargetId:"block-relation-input",createVisible:we,onCreateVisibleChange:this.handleBlockingRelationVisibleChange,blockBeforeList:Te,blockAfterList:Ce,controlFocus:this.state.controlFocus,callback:this.blockingRelationChanged,allowUpdate:$e,projectPath:p,isDetail:d,currentProject:r,isFullScreen:!d&&this.state.isFullScreen})),ge.switchQuestion&&Je.length>0&&I.default.createElement("div",{className:K.default.sectionWrapper},I.default.createElement(ft.default,{currentProject:r,data:Je,isDelete:!1,headerTitle:(0,S.t)("\u751f\u4ea7\u95ee\u9898"),code:O.code,onRemoveReference:this.onRemoveReference,pro_issue:"PRD_ISSUE"})),ge.workItem&&(this.state.associatedWorkItems.length>0||ve.workItem)&&I.default.createElement("div",{className:K.default.sectionWrapper},I.default.createElement(Ze.default,{projectID:C,projectPath:p,currentProject:r,issueCode:O.code,allowUpdate:$e,scrollTargetId:"work-item-relation-input",createVisible:Ne,onCreateVisibleChange:this.handleWorkItemRelationVisibleChange,controlFocus:this.state.controlFocus,list:this.state.associatedWorkItems,callback:this.workItemRelationChanged,isDetail:d,isFullScreen:!d&&this.state.isFullScreen})),this.state.codeRepoRelationOpened&&ge.codeRepo&&(this.state.associatedCodeRepos.length>0||ve.codeRepo)&&I.default.createElement("div",{className:K.default.sectionWrapper},I.default.createElement(qe.default,{projectPath:p,allowUpdate:$e,list:this.state.associatedCodeRepos,searchResList:this.state.availableCodeRepos,isFocus:this.state.isAssociatedCodeRepoFocus,onFocusChanged:function(e){return a.setState({isAssociatedCodeRepoFocus:e})},onSearch:this.getCodeRepos,onAssociate:this.associateCodeRepo,onCancelAssociate:this.cancelAssociateCodeRepo,onCancel:this.cancelCodeRepo,isDetail:d,isAssociateDetail:!0,enterpriseGlobalKey:l,currentProjectName:null===r||void 0===r?void 0:r.name,editionVersion:null===O||void 0===O||null===(e=O.edition)||void 0===e?void 0:e.editionVersion,onUpdateCodeRepos:this.onUpdateCodeRepos,code:null===O||void 0===O?void 0:O.code,issueType:null===O||void 0===O?void 0:O.type,issueStatusType:null===O||void 0===O||null===(t=O.issueStatus)||void 0===t?void 0:t.type})),ge.reference&&(Object.keys(w).length>0||Object.keys(D).length>0||ve.reference)&&I.default.createElement("div",{className:K.default.sectionWrapper},I.default.createElement(N.default,{flashAnchor:function(e){a.setState({activeLogTab:"activity"},(function(){a.props.flashAnchor(e)}))},currentProject:r,citedSources:w,citingSources:D,markdown:U,autoToggleComment:this.referencesBtnClicked,code:O.code,onRemoveReference:this.onRemoveReference})),vt.length>=2&&I.default.createElement(I.default.Fragment,null,I.default.createElement("div",{id:"activity-log-tab"}),I.default.createElement(Me.default,{tabs:vt,activeTab:Ie,onChange:this.changeActivityLogTab})),ge.logs&&I.default.createElement(I.default.Fragment,null,"activity"===Ie&&this.renderActivity(it),it&&"work"===Ie&&I.default.createElement(xe.default,{detailInfo:O,records:De,onDelete:this.deleteManhourRecord,reloadData:this.fetchManHourRecordsAndFetchSpecData,allowUpdate:$e,schemeFields:this.props.bugSchemeFieldArchives,user:s})),ht&&"approval"===Ie&&I.default.createElement("div",{id:"issue-review-list"},I.default.createElement(et.default,{isDetail:d,list:this.state.issueReviewList,onItemChange:this.handleReviewListChanged,onShowCreate:function(){a.setState({isShowApproveCreate:!0})},onShowDetail:function(e){a.setState({issueReviewCode:e})},allowUpdate:$e}))),I.default.createElement(x.default,{show:R,closeHandle:this.toggleCopyModal,detailInfo:O,callback:this.callback})))),k&&I.default.createElement(q.default,{isShown:k,previewFiles:j,onFileViewerHide:this.filePreviewHide,enterpriseGlobalKey:l,currentId:C,currentProjectName:T,currentFileId:A,onHandleDelAttachment:this.handleDeleteAttachmentConfirm}),$&&pt&&I.default.createElement(pe.default,{parentCode:O.code,title:Q,show:!0,callback:this.actionCallback,closeHandle:this.cancelCreationModal,targetData:E,issueTypeDetail:pt}),V&&I.default.createElement(se.default,{show:V,closeHandle:this.toggleRecord,enterpriseGlobalKey:l,currentProject:r,issueType:J.HISTORY_RESCORDS[O.type],parentDescriptionType:O.issueDescriptionType,issueCode:O.code,pageId:Ae,currentLogId:G,handleUpdate:this.renewDescription,allowUpdate:$e}),ee&&I.default.createElement(he.default,{show:!0,issueCode:O.code,currentSubtaskCode:ae&&ae.code,projectID:C,closeHandle:function(){a.setState({parentSelectorStatus:!1,isParentModified:!1,currentSubTask:null})},currentParentCode:O.parent?O.parent.code:0,onUpdate:this.onParentUpdate,currentProject:r,isModification:te,handleSelect:this.handleModifyParentIssue,currentProjectCooperateSettings:v}),ie&&I.default.createElement(Ee.default,{show:ie,closeHandle:this.toggleRequirementCreationModal,isShowCreateNext:!1,callbackWithData:this.handleConvertRequirementCallback,name:oe.name,description:oe.description,markdown:oe.markdown,defectAttachments:oe.attachments,defectCode:O.code,targetData:E,issueTypeDetail:ke}),I.default.createElement(Be.default,{show:Oe,type:"ATTACHMENT",text:(0,S.t)("\u786e\u5b9a\u8981\u5220\u9664\u5417\uff1f"),onConfirm:function(){a.handleDelInPreviewFile()},onClose:function(){a.setState({showDeleteConfirmModal:!1})}}),le&&I.default.createElement(ye.default,{issueList:Z,parentType:"bug-tracking",getList:function(){return a.getSubTasksList(O.code)},params:i,currentProject:r,projectPath:p,closeSlideslip:this.closeSlideslip,enterpriseName:c,targetData:E}),this.state.isShowApproveCreate&&I.default.createElement(tt.default,{fromIssueId:this.props.detailInfo.id,onItemChange:function(){return a.handleReviewListChanged(!0)},onCancel:function(){return a.setState({isShowApproveCreate:!1})}}),this.state.issueReviewCode&&I.default.createElement(at.default,{allowUpdate:$e,detailCode:this.state.issueReviewCode,onDetailCodeChange:function(e){a.setState({issueReviewCode:e})},onCancel:function(){a.setState({issueReviewCode:void 0},(function(){a.handleReviewListChanged()}))}}),I.default.createElement(nt.default,{slotVisible:Ke,identity:Ge,context:Xe,onClose:function(){return a.setState({slotVisible:!1})}}),Qe.KA_DEFECT_COPY_SWITCH&&I.default.createElement(st.default,(0,o.default)({show:R,closeHandle:this.toggleCopyModal,defectCode:O.code,currentProjectCooperateSettings:v},this.state,this.props,{callback:this.callback})),!Se&&I.default.createElement(_e.default,null),I.default.createElement("div",{id:"bottom"}),gt&&I.default.createElement(M.default,{autoToggleComment:this.props.autoToggleComment,autoshowComment:!!h[O.code],expanded:u,currentProject:r,avatar:s.avatar,issueCode:O.code,onPostComment:this.postComment,isCommentSticky:fe,isCommentAbsBottom:this.state.isCommentAbsBottom,onEditStatusChanged:function(e,t){a.commentEditorRef=t,a.setState({isCommentEditing:e})},onDragEnterEditor:this.dragEnterComment,onDragLeaveEditor:this.dragLeaveComment,onMouseLeaveEditor:this.mouseLeaveComment,isDetail:d,userID:s.id,isDescriptionBtnFixed:this.state.isDescriptionBtnFixed,onRef:function(e){return a.commentStickyContainerRef=e}})),le?I.default.createElement("div",{className:(0,ne.default)(K.default.specAttribute,d||!d&&this.state.isFullScreen?K.default.isDetail:K.default.isSpec,me&&K.default.isFullWidth)}):this.renderAttributes())),this.state.showCopyIssues&&I.default.createElement(lt.default,{user:this.props.user,enterpriseGlobalKey:l,sourceProject:this.props.currentProject,sourceIssueTypeDetail:this.props.issueTypeDetail,sourceIssueCode:this.props.issueCode,callback:this.callback,closeHandle:function(){return a.setState({showCopyIssues:!1})}}))}},{key:"isAssignAttrRequired",value:function(e,t){if(!e||!t)return!1;var a=!1;return Object.keys(e).forEach((function(n){var i=e[n]&&e[n].issueField;i&&i.type===t&&(a=e[n].required)})),a}},{key:"renderAttributes",value:function(){var e,t=this,a=this.props,n=a.isDetail,i=a.isPermissible,r=a.currentProjectCooperateSettings,o=a.projectPath,s=a.expanded,l=a.bugSchemeFieldArchives,u=a.bugUpdateFieldIDs,d=a.currentProject,f=a.bugTypes,p=a.requirementTypes,m=a.moduleSchemes,h=a.labels,v=a.addLabel,g=a.detailInfo,E=a.issueCode,b=(a.ramOnline,a.sourceTypes),y=a.zipRes,T=void 0===y?{}:y,C=a.zipRes2,P=void 0===C?{}:C,w=a.zipRes3,D=void 0===w?{}:w,O=a.zipRes4,R=void 0===O?{}:O,j=this.state,N=j.detailInfoState,A=j.attributes,L=j.assignee,F=j.iterationList,_=j.watchers,M=j.availableRequirements,x=j.isFullWidth,W=j.isInited,H=j.defectSource,G=j.isIterationConfirm,z=j.versionList,q=(0,rt.getSlotContext)(g,d.id),Z=i([{function:re.ProjectPermissionFunction.PROJECT_ISSUE,action:re.ProjectPermissionAction.UPDATE}]),Q=r&&r.ITERATION&&r.ITERATION===J.MODULE_SWITCH.OPENED,$=r&&r.REQUIREMENT&&r.REQUIREMENT===J.MODULE_SWITCH.OPENED,ee=r&&r.STORY_POINT===J.MODULE_SWITCH.OPENED,te=r&&r.STORY_POINT_TYPE===J.STORY_POINT_TYPE.TSHIRT,ie=i([{function:re.ProjectPermissionFunction.PROJECT_ITERATION,action:re.ProjectPermissionAction.UPDATE}]),se=!H||"production"!==H.valueType&&"\u751f\u4ea7"!==H.name?"":H.name,ce=[];if(M){var ue=[];""===this.state.relateRequirementSearchStr&&N.relatedRequirement&&ue.push({isAvailable:!0,code:N.relatedRequirement.code,name:N.relatedRequirement.name,projectId:N.relatedRequirement.projectId,type:N.relatedRequirement.type,issueTypeDetail:N.relatedRequirement.issueTypeDetail}),ue=ue.concat(M),ce=N.relatedRequirement?(0,Ue.default)(ue,"code"):M}var de=(0,c.default)(F||[]);return N.iteration&&-1===de.findIndex((function(e){return e.value===N.iteration.code}))&&de.unshift({value:N.iteration.code,text:N.iteration.name}),I.default.createElement("div",{className:(0,ne.default)(K.default.specAttribute,n||!n&&this.state.isFullScreen?K.default.isDetail:K.default.isSpec,x&&K.default.isFullWidth)},"outer"===this.props.callFrom&&I.default.createElement("div",{className:(0,ne.default)(K.default.issueProperty,n&&K.default.isDetail)},I.default.createElement("div",{className:(0,ne.default)(K.default.label,n&&K.default.isDetail)},(0,S.t)("\u7814\u53d1\u7a7a\u95f4")),I.default.createElement("div",{className:(0,ne.default)(K.default.customBar,n&&K.default.isDetail)},I.default.createElement(Ge.default,{name:this.props.currentProject.display_name,icon:this.props.currentProject.icon,jumpUrl:this.props.currentProject.project_path}))),I.default.createElement("div",{className:(0,ne.default)(K.default.issueProperty,n&&K.default.isDetail)},I.default.createElement("div",{className:(0,ne.default)(K.default.label,n&&K.default.isDetail)},(0,S.t)("\u72b6\u6001")),I.default.createElement(k.default,{className:(0,ne.default)(K.default.step,K.default.customBar,n&&K.default.isDetail),projectID:d.id,project:d,issueCode:E,value:N.issueStatus,onSelect:this.onStatusChange,disabled:!Z,isDetail:n,hoverControlArrow:!0,labelSize:"default",detailType:g.issueTypeDetail.type,detailInfo:g,itemInfo:g,attributes:A,iterationDropdownList:de,versionList:z,bugSchemeFieldArchives:l,currentProjectCooperateSettings:r})),I.default.createElement("div",{className:(0,ne.default)(K.default.issueProperty,n&&K.default.isDetail)},I.default.createElement("div",{className:(0,ne.default)(K.default.label,n&&K.default.isDetail,this.isAssignAttrRequired(l)&&K.default.required)},(0,S.t)("\u5904\u7406\u4eba")),I.default.createElement("div",{className:(0,ne.default)(K.default.customBar,n&&K.default.isDetail)},I.default.createElement(le.default,{disabled:!Z,inProject:!0,projectID:d.id,value:A.assignee||null,onSelect:function(e){return t.changeAttributes({type:"assignee",value:e.id})},onClear:function(){return t.changeAttributes({type:"assignee"})},triggerExtraProps:{initialSelectedItem:L},dropdownStyle:K.default.dropdownStyle,triggerStyle:K.default.triggerStyle,panelCustomStyle:K.default.panelCustomStyle}))),I.default.createElement("div",{className:(0,ne.default)(K.default.issueProperty,n&&K.default.isDetail)},I.default.createElement("div",{className:(0,ne.default)(K.default.label,n&&K.default.isDetail,this.isAssignAttrRequired(l,J.BASE_FIELD_TYPE.PARTICIPANT)&&K.default.required)},(0,S.t)("\u53c2\u4e0e\u4eba")),I.default.createElement("div",{className:(0,ne.default)(K.default.customBar,n&&K.default.isDetail)},I.default.createElement(le.default,{disabled:!Z,value:A.participants.map((function(e){return e.id})),inProject:!0,isMultiple:!0,projectID:d.id,onSelect:function(e){var a=[];a=A.participants.find((function(t){return t.id===e.id}))?A.participants.filter((function(t){return e.id!==t.id})):(0,Y.default)(A.participants,e),t.changeAttributes({type:"participants",value:a})},onClear:function(){return t.changeAttributes({type:"participants",value:[]})},triggerExtraProps:{initialSelectedItem:A.participants},dropdownStyle:K.default.dropdownStyle,triggerStyle:K.default.triggerStyle,panelCustomStyle:K.default.panelCustomStyle}))),Q&&I.default.createElement("div",{className:(0,ne.default)(K.default.issueProperty,n&&K.default.isDetail)},I.default.createElement("div",{className:(0,ne.default)(K.default.label,n&&K.default.isDetail)},(0,S.t)("\u8fed\u4ee3")),I.default.createElement(ae.default,{type:{issueType:"sprint",iconType:"sprint"},clearPlaceholder:(0,S.t)("\u79fb\u51fa\u8fed\u4ee3"),placeholder:(0,S.t)("\u672a\u89c4\u5212\u8fdb\u8fed\u4ee3"),searchable:!0,value:N.iteration&&N.iteration.code||0,projectPath:o,items:de,onSelect:this.onIterationChange,className:(0,ne.default)(K.default.iteration,n&&K.default.iterationInDetail,K.default.customBar,n&&K.default.isDetail),onClear:function(){t.onIterationChange()},disabled:!!N.parentId||!ie,isDetail:n,portalProps:{toRight:this.getDropdownPortalToRight(),portalWrapStyle:{zIndex:1099,width:n?"320px":"280px"},isScroll:this.state.isElemScroll,resetIsScroll:function(){t.setState({isElemScroll:!1})}}})),Q&&G&&I.default.createElement(pt.default,{className:mt.default.confirmWrapper,modalStyle:{width:460},buttonStyle:{flexSpaceAround:!0},onCancel:function(){t.setState({isIterationConfirm:!1,iterationConfirmParams:null})},onHide:function(){t.setState({isIterationConfirm:!1,iterationConfirmParams:null})},show:G,callback:function(){t.setState({isIterationConfirm:!1},(function(){return t.handleIterationChangeConfirm()}))},title:this.formatTypeText("title"),confirmText:(0,S.t)("\u786e\u8ba4"),hideText:(0,S.t)("\u53d6\u6d88")},I.default.createElement("p",null,this.formatTypeText("desc"))),$&&I.default.createElement("div",{className:(0,ne.default)(K.default.issueProperty,n&&K.default.isDetail)},I.default.createElement("div",{className:(0,ne.default)(K.default.label,n&&K.default.isDetail)},(0,S.t)("\u5173\u8054\u9700\u6c42")),I.default.createElement(ae.default,{requireCode:!0,type:N.relatedRequirement&&N.relatedRequirement.issueTypeDetail||null,placeholder:(0,S.t)("\u672a\u5173\u8054\u9700\u6c42"),clearPlaceholder:(0,S.t)("\u89e3\u9664\u5173\u8054"),searchable:!0,singleReturn:!0,disabled:!Z,value:N.relatedRequirement?N.relatedRequirement.code:null,projectPath:o,items:ce,selectedItem:N.relatedRequirement,onSearch:function(e){t.setState({relateRequirementSearchStr:e}),t.getRequirements(e)},onSelect:function(e){var a=e,n=(0,B.default)(t.state.detailInfoState,(function(e){e.relatedRequirement=a}));t.setState({detailInfoState:n}),t.updateRelatedRequirement(a.code)},onClear:function(){var e=(0,B.default)(t.state.detailInfoState,(function(e){e.relatedRequirement=void 0}));t.setState({detailInfoState:e}),t.updateRelatedRequirement(0)},className:(0,ne.default)(K.default.iteration,n&&K.default.iterationInDetail,K.default.customBar,n&&K.default.isDetail),isDetail:n,portalProps:{toRight:this.getDropdownPortalToRight(),popDropdownMenuWidth:n?320:280,portalWrapStyle:{zIndex:1099,width:n?"320px":"280px"},isScroll:this.state.isElemScroll,resetIsScroll:function(){t.setState({isElemScroll:!1})}}})),ee&&I.default.createElement("div",{className:(0,ne.default)(K.default.issueProperty,n&&K.default.isDetail)},I.default.createElement("div",{className:(0,ne.default)(K.default.label,n&&K.default.isDetail)},(0,S.t)("\u6545\u4e8b\u70b9")),I.default.createElement("div",{className:(0,ne.default)(K.default.customBar,n&&K.default.isDetail)},I.default.createElement(ge.default,{useSize:te,value:N.storyPoint,disabled:!Z,onSelect:function(e){t.updateIssue({storyPoint:e})},onClear:function(){t.updateIssue({storyPoint:-1})},dropdownStyle:K.default.dropdownStyle,triggerStyle:K.default.triggerStyle,panelCustomStyle:K.default.panelCustomStyle}))),"defect"===this.props.issueTypeDetail.type&&I.default.createElement(ht.default,{status:"isEdit",getInnerVersionList:this.getVersionList,getVersion:function(e){return e},labelStyle:(0,ne.default)(K.default.label,n&&K.default.isDetail),boxStyle:(0,ne.default)(K.default.issueProperty,n&&K.default.isDetail),projectId:d.id,onChange:this.changeAttributes,planDateValue:N.planDate,versionValue:N.edition,isSetDropdownPanelWidth:!0,issueId:N.id,planDateCustomID:null===(e=Object.values(l).find((function(e){var t;return"\u8ba1\u5212\u4e0a\u7ebf\u65e5\u671f"===(null===(t=e.issueField)||void 0===t?void 0:t.name)})))||void 0===e?void 0:e.issueFieldId,updateActivity:function(){t.getActivityList()},isFieldUpdate:!0,updateVersions:function(e){var a={editionId:e};t.updateIssue(a)}}),I.default.createElement("div",{className:K.default.splitLine,style:{marginTop:"16px"}}),W&&I.default.createElement(X.default,{user:this.props.user,expanded:s,className:K.default.issueProperties,isCreate:!1,schemeFieldArchives:l,fieldIds:u,issueType:"DEFECT",onChange:this.changeAttributes,customAttributes:A,assignee:L,watchers:_,isFromDetailPage:n||s,isDetailPage:n,permissionFunction:re.ProjectPermissionFunction.PROJECT_ISSUE,projectID:d.id,currentProject:d,bugTypes:f,sourceTypes:b,requirementTypes:p,moduleSchemes:m,labels:h,addLabel:v,isPermissible:i,detailInfo:g,activities:this.state.activities,productName:se,onManHourUpdate:function(){t.fetchManHourRecords().then((function(){t.changeAttributes({type:""})}))},onForwardLogs:function(){(0,oe.scrollRelatedToTopMenu)("activity-log-tab",200,t.scrollRef.current),t.setState({activeLogTab:"work"})},portalProps:{toRight:this.getDropdownPortalToRight(),portalWrapStyle:{zIndex:1099},isScroll:this.state.isElemScroll,resetIsScroll:function(){t.setState({isElemScroll:!1})}},zipRes:T,zipRes2:P,zipRes3:D,zipRes4:R}),I.default.createElement("div",{className:(0,ne.default)(K.default.createTime,K.default.creatorInfo),title:"".concat(N.creator.name).concat((0,S.t)(" \u521b\u5efa\u4e8e ")).concat((0,U.default)((0,V.timeFormat)(N.createdAt,"YYYY-MM-DD HH:mm:ss")).fromNow())},N.creator.name," ",(0,S.t)("\u521b\u5efa\u4e8e")," ",(0,U.default)((0,V.timeFormat)(N.createdAt,"YYYY-MM-DD HH:mm:ss")).fromNow()),I.default.createElement(it.default,{context:q}))}},{key:"onScroll",value:function(e){var t=this.state,a=t.isDesEditing,n=t.isDescriptionBtnFixed;if(a){var i,r,o,s,l=this.scrollRef.current.scrollTop,c=this.scrollRef.current.getBoundingClientRect().height,u=this.editorRef.current.getBoundingClientRect().height,d=(null===(i=this.commentStickyContainerRef)||void 0===i||null===(r=i.current)||void 0===r?void 0:r.offsetHeight)||0;n=u>=c+l-(null===(o=this.headerRef)||void 0===o||null===(s=o.current)||void 0===s?void 0:s.offsetHeight)-d}this.setState({scrollControl:Date.now(),isDescriptionBtnFixed:n}),clearTimeout(this.scrollRunId),e.stopPropagation(),this.scrollRunId=setTimeout(this.doScroll,50)}},{key:"componentDidMount",value:function(){var e=this.props,t=e.user,a=e.watermark,n=(e.type,e.payed),i=e.isDetail,r=e.params.subIssueCode,o=e.detailInfo,s=e.getLabels,l=e.currentProjectCooperateSettings,c=e.zipRes,u=void 0===c?{}:c,d=u.code,f=u.data;this.scrollRef.current&&this.scrollRef.current.addEventListener("scroll",this.onScroll,!1);var p=(0,Qe.getWatermarkPaymentState)();if(s&&s(),i&&r&&this.openSlideslip(),this.initAttributesData(o),this.getBasicInfo(0===d&&f),o.pageId?this.state.isDescriptionEmpty&&this.dataLoad("description"):this.dataLoad("description"),!p||n){var m=(0,Te.getText)(t);(0,Te.watermarkService)(a,m,i)}l.txcAuthorized&&this.getFeedBackList(),document.addEventListener("keyup",this.handleFullScreenKey)}},{key:"componentWillUnmount",value:function(){var e=this.props,t=e.payed,a=e.isDetail;(0,Qe.getWatermarkPaymentState)()&&!t||(0,Te.removeWatermark)(a),document.removeEventListener("keyup",this.handleFullScreenKey)}},{key:"componentDidUpdate",value:function(e,t){var a=this.props,n=a.params,i=a.detailInfo,r=a.issueCode,o=a.isDetail,s=e.params,l=e.detailInfo;t.controlCaculatePos,this.state.controlCaculatePos;(0,W.default)(s,n)||(n.issueCode!==s.issueCode&&(this.props.getBugScheme(),this.getSubTasksList()),o&&n.subIssueCode?this.openSlideslip():this.closeSlideslip()),(0,W.default)(i,l)||this.updateDetailInfo(r,i)}},{key:"updateDetailInfo",value:function(e,t){var a=this;this.setState(Tt({detailInfoState:t,attachmentsState:(0,c.default)(t.files)},this.isDeleteInFilePreview?{isFilePreviewVisible:!1}:null),(function(){a.isDeleteInFilePreview=!1,a.initAttributesData(t),a.getSubTasksList(e)}))}},{key:"openSlideslip",value:function(){this.setState({showSideslip:!0})}},{key:"closeSlideslip",value:function(){this.setState({showSideslip:!1})}},{key:"getBasicInfo",value:function(e){var t=this,a=this.props,n=a.currentProjectCooperateSettings,i=a.zipRes3,r=void 0===i?{}:i,o=a.zipRes4,s=void 0===o?{}:o,l=this.getFunctionFlags(),u=l.codeManagementOpen,d=l.testManagementOpen,f=l.issueReviewOpen,p=n&&n.COOPERATE_MODE,m=(r.code,r.data,s.code),h=s.data;this.setState({codeManagementOpen:u,testManagementOpen:d,issueReviewOpen:f}),Promise.all([this.props.getBugTypes(e&&e[vt.default.getBugTypes]),this.props.getSourceTypes(e&&e[vt.default.getSourceTypes]),this.props.getRequirementTypes(e&&e[vt.default.getRequirementTypes]),this.props.getModuleSchemes(),this.props.getBugScheme()].concat((0,c.default)(u?[this.getCodeRepoSetting()]:[]),(0,c.default)(f?[this.fetchIssueReviewList()]:[]),[this.getActivityList()])).then((function(){t.setState({isInited:!0})})),this.getSubTasksList(e&&e[vt.default.getSubTasksList]),this.getResourceReference(0===m&&h).then((function(){t.dataLoad("reference")})),this.getConvertedList().then((function(){t.dataLoad("switchQuestion")})),this.getRequirements(),d?(this.fetchAssociatedTestCase(),this.getRelationTests()):this.dataLoad("associateTestCase"),u||this.dataLoad("codeRepo"),this.getIterationList(e&&e[vt.default.getIterationList]),this.fetchManHourRecords(e&&e[vt.default.fetchManHourRecords]),"CLASSIC"===p&&this.fetchBlockingRelationList(e&&e[vt.default.fetchBlockingRelationList])}},{key:"fetchBlockingRelationList",value:function(e){var t=this,a=this.props.currentProject,n=this.state.detailInfoState;e?0===e.code?this.setState({blockBeforeList:e.data.blocked_by,blockAfterList:e.data.blocks},(function(){t.dataLoad("blockingRelation")})):this.dataLoad("blockingRelation"):(0,we.fetchBlockRelation)(a.id,n.code,{blockType:"ALL"}).then((function(e){var a=e.data;t.setState({blockBeforeList:a.blocked_by,blockAfterList:a.blocks},(function(){t.dataLoad("blockingRelation")}))}),(function(){t.dataLoad("blockingRelation")}))}},{key:"toggleRequirementCreationModal",value:function(){var e=this.state.isRequirementCreationModalVisible;this.setState({isRequirementCreationModalVisible:!e})}},{key:"convertIntoRequirement",value:function(e){var t=this.state,a=t.detailInfoState,n=t.markdown,i=t.description,r=t.attachmentsState;this.setState({isRequirementCreationModalVisible:!0,willCreateRequirementIssueType:e,convertRequirementInfo:{name:"".concat((0,S.t)("\u3010\u7f3a\u9677\u8f6c\u9700\u6c42\u3011")).concat(a.name),markdown:"".concat((0,S.t)("\u3010\u8f6c\u81ea\u7f3a\u9677 #")).concat(a.code,"\u3011\n").concat(n),description:"".concat((0,S.t)("<p>\u3010\u8f6c\u81ea\u7f3a\u9677 #")).concat(a.code,"\u3011</p>").concat(i),attachments:(0,c.default)(r)}})}},{key:"handleDeleteModao",value:function(e){var t=this,a=this.props,n=a.currentProject.id,i=a.issueCode;(0,Ce.deleteModao)(n,i,e).then((function(){(0,G.success)((0,S.t)("\u5220\u9664\u6210\u529f")),t.setState({attachmentsState:t.state.attachmentsState.filter((function(t){return t.fileId!==e}))}),t.getActivityList()}))}},{key:"handleConvertRequirementCallback",value:function(e){this.props.updateCallback(e,null,!0),this.getActivityList()}},{key:"fileUpload",value:function(e){var t=this.state.attachmentsState;this.setState({attachmentsState:[].concat((0,c.default)(t),(0,c.default)(e))})}},{key:"filePreviewHide",value:function(e){this.setState({isFilePreviewVisible:e})}},{key:"previewItem",value:function(e){this.setState({previewFileID:e,isFilePreviewVisible:!0})}},{key:"handleDelInPreviewFile",value:function(){var e=this,t=this.state.deleteFileId;this.isDeleteInFilePreview=!0,this.updateIssue({delFileIds:[t]},(function(){e.setState({showDeleteConfirmModal:!1,deleteFileId:void 0})}))}},{key:"handleDeleteAttachmentConfirm",value:function(e,t){this.setState({showDeleteConfirmModal:!0,deleteFileId:t})}},{key:"getRelationTests",value:function(){var e=this,t=this.props,a=t.currentProject,n=t.issueCode;return(0,D.fetchRelationTests)(a.id,n).then((function(t){var a=t.data;e.setState({relationTests:a})}))}},{key:"toggleCopyModal",value:function(){var e=this.state.showCopyModal;this.setState({showCopyModal:!e})}},{key:"onVisibleChange",value:function(){this.setState({tooltipTitle:(0,S.t)("\u590d\u5236\u94fe\u63a5")})}},{key:"onCopyClick",value:function(){this.setState({tooltipTitle:(0,S.t)("\u5df2\u590d\u5236")})}},{key:"onNameChange",value:function(e){var t=(0,B.default)(this.state.detailInfoState,(function(t){t.name=e.target.value}));this.setState({detailInfoState:t})}},{key:"submitTitleChange",value:function(){var e=this,t=this.state.detailInfoState,a=this.props.detailInfo;t.name&&t.name.length<=128?t.name!==a.name&&this.updateIssue({name:t.name.trim()},(function(){e.titleInputRef&&e.titleInputRef.current&&(e.titleInputRef.current.blur(),e.setState({noHoverIcon:!0},(function(){setTimeout((function(){e.setState({noHoverIcon:!1})}),0)}))),e.setState({detailInfoState:Tt(Tt({},t),{},{name:t.name.trim()})})})):(0,G.warning)((0,S.t)("\u8bf7\u8f93\u5165\u4e0d\u8d85\u8fc7128\u4f4d\u7684\u7f3a\u9677\u540d\u79f0"))}},{key:"onStatusChange",value:function(e){return this.updateIssue(e)}},{key:"changeAttributes",value:function(e){var t,a,n=this,i=e.isCustom,r=e.type,o=e.value,s=e.issueFieldId,l=e.customValue,c=e.operationType,d=e.specCallback,f=this.state.attributes,p=this.props.bugSchemeFieldArchives;if(i){var m=f.fields,h=o;!o&&(0,te.default)(m[s])?h=[]:!o&&((0,$.default)(m[s])||(0,ee.default)(m[s])||(0,Q.default)(m[s]))&&(h=null),p[s].issueField.componentType!==Ke.PROPERTY_TYPE_CONSTANTS.SELECT_MEMBER_SINGLE&&p[s].issueField.componentType!==Ke.PROPERTY_TYPE_CONSTANTS.SELECT_ITERATION_SINGLE||(h=o?o.id:null),p[s].issueField.componentType!==Ke.PROPERTY_TYPE_CONSTANTS.SELECT_MEMBER_MULTI&&p[s].issueField.componentType!==Ke.PROPERTY_TYPE_CONSTANTS.SELECT_ITERATION_MULTI||(h=o?o.map((function(e){return e.id})):[]),a={customFieldValueMap:[{id:s,content:h}]}}else switch(r){case"requirementType":a={requirementTypeId:o||0};break;case"defectSourceId":case"priority":case"assignee":a=Tt({},"defectType"===r?{defectTypeId:o||0}:(0,u.default)({},r,o||0));break;case"participants":a=(0,u.default)({},r,o?o.map((function(e){return e.id})):[]);break;case"softwareUnitDTO":a={softwareUnitIds:o?o.map((function(e){return e.id})):[]};break;case"labels":case"watchers":var v=f.labels,g=f.watchers,E="labels"===r?"labelIds":"watchers",b="labels"===r?"delLabelIds":"delWatchers",y="labels"===r?v:g,S=Array.from(new Set(y.concat(o)));if(o)if(S.length===y.length){var I=y.findIndex((function(e){return!o.includes(e)}));a=(0,u.default)({},b,[y[I]])}else a=(0,u.default)({},E,[o[o.length-1]]),"watchers"===r&&(o=S);else a=(0,u.default)({},b,y);break;case"projectModule":a={projectModuleId:o||0};break;case"workingHours":a={workingHours:(null===(t=o)||void 0===t?void 0:t.workingHours)||0,estimatedWorkHour:o||void 0};break;case"progress":a={progress:o||0};break;case"rblkhxgProperty":a={rblkhxg:o||0};break;case"rblsjxgProperty":a={rblsjxg:o||0};break;case"systemsId":a={systemsId:o||0};break;case"groupTeamId":a={groupTeamId:o||0};break;case"programId":a={programId:o?o.id:0,milestoneId:0},c&&(a.operate=c),this.setState({milestone:0,selectedProgram:o||{},programId:o.id});break;case"milestone":a={milestoneId:o||0};break;case"defectKindIds":a={defectKindIds:o||[],defectPhaseId:l};break;case"defectPhaseId":a={defectPhaseId:o||0,defectKindIds:[]};break;default:a=(0,u.default)({},r,o)}"programId"!==r&&this.setState({attributes:Tt(Tt({},f),i?{fields:Tt(Tt({},f.fields),{},(0,u.default)({},s,o))}:(0,u.default)({},r,o))}),this.updateIssue(a).then((function(){d&&d(),"softwareUnitDTO"===r&&n.getCodeRepoSetting()}))}},{key:"deleteIssue",value:function(){var e=this.props,t=e.currentProject,a=e.projectPath,n=e.refreshCallback,i=e.iterationCode,r=e.location,o=r.pathname,s=r.search,l=e.browserRouter,c=e.callFrom,u=this.state.detailInfoState,d=(0,me.currentListPath)(o);(0,D.deleteIssue)(t.id,u.code).then((function(){if((0,G.success)((0,S.t)("\u5220\u9664\u6210\u529f")),"outer"===c)(0,Ne.emitFromPM)({type:"closeSlide"});else if(/detail\/subissues/.test(o))l.push("".concat(a,"/epics/issues/").concat(u.epic.code,"/detail"));else{var e=-1!==d.indexOf("iterations")?"iterations":"releases";l.push("".concat(a,"/").concat(i?"".concat(e,"/").concat(i,"/issues"):"".concat(d,"/issues")).concat(s))}n(!0)}))}},{key:"updateIssue",value:function(e,t){var a=this,n=this.props.currentProject,i=this.state,r=i.detailInfoState,o=i.attachmentsState;return(0,D.modifyIssue)(n.id,r.code,e).then((function(t){var n=t.data;return n.files=a.combineThirdLinks(n.files,n.thirdLinks),a.callback(Tt(Tt({},n),{},{parent:r.parent}),e.statusId),a.getActivityList(),a.fetchManHourRecords(),a.getCodeRepoSetting(),(0,G.success)((0,S.t)("\u66f4\u65b0\u6210\u529f")),t}),(function(t){var n=t.code,i=t.data,s=t.msg;return 8015===n?i.issue_status_id===e.statusId?(a.callback(null,e.statusId),a.getActivityList(),(0,G.success)((0,S.t)("\u66f4\u65b0\u6210\u529f"))):((0,G.danger)((0,S.t)("\u66f4\u65b0\u5931\u8d25\uff0c\u5f53\u524d\u72b6\u6001\u4e0d\u6b63\u786e\u3002")),a.callback(null,i.issue_status_id),a.getActivityList()):((0,G.danger)((0,ie.getErrorMessage)(s)),a.setState({detailInfoState:r,attachmentsState:(0,c.default)(o.filter((function(e){return e.fileId>0})))},(function(){a.initAttributesData(r)}))),t})).finally((function(){"function"===typeof t&&t()}))}},{key:"callback",value:function(e,t){var a=this.props.updateCallback;a&&a(e,t)}},{key:"updateIssueDescription",value:function(e){var t=this,a=this.props,n=a.currentProject,i=a.issueCode;return(0,O.modifyIssueDescription)(n.id,i,Tt({},e)).then((function(e){return(0,Et.clearLocalStorage)(t.props),t.getResourceReference(),e}))}},{key:"getResourceReference",value:function(e){var t=this,a=this.state.detailInfoState,n=this.props.currentProject,i=e&&e[vt.default.fetchCitedResourceReference],r=e&&e[vt.default.fetchCitingResourceReference];return i&&r?new Promise((function(e){0===i.code&&0===r.code&&(t.setState({citedSources:i.data,citingSources:r.data}),e())})):Promise.all([(0,O.fetchCitedResourceReference)(n.id,a.code),(0,O.fetchCitingResourceReference)(n.id,a.code)]).then((function(e){t.setState({citedSources:e[0].data,citingSources:e[1].data})}))}},{key:"onRemoveReference",value:function(){(0,G.success)((0,S.t)("\u53d6\u6d88\u5173\u8054\u6210\u529f")),this.getResourceReference(),this.getActivityList()}},{key:"getActivityList",value:function(e){var t=this,a=this.props.issueCode,n=this.props.currentProject.id;return(0,D.fetchIssueActitvites)(n,a).then((function(a){t.setState({activities:a.data},(function(){e&&e()})),t.dataLoad("logs")}))}},{key:"handleEditCommentCallback",value:function(e){var t=this;this.getActivityList((function(){setTimeout((function(){(0,oe.scrollRelatedToTopMenu)("comment-".concat(e),0,t.scrollRef.current)}))})),this.getResourceReference()}},{key:"postComment",value:function(e,t,a,n,i){var r=this,o=this.scrollRef;return(0,D.addComment)({projectID:e,issueCode:t,content:a,parentID:n}).then((function(e){i&&i(),r.getActivityList((function(){setTimeout((function(){(0,oe.scrollRelatedToTopMenu)("comment-".concat(e.data.id),0,o.current)}))})),r.getResourceReference()}))}},{key:"deleteComment",value:function(e,t,a,n){var i=this;(0,D.deleteComment)(e,t,a).then((function(){n&&n(),i.getResourceReference(),i.getActivityList()}))}},{key:"handleDeleteAttachment",value:function(e,t){t?this.handleDeleteModao(e):this.updateIssue({delFileIds:[e]})}},{key:"onFileDropSuccess",value:function(e){var t=this;if(e.isCanceled)this.setState({attachmentsState:(0,B.default)(this.state.attachmentsState,(function(t){var a=t.findIndex((function(t){return t.timestamp===e.timestamp}));t.splice(a,1)}))});else if(e.isModao||e.isCodesign){(0,G.success)((0,S.t)("\u66f4\u65b0\u6210\u529f"));var a=this.props,n=a.currentProject.id,i=a.issueCode;(0,D.fetchIssueDetail)(n,i,{withDescriptionMarkup:!0}).then((function(e){var a=e.data;t.setState({attachmentsState:t.combineThirdLinks(a.files,a.thirdLinks)},(function(){t.scrollToAttechment()}))})),this.getActivityList()}else this.updateIssue({fileIds:[e.fileId]},(function(){t.scrollToAttechment()}))}},{key:"onFileDropFail",value:function(e){var t=e.timestamp;this.setState({attachmentsState:(0,B.default)(this.state.attachmentsState,(function(e){var a=e.findIndex((function(e){return e.timestamp===t}));e.splice(a,1)}))})}},{key:"onFileDropDelete",value:function(e){var t=e.fileId,a=e.isModao,n=e.isCodesign;this.handleDeleteAttachment(t,a||n)}},{key:"onFileDropCancel",value:function(e){var t=e.timestamp;this.setState({attachmentsState:(0,B.default)(this.state.attachmentsState,(function(e){var a=e.findIndex((function(e){return e.timestamp===t}));e[a].isCanceled=!0}))})}},{key:"getVersionList",value:function(e){this.setState({versionList:e})}},{key:"getIterationList",value:function(e){var t=this;if(!e){var a=this.props.currentProject;return(0,O.fetchIterationList)(a.id).then((function(e){t.setState({iterationList:t.formatIterationList(e.data)})}))}0===e.code&&this.setState({iterationList:this.formatIterationList(e.data)})}},{key:"formatIterationList",value:function(e){return e.map((function(e){return{value:e.code,text:e.name,status:e.status,progress:{finished:e.completedCount,processing:e.processingCount,unstart:e.waitProcessCount}}}))}},{key:"formatIteration",value:function(e){return e?{value:e.code,text:e.name,progress:{finished:e.completedCount,processing:e.processingCount,unstart:e.waitProcessCount}}:null}},{key:"onIterationChange",value:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.props,i=n.currentProject,r=n.iterationCode,o=n.updateCallback,s=this.state.detailInfoState,l=s.iteration&&s.iteration.code||0;if((null===e||void 0===e?void 0:e.value)!==l)if(this.setState({useOld:a}),null===s.iteration&&e&&e.status===Ke.ITERATION_STATUS.PROCESSING)this.setState({isIterationConfirm:!0,iterationConfirmParams:e});else if(s.iteration&&[Ke.ITERATION_STATUS.WAIT_PROCESS,Ke.ITERATION_STATUS.PROCESSING,Ke.ITERATION_STATUS.COMPLETED].includes(s.iteration.status)&&e&&[Ke.ITERATION_STATUS.WAIT_PROCESS,Ke.ITERATION_STATUS.PROCESSING,Ke.ITERATION_STATUS.COMPLETED].includes(e.status)&&([Ke.ITERATION_STATUS.WAIT_PROCESS,Ke.ITERATION_STATUS.COMPLETED].includes(s.iteration.status)&&e.status===Ke.ITERATION_STATUS.PROCESSING||s.iteration.status===Ke.ITERATION_STATUS.PROCESSING&&[Ke.ITERATION_STATUS.WAIT_PROCESS,Ke.ITERATION_STATUS.PROCESSING,Ke.ITERATION_STATUS.COMPLETED].includes(e.status)))this.setState({isIterationConfirm:!0,iterationConfirmParams:e});else if(void 0===e&&s.iteration&&s.iteration.status===Ke.ITERATION_STATUS.PROCESSING)this.setState({isIterationConfirm:!0,iterationConfirmParams:e});else if(a)(0,O.updateIteration)(i.id,s.code,e?e.value:0).then((function(e){var a=e.data;(0,G.success)((0,S.t)("\u66f4\u65b0\u6210\u529f")),o(a),t.callback(),t.getActivityList(),r&&t.props.refreshCallback()}));else{var c={iterationCode:e?e.value:0};this.updateIssue(c)}}},{key:"handleIterationChangeConfirm",value:function(){var e=this,t=this.props,a=t.currentProject,n=t.iterationCode,i=t.updateCallback,r=this.state,o=r.detailInfoState,s=r.iterationConfirmParams;if(r.useOld)(0,O.updateIteration)(a.id,o.code,s?s.value:0).then((function(t){var a=t.data;(0,G.success)((0,S.t)("\u66f4\u65b0\u6210\u529f")),i(a),e.callback(),e.getActivityList(),n&&e.props.refreshCallback(),e.setState({iterationConfirmParams:null})}));else{var l={iterationCode:s?s.value:0};this.updateIssue(l)}}},{key:"toggleRecord",value:function(){var e=this.state.isHistoryRecordVisible;this.setState({isHistoryRecordVisible:!e})}},{key:"viewRecord",value:function(e){var t=e.currentId;this.setState({isHistoryRecordVisible:!0,currentLogId:t})}},{key:"handleModifyParentIssue",value:function(){var e=(0,s.default)(r.default.mark((function e(t){var a,n;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=this.state.currentSubTask,n=this.props.currentProject.id,e.next=5,(0,O.modifyParentIssue)(n,a.code,{parentCode:t.code});case 5:this.showRequirementSelector(!1),this.actionCallback(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),window.console.log(e.t0);case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()},{key:"handleRemoveEpic",value:function(){var e=this,t=this.props,a=t.currentProject,n=t.projectPath,i=t.location.pathname,r=t.browserRouter,o=this.state.detailInfoState;(0,ve.deleteIssueFromEpic)(a.id,o.epic.code,o.code).then((function(){(0,G.success)((0,S.t)("\u53d6\u6d88\u5173\u8054\u6210\u529f")),/detail\/subissues/.test(i)?(r.push("".concat(n,"/epics/issues/").concat(o.epic.code,"/detail")),e.callback()):(e.callback(),e.getActivityList())}))}},{key:"fetchAssociatedTestCase",value:function(){var e=this,t=this.props.currentProject,a=this.state.detailInfoState.code;(0,D.associatedTestCase)(t.id,a).then((function(t){var a=t.data;e.setState({associatedTestCase:a}),e.dataLoad("associateTestCase")}))}}]),a}(I.Component),b.propTypes=Tt(Tt({detailInfo:C.default.object,issueList:C.default.array,projectPath:C.default.string,params:C.default.object,expanded:C.default.bool,isDetail:C.default.bool,currentProject:C.default.object,labels:C.default.array,user:C.default.object,getIssueStatus:C.default.func,getBugScheme:C.default.func,bugTypes:C.default.array,sourceTypes:C.default.array,getBugTypes:C.default.func,moduleSchemes:C.default.array,getModuleSchemes:C.default.func,bugSchemeFieldArchives:C.default.object,bugUpdateFieldIDs:C.default.array,updateCallback:C.default.func,refreshCallback:C.default.func,enterpriseGlobalKey:C.default.string,enterpriseName:C.default.string,watermark:C.default.string,type:C.default.number,payed:C.default.bool,getRequirementTypes:C.default.func,location:C.default.object,issueCode:C.default.oneOfType([C.default.number,C.default.string]),iterationCode:C.default.oneOfType([C.default.number,C.default.string]),autoshowComment:C.default.object,autoToggleComment:C.default.func,domID:C.default.string,flashAnchor:C.default.func,scrollRef:C.default.any},re.WithProjectPermissionProps),{},{currentProjectCooperateSettings:C.default.object,browserRouter:C.default.object,callFrom:C.default.string,getLabels:C.default.func,targetData:C.default.object,ramOnline:C.default.bool}),b.defaultProps={expanded:!0,issueList:[],isDetail:!1},E=y))||E)||E)||E)||E)||E)||E)||E)||E)||E)||E);t.default=Pt},"9Vkv":function(e,t,a){"use strict";a("I5cv"),a("RW0V"),a("ioFf"),a("mYba"),a("jm62"),a("EK0E"),a("XfO3"),a("Btvt"),a("yt8O"),a("rGqo");var n=a("TqRt"),i=a("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("0l/t"),a("f3/d"),a("bWfx");var r,o,s,l=n(a("lSNA")),c=n(a("lwsE")),u=n(a("W8MJ")),d=n(a("PJYZ")),f=n(a("7W2i")),p=n(a("a1gu")),m=n(a("Nsbk")),h=a("mVeg"),v=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!==typeof e)return{default:e};var a=C(t);if(a&&a.has(e))return a.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=r?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}n.default=e,a&&a.set(e,n);return n}(a("cDcd")),g=n(a("K2gz")),E=n(a("17x9")),b=a("nuIr"),y=a("DKcV"),S=a("w3Wo"),I=n(a("KUqB")),T=n(a("W4WD"));function C(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(C=function(e){return e?a:t})(e)}function P(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function w(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?P(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):P(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function D(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,m.default)(e);if(t){var i=(0,m.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,p.default)(this,a)}}var O=(0,y.WithProjectPermission)((s=o=function(e){(0,f.default)(a,e);var t=D(a);function a(e){var n;return(0,c.default)(this,a),(n=t.call(this,e)).getAssignmentTypeList=function(){return n.props.currentProjectCooperateSettings.ISSUE_TYPES.filter((function(e){return"MISSION"===e.issueType}))},n.state={expanded:!1,requirementAvailable:!1},n.hideToggle=n.hideToggle.bind((0,d.default)(n)),n.showToggle=n.showToggle.bind((0,d.default)(n)),n.onToggle=n.onToggle.bind((0,d.default)(n)),n}return(0,u.default)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.handleClick,n=t.isPermissible,i=t.currentProjectCooperateSettings,r=this.state,o=r.expanded,s=r.assignmentAvailable,l=n([{function:y.ProjectPermissionFunction.PROJECT_ISSUE,action:y.ProjectPermissionAction.CREATE}]),c=i.MISSION===b.MODULE_SWITCH.OPENED,u=!l||!s||!c,d=this.getAssignmentTypeList();return v.default.createElement("div",{className:(0,g.default)(T.default.creationWrapper,1===d.length&&T.default.creationWrapperSingle)},v.default.createElement("div",{style:{display:b.KA_DEFECT_EDIT_ENTRY_DISABLE?"none":"flex"},className:(0,g.default)(T.default.creationTrigger,u&&T.default.disabled),onClick:function(){return e.onToggle(u)}},v.default.createElement("span",null,1===d.length?(0,h.t)("\u521b\u5efa{{name}}",{name:d[0].name}):(0,h.t)("\u521b\u5efa\u4efb\u52a1"))),o&&v.default.createElement("div",{className:T.default.dropdownMenu},d.map((function(e){return v.default.createElement("div",{className:T.default.item,onClick:function(){return a(e)},key:e.id},v.default.createElement(I.default,{type:e.iconType,className:T.default.itemIcon}),v.default.createElement("div",{className:T.default.itemName},e.name))}))))}},{key:"componentDidMount",value:function(){this.getStatusFromIssueState()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.hideToggle,!1)}},{key:"onToggle",value:function(e){var t=this.props.handleClick;e||(1!==this.getAssignmentTypeList().length?this.state.expanded?this.hideToggle():this.showToggle():t(this.getAssignmentTypeList()[0]))}},{key:"hideToggle",value:function(){document.removeEventListener("click",this.hideToggle,!1),this.setState({expanded:!1})}},{key:"showToggle",value:function(){this.setState({expanded:!0}),document.addEventListener("click",this.hideToggle,!1)}},{key:"getStatusFromIssueState",value:function(){var e=this,t=this.props.currentProject;return(0,S.fetchIssueInitStatus)(t.id).then((function(t){var a=t.data;e.setState({assignmentAvailable:a.MISSION})}))}}]),a}(v.Component),o.propTypes=w(w({currentProject:E.default.object,handleClick:E.default.func},y.WithProjectPermissionProps),{},{currentProjectCooperateSettings:E.default.object}),r=s))||r;t.default=O},"9W8b":function(e,t,a){e.exports={item:"item-2NZ1d46Haw","item-above":"item-above-188mfD2hBu",itemAbove:"item-above-188mfD2hBu","item-into":"item-into-2kSQvsBkt6",itemInto:"item-into-2kSQvsBkt6","item-below":"item-below-2zLP9DgCLg",itemBelow:"item-below-2zLP9DgCLg","item-last":"item-last-nrpTonG6Ht",itemLast:"item-last-nrpTonG6Ht","item-first":"item-first-1pK1ThcwTU",itemFirst:"item-first-1pK1ThcwTU","item-level0":"item-level0-zaljf_FDTS",itemLevel0:"item-level0-zaljf_FDTS","item-level1":"item-level1-2CRLzW5cko",itemLevel1:"item-level1-2CRLzW5cko","item-level2":"item-level2-NK6AFxPf_b",itemLevel2:"item-level2-NK6AFxPf_b","item-level3":"item-level3-wyqt_DmaTX",itemLevel3:"item-level3-wyqt_DmaTX","item-level4":"item-level4-3NoMife1-h",itemLevel4:"item-level4-3NoMife1-h","item-level5":"item-level5-1g3BRiR0tC",itemLevel5:"item-level5-1g3BRiR0tC","item-level6":"item-level6-1BO0iG-Den",itemLevel6:"item-level6-1BO0iG-Den"}},"9i3m":function(e,t,a){e.exports={filterSort:"filterSort-3NKDa-sn0g",sortBtn:"sortBtn-1vnKe8jeca",pl5:"pl5-3LusSeFnto",flexBetween:"flexBetween-YUTlj_hy4-"}},A2mN:function(e,t,a){"use strict";var n=a("cDcd"),i=a.n(n),r=a("BKNj"),o=a("mVeg"),s=a("7HzJ"),l=a("RoFc"),c=a("O9Lt"),u=a.n(c),d=a("xwLU"),f=a.n(d),p=function(){return(p=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},m=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(a[n[i]]=e[n[i]])}return a},h=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},v=Object(n.forwardRef)((function(e,t){var a=e.dataFetching,n=e.items,r=e.value,l=e.isMultiple,c=e.changeFocusIndex,d=e.mouseFocusEnable,p=e.setMouseFocusEnable,m=e.onListScroll,h=e.onSelect,v=e.focusIndex;return i.a.createElement("div",{className:f.a.list,onScroll:m,ref:t,onMouseMove:function(){p(!0)},onMouseLeave:function(){p(!1),c(void 0)}},!a&&n.length<1&&i.a.createElement("div",{className:f.a.noSearchResult},Object(o.t)("\u65e0\u5339\u914d\u7684\u5c5e\u6027")),n.map((function(e,t){return i.a.createElement("div",{key:e.id,onMouseEnter:function(){return d&&c(t)}},i.a.createElement(s.a,{item:e,value:r,isMultiple:l,onSelect:h,focused:v===t}))})),a&&i.a.createElement(u.a,{show:!0}))}));t.a=Object(n.memo)((function(e){var t=e.items,a=e.value,s=e.dataFetching,c=m(e,["items","value","dataFetching"]),u=h(Object(n.useState)(""),2),d=u[0],f=u[1],g=h(Object(n.useState)(t),2),E=g[0],b=g[1];Object(n.useEffect)((function(){var e=t;d&&(e=null===t||void 0===t?void 0:t.filter((function(e){var t,a;return null===(a=null===(t=null===e||void 0===e?void 0:e.text)||void 0===t?void 0:t.toLowerCase())||void 0===a?void 0:a.includes(d.toUpperCase())}))),b(e)}),[t,d]);return i.a.createElement(r.default,p({value:a,items:E,placeholder:Object(o.t)("\u8bf7\u9009\u62e9\u5c5e\u6027"),dataFetching:s,CustomPanel:v,Trigger:l.a,onSearch:function(e){f(e)}},c))}))},A5Gp:function(e,t,a){"use strict";a.r(t),a.d(t,"DEFAULT_TR_PADDING",(function(){return l})),a.d(t,"TR_HEIGHT",(function(){return c})),a.d(t,"DEFAULT_CELL_MIN_WIDTH",(function(){return u})),a.d(t,"DEFAULT_INDEX",(function(){return d})),a.d(t,"MIN_WIDTH",(function(){return f})),a.d(t,"DEFAULT_WIDTH",(function(){return p})),a.d(t,"STICKY_TYPE",(function(){return m})),a.d(t,"EXCLUDE_SORTABLE_TYPE",(function(){return h})),a.d(t,"PROJECT_CELL_NAME",(function(){return r}));var n,i,r,o=a("z6Fr"),s=a("7bn+"),l=24,c={LOOSE:45,TIGHT:37},u=80,d=1025,f=((n={})[o.a.id]=48,n[o.a.code]=48,n[o.a.title]=200,n[o.a.priority]=48,n[o.a.hourRecord]=96,n[o.a.label]=80,n[o.a.assignee]=100,n[o.a.creator]=100,n[o.a.watcher]=128,n[s.PROPERTY_TYPE_CONSTANTS.SELECT_MEMBER_MULTI]=128,n),p=((i={})[o.a.id]=72,i[o.a.code]=72,i[o.a.title]=480,i[o.a.priority]=80,i[o.a.status]=96,i[o.a.dueDate]=132,i[o.a.hourRecord]=200,i[o.a.label]=200,i[o.a.assignee]=120,i[o.a.creator]=120,i[o.a.watcher]=128,i[o.a.iteration]=160,i[o.a.progress]=96,i[o.a.project]=176,i[o.a.workingHours]=96,i[o.a.rigisteredHours]=96,i[o.a.createdAt]=152,i[o.a.updatedAt]=152,i[o.a.startDate]=152,i[s.PROPERTY_TYPE_CONSTANTS.SELECT_MEMBER_MULTI]=128,i[s.PROPERTY_TYPE_CONSTANTS.SELECT_MEMBER_SINGLE]=120,i[s.PROPERTY_TYPE_CONSTANTS.SELECT_MULTI]=200,i[s.PROPERTY_TYPE_CONSTANTS.SELECT_SINGLE]=120,i[s.PROPERTY_TYPE_CONSTANTS.TEXT_DATE]=120,i[s.PROPERTY_TYPE_CONSTANTS.TEXT_DATETIME]=152,i[s.PROPERTY_TYPE_CONSTANTS.TEXT_SINGLE_LINE]=160,i[s.PROPERTY_TYPE_CONSTANTS.TEXT_MULTI_LINE]=160,i[s.PROPERTY_TYPE_CONSTANTS.TEXT_DECIMAL]=96,i[s.PROPERTY_TYPE_CONSTANTS.TEXT_INTEGER]=96,i),m=["TITLE"],h=["TITLE","ITERATION","PROJECT","CREATOR"];!function(e){e.PROJECT="PROJECT",e.PROGRAM="PROGRAM",e.ALL="ALL"}(r||(r={}))},"A97/":function(e,t,a){"use strict";a("I5cv"),a("RW0V"),a("ioFf"),a("0l/t"),a("mYba"),a("jm62"),a("EK0E"),a("XfO3"),a("Btvt"),a("yt8O"),a("rGqo");var n=a("TqRt"),i=a("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("f3/d"),a("pIFo");var r,o,s,l=n(a("lSNA")),c=n(a("lwsE")),u=n(a("W8MJ")),d=n(a("PJYZ")),f=n(a("7W2i")),p=n(a("a1gu")),m=n(a("Nsbk")),h=a("mVeg"),v=k(a("cDcd")),g=n(a("17x9")),E=n(a("O9Lt")),b=a("w3Wo"),y=n(a("YJB4")),S=n(a("K2gz")),I=n(a("G0so")),T=a("dtw8"),C=a("xgZS"),P=a("Z4vw"),w=a("TJpk"),D=k(a("v3Uf")),O=a("17N+"),R=n(a("TT2u"));function j(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(j=function(e){return e?a:t})(e)}function k(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!==typeof e)return{default:e};var a=j(t);if(a&&a.has(e))return a.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=r?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}return n.default=e,a&&a.set(e,n),n}function N(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function A(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?N(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):N(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function L(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,m.default)(e);if(t){var i=(0,m.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,p.default)(this,a)}}var F={requirements:"requirementCode",assignments:"assignmentCode","bug-tracking":"issueCode"},_=(0,D.default)(r=(0,R.default)((s=o=function(e){(0,f.default)(a,e);var t=L(a);function a(e){var n;return(0,c.default)(this,a),(n=t.call(this,e)).getSubIssueCode=function(){return n.props.params.subIssueCode},n.handleFullScreenChange=function(e){n.setState({isFullScreen:e})},n.state={detailInfo:void 0,isFullScreen:(0,O.getIsSlideFullScreen)()},n.updateCallback=n.updateCallback.bind((0,d.default)(n)),n.refreshCallback=n.refreshCallback.bind((0,d.default)(n)),n.getSpec=n.getSpec.bind((0,d.default)(n)),n}return(0,u.default)(a,[{key:"render",value:function(){var e=this.state,t=e.detailInfo,a=e.isFullScreen,n=this.props,i=n.currentProject,r=n.enterpriseName,o=n.projectPath,s=n.params,l=n.parentType,c="".concat(o,"/").concat(l,"/issues/").concat(s[F[l]],"/detail"),u=a;return v.default.createElement(v.default.Fragment,null,u&&v.default.createElement("div",{className:I.default.fullScreenMask}),v.default.createElement("div",{className:(0,S.default)(I.default.root,I.default.subtaskRoot,"full-screen-style",u&&I.default.fullScreen)},t&&v.default.createElement(w.Helmet,null,v.default.createElement("title",null,"".concat(t.name).concat((0,h.t)(" - \u5b50\u5de5\u4f5c\u9879 - ")).concat(i.display_name," - ").concat(r))),v.default.createElement(T.Link,{className:(0,S.default)(I.default.closeButton,u&&I.default.closeButtonFullScreen),to:c}),v.default.createElement("div",{id:"wm-spec",className:I.default.detailRoot},t?this.getSpec():v.default.createElement(E.default,{show:!0}))))}},{key:"getSpec",value:function(){var e=this.state.detailInfo,t=this.props,a=t.params,n=t.issueList,i=t.largeSize;return v.default.createElement(y.default,{updateCallback:this.updateCallback,refreshCallback:this.refreshCallback,expanded:i,params:a,detailInfo:e,affairList:n,issueCode:this.getSubIssueCode(),issueTypeDetail:e.issueTypeDetail,onFullScreenChange:this.handleFullScreenChange,onCodeChange:this.props.onCodeChange,targetData:this.props.targetData})}},{key:"getDetailInfo",value:function(){var e=this,t=this.props,a=t.params,n=t.currentProject,i=t.projectPath,r=t.closeSlideslip,o=t.browserRouter,s=t.parentType,l="".concat(i,"/").concat(s,"/issues/").concat(a[F[s]],"/detail"),c=this.getSubIssueCode();n.id&&c&&(0,b.fetchIssueDetailByCode)(n.id,c,{withDescriptionMarkup:!0}).then((function(t){var a=t.data;e.setState({detailInfo:a})}),(function(e){var t=e.msg;1400===e.code?((0,C.danger)((0,P.getErrorMessage)(t)),o.replace(i)):((0,C.danger)((0,P.getErrorMessage)(t)),r(),o.replace(l))}))}},{key:"updateCallback",value:function(e){var t=this.props.getList;t&&t(),e?this.setState({detailInfo:e}):this.getDetailInfo()}},{key:"refreshCallback",value:function(){var e=this.props.getList;e&&e()}},{key:"componentDidMount",value:function(){this.getDetailInfo()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.params,a=e.currentProject,n=this.props,i=n.params,r=n.currentProject;(a&&a.id!==r.id||t.subIssueCode!==i.subIssueCode)&&this.setState({detailInfo:void 0})}},{key:"componentDidUpdate",value:function(e){var t=e.params,a=e.currentProject,n=this.props,i=n.params,r=n.currentProject;(r&&r.id!==a.id||t.subIssueCode!==i.subIssueCode)&&this.getDetailInfo()}}]),a}(v.Component),o.propTypes=A(A({params:g.default.object,parentType:g.default.string,enterpriseName:g.default.string,projectPath:g.default.string,currentProject:g.default.object,closeSlideslip:g.default.func,issueList:g.default.array,getList:g.default.func},D.sizeProps),{},{browserRouter:g.default.object,code:g.default.number,onCodeChange:g.default.func,targetData:g.default.object}),r=s))||r)||r;t.default=_},AUsL:function(e,t,a){"use strict";var n=a("cDcd"),i=a.n(n),r=a("faye"),o=a.n(r),s=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(t,a)};return function(t,a){if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),l=function(){return(l=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},c=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(a[n[i]]=e[n[i]])}return a};t.a=function(e){return function(t){function a(){var e=null!==t&&t.apply(this,arguments)||this;return e.state={toTop:!1,toRight:!1},e.calculatePosition=function(t){var a=t.itemsHeight,n=t.itemsWidth,i=t.callback,r=o.a.findDOMNode(e);if(r&&r instanceof Element){var s=0,l=0,c=e.props.parentRef;if(c){var u=c.getBoundingClientRect();s=window.innerHeight-u.bottom,l=u.top}var d=r.getBoundingClientRect(),f=d.top-l,p=window.innerHeight-d.bottom-s,m=window.innerWidth-d.left;e.setState({toTop:!!a&&(!(f<a&&p<a)&&(p<a&&p+a+60<f)),toRight:!!n&&m<n},(function(){i&&i()}))}},e}return s(a,t),a.prototype.render=function(){var t=this.state,a=t.toTop,n=t.toRight,r=this.props,o=(r.parentRef,c(r,["parentRef"]));return i.a.createElement(e,l({},o,{toTop:a,toRight:n,calculatePosition:this.calculatePosition}))},a}(i.a.Component)}},Ad8u:function(e,t,a){e.exports=a.p+"82aff8fa8ec65d5fd0d4c1c329f53866.svg"},AjCu:function(e,t,a){"use strict";var n=a("cDcd"),i=a.n(n),r=a("K2gz"),o=a.n(r),s=a("jQ3A"),l=a.n(s),c=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(t,a)};return function(t,a){if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.toggle=function(){var e=t.props,a=e.checked,n=e.onChange;n&&n(!a)},t}return c(t,e),t.prototype.render=function(){var e=this.props,t=e.className,a=e.checked,n=e.indeterminate,r=e.disabled,s=e.noHoverClass;return i.a.createElement("span",{className:o()([t,l.a.defaultStyle,a&&l.a.checkedStyle,n&&l.a.indeterminateStyle,s&&l.a.hoverDisable,r&&l.a.disabled]),onClick:this.toggle})},t}(i.a.Component);t.a=u},B7Ya:function(e,t,a){"use strict";a.r(t);var n=a("cDcd"),i=a.n(n),r=a("BKNj"),o=a("psb5"),s=a("1bIq"),l=a("necX"),c=a.n(l),u=a("VaZk"),d=function(){return(d=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};t.default=function(e){if(e.pingPuObj){var t=e.itemInfo;return i.a.createElement("div",{className:c.a.dropdwonMargin1},i.a.createElement(u.a,d({},e.pingPuObj,{conditions:t})),i.a.createElement(r.default,d({},e,{isFilter:!0,showPanel:e.show,Trigger:s.a,triggerExtraProps:e.triggerExtraProps,itemExtraProps:e.itemExtraProps,dropdownStyle:c.a.flatTrigger})))}return i.a.createElement(r.default,d({},e,{isFilter:!0,showPanel:e.show,Trigger:o.a,isSpread:!1,triggerExtraProps:e.triggerExtraProps,itemExtraProps:e.itemExtraProps}))}},BHf8:function(e,t,a){e.exports={root:"root-y1vFWV2UR3","skeleton-loading":"skeleton-loading-2PQpUddiTm",skeletonLoading:"skeleton-loading-2PQpUddiTm",square:"square-1aFfEbjgfb",tiny:"tiny-3cY0a-qDjb",rectangle:"rectangle-2dynEq7uTo"}},BJkK:function(e,t,a){"use strict";var n=a("mVeg"),i=a("cDcd"),r=a.n(i),o=a("K2gz"),s=a.n(o),l=a("vih4"),c=a.n(l);t.a=Object(i.memo)((function(e){var t=e.value,a=e.items,i=e.initialSelectedItem,o=e.active,l=e.disabled,u=e.isMultiple,d=e.placeholder,f=void 0===d?Object(n.t)("\u5168\u90e8\u9879\u76ee\u7ba1\u7406"):d,p=e.sliceLength,m=void 0===p?4:p,h=function(){return u?(null===t||void 0===t?void 0:t.length)>0:!!t},v=function(){if(h())return u?t.length>1?(null===i||void 0===i?void 0:i.length)>0?i:t.map((function(e){return a.find((function(t){return t.id===e}))})):(null===i||void 0===i?void 0:i.length)>0?i[0]:a.find((function(e){return e.id===t[0]})):i||a.find((function(e){return e.id===t}))}(),g=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("img",{className:c.a.avatar,src:null===e||void 0===e?void 0:e.media}),r.a.createElement("div",{className:s()(c.a.content)},null===e||void 0===e?void 0:e.name))};return r.a.createElement("div",{className:s()(c.a.trigger,c.a.projectTrigger,o&&c.a.active,l&&c.a.disabled),title:Array.isArray(v)?v.map((function(e){return e.name})).join(","):v?v.name:""},h()?u?function(e){if(Array.isArray(e)){var t=e.slice(0,m);return r.a.createElement("div",{className:c.a.avatarGroup},t.map((function(e,a){return r.a.createElement("img",{key:e.id,className:c.a.avatarItem,src:e.media,style:{zIndex:t.length-a,left:"".concat(-6*a,"px")}})})),e.length>t.length&&r.a.createElement("div",{className:c.a.userCount,style:{zIndex:0,left:"".concat(-6*t.length,"px")}},e.length))}return g(e)}(v):g(v):r.a.createElement("div",{className:s()(c.a.content)},f),r.a.createElement("span",{className:s()(c.a.caret)}))}))},BQhn:function(e,t,a){"use strict";a("I5cv");var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("lwsE")),r=n(a("W8MJ")),o=n(a("7W2i")),s=n(a("a1gu")),l=n(a("Nsbk")),c=n(a("cDcd")),u=n(a("17x9")),d=n(a("BHf8")),f=n(a("K2gz"));function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,l.default)(e);if(t){var i=(0,l.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,s.default)(this,a)}}var m=function(e){(0,o.default)(a,e);var t=p(a);function a(){return(0,i.default)(this,a),t.apply(this,arguments)}return(0,r.default)(a,[{key:"render",value:function(){var e=this.props,t=e.className,a=e.square,n=e.rectangle,i=e.tiny,r=e.style;return c.default.createElement("div",{className:(0,f.default)([d.default.root,t,a?d.default.square:"",n?d.default.rectangle:"",i?d.default.tiny:""]),style:r})}}]),a}(c.default.Component);m.propTypes={className:u.default.string,square:u.default.bool,rectangle:u.default.bool,tiny:u.default.bool,style:u.default.object};var h=m;t.default=h},BXnm:function(e,t,a){"use strict";a.r(t),a.d(t,"StatusTag",(function(){return c})),a.d(t,"StatusSelect",(function(){return b}));var n=a("cDcd"),i=a.n(n),r=a("Slup"),o=a.n(r),s=a("K2gz"),l=a.n(s),c=Object(n.memo)((function(e){var t=e.issueStatus,a=e.style,n=e.className;return i.a.createElement("div",{className:l()(o.a.status,o.a["status-".concat(t.type.toLocaleLowerCase())],n),style:a,title:t.name},t.name)})),u=a("sgW/"),d=a.n(u),f=a("5kKY"),p=a("w3Wo"),m=a("TsYS"),h=a("+3Ur"),v=a("mFAe"),g=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},E=Object(n.memo)((function(e){var t=e.value,a=e.onSelect,r=e.projectID,o=e.issueCode,s=e.disabled,c=e.trigger,u=e.popupStyle,h=e.isPortal,E=void 0!==h&&h,b=e.portalProps,y=e.portalContainer,S=e.portalAlign,I=e.updateTransferObject,T=e.project,C=e.disabledBottomSpace,P=g(Object(n.useState)(!1),2),w=P[0],D=P[1],O=g(Object(n.useState)(!1),2),R=O[0],j=O[1],k=g(Object(n.useState)(0),2),N=k[0],A=k[1],L=g(Object(n.useState)([]),2),F=L[0],_=L[1],M=function(){Object(p.fetchIssueStatusTransfers)(r,o).then((function(e){_(e.data),(null===b||void 0===b?void 0:b.updatePos)&&(null===b||void 0===b||b.updatePos())})).finally((function(){A(Date.now()),j(!1)}))};return i.a.createElement(f.Trigger,{disabled:s,visible:w,onVisibleChange:function(e){R||(e&&(j(!0),I&&I(void 0),M()),D(e))},isPortal:E,portalProps:b,portalContainer:y,portalAlign:S,disabledBottomSpace:C,controlUpdatePos:N,popup:i.a.createElement("div",{className:d.a.popup,style:u},R&&Object(m.loadingDropdown)(),!R&&(F.length>0?F.map((function(e){return i.a.createElement("div",{key:e.id,className:d.a.option,onClick:function(){e.projectIssueTransferAdditionalFields.length>0&&I?I({startIssueStatus:t,transfer:e,callback:a,project:T,issueCode:o}):a({statusId:e.endStatusId})}},i.a.createElement("div",{className:d.a.optionName},e.stepName),i.a.createElement("div",{className:d.a.optionArrow}),i.a.createElement("div",{className:d.a.optionTag},i.a.createElement(v.default,{status:e.endIssueStatus})))})):Object(m.emptyDropdown)()))},c?c(w&&!!F.length,R):i.a.createElement("div",{className:l()(d.a.trigger,s&&d.a.triggerDisabled)},i.a.createElement("div",{className:l()([d.a.status,w?d.a.expanded:""])},i.a.createElement(v.default,{status:t}))))})),b=Object(h.withAttributeFormModalContext)(E)},BqJP:function(e,t,a){"use strict";var n=a("5JFE"),i=a("cDcd"),r=a.n(i),o=a("mVeg"),s=a("DlAp"),l=a("Mdvu"),c=a("te0o"),u=(a("0+fR"),a("dtw8")),d=a("TLfn"),f=function(){return(f=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},p=function(e,t,a,n){return new(a||(a=Promise))((function(i,r){function o(e){try{l(n.next(e))}catch(t){r(t)}}function s(e){try{l(n.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,s)}l((n=n.apply(e,t||[])).next())}))},m=function(e,t){var a,n,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(l){return function(s){if(a)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(a=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(l){s=[6,l],n=0}finally{a=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},h=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},v=Object(u.withRouter)((function(e){var t=e.visable,a=e.onClose,u=e.filterInfo,v=e.getContainer,g=h(n.Form.useForm(),1)[0],E=Object(i.useContext)(s.b).state,b=E.type,y=E.currentProject,S=E.issueType;return r.a.createElement(n.Modal,{title:Object(o.t)("\u91cd\u547d\u540d\u7b5b\u9009\u5668"),visible:t,getContainer:v,onOk:function(){return p(void 0,void 0,void 0,(function(){var t;return m(this,(function(i){switch(i.label){case 0:return[4,g.validateFields()];case 1:return i.sent(),t=f({sharedTeam:u.sharedTeam},g.getFieldsValue(!0)),S!==d.PAGE_TYPE.PRD_REQUIREMENT?[3,3]:[4,Object(c.n)(b,y.id,S,u.value,t,{code:e.router.params.code})];case 2:return i.sent(),[3,5];case 3:return[4,Object(c.m)(b,y.id,S,u.value,t,{code:e.router.params.code})];case 4:i.sent(),i.label=5;case 5:return n.message.success("\u91cd\u547d\u540d\u6210\u529f"),l.default.emit(l.EventBusType.FilterLayout,l.FilterLayoutEventKeys.filterReloadScheme),a(),[2]}}))}))},onCancel:a,bodyStyle:{paddingTop:8},className:"antPModal",zIndex:2031},r.a.createElement(n.Form,{layout:"vertical",form:g},r.a.createElement(n.Form.Item,{name:"name",label:Object(o.t)("\u7b5b\u9009\u5668\u540d\u79f0"),rules:[{required:!0,message:Object(o.t)("\u8bf7\u8f93\u5165\u7b5b\u9009\u5668\u540d\u79f0")},{message:Object(o.t)("\u6700\u5927\u652f\u630120\u4e2a\u5b57\u7b26"),max:20,trigger:"change"}],initialValue:u.text},r.a.createElement(n.Input,{placeholder:Object(o.t)("\u8bf7\u8f93\u5165\u7b5b\u9009\u5668\u540d\u79f0"),maxLength:20}))))})),g=a("XXMN"),E=a("Se5f"),b=a("rkME"),y=a("DKcV"),S=a("G4bb"),I=a("pMd9"),T=a.n(I),C=a("Do0A"),P=a.n(C),w=a("/HJl"),D=a.n(w),O=a("xgZS"),R=a("LvDl"),j=a("DTVk"),k=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o};var N=D()((function(e){return{user:e.APP.user}}))(Object(u.withRouter)((function(e){var t=e.onClick,a=e.filterInfo,u=e.getPopupContainer,f=Object(i.useContext)(s.b),p=f.state,m=p.type,h=p.currentProject,v=p.issueType,I=p.filterSchemes,C=p.projectIdList,w=f.dispatch,D=k(Object(i.useState)(!1),2),N=D[0],A=D[1],L=k(Object(i.useState)(!1),2),F=L[0],_=L[1],M="system"===a.type,x=a.creator===e.user.id,B="team"===m,U=(S.f.getPermission(y.ProjectPermissionFunction.PROJECT_ISSUE_FILTER,y.ProjectPermissionAction.UPDATE),S.f.getPermission(y.ProjectPermissionFunction.PROJECT_ISSUE_FILTER,y.ProjectPermissionAction.DELETE));Object(i.useEffect)((function(){Object(b.isPermissible)("project",h.id,"collaboration:shareFilterConfiguration").then((function(e){_(e)}))}),[]);var W={code:e.router.params.code},Y=r.a.createElement(n.Menu,{style:{width:"190px"},onClick:function(e){var i;if("star"!==e.key)if("unStar"!==e.key)if("delete"!==e.key)if("toSharedTeam"!==e.key)if("cancelSharedTeam"!==e.key){if("cancelTeam"===e.key&&A(!0),"iterationCommon"===e.key){var r={sharedIteration:!a.sharedIteration};Object(c.K)(h.id,W.code,a.value,r).then((function(e){e.data&&(n.message.success(Object(o.t)("\u8bbe\u4e3a\u8fed\u4ee3\u5171\u7528\u7b5b\u9009\u5668\u6210\u529f")),l.default.emit(l.EventBusType.FilterLayout,l.FilterLayoutEventKeys.filterReloadScheme))}))}if("isSpread"===e.key){r={isSpread:1===a.isSpread?0:1};Object(c.I)(h.id,v,a.value,r,W).then((function(e){if(e.data){n.message.success("".concat(e.data.isSpread?Object(o.t)("\u8bbe\u7f6e\u5e73\u94fa\u7b5b\u9009\u6210\u529f"):Object(o.t)("\u53d6\u6d88\u5e73\u94fa\u7b5b\u9009\u6210\u529f"))),l.default.emit(l.EventBusType.FilterLayout,l.FilterLayoutEventKeys.filterReloadScheme);var t=Object(R.cloneDeep)(e.data.content);e.data.isSpread&&(t.conditions=t.conditions.map((function(e){return e.isSpread=1,e}))),w({type:s.a.init,value:{currentFilterScheme:{isDefault:e.data.isDefault,sharedTeam:e.data.sharedTeam,text:e.data.name,type:e.data.isSystem?"system":"custom",value:e.data.id,pin:e.data.pin,isSpread:e.data.isSpread},activeFilterContent:t}})}}))}if("copy"!==e.key)if("default"!==e.key)t(e);else{(v===d.PAGE_TYPE.PRD_REQUIREMENT?Object(c.l)(m,h.id,v,a.value,W):Object(c.k)(m,h.id,v,a.value,W)).then((function(){n.message.success(Object(o.t)("\u8bbe\u7f6e\u9ed8\u8ba4\u6210\u529f")),l.default.emit(l.EventBusType.FilterLayout,l.FilterLayoutEventKeys.filterReloadScheme)}))}else{var u=I[a.value];r={content:u.content,name:u.name,sharedTeam:!1};Object(c.h)(m,h.id,v,r,W).then((function(e){var t=e.data;n.message.success(Object(o.t)("\u7b5b\u9009\u5668\u590d\u5236\u6210\u529f")),l.default.emit(l.EventBusType.FilterLayout,l.FilterLayoutEventKeys.filterReloadScheme,{schemeId:t.id})}))}}else Object(c.a)(a.value).then((function(){n.message.success(Object(o.t)("\u8bbe\u4e3a\u4e2a\u4eba\u7b5b\u9009\u5668\u6210\u529f")),l.default.emit(l.EventBusType.FilterLayout,l.FilterLayoutEventKeys.filterReloadScheme)}));else{var f=[],p=I[a.value].content;if(B&&(null===(i=null===p||void 0===p?void 0:p.conditions)||void 0===i?void 0:i.length)&&p.conditions.map((function(e){var t;"PROJECT"===e.key&&e.value&&e.value.length&&(null===(t=null===e||void 0===e?void 0:e.value)||void 0===t||t.map((function(e){C.includes(e)&&f.push(e)})))})),B&&0===f.length)return void Object(O.danger)(Object(o.t)("\u8bf7\u9009\u62e9\u7814\u53d1\u7a7a\u95f4"));(v===d.PAGE_TYPE.PRD_REQUIREMENT?Object(c.t)(m,h.id,v,a.value,W,f):Object(c.s)(m,h.id,v,a.value,W,f)).then((function(){n.message.success(Object(o.t)("\u8bbe\u4e3a\u56e2\u961f\u7b5b\u9009\u5668\u6210\u529f")),l.default.emit(l.EventBusType.FilterLayout,l.FilterLayoutEventKeys.filterReloadScheme)}))}else{(v===d.PAGE_TYPE.PRD_REQUIREMENT?Object(c.G)(m,h.id,v,a.value,W):Object(c.F)(m,h.id,v,a.value,W)).then((function(){n.message.success(Object(o.t)("\u7b5b\u9009\u5668\u5220\u9664\u6210\u529f")),l.default.emit(l.EventBusType.FilterLayout,l.FilterLayoutEventKeys.filterReloadScheme)}))}else{(v===d.PAGE_TYPE.PRD_REQUIREMENT?Object(c.g)(m,h.id,v,a.value):Object(c.f)(m,h.id,v,a.value)).then((function(){n.message.success(Object(o.t)("\u53d6\u6d88\u661f\u6807\u6210\u529f")),l.default.emit(l.EventBusType.FilterLayout,l.FilterLayoutEventKeys.filterReloadScheme)}))}else{(v===d.PAGE_TYPE.PRD_REQUIREMENT?Object(c.r)(m,h.id,v,a.value):Object(c.q)(m,h.id,v,a.value)).then((function(){n.message.success(Object(o.t)("\u8bbe\u7f6e\u661f\u6807\u6210\u529f")),l.default.emit(l.EventBusType.FilterLayout,l.FilterLayoutEventKeys.filterReloadScheme)}))}}},a.pin?r.a.createElement(n.Menu.Item,{key:"unStar"},Object(o.t)("\u53d6\u6d88\u661f\u6807")):r.a.createElement(n.Menu.Item,{key:"star"},r.a.createElement("div",{className:T.a.flexBetween},Object(o.t)("\u8bbe\u4e3a\u661f\u6807"),r.a.createElement(n.Tooltip,{placement:"right",title:Object(o.t)("\u661f\u6807\u7b5b\u9009\u5668\u4f1a\u7f6e\u9876\u663e\u793a"),getPopupContainer:u},r.a.createElement(g.Question,{style:{color:"#DADFE6"}})))),a.isDefault?null:r.a.createElement(n.Menu.Item,{key:"default"},r.a.createElement("div",{className:T.a.flexBetween},Object(o.t)("\u8bbe\u4e3a\u9ed8\u8ba4"),r.a.createElement(n.Tooltip,{placement:"right",title:Object(o.t)("\u6bcf\u6b21\u56de\u5230\u5f53\u524d\u9875\u9762\u65f6\u9ed8\u8ba4\u8fdb\u5165\u7684\u7b5b\u9009\u5668"),getPopupContainer:u},r.a.createElement(g.Question,{style:{color:"#DADFE6"}})))),a.sharedTeam?B&&x&&r.a.createElement(n.Menu.Item,{key:"cancelSharedTeam",disabled:M,className:T.a.flexBetween},r.a.createElement("div",{className:T.a.flexBetween},r.a.createElement(n.Tooltip,{placement:"top",title:M?Object(o.t)("\u7cfb\u7edf\u7b5b\u9009\u5668\u4e0d\u5141\u8bb8\u8bbe\u4e3a\u4e2a\u4eba\u7b5b\u9009\u5668"):"",getPopupContainer:u},Object(o.t)("\u8bbe\u4e3a\u4e2a\u4eba\u7b5b\u9009\u5668")),r.a.createElement(n.Tooltip,{placement:"right",title:Object(o.t)("\u4ec5\u4e2a\u4eba\u53ef\u89c1\uff0c\u56e2\u961f\u5185\u5176\u5b83\u6210\u5458\u4e0d\u53ef\u89c1"),getPopupContainer:u},r.a.createElement(g.Question,{style:{color:"#DADFE6"}})))):r.a.createElement(n.Menu.Item,{key:"toSharedTeam",disabled:M,className:T.a.flexBetween},r.a.createElement("div",{className:T.a.flexBetween},r.a.createElement(n.Tooltip,{placement:"top",title:M?Object(o.t)("\u7cfb\u7edf\u7b5b\u9009\u5668\u4e0d\u5141\u8bb8\u8bbe\u4e3a\u56e2\u961f\u7b5b\u9009\u5668"):"",getPopupContainer:u},Object(o.t)("\u8bbe\u4e3a\u56e2\u961f\u7b5b\u9009\u5668")),r.a.createElement(n.Tooltip,{placement:"right",title:Object(o.t)("\u56e2\u961f\u6210\u5458\u5747\u53ef\u89c1\u548c\u7f16\u8f91"),getPopupContainer:u},r.a.createElement(g.Question,{style:{color:"#DADFE6"}})))),!B&&!a.sharedIteration&&v===j.IssueType.iteration_issue&&r.a.createElement(n.Menu.Item,{key:"iterationCommon",disabled:M,className:T.a.flexBetween},r.a.createElement("div",{className:T.a.flexBetween},Object(o.t)("\u8bbe\u4e3a\u8fed\u4ee3\u5171\u7528\u7b5b\u9009\u5668"),!!a.sharedIteration&&r.a.createElement(P.a,{className:T.a.checkIcon}))),!B&&r.a.createElement(n.Menu.Item,{key:"isSpread",disabled:M,className:T.a.flexBetween},r.a.createElement("div",{className:T.a.flexBetween},Object(o.t)("\u5e73\u94fa\u7b5b\u9009\u9879"),!!a.isSpread&&r.a.createElement(P.a,{className:T.a.checkIcon}))),(x||a.sharedTeam&&F)&&r.a.createElement(n.Menu.Item,{key:"rename",disabled:M},r.a.createElement(n.Tooltip,{placement:"top",title:M?Object(o.t)("\u7cfb\u7edf\u7b5b\u9009\u5668\u4e0d\u5141\u8bb8\u91cd\u547d\u540d"):"",getPopupContainer:u},Object(o.t)("\u91cd\u547d\u540d"))),r.a.createElement(n.Menu.Item,{key:"copy"},Object(o.t)("\u590d\u5236\u7b5b\u9009\u5668")),"project"===m&&a.sharedTeam&&(F||x)&&r.a.createElement(n.Menu.Item,{key:"cancelTeam"},"\u53d6\u6d88\u56e2\u961f\u5171\u7528"),N&&r.a.createElement(E.default,{modalStyle:{width:460},buttonStyle:{flexSpaceAround:!0},onCancel:function(){A(!1)},onHide:function(){A(!1)},show:N,callback:function(){(null===W||void 0===W?void 0:W.code)?Object(c.b)(h.id,null===W||void 0===W?void 0:W.code,a.value).then((function(){n.message.success("\u53d6\u6d88\u56e2\u961f\u5171\u7528\u7b5b\u9009\u5668\u6210\u529f"),l.default.emit(l.EventBusType.FilterLayout,l.FilterLayoutEventKeys.filterReloadScheme)})):Object(c.c)(h.id,v,a.value).then((function(){n.message.success("\u53d6\u6d88\u56e2\u961f\u5171\u7528\u7b5b\u9009\u5668\u6210\u529f"),l.default.emit(l.EventBusType.FilterLayout,l.FilterLayoutEventKeys.filterReloadScheme)}))},title:"",confirmText:Object(o.t)("\u786e\u8ba4"),hideText:Object(o.t)("\u53d6\u6d88")},r.a.createElement("p",null,"\u786e\u8ba4\u5c06\u7b5b\u9009\u5668\u53d8\u4e3a\u4e2a\u4eba\u7b5b\u9009\u5668\uff1f")),r.a.createElement(n.Menu.Divider,null),(x||a.sharedTeam&&F)&&r.a.createElement(n.Menu.Item,{key:"delete",className:!M&&U?T.a.menuDelete:"",disabled:M||!x&&!U&&a.sharedTeam&&!F},r.a.createElement(n.Tooltip,{placement:"top",title:M?Object(o.t)("\u7cfb\u7edf\u7b5b\u9009\u5668\u4e0d\u5141\u8bb8\u5220\u9664"):"",getPopupContainer:u},Object(o.t)("\u5220\u9664\u7b5b\u9009\u5668"))));return r.a.createElement(n.Dropdown,{getPopupContainer:u,trigger:["click"],overlay:Y},r.a.createElement("span",{className:T.a.moreIcon},r.a.createElement(g.More,{color:"#E6E9ED"})))}))),A=a("TGxl"),L=function(){return(L=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},F=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o};t.a=function(e){var t=e.getPopupContainer,a=e.schemeType,l=void 0===a?"top":a,c=e.searchValue,u=e.setVisible,d=Object(i.useContext)(s.b),f=d.state,p=f.schemesList,m=f.currentFilterScheme,h=f.filterSchemes,g=d.dispatch,E=F(Object(i.useState)(!1),2),b=E[0],y=E[1],S=F(Object(i.useState)({}),2),I=S[0],C=S[1],P=Object(A.d)(),w=function(){return P.current},D=Object(i.useMemo)((function(){return c?p.filter((function(e){return-1!==e.text.indexOf(c)})):p}),[c,p]);return r.a.createElement(r.a.Fragment,null,D&&D.map((function(e){return r.a.createElement("div",{className:"".concat(T.a.menuItem," ").concat("left"===l?T.a.siderItem:""," ").concat(m.value===e.value?T.a.schemeActive:""),key:"".concat(e.value).concat(e.pin)},r.a.createElement("div",{title:e.text,className:T.a.schemeName,onClick:function(){return function(e){var t=h[e.value];g({type:s.a.init,value:{currentFilterScheme:{isDefault:t.isDefault,sharedTeam:t.sharedTeam,text:t.name,type:t.isSystem?"system":"custom",value:t.id,pin:t.pin,isSpread:t.isSpread},activeFilterContent:L({},t.content)}}),u&&u(!1)}(e)}},r.a.createElement("div",{className:T.a.schemeNametext},r.a.createElement(n.Tooltip,{title:e.text,placement:"topLeft"},e.text)),e.isDefault?r.a.createElement("div",null,r.a.createElement(n.Tag,{style:{marginLeft:"8px",color:"#666F80",background:"#E6E9ED"}},Object(o.t)("\u9ed8\u8ba4"))):null,e.sharedTeam?r.a.createElement("div",null,r.a.createElement(n.Tooltip,{title:Object(o.t)("\u56e2\u961f\u6210\u5458\u53ef\u89c1\u548c\u7f16\u8f91")},r.a.createElement("span",{className:T.a.teamIcon}))):null,e.sharedIteration&&r.a.createElement("div",null,r.a.createElement(n.Tooltip,{title:Object(o.t)("\u8fed\u4ee3\u5171\u7528\u7b5b\u9009\u5668")},r.a.createElement("span",{className:T.a.iterationFilter})))),r.a.createElement("div",{className:"".concat(T.a.menu," ").concat(e.pin?T.a.star:"")},e.pin?r.a.createElement("span",{className:T.a.iconStar}):null,r.a.createElement("span",{className:T.a.moreMenu},r.a.createElement(N,{filterInfo:e,getPopupContainer:t||w,onClick:function(t){C(e),function(e){"rename"===e.key&&y(!0)}(t)}}))))})),b?r.a.createElement(v,{getContainer:t||w,visable:b,filterInfo:I,onClose:function(){return y(!1)}}):null)}},C8w1:function(e,t,a){"use strict";a.r(t);var n,i=a("mVeg"),r=a("cDcd"),o=a.n(r),s=a("QOal"),l=a.n(s),c=a("246l"),u=a.n(c),d=a("K2gz"),f=a.n(d),p=a("sftu"),m=a.n(p),h=a("yZ+p"),v=a.n(h),g=a("KUqB"),E=a("z6PH"),b=a.n(E),y=a("gp0q"),S=a.n(y),I=a("vCmj"),T=a.n(I),C=a("AUsL"),P=a("uSpp"),w=a.n(P),D=a("venA"),O=a("L5/0"),R=a.n(O),j=a("hlQ/"),k=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(t,a)};return function(t,a){if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),N=function(){return(N=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},A=function(e,t,a,n){var i,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,a,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(r<3?i(o):r>3?i(t,a,o):i(t,a))||o);return r>3&&o&&Object.defineProperty(t,a,o),o},L=function(e,t){var a=function(e,t){var a=Object(D.splitWithBlankSpace)(R()(e));return t.filter((function(e){var t=e.display_name,n=e.name,i=e.name_pinyin;return a.every((function(e){return R()(t).indexOf(e)>=0||R()(n).indexOf(e)>=0||R()(i).indexOf(e)>=0}))}))}(e,t),n=a.filter((function(e){return e.pin})),i=a.filter((function(e){return!e.pin}));return{filteredProjects:a,pinedProjects:n,unPinedProjects:i,filteredCount:a.length,pinedCount:n.length,unPinedCount:i.length}},F=function(e){function t(t){var a=e.call(this,t)||this;return a.onSearch=function(e){a.setState({keyword:e})},a.state={expanded:!1,filteredProjects:[],pinedProjects:[],unPinedProjects:[],filteredCount:0,pinedCount:0,unPinedCount:0,keyword:""},a.trigger=a.trigger.bind(a),a.onToggle=a.onToggle.bind(a),a}return k(t,e),t.getDerivedStateFromProps=function(e,t){var a=e.items,n=t.keyword;return L(n,a)},t.prototype.itemRender=function(e){var t=e.media,a=e.text,n=this.props.onSelect;return o.a.createElement("div",{className:b.a.item,onClick:function(){return n(e)}},o.a.createElement(S.a,{size:"tiny",shape:"square",src:t}),o.a.createElement("span",{className:b.a.projectPathName,title:a},a))},t.prototype.menuRender=function(){var e=this.state,t=e.filteredProjects,a=e.pinedProjects,n=e.unPinedProjects,r=e.filteredCount,s=e.pinedCount,l=e.unPinedCount,c=e.keyword;return o.a.createElement("div",null,c?o.a.createElement("div",{className:b.a.list},o.a.createElement("div",{className:b.a.sectionTitle},r?"".concat(r).concat(Object(i.t)(" \u4e2a\u7814\u53d1\u7a7a\u95f4")):Object(i.t)("\u65e0\u76f8\u5173\u7814\u53d1\u7a7a\u95f4")),o.a.createElement(w.a,{empty:o.a.createElement("div",null),type:"block"},t.map(this.itemRender,this))):o.a.createElement("div",{className:b.a.list},s>0&&o.a.createElement("div",{className:b.a.sectionTitle},Object(i.t)("\u7f6e\u9876\u7814\u53d1\u7a7a\u95f4")),o.a.createElement(w.a,{empty:o.a.createElement("div",null),type:"block"},a.map(this.itemRender,this)),l>0&&o.a.createElement("div",{className:b.a.sectionTitle},Object(i.t)("\u6700\u8fd1\u8bbf\u95ee")),o.a.createElement(w.a,{empty:o.a.createElement("div",null),type:"block"},n.map(this.itemRender,this))))},t.prototype.trigger=function(){var e,t=this.props,a=t.placeholder,n=t.hasBorder,i=t.isBlock,r=t.className,s=t.value,l=t.items,c=this.state.expanded,u=s?l.find((function(e){return e.value===s})):null;return o.a.createElement("div",{className:f()(b.a.selectTrigger,n&&b.a.hasBorder,i&&b.a.isBlock,r)},o.a.createElement("span",{className:b.a.itemText},u&&o.a.createElement(S.a,{className:b.a.projectTriggerAvatar,src:u.media,size:"tiny",shape:"square"}),o.a.createElement("span",{className:f()((e={},e[b.a.projectPlaceholder]=!u,e))},u?u.name:a)),o.a.createElement("span",{className:"".concat(b.a.selectArrowWrapper," ").concat(c&&b.a.isExpanded)},o.a.createElement("div",{className:j.cartDown})))},t.prototype.render=function(){var e=this.props,t=e.className,a=e.value,n=e.initialSelectedItem,i=e.multiple,r=e.onSelect,s=e.searchable,l=e.searchPlaceholder,c=e.clearable,u=e.onClear,d=e.isMenuTop,p=e.disabled,m=e.toTop,h=e.toRight;return o.a.createElement("div",{className:f()(b.a.select,b.a.inlineDropdown,t,m&&b.a.toTop,h&&b.a.toRight,d&&b.a.menuTop)},o.a.createElement(T.a,N({},{value:a,initialSelectedItem:n,multiple:i,onSelect:r,searchable:s,searchPlaceholder:l,clearable:c,onClear:u,disabled:p},{menu:this.menuRender(),onToggle:this.onToggle,onSearch:this.onSearch}),this.trigger()))},t.prototype.onToggle=function(e){var t=this,a=this.props,n=a.calculatePosition,i=a.searchable,r=a.clearable,o=a.items;if(e)this.setState({expanded:!e});else{n({itemsHeight:36*o.length+(i?42:0)+(r?36:0),itemsWidth:200,callback:function(){t.setState({expanded:!e})}})}},t=A([C.a],t)}(o.a.Component),_=a("xgZS"),M=a("Z4vw"),x=a("O9Lt"),B=a.n(x),U=a("8r0r"),W=a("ZcJI"),Y=a("fLoT"),H=a("/HD1"),V=function(){return(V=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};!function(e){e.FUSION="fusion",e.PROCECT="project-managent"}(n||(n={}));var G=function(){function e(e){this.current=e,this.mode=e.props.issueKey?n.FUSION:n.PROCECT}return e.prototype.changeAssociate=function(){var e=this.current.props,t=e.issueKey,a=e.program,i=e.itemCode,r=this.current.state.selectedIssue;if(r){var o=r.related,s=void 0;switch(this.mode){case n.FUSION:return s={projectId:r.projectId,issueCode:r.code},o?Object(H.workspaceRemoveSplittedIssue)(t,s):Object(H.workspaceSplittingIssues)(t,s);case n.PROCECT:return o?Object(H.workItemRemoveSplittedIssue)(a.name,i,r.id):Object(H.workItemSplittingIssues)(a.name,i,r.id)}}},e.prototype.queryData=function(){var e=this.current.state,t=e.queryProject,a=e.keyword,i=e.curTab,r=e.params,o=this.current.props,s=o.program,l=o.itemCode,c=o.issueKey,u=V({projectId:t||void 0,keyword:a.trim(),issueType:"ALL"===i?void 0:i,lastIssueId:null===r||void 0===r?void 0:r.lastIssueId},!a&&{pageSize:r.pageSize});switch(this.mode){case n.FUSION:return Object(H.getWorkspaceAvailableIssues)(c,u);case n.PROCECT:return Object(H.getAvailableIssues)(s.name,l,u)}},e}(),K=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(t,a)};return function(t,a){if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),z=function(){return(z=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},q=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},Z=function(e,t,a){if(a||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},J=[{name:Object(i.t)("\u5168\u90e8\u4e8b\u9879"),value:"ALL"},{name:Object(i.t)("\u53f2\u8bd7"),value:"EPIC"},{name:Object(i.t)("\u9700\u6c42"),value:"REQUIREMENT"},{name:Object(i.t)("\u4efb\u52a1"),value:"MISSION"},{name:Object(i.t)("\u7f3a\u9677"),value:"DEFECT"}],X=function(e){function t(t){var a=e.call(this,t)||this;return a.timer=null,a.activeRef=null,a.containerRef=null,a.renderKeyboard=function(e,t){return o.a.createElement("div",{className:f()(l.a.keyboardIcon,t&&l.a.hasPadding)},o.a.createElement("div",{className:l.a[e]}))},a.renderResult=function(){var e=a.state,t=e.list,n=e.params,r=e.selectedIssue,s=e.keyword;return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:l.a.tip},s&&n&&n.totalRow?"".concat(Object(i.t)("\u5339\u914d\u5230 ")).concat(n&&n.totalRow).concat(Object(i.t)(" \u4e2a\u76f8\u5173\u7ed3\u679c")):Object(i.t)("\u6700\u8fd1\u521b\u5efa")),t.map((function(e){var t,n;return o.a.createElement("div",{className:f()(l.a.itemBar,r&&r.id===e.id&&l.a.active),key:e.id,onMouseEnter:function(){return a.changeIssue(e)},ref:function(t){return r&&r.id===e.id?a.createRef(t):null}},o.a.createElement("div",{className:l.a.item,onClick:function(){return a.handleAssociate()}},o.a.createElement(g.default,{className:l.a.typeIcon,type:(null===(t=null===e||void 0===e?void 0:e.issueTypeDetail)||void 0===t?void 0:t.iconType)||(null===(n=null===e||void 0===e?void 0:e.type)||void 0===n?void 0:n.toLowerCase())}),o.a.createElement("div",{className:l.a.issueId},"#",e.code),o.a.createElement("div",{className:l.a.issueDetail},e.name),e.related&&o.a.createElement("div",{className:f()(u.a.newButton,u.a.default,l.a.btn)},Object(i.t)("\u5df2\u5173\u8054")),r&&e.id===r.id&&!e.related&&o.a.createElement("div",{className:f()(u.a.newButton,u.a.primary,l.a.btn)},Object(i.t)("\u5173\u8054"),a.renderKeyboard("return",!1))))})),n&&n.hasNext&&o.a.createElement("div",{className:l.a.loadMore},o.a.createElement("div",{className:l.a.loadIcon})))},a.generateProjectItems=function(e){return e.map((function(e){return{id:e.id,value:e.id,name:e.display_name,text:e.display_name,media:e.icon,name_pinyin:e.name_pinyin,pin:e.pin}}))},a.handleKeyDown=function(e){if(9===e.keyCode){e.preventDefault();var t=a.state.curTab,n=J.findIndex((function(e){return e.value===t})),i=0;i=n===J.length-1?0:n+1,a.changeTab(J[i].value)}if(40===e.keyCode||38===e.keyCode){var r=a.state,o=r.selectedIssue,s=r.list,l=o&&s.findIndex((function(e){return e.id===o.id}))||0,c=0;c=40===e.keyCode?l<s.length-1?l+1:s.length-1:l>1?l-1:0,a.changeIssue(s[c],(function(){setTimeout((function(){var e=a.activeRef.offsetTop,t=a.containerRef.clientHeight,n=a.containerRef.offsetTop;e-n>=t-40?a.containerRef.scrollTo({top:e-n-40,smooth:!0}):a.containerRef.scrollTo({top:0,smooth:!0})}))}))}13===e.keyCode&&a.handleAssociate()},a.changeKeyword=function(e){a.setState({keyword:e.target.value,params:{lastIssueId:0},needShowLoading:!0},(function(){a.timer&&window.clearTimeout(a.timer),a.timer=window.setTimeout((function(){a.onSearch()}),300)}))},a.changeProject=function(e){a.setState({queryProject:e,needShowLoading:!0},a.onSearch)},a.changeTab=function(e){a.setState({curTab:e,params:{lastIssueId:0},needShowLoading:!0},(function(){a.onSearch()}))},a.changeIssue=function(e,t){a.setState({selectedIssue:e},(function(){t&&"function"===typeof t&&t()}))},a.onScroll=function(e){var t=a.state,n=t.params,i=t.isLoadingMore,r=e.target.offsetHeight,o=e.target.scrollTop,s=e.target.scrollHeight;!i&&r+o>=s-40&&(null===n||void 0===n?void 0:n.hasNext)&&a.onSearch(!0)},a.onSearch=function(e){var t=a.state,n=t.keyword,i=t.list,r=t.selectedIssue,o=t.isLoadingMore;if(e){if(o)return;a.setState({isLoadingMore:!0})}a.issuesStrategy.queryData().then((function(t){var o=t.data,s=o.issues,l=o.hasNext,c=o.totalRow,u=o.pageSize,d=[];d=Z(e?Z([],q(i),!1):[],q(s),!1),a.setState(z({list:d,params:{hasNext:l,totalRow:c,pageSize:u,lastIssueId:l&&n.length&&s.length?s[s.length-1].id:0}},d.length?{selectedIssue:d.length<=u?d[0]:r}:{selectedIssue:null}))}),(function(e){var t=e.msg;a.handleError(t)})).finally((function(){a.setState({needShowLoading:!1,isLoadingMore:!1})}))},a.handleAssociate=function(){var e=a.props.handleAssociateCb,t=a.state,n=t.selectedIssue,r=t.isAssociating,o=t.list;if(n){if(r)return;a.setState({isAssociating:!0}),a.issuesStrategy.changeAssociate().then((function(){Object(_.success)(n.related?Object(i.t)("\u53d6\u6d88\u5173\u8054\u6210\u529f"):Object(i.t)("\u5173\u8054\u6210\u529f")),a.setState({list:o.map((function(e){return e.id===n.id?z(z({},n),{related:!n.related}):e}))}),e&&"function"===typeof e&&e()}),(function(e){var t=e.msg;a.handleError(t)})).finally((function(){a.setState({isAssociating:!1})}))}},a.handleError=function(e){e&&Object(_.danger)(Object(M.getErrorMessage)(e))},a.state={keyword:"",curTab:"ALL",list:[],queryProject:void 0,projectDetais:void 0,selectedIssue:null,isAssociating:!1,needShowLoading:!0,params:{pageSize:10},isLoadingMore:!1},a.issuesStrategy=new G(a),a}return K(t,e),t.prototype.render=function(){var e=this,t=this.props,a=t.isShown,n=t.onHide,r=t.projects,s=t.issueKey,c=this.state,u=c.keyword,d=c.list,p=c.curTab,h=c.queryProject,g=c.projectDetais,E=c.needShowLoading,b=r?this.generateProjectItems(r):[];return o.a.createElement(m.a,{show:a,className:l.a.issueModal,onHide:n},o.a.createElement("div",{className:l.a.title},Object(i.t)("\u5173\u8054\u4e8b\u9879")),o.a.createElement("div",{className:l.a.close,onClick:n}),o.a.createElement("div",{className:l.a.searchArea},o.a.createElement(v.a,{autoFocus:!0,placeholder:Object(i.t)("\u8f93\u5165 ID \u6216\u6807\u9898\u641c\u7d22\u4e8b\u9879"),size:"medium",value:u,className:l.a.customInput,onChange:this.changeKeyword,prefix:o.a.createElement("div",{className:l.a.searchIcon})}),o.a.createElement("div",{className:l.a.filterBar},s?o.a.createElement(U.b,null,o.a.createElement(U.a.Consumer,null,(function(t){var a=t.projects,n=t.loadMore,i=t.onSearch;return o.a.createElement(W.a,{whichIs:"PROJECT",singleReturn:!0,skipClass:!0,value:void 0===g?[]:[g],list:a,onSearch:i,onSelect:function(t){e.setState({projectDetais:t[0]}),e.changeProject(t[0].id)},onClear:function(){e.setState({projectDetais:void 0}),e.changeProject()},onReachBottom:function(e){e&&n()}},o.a.createElement(Y.a,null))}))):o.a.createElement(F,{value:h,items:b,clearable:!0,searchable:!0,searchPlaceholder:Object(i.t)("\u5feb\u901f\u7b5b\u9009"),placeholder:Object(i.t)("\u5168\u90e8\u7814\u53d1\u7a7a\u95f4"),avatarSize:"xsmall",className:l.a.customProjectDropdown,onSelect:function(t){return e.changeProject(t.value)},onClear:function(){return e.changeProject()}}),o.a.createElement("div",{className:l.a.arrow}),J.map((function(t){return o.a.createElement("div",{className:f()(l.a.filterTab,t.value===p&&l.a.active),key:t.value,onClick:function(){return e.changeTab(t.value)}},t.name)})))),o.a.createElement("div",{className:f()(l.a.result,!d.length&&l.a.empty),ref:function(t){return e.containerRef=t},onScroll:this.onScroll},E&&o.a.createElement(B.a,{show:!0}),!E&&!d.length&&Object(i.t)("\u672a\u5339\u914d\u5230\u76f8\u5173\u4e8b\u9879"),!E&&!!d.length&&this.renderResult()),o.a.createElement("div",{className:l.a.tipBars},this.renderKeyboard("tab",!0),o.a.createElement("div",{className:l.a.txt},Object(i.t)("\u5207\u6362\u4e8b\u9879\u7c7b\u578b")),this.renderKeyboard("up",!1),this.renderKeyboard("down",!1),o.a.createElement("div",{className:l.a.txt},Object(i.t)("\u5207\u6362\u641c\u7d22\u6761\u76ee")),this.renderKeyboard("return",!1),o.a.createElement("div",{className:l.a.txt},Object(i.t)("\u786e\u8ba4/\u53d6\u6d88\u5173\u8054\u4e8b\u9879")),this.renderKeyboard("esc",!0),o.a.createElement("div",{className:l.a.txt},Object(i.t)("\u5173\u95ed"))))},t.prototype.componentDidMount=function(){this.onSearch(),document.addEventListener("keydown",this.handleKeyDown)},t.prototype.componentWillUnmount=function(){document.removeEventListener("keydown",this.handleKeyDown)},t.prototype.createRef=function(e){this.activeRef=e},t}(o.a.Component);t.default=X},C9Yq:function(e,t,a){e.exports={contanier:"contanier-qCpedh69z_",icon:"icon-10k3cpW_3d","priority-0":"priority-0-uJflBkchMg",priority0:"priority-0-uJflBkchMg","priority-1":"priority-1-lR2OOQPqqL",priority1:"priority-1-lR2OOQPqqL","priority-2":"priority-2-279vlqu2h8",priority2:"priority-2-279vlqu2h8","priority-3":"priority-3-3jj4Prxycs",priority3:"priority-3-3jj4Prxycs",text:"text-Ni358T26KR"}},CDXi:function(e,t,a){"use strict";(function(e){var n=a("mVeg"),i=a("cDcd"),r=a.n(i),o=a("g84+"),s=a("2RjC"),l=a("2oPZ"),c=a("q+jK"),u=a("L/oC"),d=a("9+7+"),f=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(t,a)};return function(t,a){if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),p=function(){return(p=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},m=function(t){function i(n){var i=t.call(this,n)||this;return i.importPdfjs=function(){return Promise.all([a.e("vendors~pdfjs"),a.e("pdfjs")]).then(a.t.bind(null,"lRFz",7)).then((function(t){i.pdf=t,e.PDFJS.workerSrc=a("ONf6")}))},i.getPdfDucomentPreviewUrl=function(e,t){if(!d.isCOSPreviewEnabled)return i.loadPdfDocument(t);var a=i.props.currentProjectName;return Object(u.getOfficePdfPreview)(a,e).then((function(e){if(!e.data||!e.data.preview_url)return i.setState({previewUrl:""}),i.loadPdfDocument(t);i.setState({previewUrl:e.data.preview_url})}))},i.pdfScaleChange=function(e){var t=i.state,a=t.scale,n=t.currentPage,r=0;"click"===e.type?r=a+e.scale:"select"===e.type&&e.scale&&(r=e.scale),i.setState({scale:r},(function(){i.renderPage(n)}))},i.state={doc:{numPages:0,getPage:function(){}},currentPageNum:1,isFullscreen:!1,currentPage:null,autoSize:{},cachedAutoSize:{},scale:1.5,canvasHeight:0,canvasWidth:0,previewUrl:"",pdfjsInitialized:!1},i.navigateToPage=i.navigateToPage.bind(i),i}return f(i,t),i.prototype.componentDidMount=function(){var e=this;this.importPdfjs().then((function(){return e.setState({pdfjsInitialized:!0})}))},i.prototype.renderPage=function(e){var t=this,a=this.state.scale,n=e.getViewport(a);this.setState({scale:a},(function(){var a=t.refs.canvas,i=a.getContext("2d");a.height=n.height,a.width=n.width;var r={canvasContext:i,viewport:n};e.render(r),t.setState({canvasWidth:a.width,canvasHeight:a.height})}))},i.prototype.navigateToPage=function(e){var t=this;this.setState({currentPageNum:e}),this.state.doc.getPage(e).then((function(e){var a=Object(c.stageSize)();t.setState({currentPage:e,autoSize:a,cachedAutoSize:a}),t.renderPage(e)}))},i.prototype.loadPdfDocument=function(e){var t=this;return this.pdf.getDocument({url:e,withCredentials:!0}).then((function(e){t.setState({doc:e}),t.navigateToPage(1)}))},i.prototype.fetchFileDownloadUrl=function(e){var t=this.props,a=t.enterpriseGlobalKey,n=t.currentProjectName,i="/api/user/".concat(a,"/project/").concat(n),r="".concat(i,"/files/").concat(e,"/pdf-stream");return this.getPdfDucomentPreviewUrl(e,r)},i.prototype.render=function(){var e=this,t=this.state,a=t.scale,i=t.currentPage,c=t.canvasHeight,u=t.canvasWidth,d=t.autoSize,f=t.cachedAutoSize,m=t.doc,h=t.currentPageNum,v=t.previewUrl,g=t.pdfjsInitialized,E=this.props.file.fileId;return g?r.a.createElement(l.a,{className:o.filePreview,fileId:E,version:"11",fileTypeName:Object(n.t)("PDF \u6587\u4ef6"),fetchPromise:function(t){return e.fetchFileDownloadUrl(t)},invisible:!0},v?r.a.createElement("iframe",{frameBorder:"0",src:v,allowFullScreen:!0,className:o.filePreviewPdf}):r.a.createElement("div",{className:o.filePreviewPdf,ref:"pdfStage",style:p({},d)},r.a.createElement("canvas",{ref:"canvas",id:"canvas"}),r.a.createElement(s.a,{type:"pdf",scale:a,file:i,canvasHeight:c,canvasWidth:u,currentPageNumber:h,totalPage:m.numPages,pageItemsShow:!0,onPageChange:this.navigateToPage,onScaleChange:this.pdfScaleChange,getFullscreen:function(){return e.refs.pdfStage},onFullscreenChange:function(t){e.setState({isFullscreen:t,autoSize:t?{}:f},(function(){var t=e.state.currentPage;e.renderPage(t)}))}}))):null},i}(i.Component);t.a=m}).call(this,a("yLpj"))},CPYp:function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjRweCIgaGVpZ2h0PSIyNHB4IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+ZmlsZS1pY29ucy8yNHB4L2FpPC90aXRsZT4KICAgIDxkZWZzPgogICAgICAgIDxwYXRoIGQ9Ik01LjI1LDIgTDE1LDIgTDE1LDIgTDIxLDggTDIxLDE5Ljc1IEMyMSwyMC45OTI2NDA3IDE5Ljk5MjY0MDcsMjIgMTguNzUsMjIgTDUuMjUsMjIgQzQuMDA3MzU5MzEsMjIgMywyMC45OTI2NDA3IDMsMTkuNzUgTDMsNC4yNSBDMywzLjAwNzM1OTMxIDQuMDA3MzU5MzEsMiA1LjI1LDIgWiIgaWQ9InBhdGgtMSI+PC9wYXRoPgogICAgICAgIDxmaWx0ZXIgeD0iLTguMyUiIHk9Ii03LjUlIiB3aWR0aD0iMTE2LjclIiBoZWlnaHQ9IjExNS4wJSIgZmlsdGVyVW5pdHM9Im9iamVjdEJvdW5kaW5nQm94IiBpZD0iZmlsdGVyLTIiPgogICAgICAgICAgICA8ZmVPZmZzZXQgZHg9IjAiIGR5PSIwIiBpbj0iU291cmNlQWxwaGEiIHJlc3VsdD0ic2hhZG93T2Zmc2V0T3V0ZXIxIj48L2ZlT2Zmc2V0PgogICAgICAgICAgICA8ZmVHYXVzc2lhbkJsdXIgc3RkRGV2aWF0aW9uPSIwLjUiIGluPSJzaGFkb3dPZmZzZXRPdXRlcjEiIHJlc3VsdD0ic2hhZG93Qmx1ck91dGVyMSI+PC9mZUdhdXNzaWFuQmx1cj4KICAgICAgICAgICAgPGZlQ29sb3JNYXRyaXggdmFsdWVzPSIwIDAgMCAwIDAgICAwIDAgMCAwIDAgICAwIDAgMCAwIDAgIDAgMCAwIDAuMDUgMCIgdHlwZT0ibWF0cml4IiBpbj0ic2hhZG93Qmx1ck91dGVyMSI+PC9mZUNvbG9yTWF0cml4PgogICAgICAgIDwvZmlsdGVyPgogICAgPC9kZWZzPgogICAgPGcgaWQ9IlBhZ2UtMSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9Ikljb25zL0ZpbGUvMjRweC9BSSI+CiAgICAgICAgICAgIDxnIGlkPSJSZWN0YW5nbGUtQ29weSI+CiAgICAgICAgICAgICAgICA8dXNlIGZpbGw9ImJsYWNrIiBmaWxsLW9wYWNpdHk9IjEiIGZpbHRlcj0idXJsKCNmaWx0ZXItMikiIHhsaW5rOmhyZWY9IiNwYXRoLTEiPjwvdXNlPgogICAgICAgICAgICAgICAgPHVzZSBmaWxsPSIjRjY4NzAxIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIHhsaW5rOmhyZWY9IiNwYXRoLTEiPjwvdXNlPgogICAgICAgICAgICA8L2c+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik05Ljk1NDc1LDE2Ljc1IEwxMC4xOTEsMTYuMDM0NSBMMTEuNjY5MjUsMTYuMDM0NSBMMTEuODkyLDE2Ljc1IEwxMy4xMjcyNSwxNi43NSBMMTEuMzc5LDExLjk0NCBMMTAuNDY3NzUsMTEuOTQ0IEw4LjcxOTUsMTYuNzUgTDkuOTU0NzUsMTYuNzUgWiBNMTEuMzU4NzUsMTUuMDQ5IEwxMC41MjE3NSwxNS4wNDkgTDEwLjk1Mzc1LDEzLjc2NjUgTDExLjM1ODc1LDE1LjA0OSBaIE0xNC43OTQ1LDE2Ljc1IEwxNC43OTQ1LDExLjk0NCBMMTMuNjEzMjUsMTEuOTQ0IEwxMy42MTMyNSwxNi43NSBMMTQuNzk0NSwxNi43NSBaIiBpZD0iQUkiIGZpbGw9IiNGRkZGRkYiIGZpbGwtcnVsZT0ibm9uemVybyIgb3BhY2l0eT0iMC45MDAwMDAwMzYiPjwvcGF0aD4KICAgICAgICAgICAgPHBhdGggZD0iTTE1LDIgTDIxLDggTDE3LjI1LDggQzE2LjAwNzM1OTMsOCAxNSw2Ljk5MjY0MDY5IDE1LDUuNzUgTDE1LDIgTDE1LDIgWiIgaWQ9IlJlY3RhbmdsZS1Db3B5LTMiIGZpbGw9IiNGRkZGRkYiIG9wYWNpdHk9IjAuNDAwMDAwMDA2Ij48L3BhdGg+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4="},CVru:function(e,t,a){e.exports={title:"title-19L82hWEbh","defect-wrapper":"defect-wrapper-2js8QC7ZIe",defectWrapper:"defect-wrapper-2js8QC7ZIe","defect-icon":"defect-icon-2LTZsSENdi",defectIcon:"defect-icon-2LTZsSENdi","defect-id":"defect-id-2HifBKOxWx",defectId:"defect-id-2HifBKOxWx","defect-title":"defect-title-zWcbuDGLGp",defectTitle:"defect-title-zWcbuDGLGp","defect-tag":"defect-tag-1xym5HAiqE",defectTag:"defect-tag-1xym5HAiqE",empty:"empty-1No-Os_wLM"}},CYfE:function(e,t,a){"use strict";a("I5cv"),a("mYba"),a("jm62"),a("EK0E");var n=a("TqRt"),i=a("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(a("o0o1")),o=n(a("RIqP")),s=n(a("yXPU")),l=n(a("lSNA")),c=n(a("lwsE")),u=n(a("W8MJ")),d=n(a("PJYZ")),f=n(a("7W2i")),p=n(a("a1gu")),m=n(a("Nsbk"));a("f3/d"),a("0l/t"),a("dRSK"),a("L9s1"),a("Z2Ku"),a("CX2u"),a("Btvt"),a("VRzm"),a("pIFo"),a("INYr"),a("0mN4"),a("bWfx"),a("hhXQ"),a("RW0V"),a("XfO3"),a("yt8O"),a("rGqo"),a("tUrg"),a("ioFf"),a("HEwt"),a("T39b"),a("OG14");var h,v,g,E,b=a("mVeg"),y=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!==typeof e)return{default:e};var a=$e(t);if(a&&a.has(e))return a.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=r?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}n.default=e,a&&a.set(e,n);return n}(a("cDcd")),S=a("h74D"),I=n(a("17x9")),T=a("dtw8"),C=n(a("P5Jw")),P=a("x+BT"),w=a("sWxF"),D=a("7FZc"),O=n(a("TsYS")),R=n(a("JEMs")),j=n(a("qCZF")),k=n(a("WE/Q")),N=n(a("AVuq")),A=n(a("Yzhn")),L=n(a("V/h/")),F=n(a("f0Wu")),_=n(a("wd/R")),M=n(a("Y+p1")),x=a("FaIw"),B=a("xgZS"),U=n(a("qLOp")),W=n(a("8+Mu")),Y=n(a("2KQ+")),H=a("nuIr"),V=n(a("XLbL")),G=n(a("4qC0")),K=n(a("GoyQ")),z=n(a("UB5X")),q=n(a("Z0cm")),Z=a("Z4vw"),J=a("DKcV"),X=n(a("K2gz")),Q=a("FpRC"),$=n(a("2CT0")),ee=n(a("L8Eh")),te=n(a("1+AE")),ae=n(a("J0Vw")),ne=n(a("pgVe")),ie=n(a("Th6D")),re=n(a("KUqB")),oe=n(a("8lvN")),se=n(a("u5of")),le=n(a("Q95R")),ce=n(a("Zsd2")),ue=a("DgMC"),de=n(a("Qkhu")),fe=a("17N+"),pe=a("w3Wo"),me=a("885C"),he=n(a("vUV6")),ve=n(a("TT2u")),ge=a("5DNL"),Ee=a("3RH6"),be=a("AwMv"),ye=n(a("mSbZ")),Se=n(a("htee")),Ie=n(a("4Fdf")),Te=n(a("uk0h")),Ce=n(a("+Dhf")),Pe=a("jzjO"),we=n(a("oIiO")),De=n(a("CF/V")),Oe=n(a("begU")),Re=n(a("0Zwn")),je=n(a("W0/N")),ke=n(a("HtPo")),Ne=n(a("AoGB")),Ae=n(a("HwxY")),Le=n(a("KIkv")),Fe=a("7bn+"),_e=n(a("X5YD")),Me=n(a("xMGB")),xe=a("LvkV"),Be=a("9+7+"),Ue=a("9+7+"),We=a("lGCG"),Ye=n(a("WKBZ")),He=n(a("cHah")),Ve=n(a("DDpV")),Ge=n(a("QWzU")),Ke=n(a("6yKH")),ze=a("cUHt"),qe=a("nuIr"),Ze=n(a("ZYwa")),Je=a("LvDl"),Xe=a("82Y3"),Qe=a("DgMC");function $e(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return($e=function(e){return e?a:t})(e)}function et(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function tt(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?et(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):et(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function at(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,m.default)(e);if(t){var i=(0,m.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,p.default)(this,a)}}var nt=(0,ue.isSupportsPlaintextEdit)()?"plaintext-only":"true";var it=(h=(0,S.connect)((function(e){return{enterpriseGlobalKey:e.APP.enterprise.globalKey,enterpriseName:e.APP.enterprise.name,watermark:e.APP.enterprise.watermark,payed:e.APP.enterprise.payed,user:e.APP.user}})),(0,T.withRouter)(v=h(v=(0,ye.default)(v=(0,Ce.default)(v=(0,Se.default)(v=(0,Te.default)(v=(0,Ie.default)(v=(0,ve.default)(v=(0,ge.FlashAnchorDecorator)(v=(0,Ne.default)((E=g=function(e){(0,f.default)(a,e);var t=at(a);function a(e){var n;return(0,c.default)(this,a),(n=t.call(this,e)).getFunctionFlags=function(){var e=n.props.currentProjectFunctions;return{codeManagementOpen:e.some((function(e){return e.code===xe.KEY_CONFIG.CODE_MANAGEMENT&&"1"===e.value})),testManagementOpen:e.some((function(e){return e.code===xe.KEY_CONFIG.TEST_MANAGEMENT&&"1"===e.value})),issueReviewOpen:Ue.enableIssueReview}},n.renderParentsInfo=function(){var e=n.state,t=e.tooltipTitle,a=e.detailInfoState,i=n.props.projectPath,r="".concat(i,"/epics/issues/").concat(a.code,"/detail");return y.default.createElement("div",{className:U.default.detailId},y.default.createElement("span",{className:(0,X.default)(U.default.code,U.default.lastId,U.default.lastNumber)},y.default.createElement(T.Link,{to:r,className:(0,X.default)(U.default.code,U.default.number)},y.default.createElement(re.default,{type:a.issueTypeDetail.iconType}),"#",a.code),y.default.createElement(D.TooltipTrigger,{title:t,onVisibleChange:n.onVisibleChange},y.default.createElement(C.default,{text:"".concat(window.location.origin).concat(i,"/epics/issues/").concat(a.code,"/detail")},y.default.createElement("div",{className:U.default.copyIcon,onClick:n.onCopyClick})))),y.default.createElement("div",{className:(0,X.default)(U.default.code,U.default.lastId,U.default.lastNumber),style:{marginLeft:20,fontWeight:600}},"|",y.default.createElement("span",{style:{color:"red",margin:"0 5px"}},"GID"),"#",a.id,y.default.createElement(D.TooltipTrigger,{title:t,onVisibleChange:n.copyGID},y.default.createElement(C.default,{text:a.id},y.default.createElement("div",{className:U.default.copyIcon,onClick:n.onCopyClick})))))},n.copyGID=function(){n.setState({tooltipTitle:(0,b.t)("\u590d\u5236")})},n.renderTitle=function(e,t,a){var i=n.state,r=i.detailInfoState,o=i.inputFocus;return y.default.createElement("div",{className:(0,X.default)(U.default.titleInputWrap,o&&t&&U.default.titleInputFocusWrap)},y.default.createElement("div",{className:(0,X.default)(U.default.titleInput,!e&&U.default.titleInputDisabled,t&&U.default.titleInputScrolled),ref:!a&&n.titleInputRef,onFocus:function(){n.setState({inputFocus:!0}),setTimeout((function(){(0,ue.setFocus)(n.titleInputRef.current)}),0)},onBlur:function(){n.setState({inputFocus:!1}),n.handleInput(n.titleInputRef.current.innerText)},onKeyDown:function(e){"Enter"===e.key&&(e.preventDefault(),n.handleInput(n.titleInputRef.current.innerText))},contentEditable:e?nt:"false",suppressContentEditableWarning:!0},r.name))},n.renderScrollTitle=function(e,t){var a=n.state,i=a.inputFocus,r=a.detailInfoState;return i?y.default.createElement(y.default.Fragment,null,n.renderTitle(e,!0,t)):y.default.createElement("div",{className:U.default.scrolledTitleWrap},y.default.createElement("div",{className:(0,X.default)(U.default.titleIconWrap,n.state.noHoverIcon&&U.default.noHoverIcon)},y.default.createElement(re.default,{type:r.issueTypeDetail.iconType}),y.default.createElement("div",{className:U.default.breadcrumb},n.renderParentsInfo())),n.renderTitle(e,!0,t))},n.elemShow=function(){n.dataLoad=(0,je.default)({elemInOrder:["issue","workItem","codeRepo","reference","logs","comment"].filter((function(e){return e})),onRenderItem:function(e,t,a,i){n.setState({isRender:tt({},i),isRenderAll:t},(function(){a(),t&&n.setState({controlCaculatePos:Date.now()})}))}}),n.dataLoad("comment")},n.isDeleteInFilePreview=!1,n.titleInputRef=y.default.createRef(),n.onBtnClick=function(e){n["".concat(e.toLowerCase(),"BtnClicked")]&&n["".concat(e.toLowerCase(),"BtnClicked")]()},n.getEditComp=function(e){n.editComp=e},n.editStatusChanged=function(e,t){n.setState(tt({isDesEditing:e,isShowItemPlaceholder:tt(tt({},n.state.isShowItemPlaceholder),{},{description:void 0!==t?t:!e})},e?{}:{isDescriptionBtnFixed:!1}),(function(){n.setState({controlCaculatePos:Date.now()})}))},n.scrollToAttechment=function(){var e,t,a;null!==(e=n.scrollRef)&&void 0!==e&&e.current&&null!==(t=n.attechmentRef)&&void 0!==t&&t.current&&null!==(a=n.headerRef)&&void 0!==a&&a.current&&(0,Q.scrollIntoView)(n.scrollRef.current,n.attechmentRef.current,-n.headerRef.current.offsetHeight)},n.handleReviewListChanged=function(){n.fetchIssueReviewList((function(e){0!==e.length?Q.scrollIntoView&&n.setState({activeLogTab:"approval"},(function(){(0,Q.scrollRelatedToTopMenu)("issue-review-list",0,n.scrollRef.current)})):n.setState({activeLogTab:"activity"})})),setTimeout((function(){n.getActivityList()}),1e3)},n.getCodeRepoSetting=function(){var e=n.props.currentProject,t=n.state.detailInfoState;return(0,w.fetchRepoSettingInfo)(e.name,t.issueTypeDetail.id).then((function(e){var t=e.data.find((function(e){return"RELATE_VCS"===e.configName}));t&&"ON"===t.configValue?(n.setState({codeRepoRelationOpened:!0}),n.getAssociatedCodeRepos()):n.dataLoad("codeRepo")}))},n.getCodeRepos=function(e){var t=n.props,a=t.enterpriseGlobalKey,i=t.currentProject,r=n.state,o=r.associatedCodeRepos,s=r.codeRepoList;e?n.setState({availableCodeRepos:s.filter((function(t){return t.name.toLowerCase().includes(e.toLowerCase())&&!o.some((function(e){return e.id===t.id}))}))}):(0,w.fetchAvailableCodeRepos)(a,i.name).then((function(e){var t=e.data;n.setState({codeRepoList:t,availableCodeRepos:t.filter((function(e){return!o.some((function(t){return t.id===e.id}))}))})}))},n.associateCodeRepo=function(e){var t=n.props.currentProject,a=n.state.detailInfoState.code;(0,w.associateCodeRepo)(t.name,a,e).then((function(){(0,B.success)((0,b.t)("\u66f4\u65b0\u6210\u529f")),n.getAssociatedCodeRepos().then((function(){return n.getCodeRepos()}))}))},n.cancelAssociateCodeRepo=function(e){var t=n.props.currentProject,a=n.state.detailInfoState.code;(0,w.cancelAssociateCodeRepo)(t.name,a,e).then((function(){(0,B.success)((0,b.t)("\u66f4\u65b0\u6210\u529f")),n.getAssociatedCodeRepos().then((function(){return n.getCodeRepos()}))}))},n.cancelCodeRepo=function(){var e=n.state.isShowItemPlaceholder;n.setState({isShowItemPlaceholder:tt(tt({},e),{},{codeRepo:!1})})},n.handleWorkItemRelationVisibleChange=function(e){n.setState({isWorkItemCreationVisible:e,isShowItemPlaceholder:tt(tt({},n.state.isShowItemPlaceholder),{},{workItem:e})})},n.insideProgramCheck=function(){var e=n.props.currentProject;return(0,w.whetherInProgram)(e.id).then((function(e){e.data.length>0&&n.setState({inProgram:!0}),n.getAssociatedWorkItems()})).finally((function(){n.dataLoad("workItem")}))},n.workItemRelationChanged=function(){n.getAssociatedWorkItems(),n.getActivityList()},n.cancelWorkItem=function(){return n.setState({isShowItemPlaceholder:tt(tt({},n.state.isShowItemPlaceholder),{},{workItem:!1})})},n.referencesBtnClicked=function(){"activity"===n.state.activeLogTab?n.changeActivityTabAndShow():n.setState({activeLogTab:"activity"},(function(){n.setCommentPosition((function(){setTimeout((function(){n.changeActivityTabAndShow()}),0)}))}))},n.changeActivityTabAndShow=function(){"WITHOUT_COMMENT"===n.state.activitiesTab?n.setState({activitiesTab:"ALL"},(function(){n.changeTabFn(["ALL"]),n.setCommentPosition((function(){n.doShowReference()}))})):n.doShowReference()},n.doShowReference=function(){n.props.autoToggleComment(n.state.detailInfoState.code,!0)},n.scrollToBottom=function(e){(0,Q.scrollRelatedToTopMenu)("bottom",0,n.scrollRef.current,e)},n.handleAffairsChange=function(e){n.setState({affairs:e})},n.getNotUploadElems=function(){var e=n.state,t=e.isDesEditing,a=e.isCommentEditing;return[t&&n.editComp.containerRef.current,a&&n.commentEditorRef&&n.commentEditorRef.current]},n.dragEnterDes=function(e){n.dragEnter(e,"des")},n.dragEnterComment=function(e){n.dragEnter(e,"comment")},n.dragEnter=function(e,t){e.preventDefault(),e.stopPropagation(),n["des"===t?"intoDesCount":"intoCommentCount"]++},n.dragLeaveDes=function(e){n.dragLeave(e,"des")},n.dragLeaveComment=function(e){n.dragLeave(e,"comment")},n.dragLeave=function(e,t){e.preventDefault(),e.stopPropagation();var a="des"===t?"intoDesCount":"intoCommentCount";n[a]--,0===n[a]&&n.setState({notUpload:!1})},n.mouseLeaveDes=function(){n.mouseLeave("des")},n.mouseLeaveComment=function(){n.mouseLeave("comment")},n.renderActivity=function(e){var t=n.state,a=t.isInited,i=t.activities,r=t.detailInfoState,o=t.activitiesTab,s=t.isCommentSticky,l=n.props,c=l.isDetail,u=l.currentProject,d=l.user,f=l.projectPath,p=l.domID;return y.default.createElement(N.default,{isInited:a,scrollRef:n.scrollRef,isDetail:c,currentProject:u,user:d,activities:i,projectPath:f,domID:p,flashAnchor:n.props.flashAnchor,itemType:"EPIC",code:r.code,onPublishChildComment:n.postComment,editCommentCallback:n.handleEditCommentCallback,onDeleteComment:n.deleteComment,handleViewRecord:n.viewRecord,activeTab:[o],changeTab:function(e){return n.setState({activitiesTab:e},n.setCommentPosition)},getChangeTabFn:function(e){n.changeTabFn=e},isCommentSticky:s,hideTitle:e,handleEditComment:function(e){return n.setState({isEdittingCommentModalVisible:e})}})},n.changeActivityLogTab=function(e){n.setState({activeLogTab:e.value},(function(){n.setCommentPosition(),"approval"===e.value&&n.fetchIssueReviewList((function(e){0===e.length&&n.setState({activeLogTab:"activity"})}))}))},n.getDropdownPortalToRight=function(){return!n.props.isDetail&&!n.state.isFullScreen},n.doScroll=function(){if(n.state.isScrollTakeEffect&&!n.state.inputFocus){var e=n.scrollRef.current.scrollTop,t=n.state.isScrolled;e>100&&!t?n.setState({isScrolled:!0}):e<=100&&n.setState({isScrolled:!1})}},n.onAttrScroll=function(){n.setState({isElemScroll:!0})},n.getEpicCanCreateIssueTypes=function(){return n.props.currentProjectCooperateSettings?n.props.currentProjectCooperateSettings.ISSUE_TYPES.filter((function(e){return"SUB_TASK"!==e.issueType&&"EPIC"!==e.issueType})):[]},n.fetchManHourRecords=function(){var e=n.props,t=e.currentProject.id,a=e.detailInfo.code;return(0,w.getManhourHistories)(t,a).then((function(e){var t=e.data;n.setState({manHourRecords:t})}))},n.fetchManHourRecordsAndFetchSpecData=(0,s.default)(r.default.mark((function e(){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.fetchManHourRecords();case 2:return e.next=4,n.changeAttributes({type:""});case 4:case"end":return e.stop()}}),e)}))),n.deleteManhourRecord=function(e,t){var a=n.props.currentProject.id;return(0,w.delManHourHistory)(a,e.id,t).then((function(){n.fetchManHourRecordsAndFetchSpecData()}))},n.renewDescription=function(e){var t=e.historyId,a=e.issueLogId,i=e.description,r=n.props.currentProject,o=n.state.detailInfoState;return(0,pe.rollbackDescription)(r.id,o.code,a).then((function(){n.setState({historyId:t,description:i,isDescriptionEmpty:!i.replace(/\n|\s/g,"")}),n.getActivityList(),n.getResourceReference()}))},n.caculateDetailEleHeight=function(){return new Promise((function(e){n.doCaculate(-1,e)}))},n.doCaculate=function(e,t){if(n.detailBodyRef.current){var a=n.detailBodyRef.current.offsetHeight;a!==e?setTimeout((function(){n.doCaculate(a,t)}),300):t(a)}},n.setCommentPosition=function(){var e=(0,s.default)(r.default.mark((function e(t){var a,i,o,s,l;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n.scrollRef&&n.scrollRef.current&&n.hiddenHeaderRef.current&&n.detailBodyRef.current)){e.next=7;break}return e.next=3,n.caculateDetailEleHeight();case 3:o=e.sent,s=n.scrollRef.current.offsetHeight-n.hiddenHeaderRef.current.offsetHeight,l=(null===(a=n.commentEditorRef)||void 0===a||null===(i=a.current)||void 0===i?void 0:i.offsetHeight)||140,n.setState(tt({isCommentSticky:o+l>=s},o+l<s?{isDescriptionBtnFixed:!1,isCommentAbsBottom:!1}:{}),(function(){if(n.state.isCommentSticky&&(setTimeout((function(){var e=n.hiddenHeaderRef.current.offsetHeight+(n.detailBodyRef.current.offsetHeight<s?s:n.detailBodyRef.current.offsetHeight);n.setState({isCommentAbsBottom:n.scrollRef.current.offsetHeight-e>=0,minHeight:s})}),0),n.state.isDesEditing)){var e=n.editorRef.current.offsetHeight+24,a=n.scrollRef.current.offsetHeight-n.hiddenHeaderRef.current.offsetHeight-44;n.setState({isDescriptionBtnFixed:e>=a})}"function"===typeof t&&t()}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleAttentionChange=function(e){n.changeAttributes({type:"watchers",value:e})},n.handleSelfChange=function(e){var t=n.props,a=t.currentProject,i=t.user,r=n.state,s=r.detailInfoState,l=r.watchers;e?(0,pe.watchIssue)(a.id,s.code).then((function(){n.setState({watchers:[].concat((0,o.default)(l),[i])}),(0,B.success)((0,b.t)("\u66f4\u65b0\u6210\u529f")),n.callback(),n.getActivityList()})):(0,pe.unwatchIssue)(a.id,s.code).then((function(){n.setState({watchers:(0,o.default)(l.filter((function(e){return e.id!==i.id})))}),(0,B.success)((0,b.t)("\u66f4\u65b0\u6210\u529f")),n.callback(),n.getActivityList()}))},n.handleAffairsInput=function(e){n.setState({affairsInput:e.target.value})},n.handleAffairsInputCancel=function(){n.setState({isCreateAffairsVisible:!1,affairsInput:"",isShowItemPlaceholder:tt(tt({},n.state.isShowItemPlaceholder),{},{issue:!1})})},n.handleAffairsInputShow=function(){var e=(0,d.default)(n).scrollRef;n.setState({affairsInput:"",isCreateAffairsVisible:!0,isAssociateAffairsVisible:!1,isShowItemPlaceholder:tt(tt({},n.state.isShowItemPlaceholder),{},{issue:!0}),willCreateEpicType:n.getEpicCanCreateIssueTypes().length?n.getEpicCanCreateIssueTypes()[0]:{}},(function(){(0,Q.scrollRelatedToTopMenu)("affairs-input",200,e.current),n.issueInputRef.current&&n.issueInputRef.current.focus()}))},n.handleAffairsInputCreate=(0,Je.debounce)((function(){var e,t=n.props.currentProject,a=n.state,i=a.affairsInput,r=a.detailInfoState,o=a.willCreateEpicType;if(i){var s={issueType:o.issueType,epicCode:r.code,name:(0,ce.default)(i),issueTypeId:o.id,issueDescriptionType:null!==(e=r.issueDescriptionType)&&void 0!==e?e:(0,Xe.getPreferEditorType)()};""!==i&&(0,pe.fastCreateIssue)(t.id,s).then((function(){n.getIssues(),n.setState({affairsInput:""})})).catch((function(e){var t=e.code;(0,Qe.configPlanNotToastMsg)(t)||8011!==t&&n.setState({isCreationModalVisible:!0})}))}else{var l=(0,b.t)("\u8bf7\u8f93\u5165{{title}}\u6807\u9898",{title:o.name});(0,B.warning)(l)}}),300),n.handleAffairsAssociate=function(){var e=(0,d.default)(n).scrollRef;n.setState({isAssociateAffairsVisible:!0,isCreateAffairsVisible:!1},(function(){(0,Q.scrollRelatedToTopMenu)("affairs-associate",200,e.current),n.associateAffairsRef.current&&n.associateAffairsRef.current.focus()}))},n.handleAffairsAssociateCancel=function(){n.setState({isAssociateAffairsVisible:!1})},n.handleSelect=function(e){n.setState({willCreateEpicType:e})},n.handleAffairsInputFullCreate=function(){n.setState({isCreationModalVisible:!0})},n.timeDetect=function(e,t){var a=n.state.attributes,i=a.dueDate,r=a.startDate,o=(0,F.default)(e).startOf("day");return"start"===t&&i?o.valueOf()>(0,F.default)(i).valueOf():!("end"!==t||!r)&&o.valueOf()<(0,F.default)(r).valueOf()},n.onIsFullWidthChange=function(e){n.setState({isFullWidth:e})},n.toggleFullScreenStatus=function(){var e=!n.state.isFullScreen;n.setState({isFullScreen:e}),(0,fe.setIsSlideFullScreen)(e),n.props.onFullScreenChange&&n.props.onFullScreenChange(e)},n.handleFullScreenKey=function(e){n.state.isDesEditing||e.target===document.body&&"f"===e.key.toLowerCase()&&n.toggleFullScreenStatus()},n.state={tooltipTitle:(0,b.t)("\u590d\u5236\u94fe\u63a5"),noHoverIcon:!1,detailInfoState:e.detailInfo,references:{},activities:[],description:e.detailInfo.descriptionMarkup,isDescriptionEmpty:!e.detailInfo.description.replace(/\n|\s/g,""),markdown:e.detailInfo.description,slateRaw:e.detailInfo.slateRaw,attachmentsState:n.combineThirdLinks(e.detailInfo.files,e.detailInfo.thirdLinks),isFilePreviewVisible:void 0,previewFileID:void 0,attributes:{assignee:void 0,priority:void 0,requirementType:void 0,defectType:void 0,dueDate:void 0,projectModule:void 0,labels:[],watchers:[],fields:{},startDate:void 0,progress:void 0},assignee:e.detailInfo.assignee,watchers:e.detailInfo.watchers||[],iterationList:[],epicTrackingStatusTransfers:[],citedSources:{},citingSources:{},isInited:!1,isHistoryRecordVisible:!1,currentLogId:void 0,activitiesTab:"ALL",activeLogTab:"activity",isCommentSticky:!1,isCommentAbsBottom:!1,isScrolled:!1,inputFocus:!1,isCreateAffairsVisible:!1,isAssociateAffairsVisible:!1,affairsInput:"",affairs:[],isCreationModalVisible:!1,initStatus:[],showSideSlip:!1,isShowApproveCreate:!1,issueReviewList:[],isDesEditing:!1,isFullScreen:(0,fe.getIsSlideFullScreen)(),isFullWidth:!0,isShowItemPlaceholder:{description:!0,issue:!1,workItem:!1,codeRepo:!1,reference:!1},isRender:{issue:!1,workItem:!1,codeRepo:!1,reference:!1,logs:!1,comment:!1},isRenderAll:!1,manHourRecords:[],isScrollTakeEffect:!1,delFileId:void 0,showDeleteConfirmModal:!1,isElemScroll:!1,scrollControl:Date.now(),isEdittingCommentModalVisible:!1,willCreateEpicType:{},codeRepoRelationOpened:!1,associatedCodeRepos:[],availableCodeRepos:[],isAssociatedCodeRepoFocus:!1,inProgram:!1,isWorkItemCreationVisible:!1,associatedWorkItems:[],availableWorkItems:[],isAssociatedWorkItemFocus:!1,controlHideButtonActionMore:0,controlHideOptionMore:0,codeManagementOpen:!1,testManagementOpen:!1,pageId:e.detailInfo.pageId||void 0,historyId:void 0,controlCaculatePos:0,isDescriptionBtnFixed:!1,identity:"",slotVisible:!1,showCopyIssues:!1},n.onVisibleChange=n.onVisibleChange.bind((0,d.default)(n)),n.onCopyClick=n.onCopyClick.bind((0,d.default)(n)),n.onRemoveReference=n.onRemoveReference.bind((0,d.default)(n)),n.getActivityList=n.getActivityList.bind((0,d.default)(n)),n.postComment=n.postComment.bind((0,d.default)(n)),n.deleteComment=n.deleteComment.bind((0,d.default)(n)),n.onNameChange=n.onNameChange.bind((0,d.default)(n)),n.deleteIssue=n.deleteIssue.bind((0,d.default)(n)),n.callback=n.callback.bind((0,d.default)(n)),n.updateIssue=n.updateIssue.bind((0,d.default)(n)),n.onStatusChange=n.onStatusChange.bind((0,d.default)(n)),n.submitTitleChange=n.submitTitleChange.bind((0,d.default)(n)),n.updateIssueDescription=n.updateIssueDescription.bind((0,d.default)(n)),n.timeTrigger=null,n.handleDeleteAttachment=n.handleDeleteAttachment.bind((0,d.default)(n)),n.onFileDropSuccess=n.onFileDropSuccess.bind((0,d.default)(n)),n.onFileDropDelete=n.onFileDropDelete.bind((0,d.default)(n)),n.onFileDropCancel=n.onFileDropCancel.bind((0,d.default)(n)),n.onFileDropFail=n.onFileDropFail.bind((0,d.default)(n)),n.fileUpload=n.fileUpload.bind((0,d.default)(n)),n.filePreviewHide=n.filePreviewHide.bind((0,d.default)(n)),n.filePreviewHide=n.filePreviewHide.bind((0,d.default)(n)),n.handleDelInPreviewFile=n.handleDelInPreviewFile.bind((0,d.default)(n)),n.changeAttributes=n.changeAttributes.bind((0,d.default)(n)),n.getIssues=n.getIssues.bind((0,d.default)(n)),n.previewItem=n.previewItem.bind((0,d.default)(n)),n.toggleRecord=n.toggleRecord.bind((0,d.default)(n)),n.viewRecord=n.viewRecord.bind((0,d.default)(n)),n.closeCreateModal=n.closeCreateModal.bind((0,d.default)(n)),n.handleAffairsInputCreate=n.handleAffairsInputCreate.bind((0,d.default)(n)),n.scrollRef=y.default.createRef(),n.getResourceReference=n.getResourceReference.bind((0,d.default)(n)),n.onRemoveReference=n.onRemoveReference.bind((0,d.default)(n)),n.openSlideslip=n.openSlideslip.bind((0,d.default)(n)),n.closeSlideslip=n.closeSlideslip.bind((0,d.default)(n)),n.fetchManHourRecordsAndFetchSpecData=n.fetchManHourRecordsAndFetchSpecData.bind((0,d.default)(n)),n.handleDeleteAttachmentConfirm=n.handleDeleteAttachmentConfirm.bind((0,d.default)(n)),n.handleEditCommentCallback=n.handleEditCommentCallback.bind((0,d.default)(n)),n.commentEditorRef=null,n.intoDesCount=0,n.intoCommentCount=0,n.commentStickyContainerRef=null,n.onScroll=n.onScroll.bind((0,d.default)(n)),n.desComp=null,n.headerRef=y.default.createRef(),n.hiddenHeaderRef=y.default.createRef(),n.detailBodyRef=y.default.createRef(),n.desComp=null,n.attechmentRef=y.default.createRef(),n.issuesRef=y.default.createRef(),n.issueInputRef=y.default.createRef(),n.associateAffairsRef=y.default.createRef(),n.changeTabFn=null,n.editorRef=y.default.createRef(),n.elemShow(),n}return(0,u.default)(a,[{key:"headerRender",value:function(e){var t=this,a=this.state,n=a.detailInfoState,i=a.watchers,r=a.isDesEditing,o=a.isFullWidth,s=a.inputFocus,l=a.isFullScreen,c=!e&&this.state.isScrolled,u=this.props,d=u.projectPath,f=u.isDetail,p=u.issueList,m=u.isPermissible,h=u.user,v=u.location,g=v.query,E=v.pathname,S=u.browserRouter,I=u.callFrom,T=u.currentProject,C=u.detailInfo,P="outer"===I,w=p&&p.findIndex((function(e){return e.code===n.code}))+1,O=1===w,j=w===(p&&p.length),k=m([{function:J.ProjectPermissionFunction.PROJECT_ISSUE,action:J.ProjectPermissionAction.UPDATE}]),N=(0,ue.currentListPath)(E),A={DESCRIPTION:k,UPLOAD:k,ADD_ISSUES:k,LINK_WORK_ITEM:this.state.inProgram&&k,LINK_CODE_REPO:this.state.codeRepoRelationOpened&&k,REFERENCES:!0,ISSUE_REVIEW:this.state.issueReviewOpen&&k},L={};e&&(L.position="static",L.visibility="hidden");var F=tt({},r?{DESCRIPTION:""}:{}),_=(0,ze.getSlotContext)(C,T.id);return y.default.createElement("div",{className:(0,X.default)(U.default.specHeader,f&&U.default.detail,this.state.inputFocus&&c&&U.default.scrollFocus,c&&!r&&U.default.fixed,c&&U.default.noBorder),ref:e?this.hiddenHeaderRef:this.headerRef,style:L},y.default.createElement("div",{className:(0,X.default)(U.default.main,c?U.default.fixed:"",l?U.default.fullScreenMain:"",f?U.default.detail:"")},y.default.createElement("div",{className:(0,X.default)(U.default.headerPanelMenuWrapper,s&&U.default.focus)},c?y.default.createElement("div",{className:U.default.scrolledTitleInnerWrap,style:{marginRight:s?0:"15px"}},this.renderScrollTitle(k,e)):this.renderParentsInfo(),y.default.createElement("div",{className:(0,X.default)(U.default.menus,c&&s&&U.default.hide)},y.default.createElement(ie.default,{type:"EPIC",projectID:T.id,watchers:i||[],onChange:this.handleAttentionChange,user:h,showTooltip:!0,readOnly:!k,handleSelfChange:this.handleSelfChange}),!f&&p&&!P&&y.default.createElement("div",{className:U.default.divideLine}),!f&&p&&!P&&y.default.createElement("div",{className:"".concat(U.default.preButton," ").concat(O&&U.default.disabled),title:(0,b.t)("\u4e0a\u4e00\u4e2a\u4e8b\u9879"),onClick:function(){return!O&&S.push({pathname:"".concat(d,"/").concat(N,"/issues/").concat(p[w-2].code),query:tt({},g)})}}),!f&&p&&!P&&y.default.createElement("div",{className:"".concat(U.default.nextButton," ").concat(j&&U.default.disabled),title:(0,b.t)("\u4e0b\u4e00\u4e2a\u4e8b\u9879"),onClick:function(){return!j&&S.push({pathname:"".concat(d,"/").concat(N,"/issues/").concat(p[w].code),query:tt({},g)})}}),y.default.createElement("div",{className:U.default.divideLine}),!f&&y.default.createElement(D.TooltipTrigger,{title:this.state.isFullScreen?(0,b.t)("\u5207\u6362\u5230\u4fa7\u680f(F)"):(0,b.t)("\u5168\u5c4f(F)")},y.default.createElement("div",{className:this.state.isFullScreen?U.default.cancelFullScreenBtn:U.default.toFullScreenBtn,onClick:this.toggleFullScreenStatus})),!f&&y.default.createElement(D.TooltipTrigger,{title:(0,b.t)("\u5728\u65b0\u6807\u7b7e\u9875\u6253\u5f00")},y.default.createElement("div",{className:U.default.openNewLink,onClick:function(){window.open("".concat(d,"/epics/issues/").concat(n.code,"/detail"),"_blank")}})),y.default.createElement(R.default,{isPermissible:m,deleteFunction:this.deleteIssue,isShowFullWidthOption:f||!f&&this.state.isFullScreen,viewDescriptionVersion:function(){return t.setState({isHistoryRecordVisible:!0})},copyTitle:n.name,copyLink:"".concat(window.location.origin).concat(d,"/epics/issues/").concat(n.code,"/detail"),isFullWidth:o,onIsFullWidthChange:this.onIsFullWidthChange,controlHideMore:this.state.controlHideOptionMore,onClickTrigger:function(){t.setState({controlHideButtonActionMore:Date.now()})},slotCallback:function(e){return t.setState({identity:e,slotVisible:!0})},copyIssues:function(){return t.setState({showCopyIssues:!0})}}))),!c&&this.renderTitle(k,!1,e),(!c||c&&!s)&&y.default.createElement(Oe.default,{projectType:"SCRUM",issueType:H.ISSUE_TYPE.EPIC,isShow:A,onBtnClick:this.onBtnClick,isDisabled:F,uploadProps:{disabled:!k,currentAttachmentNum:this.state.attachmentsState.length,onHandleAttachments:this.fileUpload},showReward:!1,posType:c,isLoaded:!0,epicCanCreateIssue:this.getEpicCanCreateIssueTypes().length,controlHideMore:this.state.controlHideButtonActionMore,slotContext:_,onClickTrigger:function(){t.setState({controlHideOptionMore:Date.now()})}})))}},{key:"descriptionBtnClicked",value:function(){var e=this,t=this.editComp;t.show().then((function(){e.setState({isShowItemPlaceholder:tt(tt({},e.state.isShowItemPlaceholder),{},{description:!1})},(function(){var a,n,i;null!==(a=e.scrollRef)&&void 0!==a&&a.current&&null!==(n=t.containerRef)&&void 0!==n&&n.current&&null!==(i=e.headerRef)&&void 0!==i&&i.current&&(0,Q.scrollIntoView)(e.scrollRef.current,t.containerRef.current,-e.headerRef.current.offsetHeight-26),t.onHandle()}))}))}},{key:"fetchIssueReviewList",value:function(e){var t=this,a=this.props,n=a.currentProject,i=a.detailInfo;(0,We.fetchIssueReviewList)(n.id,i.code).then((function(a){var n=a.data;t.setState({issueReviewList:n},(function(){e&&e(n)}))}))}},{key:"issue_reviewBtnClicked",value:function(){this.setState({isShowApproveCreate:!0})}},{key:"add_issuesBtnClicked",value:function(){this.handleAffairsInputShow()}},{key:"link_code_repoBtnClicked",value:function(){var e=this;(0,Q.scrollRelatedToTopMenu)("associated-code-repo",200,this.scrollRef.current),this.setState({isShowItemPlaceholder:tt(tt({},this.state.isShowItemPlaceholder),{},{codeRepo:!0})},(function(){return e.setState({isAssociatedCodeRepoFocus:!0})}))}},{key:"getAssociatedCodeRepos",value:function(){var e=this,t=this.props.currentProject,a=this.state.detailInfoState.code;return(0,w.fetchAssociatedCodeRepos)(t.name,a).then((function(t){var a=t.data;e.setState({associatedCodeRepos:a.map((function(e){return tt({},e.depot)}))})})).finally((function(){return e.dataLoad("codeRepo")}))}},{key:"link_work_itemBtnClicked",value:function(){var e=this;this.setState({isWorkItemCreationVisible:!0,controlFocus:Date.now(),isShowItemPlaceholder:tt(tt({},this.state.isShowItemPlaceholder),{},{workItem:!0})},(function(){(0,Q.scrollRelatedToTopMenu)("work-item-relation-input",200,e.scrollRef.current)}))}},{key:"getAssociatedWorkItems",value:function(){var e=this,t=this.props.currentProject,a=this.state.detailInfoState.code;return(0,w.fetchAssociatedWorkItems)(t.name,a).then((function(t){var a=t.data;e.setState({associatedWorkItems:a})})).finally((function(){return e.dataLoad("workItem")}))}},{key:"initAttributesData",value:function(e){var t=this.state.attributes;this.setState({attributes:tt(tt({},t),{},{assignee:e.assignee&&e.assignee.id||void 0,priority:void 0!==e.priority?e.priority:void 0,dueDate:e.dueDate||void 0,startDate:e.startDate||void 0,defectType:e.defectType&&e.defectType.id||void 0,projectModule:e.projectModule&&e.projectModule.id||void 0,requirementType:e.requirementType&&e.requirementType.id||void 0,labels:e.labels&&!!e.labels.length&&e.labels.map((function(e){return e.id}))||[],watchers:e.watchers&&!!e.watchers.length&&e.watchers.map((function(e){return e.id}))||[],fields:e.issueSchemeFields||{},workingHours:e.workingHours,progress:e.progress}),assignee:e.assignee,watchers:e.watchers||[]})}},{key:"mouseLeave",value:function(e){this["des"===e?"intoDesCount":"intoCommentCount"]=0,this.setState({notUpload:!1})}},{key:"render",value:function(){var e=this,t=this.props,a=t.params,n=t.currentProject,i=t.user,r=t.enterpriseGlobalKey,o=t.enterpriseName,s=t.expanded,l=t.isDetail,c=t.isPermissible,u=t.domID,d=t.autoshowComment,f=t.projectPath,p=t.currentProjectCooperateSettings,m=t.location,h=t.targetData,v=t.epicSchemeFieldArchives,g=t.detailInfo,E=n.name,S=n.id,I=this.state,T=I.detailInfoState,C=I.attachmentsState,P=I.isFilePreviewVisible,w=I.previewFileID,D=I.activities,O=I.description,R=I.markdown,N=I.slateRaw,L=I.isInited,F=I.isHistoryRecordVisible,_=I.currentLogId,M=I.affairsInput,x=I.isCreateAffairsVisible,B=I.isAssociateAffairsVisible,V=I.affairs,G=I.isCreationModalVisible,K=I.initStatus,z=I.citedSources,q=I.citingSources,Z=I.showSideslip,Q=I.activitiesTab,ee=I.isCommentSticky,ie=I.isFullWidth,re=I.isShowItemPlaceholder,ce=I.isRender,ue=I.isRenderAll,fe=I.activeLogTab,pe=I.manHourRecords,ve=I.showDeleteConfirmModal,ge=I.isEdittingCommentModalVisible,Ee=I.willCreateEpicType,be=I.isWorkItemCreationVisible,ye=I.pageId,Se=I.historyId,Ie=I.isDescriptionEmpty,Te=I.minHeight,Ce=I.isDescriptionBtnFixed,Pe=I.identity,Oe=I.slotVisible,je=(0,ze.getSlotContext)(g,n.id),Ne=c([{function:J.ProjectPermissionFunction.PROJECT_ISSUE,action:J.ProjectPermissionAction.UPDATE}]),Le=void 0!==v&&Object.values(v).filter((function(e){return"HOUR_RECORD"===e.issueField.type})).length>0,Fe=(0,b.t)("{{title}}\u6807\u9898\uff08\u6309\u56de\u8f66\u5feb\u901f\u521b\u5efa\uff0cShift + \u56de\u8f66\u5b8c\u6574\u521b\u5efa\uff09",{title:Ee.name}),xe=this.state.isCreationModalVisible,Be=this.state.notUpload&&(this.state.isDesEditing||this.state.isCommentEditing)||xe||ge||Z,Ue=ee?{minHeight:"".concat(Te,"px"),position:"relative"}:{position:"relative"},We=this.state.issueReviewOpen&&this.state.issueReviewList.length>0,Ke=[];ce.logs&&Ke.push({text:(0,b.t)("\u6d3b\u52a8\u65e5\u5fd7"),value:qe.MATTER_TABS_TYPE.ACTIVITY}),Le&&Ke.push({text:(0,b.t)("\u5de5\u65f6\u65e5\u5fd7"),value:qe.MATTER_TABS_TYPE.WORK}),We&&Ke.push({text:(0,b.t)("\u5ba1\u6279"),value:qe.MATTER_TABS_TYPE.APPROVAL});var Je=ce.comment&&fe!==qe.MATTER_TABS_TYPE.WORK&&fe!==qe.MATTER_TABS_TYPE.APPROVAL&&D.length>0&&Q!==qe.ACTIVITIES_TAB.WITHOUT_COMMENT;return y.default.createElement(Re.default,{currentAttachmentNum:C.length,onHandleAttachments:this.fileUpload,notUpload:Be,notUploadElems:this.getNotUploadElems(),onIntoUploadElems:function(){return e.setState({notUpload:!0})}},y.default.createElement(Ae.default.Provider,{value:{scrollControl:this.state.scrollControl}},y.default.createElement("div",{className:U.default.specWrapper,onScroll:this.onAttrScroll},y.default.createElement("div",{className:(0,X.default)(U.default.specDetail,l?U.default.isDetail:"",ie&&U.default.isFullWidth)},this.headerRender(),this.headerRender(!0),y.default.createElement("div",{className:U.default.specMain,ref:this.scrollRef},y.default.createElement("div",{style:Ue,className:(0,X.default)(U.default.detailWrapper,l&&U.default.isDetail)},y.default.createElement("div",{className:"".concat(U.default.detailBody," ").concat(!s&&U.default.isSingleColumned," ").concat(l&&U.default.isDetail," ").concat(ie&&U.default.isFullWidth),ref:this.detailBodyRef,onClick:function(){return e.setState({controlHideButtonActionMore:Date.now()})}},y.default.createElement("div",{className:"".concat(U.default.mainWrapper," ").concat(s&&U.default.mainExpanded)},y.default.createElement("div",{onDragEnter:this.dragEnterDes,onDragLeave:this.dragLeaveDes,onMouseLeave:this.mouseLeaveDes,ref:this.editorRef},y.default.createElement(j.default,{editorType:g.issueDescriptionType,issueId:g.id,isInited:L,readOnly:!Ne,scrollRef:this.scrollRef,code:T.code,autoSaveKey:"".concat(E,"_ISSUE_DETAIL_DESCRIPTION-").concat(T.code),updateDescription:this.updateIssueDescription,updatePageId:function(t){return e.setState({pageId:t})},historyId:Se,currentProject:n,markdown:R,slateRaw:N,description:O,domID:u,flashAnchor:this.props.flashAnchor,enterpriseGlobalKey:r,getThis:this.getEditComp,editStatusChanged:this.editStatusChanged,isShowPlaceholder:Ie&&re.description,location:m,userId:i.id,pageId:ye,setCommentPosition:this.setCommentPosition,onLoad:function(t){e.dataLoad("description"),t&&e.setState({isDescriptionEmpty:t.isEmpty})},isDescriptionBtnFixed:Ce})),C.length>0&&y.default.createElement("div",{className:U.default.sectionWrapper,ref:this.attechmentRef},y.default.createElement(me.ThemeConsumer,null,(function(t){var a=t.hiddenFolderDirs;return y.default.createElement(W.default,{expanded:s,disabled:!Ne,attachments:C,enterpriseGlobalKey:r,currentProjectName:E,currentProjectID:S,currentAttachmentNum:C.length,issueCode:T.code,onHandleAttachments:e.fileUpload,uploadFileSuccess:e.onFileDropSuccess,uploadFileFailed:e.onFileDropFail,uploadFileDelete:e.onFileDropDelete,uploadFileCancel:e.onFileDropCancel,dir:a&&a[H.HIDDEN_FILE_TYPE.EPIC]&&a[H.HIDDEN_FILE_TYPE.EPIC].file_id,previewItemHandle:e.previewItem,userID:i.id})}))),ce.issue&&(V.length>0||re.issue)&&y.default.createElement("div",{className:U.default.sectionWrapper,ref:this.issuesRef},!!K.length&&y.default.createElement(ne.default,{isDetail:l,params:a,isRequirementDeletable:!0,projectID:S,epicCode:T.code,affairs:V,handleSimpleCreate:this.handleAffairsInputShow,callback:this.getIssues,isCreateAffairsVisible:x,onAffairsChange:this.handleAffairsChange,currentProject:n,projectPath:f,isPermissible:c,isFullScreen:!l&&this.state.isFullScreen}),Ne&&x&&y.default.createElement(te.default,{handleAssociate:this.handleAffairsAssociate,ref:this.issueInputRef,placeholder:Fe,className:U.default.subtaskCreationInput,multiple:!0,value:M,onChange:this.handleAffairsInput,onCancel:this.handleAffairsInputCancel,onCreate:this.handleAffairsInputCreate,onSelectIssueType:this.handleSelect,onFullCreate:this.handleAffairsInputFullCreate,initStatus:K,currentProject:n,currentProjectCooperateSettings:p,willCreateIssueType:Ee,isPortal:!0,portalProps:{portalWrapStyle:{zIndex:1099},isScroll:this.state.isElemScroll,resetIsScroll:function(){e.setState({isElemScroll:!1})},offsetX:-12,offsetY:12}}),Ne&&B&&y.default.createElement(ae.default,{ref:this.associateAffairsRef,projectID:S,epicCode:T.code,callback:this.getIssues,onCancel:function(){e.handleAffairsAssociateCancel(),e.handleAffairsInputCancel()}})),ce.workItem&&(this.state.associatedWorkItems.length>0||re.workItem)&&y.default.createElement("div",{className:U.default.sectionWrapper},y.default.createElement(Me.default,{projectID:S,projectPath:f,currentProject:n,issueCode:T.code,allowUpdate:Ne,scrollTargetId:"work-item-relation-input",createVisible:be,onCreateVisibleChange:this.handleWorkItemRelationVisibleChange,controlFocus:this.state.controlFocus,list:this.state.associatedWorkItems,callback:this.workItemRelationChanged,isDetail:l,isFullScreen:!l&&this.state.isFullScreen})),this.state.codeRepoRelationOpened&&ce.codeRepo&&(this.state.associatedCodeRepos.length>0||re.codeRepo)&&y.default.createElement("div",{className:U.default.sectionWrapper},y.default.createElement(_e.default,{projectPath:f,allowUpdate:Ne,list:this.state.associatedCodeRepos,searchResList:this.state.availableCodeRepos,isFocus:this.state.isAssociatedCodeRepoFocus,onFocusChanged:function(t){return e.setState({isAssociatedCodeRepoFocus:t})},onSearch:this.getCodeRepos,onAssociate:this.associateCodeRepo,onCancelAssociate:this.cancelAssociateCodeRepo,onCancel:this.cancelCodeRepo,isDetail:l})),ce.reference&&(Object.keys(z).length>0||Object.keys(q).length>0||re.reference)&&y.default.createElement("div",{className:U.default.sectionWrapper},y.default.createElement(k.default,{flashAnchor:function(t){e.setState({activeLogTab:"activity"},(function(){e.props.flashAnchor(t)}))},currentProject:n,citedSources:z,citingSources:q,markdown:R,autoToggleComment:this.referencesBtnClicked,code:T.code,onRemoveReference:this.onRemoveReference})),Ke.length>=2&&y.default.createElement(y.default.Fragment,null,y.default.createElement("div",{id:"activity-log-tab"}),y.default.createElement(De.default,{tabs:Ke,activeTab:fe,onChange:this.changeActivityLogTab})),ce.logs&&y.default.createElement(y.default.Fragment,null,"activity"===fe&&this.renderActivity(Le),Le&&"work"===fe&&y.default.createElement(we.default,{detailInfo:T,records:pe,onDelete:this.deleteManhourRecord,reloadData:this.fetchManHourRecordsAndFetchSpecData,allowUpdate:Ne})),y.default.createElement("div",{id:"issue-review-list"},We&&"approval"===fe&&y.default.createElement(Ye.default,{isDetail:l,list:this.state.issueReviewList,onItemChange:this.handleReviewListChanged,onShowCreate:function(){e.setState({isShowApproveCreate:!0})},onShowDetail:function(t){e.setState({issueReviewCode:t})},allowUpdate:Ne})),G&&Ee.issueType===H.ISSUE_TYPE.REQUIREMENT&&y.default.createElement(se.default,{show:G&&Ee.issueType===H.ISSUE_TYPE.REQUIREMENT,name:M,closeHandle:this.closeCreateModal,callback:this.getIssues,epicCode:T.code,targetData:h,issueTypeDetail:Ee}),G&&Ee.issueType===H.ISSUE_TYPE.ASSIGNMENT&&y.default.createElement(oe.default,{show:G&&Ee.issueType===H.ISSUE_TYPE.ASSIGNMENT,name:M,closeHandle:this.closeCreateModal,callback:this.getIssues,epicCode:T.code,targetData:h,issueTypeDetail:Ee}),G&&Ee.issueType===H.ISSUE_TYPE.DEFECT&&y.default.createElement(le.default,{show:G&&Ee.issueType===H.ISSUE_TYPE.DEFECT,name:M,closeHandle:this.closeCreateModal,callback:this.getIssues,epicCode:T.code,targetData:h,issueTypeDetail:Ee})))),P&&y.default.createElement(Y.default,{isShown:P,previewFiles:C,onFileViewerHide:this.filePreviewHide,enterpriseGlobalKey:r,currentId:S,currentProjectName:E,currentFileId:w,onHandleDelAttachment:this.handleDeleteAttachmentConfirm}),F&&y.default.createElement($.default,{show:F,closeHandle:this.toggleRecord,enterpriseGlobalKey:r,currentProject:n,issueType:H.HISTORY_RESCORDS[T.type],issueCode:T.code,pageId:ye,currentLogId:_,handleUpdate:this.renewDescription,allowUpdate:Ne}),Z&&y.default.createElement(he.default,{issueList:V,getList:this.getIssues,params:a,currentProject:n,projectPath:f,closeSlideslip:this.closeSlideslip,enterpriseName:o,targetData:h}),y.default.createElement(de.default,{show:ve,type:"ATTACHMENT",text:(0,b.t)("\u786e\u5b9a\u8981\u5220\u9664\u5417\uff1f"),onConfirm:function(){e.handleDelInPreviewFile()},onClose:function(){e.setState({showDeleteConfirmModal:!1})}}),this.state.isShowApproveCreate&&y.default.createElement(He.default,{fromIssueId:this.props.detailInfo.id,onItemChange:function(){return e.handleReviewListChanged(!0)},onCancel:function(){return e.setState({isShowApproveCreate:!1})}}),this.state.issueReviewCode&&y.default.createElement(Ve.default,{allowUpdate:Ne,detailCode:this.state.issueReviewCode,onDetailCodeChange:function(t){e.setState({issueReviewCode:t})},onCancel:function(){e.setState({issueReviewCode:void 0},(function(){e.handleReviewListChanged()}))}}),y.default.createElement(Ge.default,{slotVisible:Oe,identity:Pe,context:je,onClose:function(){return e.setState({slotVisible:!1})}}),!ue&&y.default.createElement(ke.default,null),y.default.createElement("div",{id:"bottom"}),Je&&y.default.createElement(A.default,{autoToggleComment:this.props.autoToggleComment,autoshowComment:!!d[T.code],expanded:s,currentProject:n,avatar:i.avatar,issueCode:T.code,onPostComment:this.postComment,isCommentSticky:ee,isCommentAbsBottom:this.state.isCommentAbsBottom,onEditStatusChanged:function(t,a){e.commentEditorRef=a,e.setState({isCommentEditing:t})},onDragEnterEditor:this.dragEnterComment,onDragLeaveEditor:this.dragLeaveComment,onMouseLeaveEditor:this.mouseLeaveComment,isDetail:l,userID:i.id,isDescriptionBtnFixed:Ce,onRef:function(t){return e.commentStickyContainerRef=t}}))),Z?y.default.createElement("div",{className:(0,X.default)(U.default.specAttribute,l||!l&&this.state.isFullScreen?U.default.isDetail:U.default.isSpec,ie&&U.default.isFullWidth)}):this.renderAttributes())),this.state.showCopyIssues&&y.default.createElement(Ze.default,{user:this.props.user,enterpriseGlobalKey:r,sourceProject:this.props.currentProject,sourceIssueTypeDetail:this.props.issueTypeDetail,sourceIssueCode:this.props.issueCode,callback:this.getIssues,closeHandle:function(){return e.setState({showCopyIssues:!1})}}))}},{key:"isAssignAttrRequired",value:function(e){if(!e)return!1;var t=!1;return Object.keys(e).forEach((function(a){var n=e[a]&&e[a].issueField;n&&"ASSIGNEE"===n.type&&(t=e[a].required)})),t}},{key:"renderAttributes",value:function(){var e=this,t=this.props,a=t.isDetail,n=t.isPermissible,i=t.expanded,r=t.epicSchemeFieldArchives,o=t.epicUpdateFieldIDs,s=t.currentProject,l=t.bugTypes,c=t.requirementTypes,u=t.moduleSchemes,d=t.labels,f=t.addLabel,p=t.issueCode,m=t.detailInfo,h=this.state,v=h.detailInfoState,g=h.attributes,E=h.assignee,S=h.watchers,I=h.isFullWidth,T=h.isInited,C=(0,ze.getSlotContext)(m,s.id),P=n([{function:J.ProjectPermissionFunction.PROJECT_ISSUE,action:J.ProjectPermissionAction.UPDATE}]);return y.default.createElement("div",{className:(0,X.default)(U.default.specAttribute,a||!a&&this.state.isFullScreen?U.default.isDetail:U.default.isSpec,I&&U.default.isFullWidth)},"outer"===this.props.callFrom&&y.default.createElement("div",{className:(0,X.default)(U.default.issueProperty,a&&U.default.isDetail)},y.default.createElement("div",{className:(0,X.default)(U.default.label,a&&U.default.isDetail)},(0,b.t)("\u9879\u76ee")),y.default.createElement("div",{className:(0,X.default)(U.default.customBar,a&&U.default.isDetail)},y.default.createElement(Le.default,{name:this.props.currentProject.display_name,icon:this.props.currentProject.icon,jumpUrl:this.props.currentProject.project_path}))),y.default.createElement("div",{className:(0,X.default)(U.default.issueProperty,a&&U.default.isDetail)},y.default.createElement("div",{className:(0,X.default)(U.default.label,a&&U.default.isDetail)},(0,b.t)("\u72b6\u6001")),y.default.createElement(O.default,{className:(0,X.default)(U.default.step,U.default.customBar,a&&U.default.isDetail),projectID:s.id,project:s,issueCode:p,value:v.issueStatus,onSelect:this.onStatusChange,disabled:!P,isDetail:a,hoverControlArrow:!0,labelSize:"default"})),y.default.createElement("div",{className:(0,X.default)(U.default.issueProperty,a&&U.default.isDetail)},y.default.createElement("div",{className:(0,X.default)(U.default.label,a&&U.default.isDetail,this.isAssignAttrRequired(r)&&U.default.required)},(0,b.t)("\u5904\u7406\u4eba")),y.default.createElement("div",{className:(0,X.default)(U.default.customBar,a&&U.default.isDetail)},y.default.createElement(ee.default,{disabled:!P,inProject:!0,projectID:s.id,value:g.assignee||null,onSelect:function(t){return e.changeAttributes({type:"assignee",value:t.id})},onClear:function(){return e.changeAttributes({type:"assignee"})},triggerExtraProps:{initialSelectedItem:E}}))),y.default.createElement("div",{className:U.default.splitLine,style:{marginTop:"16px"}}),T&&y.default.createElement(V.default,{expanded:i,className:U.default.issueProperties,isCreate:!1,schemeFieldArchives:r,fieldIds:o,issueType:"EPIC",onChange:this.changeAttributes,customAttributes:g,assignee:E,watchers:S,isFromDetailPage:a||i,isDetailPage:a,permissionFunction:J.ProjectPermissionFunction.PROJECT_ISSUE,projectID:s.id,currentProject:s,bugTypes:l,requirementTypes:c,moduleSchemes:u,labels:d,addLabel:f,isPermissible:n,detailInfo:m,activities:this.state.activities,onManHourUpdate:function(){e.fetchManHourRecords().then((function(){e.changeAttributes({type:""})}))},onForwardLogs:function(){(0,Q.scrollRelatedToTopMenu)("activity-log-tab",200,e.scrollRef.current),e.setState({activeLogTab:"work"})},portalProps:{toRight:this.getDropdownPortalToRight(),portalWrapStyle:{zIndex:1099},isScroll:this.state.isElemScroll,resetIsScroll:function(){e.setState({isElemScroll:!1})}}}),y.default.createElement("div",{className:(0,X.default)(U.default.createTime,U.default.creatorInfo),title:"".concat(v.creator.name).concat((0,b.t)(" \u521b\u5efa\u4e8e ")).concat((0,_.default)((0,x.timeFormat)(v.createdAt,"YYYY-MM-DD HH:mm:ss")).fromNow())},v.creator.name," ",(0,b.t)("\u521b\u5efa\u4e8e")," ",(0,_.default)((0,x.timeFormat)(v.createdAt,"YYYY-MM-DD HH:mm:ss")).fromNow()),y.default.createElement(Ke.default,{context:C}))}},{key:"onScroll",value:function(e){var t=this.state,a=t.isDesEditing,n=t.isDescriptionBtnFixed;if(a){var i,r,o,s,l=this.scrollRef.current.scrollTop,c=this.scrollRef.current.getBoundingClientRect().height,u=this.editorRef.current.getBoundingClientRect().height,d=(null===(i=this.commentStickyContainerRef)||void 0===i||null===(r=i.current)||void 0===r?void 0:r.offsetHeight)||0;n=u>=c+l-(null===(o=this.headerRef)||void 0===o||null===(s=o.current)||void 0===s?void 0:s.offsetHeight)-d}this.setState({scrollControl:Date.now(),isDescriptionBtnFixed:n}),clearTimeout(this.scrollRunId),e.stopPropagation(),this.scrollRunId=setTimeout(this.doScroll,50)}},{key:"componentDidMount",value:function(){var e=this.props,t=e.user,a=e.watermark,n=e.payed,i=e.isDetail,r=e.params.subIssueCode,o=e.detailInfo,s=e.inAllList,l=e.getLabels;this.scrollRef.current&&this.scrollRef.current.addEventListener("scroll",this.onScroll,!1);var c=(0,Be.getWatermarkPaymentState)();if(l&&l(),r&&!s&&this.openSlideslip(),this.initAttributesData(o),this.getBasicInfo(),o.pageId?this.state.isDescriptionEmpty&&this.dataLoad("description"):this.dataLoad("description"),!c||n){var u=(0,Ee.getText)(t);(0,Ee.watermarkService)(a,u,i)}document.addEventListener("keyup",this.handleFullScreenKey)}},{key:"handleInput",value:function(e){var t=(0,L.default)(this.state.detailInfoState,(function(t){t.name=e}));this.setState({detailInfoState:t},this.submitTitleChange)}},{key:"componentWillUnmount",value:function(){var e=this.props,t=e.payed,a=e.isDetail;(0,Be.getWatermarkPaymentState)()&&!t||(0,Ee.removeWatermark)(a),document.removeEventListener("keyup",this.handleFullScreenKey)}},{key:"componentDidUpdate",value:function(e,t){var a=this,n=this.props,i=n.params,r=n.detailInfo,o=n.issueCode,s=e.params,l=e.detailInfo,c=t.controlCaculatePos,u=this.state.controlCaculatePos;(0,M.default)(s,i)||(s.epicCode!==i.epicCode&&(this.props.getEpicScheme(),this.getIssues(!0)),i.subIssueCode?this.openSlideslip():this.closeSlideslip()),(0,M.default)(r,l)||this.updateDetailInfo(o,r),u!==c&&0!==u&&this.setCommentPosition((function(){a.setState({isScrollTakeEffect:!0})}))}},{key:"updateDetailInfo",value:function(e,t){var a=this;this.setState(tt({detailInfoState:t,attachmentsState:(0,o.default)(t.files)},this.isDeleteInFilePreview?{isFilePreviewVisible:!1}:null),(function(){a.isDeleteInFilePreview=!1,a.initAttributesData(t),a.getIssues(!0)}))}},{key:"openSlideslip",value:function(){this.setState({showSideslip:!0})}},{key:"closeSlideslip",value:function(){this.setState({showSideslip:!1})}},{key:"getBasicInfo",value:function(){var e=this,t=this.getFunctionFlags(),a=t.codeManagementOpen,n=t.issueReviewOpen;this.setState({issueReviewOpen:n}),Promise.all([this.props.getRequirementTypes(),this.props.getBugTypes(),this.props.getModuleSchemes(),this.props.getEpicScheme(),this.getIssueInitStatus()].concat((0,o.default)(a?[this.getCodeRepoSetting()]:[]),(0,o.default)(n?[this.fetchIssueReviewList()]:[]),[this.getIssues(!0)])).then((function(){e.setState({isInited:!0})})),a||this.dataLoad("codeRepo"),this.insideProgramCheck(),this.fetchManHourRecords(),this.getResourceReference().then((function(){e.dataLoad("reference")}))}},{key:"closeCreateModal",value:function(){this.setState({isCreationModalVisible:!1})}},{key:"fileUpload",value:function(e){var t=this.state.attachmentsState;this.setState({attachmentsState:[].concat((0,o.default)(t),(0,o.default)(e))})}},{key:"filePreviewHide",value:function(e){this.setState({isFilePreviewVisible:e})}},{key:"previewItem",value:function(e){this.setState({previewFileID:e,isFilePreviewVisible:!0})}},{key:"handleDelInPreviewFile",value:function(){var e=this,t=this.state.deleteFileId;this.isDeleteInFilePreview=!0,this.updateIssue({delFileIds:[t]},(function(){e.setState({deleteFileId:void 0,showDeleteConfirmModal:!1})}))}},{key:"handleDeleteAttachmentConfirm",value:function(e,t){this.setState({showDeleteConfirmModal:!0,deleteFileId:t})}},{key:"combineThirdLinks",value:function(e,t){if(!t)return e;var a=t.map((function(e){var t="MODAO"===e.thirdType,a="CODESIGN"===e.thirdType,n="";return t&&(n=e.title||(0,b.t)("\u58a8\u5200\u9644\u4ef6")),a&&(n=e.title),tt(tt({},e),{},{isModao:t,isCodesign:a,fileId:e.id,name:n,preview:t&&e.link})})),n=[].concat((0,o.default)(e),(0,o.default)(a));return n.sort((function(e,t){return(e.createdAt||e.created_at)-(t.createdAt||t.created_at)})),n}},{key:"onVisibleChange",value:function(){this.setState({tooltipTitle:(0,b.t)("\u590d\u5236\u94fe\u63a5")})}},{key:"onCopyClick",value:function(){this.setState({tooltipTitle:(0,b.t)("\u5df2\u590d\u5236")})}},{key:"onNameChange",value:function(e){var t=(0,L.default)(this.state.detailInfoState,(function(t){t.name=e.target.value}));this.setState({detailInfoState:t})}},{key:"submitTitleChange",value:function(){var e=this,t=this.state.detailInfoState,a=this.props.detailInfo;t.name&&t.name.length<=128?t.name!==a.name&&this.updateIssue({name:t.name.trim()},(function(){e.titleInputRef&&e.titleInputRef.current&&(e.titleInputRef.current.blur(),e.setState({noHoverIcon:!0},(function(){setTimeout((function(){e.setState({noHoverIcon:!1})}),0)}))),e.setState({detailInfoState:tt(tt({},t),{},{name:t.name.trim()})})})):(0,B.warning)((0,b.t)("\u8bf7\u8f93\u5165\u4e0d\u8d85\u8fc7128\u4f4d\u7684\u53f2\u8bd7\u540d\u79f0"))}},{key:"onStatusChange",value:function(e){return this.updateIssue(e)}},{key:"getIssues",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=this.props,n=a.currentProject,i=a.issueCode,r=a.refreshCallback;return this.getActivityList(),(0,P.fetchIssues)(n.id,i).then((function(a){var n=a.data;e.setState({affairs:n,affairsInput:""}),!t&&r&&r(),e.dataLoad("issue")}))}},{key:"getIssueInitStatus",value:function(){var e=this,t=this.props.currentProject;return(0,pe.fetchIssueInitStatus)(t.id).then((function(t){var a=t.data;e.setState({initStatus:Object.keys(a).filter((function(e){return!!a[e]})).filter((function(e){return"EPIC"!==e}))})}))}},{key:"changeAttributes",value:function(e){var t,a=e.isCustom,n=e.type,i=e.value,r=e.issueFieldId,o=this.state.attributes,s=this.props.epicSchemeFieldArchives;if(a){var c=o.fields,u=i;!i&&(0,q.default)(c[r])?u=[]:!i&&((0,K.default)(c[r])||(0,z.default)(c[r])||(0,G.default)(c[r]))&&(u=null),s[r].issueField.componentType!==Fe.PROPERTY_TYPE_CONSTANTS.SELECT_MEMBER_SINGLE&&s[r].issueField.componentType!==Fe.PROPERTY_TYPE_CONSTANTS.SELECT_ITERATION_SINGLE||(u=i?i.id:null),s[r].issueField.componentType!==Fe.PROPERTY_TYPE_CONSTANTS.SELECT_MEMBER_MULTI&&s[r].issueField.componentType!==Fe.PROPERTY_TYPE_CONSTANTS.SELECT_ITERATION_MULTI||(u=i?i.map((function(e){return e.id})):[]),t={customFieldValueMap:[{id:r,content:u}]}}else switch(n){case"defectType":t={defectTypeId:i||0};break;case"requirementType":t={requirementTypeId:i||0};break;case"priority":case"assignee":t=tt({},(0,l.default)({},n,i||0));break;case"labels":case"watchers":var d=o.labels,f=o.watchers,p="labels"===n?"labelIds":"watchers",m="labels"===n?"delLabelIds":"delWatchers",h="labels"===n?d:f,v=Array.from(new Set(h.concat(i)));if(i)if(v.length===h.length){var g=h.findIndex((function(e){return!i.includes(e)}));t=(0,l.default)({},m,[h[g]])}else t=(0,l.default)({},p,[i[i.length-1]]),"watchers"===n&&(i=v);else t=(0,l.default)({},m,h);break;case"projectModule":t={projectModuleId:i||0};break;case"workingHours":t={workingHours:i||0};break;default:t=(0,l.default)({},n,i)}this.setState({attributes:tt(tt({},o),a?{fields:tt(tt({},o.fields),{},(0,l.default)({},r,i))}:(0,l.default)({},n,i))}),this.updateIssue(t)}},{key:"deleteIssue",value:function(){var e=this.props,t=e.currentProject,a=e.projectPath,n=e.refreshCallback,i=e.location,r=i.pathname,o=i.search,s=e.browserRouter,l=e.callFrom,c=this.state.detailInfoState,u=(0,ue.currentListPath)(r);(0,P.deleteIssue)(t.id,c.code).then((function(){(0,B.success)((0,b.t)("\u5220\u9664\u6210\u529f")),"outer"===l?(0,Pe.emitFromPM)({type:"closeSlide"}):s.push("".concat(a,"/").concat(u,"/issues/").concat(o)),n(!0)}))}},{key:"updateIssue",value:function(e,t){var a=this,n=this.props.currentProject,i=this.state,r=i.detailInfoState,s=i.attachmentsState;return(0,P.modifyIssue)(n.id,r.code,e).then((function(t){var n=t.data;return n.files=a.combineThirdLinks(n.files,n.thirdLinks),a.callback(n,e.statusId),a.getActivityList(),(0,B.success)((0,b.t)("\u66f4\u65b0\u6210\u529f")),t}),(function(t){var n=t.code,i=t.data,l=t.msg;return 8015===n?i.issue_status_id===e.statusId?(a.callback(null,e.statusId),a.getActivityList(),(0,B.success)((0,b.t)("\u66f4\u65b0\u6210\u529f"))):((0,B.danger)((0,b.t)("\u66f4\u65b0\u5931\u8d25\uff0c\u5f53\u524d\u72b6\u6001\u4e0d\u6b63\u786e\u3002")),a.callback(null,i.issue_status_id),a.getActivityList()):((0,B.danger)((0,Z.getErrorMessage)(l)),a.setState({detailInfoState:r,attachmentsState:(0,o.default)(s.filter((function(e){return e.fileId>0})))},(function(){a.initAttributesData(r)}))),t})).finally((function(){"function"===typeof t&&t()}))}},{key:"callback",value:function(e,t){var a=this.props.updateCallback;a&&a(e,t)}},{key:"updateIssueDescription",value:function(e){var t=this,a=this.props,n=a.currentProject,i=a.issueCode;return(0,pe.modifyIssueDescription)(n.id,i,tt({},e)).then((function(){t.getActivityList(),t.getResourceReference()}))}},{key:"getResourceReference",value:function(){var e=this,t=this.state.detailInfoState,a=this.props.currentProject;return Promise.all([(0,pe.fetchCitedResourceReference)(a.id,t.code),(0,pe.fetchCitingResourceReference)(a.id,t.code)]).then((function(t){e.setState({citedSources:t[0].data,citingSources:t[1].data})}))}},{key:"onRemoveReference",value:function(){(0,B.success)((0,b.t)("\u53d6\u6d88\u5173\u8054\u6210\u529f")),this.getResourceReference(),this.getActivityList()}},{key:"getActivityList",value:function(e){var t=this,a=this.props.issueCode,n=this.props.currentProject.id;return(0,P.fetchIssueActitvites)(n,a).then((function(a){t.setState({activities:a.data},(function(){e&&e(),setTimeout(t.setCommentPosition,0)})),t.dataLoad("logs")}))}},{key:"handleEditCommentCallback",value:function(e){var t=this;this.getActivityList((function(){setTimeout((function(){(0,Q.scrollRelatedToTopMenu)("comment-".concat(e),0,t.scrollRef.current)}))})),this.getResourceReference()}},{key:"postComment",value:function(e,t,a,n,i){var r=this,o=this.scrollRef;return(0,P.addComment)({projectID:e,issueCode:t,content:a,parentID:n}).then((function(e){i&&i(),r.getResourceReference(),r.getActivityList((function(){setTimeout((function(){(0,Q.scrollRelatedToTopMenu)("comment-".concat(e.data.id),0,o.current)}))}))}))}},{key:"deleteComment",value:function(e,t,a,n){var i=this;(0,P.deleteComment)(e,t,a).then((function(){n&&n(),i.getResourceReference(),i.getActivityList()}))}},{key:"handleDeleteAttachment",value:function(e,t){t?this.handleDeleteModao(e):this.updateIssue({delFileIds:[e]})}},{key:"handleDeleteModao",value:function(e){var t=this,a=this.props,n=a.currentProject.id,i=a.issueCode;(0,be.deleteModao)(n,i,e).then((function(){(0,B.success)((0,b.t)("\u5220\u9664\u6210\u529f")),t.setState({attachmentsState:t.state.attachmentsState.filter((function(t){return t.fileId!==e}))}),t.getActivityList()}))}},{key:"onFileDropSuccess",value:function(e){var t=this;if(e.isCanceled)this.setState({attachmentsState:(0,L.default)(this.state.attachmentsState,(function(t){var a=t.findIndex((function(t){return t.timestamp===e.timestamp}));t.splice(a,1)}))});else if(e.isModao||e.isCodesign){(0,B.success)((0,b.t)("\u66f4\u65b0\u6210\u529f"));var a=this.props,n=a.currentProject.id,i=a.issueCode;(0,P.fetchIssueDetail)(n,i,{withDescriptionMarkup:!0}).then((function(e){var a=e.data;t.setState({attachmentsState:t.combineThirdLinks(a.files,a.thirdLinks)},(function(){t.scrollToAttechment()}))})),this.getActivityList()}else this.updateIssue({fileIds:[e.fileId]},(function(){t.scrollToAttechment()}))}},{key:"onFileDropFail",value:function(e){var t=e.timestamp;this.setState({attachmentsState:(0,L.default)(this.state.attachmentsState,(function(e){var a=e.findIndex((function(e){return e.timestamp===t}));e.splice(a,1)}))})}},{key:"onFileDropDelete",value:function(e){var t=e.fileId,a=e.isModao,n=e.isCodesign;this.handleDeleteAttachment(t,a||n)}},{key:"onFileDropCancel",value:function(e){var t=e.timestamp;this.setState({attachmentsState:(0,L.default)(this.state.attachmentsState,(function(e){var a=e.findIndex((function(e){return e.timestamp===t}));e[a].isCanceled=!0}))})}},{key:"formatIterationList",value:function(e){return e.map((function(e){return{value:e.code,text:e.name,progress:{finished:e.completedCount,processing:e.processingCount,unstart:e.waitProcessCount}}}))}},{key:"formatIteration",value:function(e){return e?{value:e.code,text:e.name,progress:{finished:e.completedCount,processing:e.processingCount,unstart:e.waitProcessCount}}:null}},{key:"toggleRecord",value:function(){var e=this.state.isHistoryRecordVisible;this.setState({isHistoryRecordVisible:!e})}},{key:"viewRecord",value:function(e){var t=e.currentId;this.setState({isHistoryRecordVisible:!0,currentLogId:t})}}]),a}(y.Component),g.propTypes=tt(tt({detailInfo:I.default.object,issueList:I.default.array,projectPath:I.default.string,params:I.default.object,expanded:I.default.bool,isDetail:I.default.bool,currentProject:I.default.object,labels:I.default.array,user:I.default.object,getEpicScheme:I.default.func,moduleSchemes:I.default.array,getModuleSchemes:I.default.func,epicSchemeFieldArchives:I.default.object,epicUpdateFieldIDs:I.default.array,updateCallback:I.default.func,refreshCallback:I.default.func,enterpriseGlobalKey:I.default.string,enterpriseName:I.default.string,watermark:I.default.string,payed:I.default.bool,location:I.default.object,issueCode:I.default.oneOfType([I.default.number,I.default.string]),autoshowComment:I.default.object,autoToggleComment:I.default.func,domID:I.default.string,flashAnchor:I.default.func,scrollRef:I.default.any},J.WithProjectPermissionProps),{},{browserRouter:I.default.object,inAllList:I.default.bool,callFrom:I.default.string,getLabels:I.default.func,targetData:I.default.object,willCreateEpicType:I.default.object}),g.defaultProps={expanded:!0,issueList:[],isDetail:!1},v=E))||v)||v)||v)||v)||v)||v)||v)||v)||v)||v);t.default=it},Clsu:function(e,t,a){"use strict";var n=a("5JFE"),i=a("cDcd"),r=a.n(i),o=a("mVeg"),s=a("Mdvu"),l=a("DlAp"),c=a("te0o"),u=a("DJc2"),d=a.n(u),f=(a("0+fR"),a("eydm")),p=a("TGxl"),m=a("EAU0"),h=a.n(m),v=a("JyMx"),g=a("dtw8"),E=a("DTVk"),b=function(){return(b=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},y=function(e,t,a,n){return new(a||(a=Promise))((function(i,r){function o(e){try{l(n.next(e))}catch(t){r(t)}}function s(e){try{l(n.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,s)}l((n=n.apply(e,t||[])).next())}))},S=function(e,t){var a,n,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(l){return function(s){if(a)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(a=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(l){s=[6,l],n=0}finally{a=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},I=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o};t.a=Object(g.withRouter)((function(e){var t=e.visable,a=e.onClose,u=e.getContainer,m=e.modeType,g=void 0===m?"empty":m,T=I(n.Form.useForm(),1)[0],C=Object(i.useContext)(l.b).state,P=C.type,w=C.currentProject,D=C.issueType,O=C.activeFilterContent,R=Object(p.d)(),j=I(Object(i.useState)({sharedTeam:!1}),2),k=j[0],N=j[1];return r.a.createElement(n.Modal,{title:Object(o.t)("empty"===g?"\u65b0\u5efa\u7b5b\u9009\u5668":"\u4fdd\u5b58\u4e3a\u7b5b\u9009\u5668"),visible:t,getContainer:u||function(){return R.current},zIndex:3e3,width:520,top:"5%",onCancel:a,className:"antPModal",footer:r.a.createElement(r.a.Fragment,null,r.a.createElement(n.Button,{onClick:a},Object(o.t)("\u53d6\u6d88")),r.a.createElement(n.Button,{type:"primary",onClick:function(){return y(void 0,void 0,void 0,(function(){var t,i,r;return S(this,(function(o){switch(o.label){case 0:return[4,T.validateFields()];case 1:return o.sent(),t=T.getFieldsValue(!0),i={sort:{key:"CODE",value:"DESC"},conditions:[]},"team"===P&&(i.sort.key="CREATED_AT"),"new"===g&&(i=Object(f.b)(O)),t.isSpread=t.isSpread?1:0,[4,Object(c.h)(P,w.id,D,b({content:i},t),{code:e.router.params.code})];case 2:return r=o.sent().data,n.message.success("\u65b0\u589e\u7b5b\u9009\u5668\u6210\u529f"),s.default.emit(s.EventBusType.FilterLayout,s.FilterLayoutEventKeys.filterReloadScheme,{schemeId:r.id}),a(),[2]}}))}))},"data-container":!0,"data-title":"\u7b5b\u9009\u5668-\u53e6\u5b58\u4e3a-\u786e\u5b9a"},Object(o.t)("\u786e\u5b9a")))},r.a.createElement(n.Form,{layout:"vertical",form:T,onValuesChange:function(e,t){var a=t.sharedTeam;a!==k.sharedTeam&&N({sharedTeam:a})},id:"addFilterForm"},r.a.createElement("div",{className:d.a.tipInfo},Object(o.t)("\u5305\u542b\u7b5b\u9009\u6761\u4ef6\u3001\u6392\u5e8f\u3001\u663e\u793a\u8bbe\u7f6e\u3001\u641c\u7d22\u5185\u5bb9\u548c\u89c6\u56fe\u6a21\u5f0f\u3002")),r.a.createElement(n.Form.Item,{name:"name",className:d.a.formItem,label:Object(o.t)("\u7b5b\u9009\u5668\u540d\u79f0"),rules:[{required:!0,message:Object(o.t)("\u8bf7\u8f93\u5165\u7b5b\u9009\u5668\u540d\u79f0")},{message:Object(o.t)("\u6700\u5927\u652f\u630120\u4e2a\u5b57\u7b26"),max:20,trigger:"change"}]},r.a.createElement(n.Input,{placeholder:Object(o.t)("\u8bf7\u8f93\u5165\u7b5b\u9009\u5668\u540d\u79f0"),maxLength:20})),"team"!==P&&r.a.createElement(n.Form.Item,{name:"sharedTeam",className:d.a.formItem,label:Object(o.t)("\u53ef\u89c1\u6027"),rules:[{required:!0}],initialValue:!1,extra:k.sharedTeam?Object(o.t)("\u7814\u53d1\u7a7a\u95f4\u5185\u5176\u5b83\u6210\u5458\u5747\u53ef\u89c1\u3002"):Object(o.t)("\u4ec5\u4e2a\u4eba\u53ef\u89c1\uff0c\u56e2\u961f\u5185\u5176\u5b83\u6210\u5458\u4e0d\u53ef\u89c1\u3002")},r.a.createElement(n.Radio.Group,null,r.a.createElement(n.Radio,{value:!1}," ",Object(o.t)("\u4e2a\u4eba\u7b5b\u9009\u5668")," "),r.a.createElement(n.Radio,{value:!0}," ",Object(o.t)("\u56e2\u961f\u7b5b\u9009\u5668")," "))),"team"!==P&&r.a.createElement(r.a.Fragment,null,D===E.IssueType.iteration_issue&&r.a.createElement(n.Form.Item,{name:"sharedIteration",className:d.a.formItem,initialValue:!1,valuePropName:"checked"},r.a.createElement(h.a,null,r.a.createElement("span",{style:{margin:"0 5px"}},Object(o.t)("\u8bbe\u4e3a\u8fed\u4ee3\u5171\u7528\u7b5b\u9009\u5668")),r.a.createElement(n.Tooltip,{title:Object(o.t)("\u8fed\u4ee3\u5171\u7528\u7b5b\u9009\u5668\u5bf9\u7814\u53d1\u7a7a\u95f4\u5185\u6240\u6709\u8fed\u4ee3\u53ef\u89c1"),getPopupContainer:function(){return document.getElementById("addFilterForm")}},r.a.createElement(v.a,null)))),r.a.createElement(n.Form.Item,{name:"isSpread",className:d.a.formItem,initialValue:!1,valuePropName:"checked"},r.a.createElement(h.a,null,r.a.createElement("span",{style:{margin:"0 5px"}},Object(o.t)("\u5e73\u94fa\u5c55\u793a\u7b5b\u9009\u9879")))))))}))},D0tD:function(e,t,a){e.exports=a.p+"501e80cff4fd53852f6118a957073645.svg"},D3Zx:function(e,t,a){e.exports={label:"label-3FiiCZXHmt",tag:"tag-3KsGIJZ8S_",expand:"expand-34Hkt-f9jp","add-icon":"add-icon-oxPqvfdntU",addIcon:"add-icon-oxPqvfdntU","down-icon":"down-icon-36mCpjxOUm",downIcon:"down-icon-36mCpjxOUm",disabled:"disabled-1EtCS2Y5Ut",tooltip:"tooltip-2IJR2bEz2I",text:"text-18GfQ5we7Q","title-container":"title-container-1JGKWYMPOm",titleContainer:"title-container-1JGKWYMPOm",member:"member-1saiDoW0J7"}},D7qk:function(e,t,a){e.exports=a.p+"cdb4eec767b32b6b3729b3628662393d.svg"},DCvS:function(e,t,a){e.exports={item:"item-EOzmcv-yX7","item-icon":"item-icon-1eeCkh4Yxr",itemIcon:"item-icon-1eeCkh4Yxr","item-code":"item-code-2cjcLcY_yP",itemCode:"item-code-2cjcLcY_yP","item-name":"item-name-2rr7pSlFR-",itemName:"item-name-2rr7pSlFR-","item-program":"item-program-6hJN12mG-I",itemProgram:"item-program-6hJN12mG-I",icon:"icon-1RIAH8nSpI",name:"name-3Yxb0DZkmI","item-delay":"item-delay-1MmCLmzO7i",itemDelay:"item-delay-1MmCLmzO7i","item-date":"item-date-c0PCikcJRO",itemDate:"item-date-c0PCikcJRO","item-priority":"item-priority-c0WmITT5Tb",itemPriority:"item-priority-c0WmITT5Tb","item-status":"item-status-3vTlV6pN65",itemStatus:"item-status-3vTlV6pN65","item-assignee":"item-assignee-1gKh7syWnB",itemAssignee:"item-assignee-1gKh7syWnB","to-right":"to-right-2lsftDyRBH",toRight:"to-right-2lsftDyRBH"}},DJc2:function(e,t,a){e.exports={filterLayout:"filterLayout-3Pq7IxmkNE",filterHeader:"filterHeader-1r5Kbybf0U",headerScheme:"headerScheme-3SLDMJaGV6",headerLeft:"headerLeft-1o4-7KZLPF",headerRight:"headerRight-HB6GR6f1FQ",filterChanedMain:"filterChanedMain-3GZJ_M9gZd",btn:"btn-1QXj3hIEEi",filterBarSectionCreationButton:"filterBarSectionCreationButton-17CtYMYtCV",tipInfo:"tipInfo-3XVthChYvq",formItem:"formItem-1nUI6RUuii",fixedIcon:"fixedIcon-101r1mgwmI",filterContent:"filterContent-OiEQ5SMd1D",filterAttrs:"filterAttrs-4uMCBe0QDZ",filterSorts:"filterSorts-DmMocvcWiF",filterItem:"filterItem-3fG_uDCc22",rowCenter:"rowCenter-1unr6gmuKr",schemeDropdowmTitle:"schemeDropdowmTitle-fRnfrUCTWH",leftSider:"leftSider-3pt-r8VF4S",schemeSider:"schemeSider-1uyc3wjxdK",sliderTitle:"sliderTitle-34rfNPHmQL",schemeTitle:"schemeTitle-1jv4xe_IZI",schemeAdd:"schemeAdd-2eGdV3OPDT",schemeSiderMain:"schemeSiderMain-3IRcx36bZE",fixedToTop:"fixedToTop-CQnF4WZcH-",iconPop:"iconPop-15ELLwlEy0",schemeDropdowmContent:"schemeDropdowmContent-9RQ5G3xqZU",schemeContent:"schemeContent-14bFzFJ0Ux",item:"item-1RXCe34gUs",schemeMain:"schemeMain-1J9XwSU2Lf",line:"line-3GjwExAF-t",add:"add-2qK8E9iTQJ",pb4:"pb4-31-LZE0Ion",pl4:"pl4-1P_Gea50fc",pl5:"pl5-Vu6IZnzKKo",flexBetween:"flexBetween-1aUekoAw1F",menuDelete:"menuDelete-1U0S-EgKce"}},DbF1:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"c",(function(){return r})),a.d(t,"b",(function(){return o})),a.d(t,"d",(function(){return s}));var n=a("Z4vw"),i=function(e,t,a){return Object(n.postJSON)("/external/collaboration/agile/api/team-view/issues?".concat(Object(n.buildParams)(a)),e,t)},r=function(e,t,a){return Object(n.get)("/api/platform/project/projects/search?".concat(Object(n.buildParams)({page:e,pageSize:t,keyword:a,type:"JOINED",sort:"NAME",order:"ASC",archived:!1})))},o=function(e,t,a){return Object(n.get)("/agile/api/team-view/iterations?".concat(Object(n.buildParams)({page:e,pageSize:t,keyword:a})))},s=function(e){return Object(n.get)("/api/platform/program/".concat(e,"/projects?").concat(Object(n.buildParams)({queryJoined:!0})))}},Dihu:function(e,t,a){e.exports={trigger:"trigger-177_rlNhN0","trigger-active":"trigger-active-HMgLZESkNU",triggerActive:"trigger-active-HMgLZESkNU",popup:"popup-3r6tSZKyWl",option:"option-1QH46d06ND","option-delete":"option-delete-1uSqg9ZJd8",optionDelete:"option-delete-1uSqg9ZJd8",divider:"divider-31FdMTzcH3"}},DlAp:function(e,t,a){"use strict";a.d(t,"a",(function(){return E})),a.d(t,"b",(function(){return N}));var n,i,r,o,s,l,c,u,d,f,p,m,h,v,g,E,b=a("V/h/"),y=a("cDcd"),S=a.n(y),I=a("eydm"),T=a("LvDl"),C=a("4b23"),P=a("jgPD"),w=a("fmVk"),D=function(){return(D=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},O=function(e,t,a,n){return new(a||(a=Promise))((function(i,r){function o(e){try{l(n.next(e))}catch(t){r(t)}}function s(e){try{l(n.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,s)}l((n=n.apply(e,t||[])).next())}))},R=function(e,t){var a,n,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(l){return function(s){if(a)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(a=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(l){s=[6,l],n=0}finally{a=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},j=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o};!function(e){e.init="init",e.setActiveFilterContent="setActiveFilterContent",e.addActiveFilter="addActiveFilter",e.setDefaultFilter="setDefaultFilter",e.setCurrentFilterScheme="setCurrentFilterScheme",e.setFilterSchemes="setFilterSchemes",e.setFilterList="setFilterList",e.setHashFilterContent="setHashFilterContent",e.setSchemesList="setSchemesList",e.setType="setType",e.setFieldsArchives="setFieldsArchives",e.setLoading="setLoading",e.setCustomParams="setCustomParams",e.setCustomLoad="setCustomLoad",e.setProjectIdList="setProjectIdList"}(E||(E={}));var k=function(){var e=this;this.actions=function(t,a){return e[a.type](D({},t),a)},this[n]=function(e,t){return e.type=t.value,e},this[i]=function(e,t){var a=e.filterSchemes,n=e.currentFilterScheme,i=a[n.value]?D({},a[n.value].content):{};return Object.assign(e,t.value),Object(I.a)(e,i),e.hasFilterChanged=!1,e.loading.schemeLoad=!0,e},this[r]=function(e,t){var a,n,i,r,o,s,l,c,u=t.value.pingPuChange;delete t.value.pingPuChange,e.prevActiveFilterContent=e.activeFilterContent,t.value instanceof Function?e.activeFilterContent=Object(b.default)(e.activeFilterContent,(function(e){t.value(e)})):e.activeFilterContent=t.value;var d=e.filterSchemes[e.currentFilterScheme.value]?e.filterSchemes[e.currentFilterScheme.value].content:{},f=null===(n=null===(a=null===e||void 0===e?void 0:e.activeFilterContent)||void 0===a?void 0:a.conditions)||void 0===n?void 0:n.find((function(e){return"PRODUCT_GROUP_ID"===e.key})),p=null===(r=null===(i=null===e||void 0===e?void 0:e.prevActiveFilterContent)||void 0===i?void 0:i.conditions)||void 0===r?void 0:r.find((function(e){return"PRODUCT_GROUP_ID"===e.key}));if((f||p)&&(null===f||void 0===f?void 0:f.value)!==(null===p||void 0===p?void 0:p.value)){var m=null===(c=null===(l=null===(s=null===(o=null===w.store||void 0===w.store?void 0:w.store.getState())||void 0===o?void 0:o.APP)||void 0===s?void 0:s.issueList)||void 0===l?void 0:l.filter((function(e){return"prd_requirement"===e.type})))||void 0===c?void 0:c.map((function(e){return e.id}));Object(P.getProductGroupLabelList)({issueTypeId:m||[],productGroupIds:null===f||void 0===f?void 0:f.value})}return Object(I.a)(e,d,u),e},this[o]=function(e,t){return e.activeFilterContent=Object(b.default)(e.activeFilterContent,(function(e){e.conditions.push({key:"",value:[],fixed:!1,id:Object(C.a)()})})),e},this[s]=function(e,t){return e.defaultFilter=t.value,e},this[l]=function(e,t){return e.currentFilterScheme=t.value,e},this[c]=function(e,t){return e.filterSchemes=t.value,e},this[u]=function(e,t){return e.filterList=t.value,e.loading.filterListLoad=!0,e},this[d]=function(e,t){return e.hashFilterContent=t.value,e},this[f]=function(e,t){return e.filterSchemes=t.value,e},this[p]=function(e,t){return e.fieldsArchives=t.value,e},this[m]=function(e,t){return e.loading=D(D({},e.loading),t.value),e},this[h]=function(e,t){if(Object(T.isObject)(t.value)){var a=D({},e.customParams);Object.keys(t.value).forEach((function(e){Object(T.isObject)(t.value[e])?a[e]=D(D({},a[e]),t.value[e]):a[e]=t.value[e]})),e.customParams=a}else e.customParams=t.value;return e},this[v]=function(e,t){return e.customLoading=D(D({},e.customLoading),t.value),e},this[g]=function(e,t){return e.projectIdList=t.value,e}};n=E.setType,i=E.init,r=E.setActiveFilterContent,o=E.addActiveFilter,s=E.setDefaultFilter,l=E.setCurrentFilterScheme,c=E.setFilterSchemes,u=E.setFilterList,d=E.setHashFilterContent,f=E.setSchemesList,p=E.setFieldsArchives,m=E.setLoading,h=E.setCustomParams,v=E.setCustomLoad,g=E.setProjectIdList;var N=S.a.createContext({state:{defaultFilter:void 0,currentFilterScheme:{},filterSchemes:{},filterList:[],activeFilterContent:{conditions:[],sort:{key:"",value:""}},hashFilterContent:{},schemesList:[],type:"project",currentProject:{},issueType:"",tableView:{},hasFilterChanged:!1,conditionNumber:0,loading:{fieldLoad:!1,schemeLoad:!1,storeActionLoad:!1,teamActionLoad:!1,filterListLoad:!1},customLoading:{},layoutConfig:{},customParams:{},payed:!1,projectIdList:[],prevActiveFilterContent:{conditions:[],sort:{key:"",value:""}}},dispatch:function(){}}),A=new k;t.c=function(e){var t=j(Object(y.useReducer)(A.actions,{defaultFilter:void 0,currentFilterScheme:{},filterSchemes:{},schemesList:[],filterList:[],activeFilterContent:{conditions:[],sort:{key:"",value:""}},hashFilterContent:{},type:"project",currentProject:{},issueType:"",tableView:{},conditionNumber:0,hasFilterChanged:!1,loading:{fieldLoad:!1,schemeLoad:!1,storeActionLoad:!1,teamActionLoad:!1,filterListLoad:!1},customLoading:{},layoutConfig:{},customParams:{},payed:!1,projectIdList:[],prevActiveFilterContent:{conditions:[],sort:{key:"",value:""}}}),2),a=t[0],n=t[1];return S.a.createElement(S.a.Fragment,null,S.a.createElement(N.Provider,{value:{state:a,dispatch:function(e){return O(void 0,void 0,void 0,(function(){return R(this,(function(t){return n(e),[2]}))}))}}},e.children))}},DxFu:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FILE_TYPE_MAP=void 0,a("RW0V"),a("9AAn"),a("XfO3"),a("Btvt"),a("yt8O"),a("rGqo");var n={image:["PNG","JPG","JPEG","BMP","GIF","WEBP","TIFF"],video:["MP4","MOV","AVI","MPEG","MPG","TS"],audio:["MP3","AAC","WAV","WMA","CDA","FLAC","M4A","MID","MKA","MP2","MPA","MPC","APE","OFR","OGG","RA","WV","TTA","AC3","DTS"],archive:["ZIP","RAR","7Z","GZ","XZ",".BZ2"],code:["HTML","CSS","JS","JAVA","PY","PHP","ASP","JSP","NET","JSX","CONFIG","XML","WXML","C","SASS","STYLUS","LESS"],xls:["XLS","XLSX","CSV"],pdf:["PDF"],ppt:["PPT","PPTX"],doc:["DOC","DOCX"],txt:["TXT"],photoshop:["PSD"],illustrator:["AI"],md:["MD","MDOWN","MARKDOWN"],svg:["SVG"]},i=Object.keys(n).reduce((function(e,t){return n[t].forEach((function(a){e.set(a,t)})),e}),new Map);t.FILE_TYPE_MAP=i},E4ga:function(e,t,a){e.exports={container:"container-1uqXNb7AEP",main:"main-2ebYQbxn6Y",sticky:"sticky-WV1c6_C1yP","padding-container":"padding-container-2F-zQL1m6b",paddingContainer:"padding-container-2F-zQL1m6b",gap:"gap-2_GELSanSw",reset:"reset-10NLxu5EJQ",content:"content-2K0blmFPnG","header-title":"header-title-3X-QWkmlkB",headerTitle:"header-title-3X-QWkmlkB",title:"title-3FJ48craUI",close:"close-3ZSXAIIapf",comfortable:"comfortable-oWsQ81U-68",compact:"compact-1WXn45a3O3",checked:"checked-2oKHvmrfeJ",split:"split-36d4Cnea-p","split-with-text":"split-with-text-fPcd1MF9Fs",splitWithText:"split-with-text-fPcd1MF9Fs",text:"text-2GUk6dbCni","drag-container":"drag-container-2pEQxVO4Xc",dragContainer:"drag-container-2pEQxVO4Xc","drag-layer":"drag-layer-kUM_z0hWwI",dragLayer:"drag-layer-kUM_z0hWwI"}},EFit:function(e,t,a){e.exports={wrapper:"wrapper-3Cj79bryaJ",popup:"popup-25voHjceZr"}},EPIV:function(e,t,a){e.exports={"export-attr":"export-attr-19hlhgApHH",exportAttr:"export-attr-19hlhgApHH","export-content":"export-content-1I0PUrHuto",exportContent:"export-content-1I0PUrHuto",contair:"contair-SHn7jUTEep","left-contair":"left-contair-M7AnJeI--G",leftContair:"left-contair-M7AnJeI--G","right-contair":"right-contair-3RYKp1dpzv",rightContair:"right-contair-3RYKp1dpzv","label-tool":"label-tool-1uE6M5BNah",labelTool:"label-tool-1uE6M5BNah"}},EUlY:function(e,t,a){"use strict";a.r(t),a.d(t,"getActualDepth",(function(){return u})),a.d(t,"organizeIssues",(function(){return d})),a.d(t,"getIssueNodeList",(function(){return f})),a.d(t,"organizeIterations",(function(){return p})),a.d(t,"reorganizeIterations",(function(){return m})),a.d(t,"appendIterations",(function(){return h})),a.d(t,"getIterationNodeList",(function(){return v}));var n=a("cDcd"),i=a.n(n),r=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(t,a)};return function(t,a){if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),o=function(){return(o=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},s=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(a[n[i]]=e[n[i]])}return a},l=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},c=function(e,t,a){if(a||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},u=function(e){return e?(e.match(/\/[^/]+/g)||[]).length+1:void 0},d=function(e,t,a){void 0===e&&(e=[]),void 0===a&&(a=!1);var n=[],i={};return o(o({},e.reduce((function(e,r){var u,f,p,m,h=e.issues,v=void 0===h?[]:h,g=e.childIssueCodes,E=void 0===g?{}:g,b=r.children,y=r.subIssues,S=r.iteration,I=s(r,["children","subIssues","iteration"]),T=I.id,C=I.parentId,P=I.code,w=I.parentCode,D=P,O=w,R=y;b&&T&&(D=T,O=C,R=b),y&&P&&(D=P,O=w,R=y);var j=t||(null===S||void 0===S?void 0:S.code),k=d(R||[],t),N=k.issues,A=k.childIssueCodes,L=void 0===A?((u={})[D]=[],u):A,F=k.iterations;return n=c(c([],l(n),!1),[D],!1),i=o(o(o({},i),S?((f={})[S.code]=S,f):{}),F),{issues:o(o(o({},v),(p={},p[D]=o(o(o({},I),j?{iterationCode:j}:{}),{iteration:S}),p)),N),childIssueCodes:o(o(o({},E),a?{}:(m={},m[O]=c(c([],l(E[O]||[]),!1),[D],!1),m)),L)}}),{})),{rootIssueCodes:n,iterations:i})},f=function(e){var t=e.issues,a=void 0===t?[]:t,n=e.childIssueCodes,i=void 0===n?[]:n,r=e.collapseStatus,o=void 0===r?{}:r,s=e.entryCodes,d=e.depth,p=void 0===d?1:d;return(s||i[0]||[]).reduce((function(e,t){var n=a[t];return c(c(c([],l(e),!1),[{type:n.type,code:t,depth:p,parentCode:n.parentCode||n.parentId,actualDepth:u(n.path)}],!1),l(p>=6||o[t]?[]:f({issues:a,childIssueCodes:i,collapseStatus:o,entryCodes:i[t]||[],depth:p+1})),!1)}),[])},p=function(e,t,a){void 0===a&&(a=!1);var n=e.reduce((function(e,t){var a,n,i=e.iterations,r=void 0===i?{}:i,u=e.issues,f=void 0===u?{}:u,p=e.childIssueCodes,m=void 0===p?{}:p,h=e.iterationRootIssueCodes,v=void 0===h?[]:h,g=e.iterationCodes,E=void 0===g?[]:g,b=t.issues,y=void 0===b?[]:b,S=s(t,["issues"]),I=S.code,T=d(y,I,!0),C=T.issues,P=T.childIssueCodes,w=T.rootIssueCodes,D=T.iterations;return{iterations:o(o(o({},r),D),(a={},a[I]=S,a)),issues:o(o({},f),C),childIssueCodes:o(o({},m),P),iterationCodes:c(c([],l(E),!1),[I],!1),iterationRootIssueCodes:o(o({},v),(n={},n[I]=w,n))}}),{});if(t){var i=t.issues,r=void 0===i?{}:i,u=t.childIssueCodes,f=void 0===u?{}:u,p=t.iterations,m=void 0===p?{}:p,h=t.iterationCodes,v=void 0===h?[]:h,g=t.iterationRootIssueCodes,E=void 0===g?{}:g,b=n.issues,y=n.childIssueCodes,S=n.iterations,I=n.iterationCodes,T=void 0===I?[]:I,C=n.iterationRootIssueCodes;return{issues:o(o({},r),b),childIssueCodes:o(o({},f),y),iterations:o(o({},m),S),iterationCodes:a?c(c([],l(v),!1),l(T),!1):v,iterationRootIssueCodes:o(o({},E),C)}}return n},m=function(e,t){return p(Array.isArray(e)?e:[e],t)},h=function(e,t){return p(Array.isArray(e)?e:[e],t,!0)},v=function(e){var t=e.issues,a=void 0===t?[]:t,n=e.childIssueCodes,i=void 0===n?[]:n,r=e.iterationCodes,o=void 0===r?[]:r,s=e.iterationRootIssueCodes,u=void 0===s?[]:s,d=e.collapseStatus,p=void 0===d?{}:d;return o.reduce((function(e,t){return c(c(c([],l(e),!1),[{type:"ITERATION",code:t}],!1),l(p[t]?[]:f({issues:a,childIssueCodes:i,collapseStatus:p,entryCodes:u[t]})),!1)}),[])};t.default=function(e){return function(t){function a(e){return t.call(this,e)||this}return r(a,t),a.prototype.render=function(){return i.a.createElement(e,o({},this.props,{organizeIssues:d,getIssueNodeList:f,organizeIterations:p,getIterationNodeList:v,reorganizeIterations:m,appendIterations:h}))},a}(n.Component)}},Eios:function(e,t,a){e.exports=a.p+"19b8eda65c1915f957cdaaae4b186c95.svg"},EvOC:function(e,t,a){"use strict";a.r(t),a.d(t,"DndProvider",(function(){return n.DndProvider})),a.d(t,"Drag",(function(){return c})),a.d(t,"Drop",(function(){return d})),a.d(t,"DragPreview",(function(){return p})),a.d(t,"Backend",(function(){return s.a})),a.d(t,"sortList",(function(){return h}));var n=a("l8Oe"),i=a("cDcd"),r=a.n(i),o=a("DDKl"),s=a.n(o),l=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},c=Object(i.memo)((function(e){var t=e.type,a=e.data,r=e.canDrag,s=e.enablePreview,c=e.onBegin,u=e.onEnd,d=e.children,f=Object(i.useRef)(null),p=l(Object(n.useDrag)({item:{type:t,data:a},collect:function(e){return{isDragging:e.isDragging()}},canDrag:function(){return r},begin:function(){"function"===typeof c&&c({data:a,type:t})},end:function(){"function"===typeof u&&u({data:a,type:t})}}),3),m=p[0].isDragging,h=p[1],v=p[2];return Object(i.useEffect)((function(){s&&v(Object(o.getEmptyImage)(),{captureDraggingState:!1})}),[s]),h(f),d({isDragging:m},f)})),u=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},d=Object(i.memo)((function(e){var t=e.type,a=e.data,r=e.canDrop,o=e.onHover,s=e.onDrop,l=e.children,c=e.list,d=e.restrict,f=e.keyName,p=void 0===f?"id":f,m=Object(i.useRef)(null),h=u(Object(n.useDrop)({accept:t,collect:function(e){return{isOver:e.isOver()}},canDrop:function(){return r},hover:function(e,n){var i=e.data;if(m.current&&i[p]!==a[p]){if(d){var r=m.current.getBoundingClientRect(),s=(r.bottom-r.top)/2,l=n.getClientOffset().y-r.top,u=c.findIndex((function(e){return e[p]===i[p]})),f=c.findIndex((function(e){return e[p]===a[p]}));if(u<f&&l<s)return;if(u>f&&l>s)return}"function"===typeof o&&o({data:i,type:t},{data:a,type:t})}},drop:function(){"function"===typeof s&&s({type:t,data:a})}}),2),v=h[0].isOver;return(0,h[1])(m),l({isOver:v},m)})),f={position:"fixed",pointerEvents:"none",zIndex:100,left:0,top:0,height:"100%",width:"100%"},p=Object(i.memo)((function(e){var t=e.type,a=e.children,i=Object(n.useDragLayer)((function(e){return{itemType:e.getItemType(),initialOffset:e.getInitialSourceClientOffset(),currentOffset:e.getSourceClientOffset(),isDragging:e.isDragging()}})),o=i.itemType,s=i.isDragging,l=i.initialOffset,c=i.currentOffset;return s?t!==o?null:r.a.createElement("div",{style:f},a(function(e,t){if(!e||!t)return{display:"none"};var a=t.x,n=t.y;return{transform:"translate(".concat(a,"px, ").concat(n,"px)")}}(l,c))):null})),m=a("LvDl"),h=function(e,t,a,n){void 0===n&&(n="id");var i=Object(m.cloneDeep)(e),r=i.findIndex((function(e){return e[n]===t})),o=i.findIndex((function(e){return e[n]===a})),s=i.splice(r,1)[0];return i.splice(o,0,s),i}},EyEP:function(e,t,a){e.exports={header:"header-3VnGexFZsX",text:"text-OhFYF9ENl6",divider:"divider-s7l0DtD3cN",add:"add-LaCjCPSoIX"}},"FQ7+":function(e,t,a){"use strict";a.r(t),a.d(t,"FilterLayoutLeftSlider",(function(){return r})),a.d(t,"FilterLayoutCommonProps",(function(){return o}));var n=a("5CaM"),i=a("culb"),r=n.a,o=i.IssueCommonProps;t.default=i.default},FwO4:function(e,t,a){e.exports=a.p+"f15787cffd8bee091b5e951d82b4c6d0.svg"},G0SF:function(e,t,a){"use strict";a.r(t),a.d(t,"LabelTrigger",(function(){return m}));var n=a("mVeg"),i=a("cDcd"),r=a.n(i),o=a("nH/Q"),s=a.n(o),l=a("K2gz"),c=a.n(l),u=a("e6EU"),d=a.n(u),f=a("1YQb"),p=a("7FZc"),m=function(e){var t=e.label,a=e.defaultText,i=e.selected,o=e.valueChanged,l=e.noMatched,u=e.noMatchedText,f=e.toolTipText,m=e.list,h="";return h=i&&i.length&&m&&m.length?m.filter((function(e){return i.includes(e.value)})).map((function(e){return e.text})).join(","):l?u||Object(n.t)("\u672a\u5339\u914d"):a||Object(n.t)("\u5168\u90e8"),r.a.createElement("div",{className:"".concat(d.a.trigger," trigger-w100")},t&&r.a.createElement("span",{className:d.a.title},t),r.a.createElement("span",{className:c()(d.a.name,s.a.customLabelName)},h),r.a.createElement("div",{className:d.a.caretDown}),!!o&&r.a.createElement(p.TooltipTrigger,{title:f},r.a.createElement("div",{className:d.a.configError})))};t.default=function(e){var t=e.index,a=e.item,n=e.selected,i=e.onSelect,o=n&&n.length&&n.filter((function(e){return e===a.value})).length||!1;return r.a.createElement("div",{className:d.a.menuItem,onClick:i,key:t},r.a.createElement("div",{className:c()(d.a.menuItemIcon,s.a.labelItemIcon,!a.color&&s.a.default),style:{backgroundColor:"".concat(a.color)}}),r.a.createElement("div",{className:c()(d.a.menuItemName,a.value===f.UNSPECIFIC&&d.a.unspecific)},a.text),o&&r.a.createElement("div",{className:d.a.menuItemChecked}))}},G63z:function(e,t,a){e.exports={title:"title-1sSyVKHCQy",icon:"icon-1Ttdc9ymp5",tooltip:"tooltip-3bbeLc-LyJ",content:"content-M64pjDx700"}},GDO5:function(e,t,a){e.exports={header:"header-180_UvP6CK",text:"text-Y-_oc_XEon",divider:"divider-1mKZdVzQ9S",add:"add--loicM6T6k",disabled:"disabled-1fUZ7N6vKD",find:"find-3TUj4T0pmz",list:"list-Rhqiew8eFY","dragging-item":"dragging-item-eYNVIcOQw8",draggingItem:"dragging-item-eYNVIcOQw8",item:"item-O6fxk-qzt8","item-is-over":"item-is-over-2nDrxMyqAl",itemIsOver:"item-is-over-2nDrxMyqAl","header-right":"header-right-15rdq-tuZf",headerRight:"header-right-15rdq-tuZf","tree-expand":"tree-expand-2IS2f0l8vQ",treeExpand:"tree-expand-2IS2f0l8vQ","tree-expand-open":"tree-expand-open-12Ja-PnsZt",treeExpandOpen:"tree-expand-open-12Ja-PnsZt","tree-expand-close":"tree-expand-close-3MGjspFI0p",treeExpandClose:"tree-expand-close-3MGjspFI0p","tree-expand-disabled":"tree-expand-disabled-3HxPLlfRff",treeExpandDisabled:"tree-expand-disabled-3HxPLlfRff",progress:"progress-3oMfqZNovv","progress-bar":"progress-bar-3-G-OLl6bQ",progressBar:"progress-bar-3-G-OLl6bQ","progress-bar-inner":"progress-bar-inner-1DJLbebvBZ",progressBarInner:"progress-bar-inner-1DJLbebvBZ","progress-text":"progress-text-2o9TVwKrWW",progressText:"progress-text-2o9TVwKrWW"}},"GL+0":function(e,t,a){e.exports=a.p+"7cb3c25466c23eac9d74254b71d1194b.svg"},GQzJ:function(e,t,a){e.exports=a.p+"43f376ebff885d8b9eff866ff0231948.svg"},GaYm:function(e,t,a){"use strict";var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("17x9")),r=n(a("cDcd")),o=n(a("K2gz")),s=a("7FZc"),l=n(a("G63z")),c=function(e){var t=e.className,a=e.tooltip,n=e.children,i=e.placement;return r.default.createElement("div",{className:(0,o.default)(l.default.title,t)},n,r.default.createElement(s.TooltipTrigger,{placement:i||"right",className:l.default.tooltip,title:r.default.createElement("div",{className:l.default.content},a)},r.default.createElement("span",{className:l.default.icon})))};c.propTypes={className:i.default.string,tooltip:i.default.any,children:i.default.any,placement:i.default.string};var u=c;t.default=u},HDqR:function(e,t,a){"use strict";a.r(t);var n=a("mVeg"),i=a("cDcd"),r=a.n(i),o=a("f0Wu"),s=a.n(o),l=a("MiOB"),c=a("xgZS"),u=a("K2gz"),d=a.n(u),f=a("fJkI"),p=a.n(f),m=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(t,a)};return function(t,a){if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),h=function(e){function t(t){var a=e.call(this,t)||this;return a.state={from:t.from||"",to:t.to||"",dateFormat:t.isTimePicker?"YYYY-MM-DD HH:mm:ss":"YYYY-MM-DD",showDel:!1,isStartExpanded:t.expanded||!1,isEndExpanded:!1},a.onFromChange=a.onFromChange.bind(a),a.onToChange=a.onToChange.bind(a),a}return m(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=e.from,a=e.to,n=this.props,i=n.from,r=n.to;i!==t&&this.setState({from:t}),r!==a&&this.setState({to:a})},t.prototype.renderTrigger=function(e,t){var a,n=e.initialSelectedDate,i=e.placeholder,o=t.onToggle;return r.a.createElement("div",{className:"".concat(p.a.dateValue," date-value")},r.a.createElement("div",{className:"date-value-show ".concat(d()((a={},a[p.a.dateValuePlaceholder]=!n,a))),title:n||"",onClick:function(){return o()}},n||i),r.a.createElement("div",{className:p.a.cartDown}))},t.prototype.getDatePicker=function(e){var t=this,a=e.initialSelectedDate,i=e.placeholder,o=e.onChange,c=e.isFirst,u=this.props,f=u.isTimePicker,m=u.isPortal,h=u.portalProps,v=this.state,g=v.dateFormat,E=v.isStartExpanded,b=v.isEndExpanded;return r.a.createElement(l.default,{className:"".concat(d()([p.a.itemDate])," item-date"),dropdownClassName:f?p.a.customDropdown:p.a.customDateDropdown,isTimePicker:f,value:s()(a).valueOf(),onChange:function(e){return o&&o(e,g)},placeholder:Object(n.t)("\u672a\u6307\u5b9a"),calculatePosition:function(){},open:c?E:b,trigger:function(e){return t.renderTrigger({initialSelectedDate:a,placeholder:i},e)},isPortal:m,portalProps:h})},t.prototype.render=function(){var e=this.props,t=e.label,a=e.isTimePicker,i=e.onClearProp,o=this.state,s=o.from,l=o.to,c=o.showDel,u=o.isEndExpanded,f=o.isStartExpanded;return r.a.createElement("div",{className:"newfilter-date-range ".concat(d()(p.a.dateRangePicker,p.a.triggerBackground,(c||u||f)&&p.a.isExpanded))},t?r.a.createElement("div",{className:"newfilter-hidden ".concat(p.a.itemDateLabel)},t):null,this.getDatePicker({className:p.a.fromDate,initialSelectedDate:s,onChange:this.onFromChange,placeholder:a?Object(n.t)("\u5f00\u59cb\u65f6\u95f4"):Object(n.t)("\u5f00\u59cb\u65e5\u671f"),isFirst:!0}),r.a.createElement("div",{className:p.a.devide},Object(n.t)("\u81f3")),this.getDatePicker({className:p.a.toDate,initialSelectedDate:l,onChange:this.onToChange,placeholder:a?Object(n.t)("\u7ed3\u675f\u65f6\u95f4"):Object(n.t)("\u7ed3\u675f\u65e5\u671f"),isFirst:!1}),i&&r.a.createElement("a",{className:d()([p.a.clearButton,p.a.alignTop,(f||u)&&p.a.button]),onClick:i}))},t.prototype.onFromChange=function(e,t){var a=this.props.onChange,i=this.state.to;if(!e)return a&&a("",i),void this.setState({from:"",isStartExpanded:!1,showDel:!1});if(e.isValid()){var r=e.format(t);s()(i).isBefore(s()(r))?Object(c.warning)(Object(n.t)("\u5f00\u59cb\u65e5\u671f\u4e0d\u53ef\u5728\u7ed3\u675f\u65e5\u671f\u4e4b\u540e")):(a&&a(r,i),this.setState({from:r,isStartExpanded:!1,showDel:!1}))}else a&&a("",i),this.setState({from:""})},t.prototype.onToChange=function(e,t){var a=this.props.onChange,i=this.state.from;if(!e)return a&&a(i,""),void this.setState({to:"",isEndExpanded:!1,showDel:!1});if(e.isValid()){var r=e.format(t);s()(i).isAfter(s()(r))?Object(c.warning)(Object(n.t)("\u5f00\u59cb\u65e5\u671f\u4e0d\u53ef\u5728\u7ed3\u675f\u65e5\u671f\u4e4b\u540e")):(a&&a(i,r),this.setState({to:r,isEndExpanded:!1,showDel:!1}))}else a&&a(i,""),this.setState({to:""})},t.defaultProps={isTimePicker:!1},t}(r.a.Component);t.default=h},HlXz:function(e,t,a){"use strict";var n=a("mVeg"),i=a("cDcd"),r=a.n(i),o=a("7FZc"),s=a("K2gz"),l=a.n(s),c=a("vih4"),u=a.n(c),d=a("LvDl"),f=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},p=function(e,t,a){if(a||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))};t.a=Object(i.memo)((function(e){var t=e.value,a=e.items,i=e.active,s=e.disabled,c=e.initialSelectedItem,m=void 0===c?[]:c,h=e.isMultiple,v=e.label,g=e.removable,E=e.onRemove,b=e.valueChanged,y=e.noMatched,S=e.toolTipText,I=e.placeholder,T=e.triggerContentStyle,C=function(){if(y)return Object(n.t)("\u672a\u5339\u914d");var e,i=a;if(Array.isArray(m)?i=Object(d.uniqBy)(p(p([],f(a),!1),f(m),!1),"id"):"object"===typeof m&&m&&(i=Object(d.uniqBy)(p(p([],f(a),!1),[m],!1),"id")),h)e=t.map((function(e){var t;return null===(t=i.find((function(t){return(null===t||void 0===t?void 0:t.id)===e})))||void 0===t?void 0:t.text})).filter((function(e){return!!e}));else{var r=i.find((function(e){return e.id===t}));e=r?[r.text]:[]}return e.join(",")||I||Object(n.t)("\u672a\u6307\u5b9a")};return r.a.createElement("div",{className:l()(u.a.trigger,u.a.filterTrigger,i&&u.a.active,s&&u.a.disabled),title:C()},v&&r.a.createElement("div",{className:l()(u.a.label)},v),r.a.createElement("div",{className:l()(u.a.content,!(h?(null===t||void 0===t?void 0:t.length)>0:t)&&I&&u.a.placeholder,T)},C()),r.a.createElement("span",{className:l()(u.a.caret)}),g&&r.a.createElement("span",{className:l()(u.a.removeButton,i&&u.a.show),onClick:E}),!!b&&r.a.createElement(o.TooltipTrigger,{title:S},r.a.createElement("div",{className:u.a.configError})))}))},HtPo:function(e,t,a){"use strict";var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("cDcd")),r=n(a("17x9")),o=n(a("UurN")),s=function(e){var t=e.className;return i.default.createElement("div",{className:"".concat(o.default.loading," ").concat(t)},i.default.createElement("div",{className:o.default.loadingChild},i.default.createElement("div",{className:o.default.loadingChildPoint})))};s.propTypes={className:r.default.string};var l=s;t.default=l},IGR9:function(e,t,a){e.exports={container:"container-jdYh0uFjrK",drag:"drag-1XooY7d7T9",name:"name-1f01DnsqC7",title:"title-27sT07PEB2",swith:"swith-3pDYZB8NTE"}},IUQT:function(e,t,a){"use strict";a("mVeg");var n=a("cDcd"),i=a.n(n),r=(a("7FZc"),a("TPfW")),o=a.n(r),s=(a("K2gz"),function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o});t.a=function(e){var t=e.item,a=e.selected,r=e.onSelect,l=a.filter((function(e){return e.code===t.code||e.id===t.id})).length>0,c=s(Object(n.useState)(a.includes(t)),2),u=c[0],d=c[1];return Object(n.useEffect)((function(){d(l)})),i.a.createElement("div",{className:o.a.menuItem,onClick:function(){d(!u),r()}},i.a.createElement("span",{className:o.a.preIcon}),i.a.createElement("span",{className:o.a.itemName,title:t.name},t.name),u&&i.a.createElement("span",{className:o.a.checked}))}},IZ34:function(e,t,a){"use strict";var n=a("cDcd"),i=a.n(n),r=a("XWeJ"),o=a.n(r),s=a("K2gz"),l=a.n(s),c=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(t,a)};return function(t,a){if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),u=function(e){function t(t){var a=e.call(this,t)||this;return a.handleChange=function(){var e=a.props,t=e.checked,n=e.onChange;if(!e.disabled){var i=a.state.localChecked,r=void 0===t?i:t;a.setState({localChecked:!r}),n&&n(!r)}},a.state={localChecked:!1},a}return c(t,e),t.prototype.render=function(){var e=this.props,t=e.checked,a=e.className,n=e.disabled,r=this.state.localChecked,s=void 0===t?r:t;return i.a.createElement("div",{className:l()(o.a.checkbox,s&&o.a.checkboxActive,n&&o.a.checkboxDisabled,a),onClick:this.handleChange})},t}(n.PureComponent);t.a=u},IecL:function(e,t,a){"use strict";a.r(t),a.d(t,"track",(function(){return i})),a.d(t,"getSensitive",(function(){return r})),a.d(t,"cancelSensitive",(function(){return o})),a.d(t,"addSensitive",(function(){return s}));var n=a("Z4vw"),i=function(e){return Object(n.get)("/audit-log/api/v1/track?".concat(Object(n.buildParams)(e)))},r=function(e,t){return Object(n.get)("/audit-log/api/v1/project/".concat(t,"/resources/").concat(e,"/sensitive"))},o=function(e,t){return Object(n.del)("/audit-log/api/v1/project/".concat(t,"/resources/").concat(e,"/sensitive"))},s=function(e,t){return Object(n.post)("/audit-log/api/v1/project/".concat(t,"/resources/").concat(e,"/sensitive"))}},Ism1:function(e,t,a){e.exports={title:"title-1c3sNHLJXT",icon:"icon-4nWdjoORn_",tooltip:"tooltip-1VWhtwbVG9",content:"content-2hrTClepTJ"}},J0Vw:function(e,t,a){"use strict";a("I5cv"),a("RW0V"),a("ioFf"),a("0l/t"),a("mYba"),a("jm62"),a("EK0E"),a("XfO3"),a("Btvt"),a("yt8O"),a("rGqo");var n=a("TqRt"),i=a("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("bWfx"),a("f3/d");var r=n(a("lSNA")),o=n(a("RIqP")),s=n(a("lwsE")),l=n(a("W8MJ")),c=n(a("PJYZ")),u=n(a("7W2i")),d=n(a("a1gu")),f=n(a("Nsbk")),p=a("mVeg"),m=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!==typeof e)return{default:e};var a=P(t);if(a&&a.has(e))return a.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=r?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}n.default=e,a&&a.set(e,n);return n}(a("cDcd")),h=n(a("17x9")),v=n(a("yZ+p")),g=n(a("gHyg")),E=n(a("EAU0")),b=n(a("KUqB")),y=a("nuIr"),S=a("x+BT"),I=a("xgZS"),T=a("Z4vw"),C=n(a("Zsd2"));function P(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(P=function(e){return e?a:t})(e)}function w(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function D(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,f.default)(e);if(t){var i=(0,f.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,d.default)(this,a)}}var O=function(e){(0,u.default)(a,e);var t=D(a);function a(e){var n;return(0,s.default)(this,a),(n=t.call(this,e)).timer=null,n.localInputRef=(0,m.createRef)(),n.selectItem=function(e){var t=n.props,a=t.callback,i=t.projectID,r=t.epicCode;(0,S.joinEpic)(i,r,e.code).then((function(){(0,I.success)((0,p.t)("\u6210\u529f\u52a0\u5165\u53f2\u8bd7")),n.setState({value:void 0},(function(){n.searchResults()})),a(null)}),(function(e){var t=e.msg;(0,I.danger)((0,T.getErrorMessage)(t))}))},n.searchResults=function(){var e=n.props,t=e.projectID,a=e.epicCode,i=n.state,s=i.value,l=i.isChecked;n.timer&&clearTimeout(n.timer),n.timer=setTimeout((function(){(0,S.associateableIssues)(t,a,{keyword:(0,C.default)(s),availableOnly:l}).then((function(e){var t=e.data;n.setState({results:(0,o.default)(t.map((function(e){return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?w(Object(a),!0).forEach((function(t){(0,r.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):w(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e)})))})}))}),500)},n.handleKeyDown=function(e){27===e.keyCode&&n.onClear()},n.focus=function(){n.onShow()},n.state={value:void 0,results:[],isChecked:!1},n.handleChangeValue=n.handleChangeValue.bind((0,c.default)(n)),n.onChangeCheckbox=n.onChangeCheckbox.bind((0,c.default)(n)),n.onClear=n.onClear.bind((0,c.default)(n)),n.onShow=n.onShow.bind((0,c.default)(n)),n}return(0,l.default)(a,[{key:"render",value:function(){var e=this.props.inputRef,t=this.state,a=t.value,n=t.results,i=t.isChecked;return m.default.createElement("div",{id:"affairs-associate",className:g.default.inputWrapper},m.default.createElement(v.default,{value:a,className:g.default.customInput,ref:e||this.localInputRef,onChange:this.handleChangeValue,prefix:m.default.createElement("div",{className:g.default.customSearchIcon}),suffix:m.default.createElement("div",{className:g.default.cancelBtn,onClick:this.onClear},(0,p.t)("\u53d6\u6d88")),size:"medium",placeholder:(0,p.t)("\u8f93\u5165\u4e8b\u9879\u5f15\u7528 ID \u6216\u6807\u9898"),onKeyDown:this.handleKeyDown}),m.default.createElement("div",{className:g.default.customResult},m.default.createElement("div",{className:g.default.resultWrapper},!!n.length&&this.renderResult(),!n.length&&m.default.createElement("div",{className:g.default.resultEmpty},m.default.createElement("div",{className:"".concat(g.default.icon," ").concat(g.default.customSearchIcon)}),(0,p.t)("\u65e0\u641c\u7d22\u7ed3\u679c")),m.default.createElement("div",{className:g.default.resultFilterBar},m.default.createElement(E.default,{checked:i,onChange:this.onChangeCheckbox},m.default.createElement("span",{className:g.default.detail},(0,p.t)("\u53ea\u663e\u793a\u672a\u7eb3\u5165\u53f2\u8bd7")))))))}},{key:"renderResult",value:function(){var e=this,t=this.state.results;return m.default.createElement("div",{className:g.default.resultItems,onScroll:function(e){e.stopPropagation()}},t.map((function(t){return m.default.createElement("div",{className:g.default.item,key:t.code,onClick:function(){return e.selectItem(t)}},m.default.createElement(b.default,{type:t.issueTypeDetail.iconType}),m.default.createElement("div",{className:g.default.itemCode},"#",t.code),m.default.createElement("div",{className:"".concat(g.default.itemDetail," ").concat(g.default.customDetail)},m.default.createElement("div",{className:g.default.itemDetailTitle},t.name)),t.iteration&&m.default.createElement("div",{className:g.default.belongIteration},t.iteration.name),t.epic&&t.epic.name&&m.default.createElement("div",{className:g.default.belongEpic},m.default.createElement("div",{className:g.default.icon}),m.default.createElement("div",{className:g.default.detail},t.epic.name)))})))}},{key:"componentDidMount",value:function(){this.searchResults()}},{key:"componentWillUnmount",value:function(){this.timer&&clearTimeout(this.timer)}},{key:"onChangeCheckbox",value:function(){var e=this.state.isChecked;this.setState({isChecked:!e},this.searchResults)}},{key:"handleChangeValue",value:function(e){this.setState({value:e.target.value},this.searchResults)}},{key:"onShow",value:function(){var e=this.props.inputRef||this.localInputRef;e&&e.current&&e.current.focus()}},{key:"onClear",value:function(){this.setState({value:void 0,results:[]}),this.props.onCancel()}},{key:"parseIcon",value:function(e){switch(e){case y.ISSUE_TYPE.REQUIREMENT:return g.default.requirementIcon;case y.ISSUE_TYPE.ASSIGNMENT:return g.default.assignmentIcon;default:return g.default.issueIcon}}}]),a}(m.Component);O.propTypes={inputRef:h.default.oneOfType([h.default.func,h.default.shape({current:h.default.instanceOf(Element)})]),onCancel:h.default.func,callback:h.default.func,projectID:h.default.number,epicCode:h.default.number};var R=O;t.default=R},J8KE:function(e,t,a){"use strict";a.d(t,"a",(function(){return I}));var n,i=a("cDcd"),r=a.n(i),o=a("qPyV"),s=a.n(o),l=a("V0lW"),c=a("BKNj"),u=a("BJkK"),d=a("8ZF6"),f=a("OrPX"),p=a("mVeg"),m=a("7tbW"),h=a.n(m),v=a("9+7+"),g=a("K2gz"),E=a.n(g),b=a("6Gja"),y=a.n(b),S=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o};!function(e){e.PROJECT="PROJECT",e.PROGRAM="PROGRAM"}(n||(n={}));var I,T=Object(i.memo)((function(e){var t=e.value,a=e.items,o=e.initialSelectedItem,s=e.isMultiple,l=e.clearButtonText,c=void 0===l?Object(p.t)("\u6e05\u9664"):l,u=e.isListScrolling,d=e.onClear,f=e.onTypeChange,m=e.currentDataType,g=void 0===m?n.PROJECT:m,b=e.isPro,I=S(Object(i.useState)(g),2),T=I[0],C=I[1],P=function(e){C(e),f&&f(e)};return s||void 0!==t&&null!==t?r.a.createElement("div",{className:E()(y.a.sideOperation,y.a.projectSideOperation,u&&y.a.greyBg)},r.a.createElement("div",{className:y.a.typeList},r.a.createElement("div",{className:E()(y.a.typeItem,T===n.PROJECT&&y.a.active),onClick:function(){return P(n.PROJECT)}},Object(p.t)("\u7814\u53d1\u7a7a\u95f4")),v.enableProgramMenu&&r.a.createElement("div",{className:E()(y.a.typeItem,T===n.PROGRAM&&y.a.active,v.enableProgramProTag&&y.a.program,v.enableProgramPayment&&!b&&y.a.disabled),onClick:function(){v.enableProgramPayment&&!b||P(n.PROGRAM)}},Object(p.t)("\u9879\u76ee\u96c6"))),s&&t.length>0&&r.a.createElement("span",{className:y.a.clearButton,onClick:d},c),s&&t.length>0&&r.a.createElement("span",{className:E()(y.a.countText,0===t.length&&y.a.noCount)},Object(p.t)("\u5df2\u9009 {{count}} \u9879",{count:function(){if(s){var e=o||a;return h()(null===t||void 0===t?void 0:t.map((function(t){return e.find((function(e){return Array.isArray(e.id)?e.id.some((function(e){return e===t})):e.id===t}))})).filter(Boolean)).length||0}return 0}()})),r.a.createElement("span",{className:y.a.divider}),!s&&r.a.createElement("span",{className:y.a.clearButton,onClick:d},c)):null})),C=a("iTKN"),P=a("GOSa"),w=a.n(P),D=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(t,a)};return function(t,a){if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),O=function(){return(O=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},R=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(a[n[i]]=e[n[i]])}return a};!function(e){e.PROJECT="PROJECT",e.PROGRAM="PROGRAM",e.BOTH="BOTH"}(I||(I={}));var j={type:"JOINED",sort:"NAME",order:"ASC",archived:!1,page:1,pageSize:20,keyword:""},k={type:"JOINED",sort:"NAME",order:"ASC",archived:!1,page:1,pageSize:20,keyword:""},N=function(e){return e.map((function(e){return{id:e.id,value:e.id,text:e.display_name||e.displayName,name:e.display_name||e.displayName,media:e.icon,avatar:e.icon,pinyin:"",isProgram:!!e.displayName}}))},A=function(e){function t(t){var a=e.call(this,t)||this;return a.loadMore=function(){var e=a.state.keyword;e?a.searchData(e):a.loadData()},a.onSearch=function(e){a.setState({keyword:e})},a.changeDataType=function(e){a.setState({currentDataType:e})},a.loadData=function(){var e=a.props,t=e.programByCurrentProject,n=e.currentProjectID,i=a.state,r=i.hasNext,o=i.page,c=i.projects,u=i.dataFetching,d=i.currentDataType;if(r&&!u){a.setState({dataFetching:!0});var f=void 0;d===I.PROJECT?f=Object(l.fetchProjects)(O(O({},k),{page:o,pageSize:20})):d===I.PROGRAM&&(f=Object(l.fetchPrograms)(O(O({},j),{page:o,pageSize:20,project:t?[n]:[]}))),f.then((function(e){var t=e.data,n=t.list,i=t.totalPage,r=N(n);a.setState({dataInited:!0,projects:s()(c.concat(r),"id"),page:i>o?o+1:o,hasNext:i>o})})).finally((function(){a.setState({dataFetching:!1})}))}},a.searchData=function(e,t){void 0===t&&(t=!1);var n=a.props,i=n.programByCurrentProject,r=n.currentProjectID,o=a.state,c=o.searchResultHasNext,u=o.searchResultPage,d=o.searchResult,f=o.dataFetching,p=o.currentDataType;if((t||c)&&!f){a.setState({dataFetching:!0});var m=void 0;p===I.PROJECT?m=Object(l.fetchProjects)(O(O({},k),{page:t?1:u,pageSize:20,keyword:e})):p===I.PROGRAM&&(m=Object(l.fetchPrograms)(O(O({},j),{page:t?1:u,pageSize:20,keyword:e,project:i?[r]:[]}))),m.then((function(e){var n=e.data,i=n.list,r=n.totalPage,o=N(i);t?a.setState({searchResult:s()([].concat(o),"id"),searchResultPage:r>1?2:1,searchResultHasNext:r>1}):a.setState({searchResult:s()(d.concat(o),"id"),searchResultPage:r>u?u+1:u,searchResultHasNext:r>u})})).finally((function(){a.setState({dataFetching:!1})}))}},a.state={dataInited:!1,dataFetching:!1,projects:t.useUnspecificItem?[C.UNSPECIFIC_ITEM]:[],page:1,pageSize:20,hasNext:!0,keyword:"",searchResult:[],searchResultPage:1,searchResultHasNext:!0,currentDataType:t.dataType===I.BOTH?I.PROJECT:t.dataType},a}return D(t,e),t.prototype.render=function(){var e=this,t=this.state,a=t.keyword,n=t.searchResult,i=t.projects,o=t.dataInited,s=t.dataFetching,l=t.currentDataType,u=this.props,d=u.componentType,p=u.show,m=u.Trigger,h=u.triggerExtraProps,v=u.itemExtraProps,g=u.dataType,E=u.value,b=u.isPro,y=R(u,["componentType","show","Trigger","triggerExtraProps","itemExtraProps","dataType","value","isPro"]);return r.a.createElement(c.default,O({},y,{value:E,items:a?n:i,tableCell:d!==C.ComponentType.FILTER,isFilter:d===C.ComponentType.FILTER,dataInited:o,dataFetching:s,onReachBottom:function(t){t&&e.loadMore()},isLocalSearch:!1,onSearch:this.onSearch,disableArrowUp:!0,showPanel:p,Trigger:m||this.getTrigger(d),triggerExtraProps:h,Item:f.a,itemExtraProps:v,CustomeSideOperation:g===I.BOTH?T:void 0,operationExtraProps:{onTypeChange:this.changeDataType,currentDataType:l,isPro:b},panelCustomStyle:w.a.fieldPanel}))},t.prototype.componentDidUpdate=function(e,t){var a=this,n=this.state,i=n.keyword,r=n.currentDataType;t.keyword!==i&&(i?this.searchData(i,!0):this.setState({searchResult:[],searchResultPage:1,searchResultHasNext:!0,projects:this.props.useUnspecificItem?[C.UNSPECIFIC_ITEM]:[],page:1,hasNext:!0},(function(){return a.loadMore()}))),t.currentDataType!==r&&(i||this.setState({projects:this.props.useUnspecificItem?[C.UNSPECIFIC_ITEM]:[]}),this.setState({searchResult:[],searchResultPage:1,searchResultHasNext:!0,page:1,hasNext:!0},(function(){return a.loadMore()})))},t.prototype.getTrigger=function(e){switch(e){case C.ComponentType.FILTER:return d.a;default:return u.a}},t}(r.a.Component);t.b=A},JCha:function(e,t,a){e.exports=a.p+"7d436d2613c040ae8bcf68aad6bd3c14.svg"},JEMs:function(e,t,a){"use strict";a("I5cv"),a("EK0E"),a("XfO3"),a("Btvt"),a("yt8O"),a("rGqo"),a("mYba");var n=a("TqRt"),i=a("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(a("lwsE")),o=n(a("W8MJ")),s=n(a("PJYZ")),l=n(a("7W2i")),c=n(a("a1gu")),u=n(a("Nsbk")),d=a("mVeg"),f=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!==typeof e)return{default:e};var a=C(t);if(a&&a.has(e))return a.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=r?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}n.default=e,a&&a.set(e,n);return n}(a("cDcd")),p=n(a("17x9")),m=n(a("K2gz")),h=n(a("mtLS")),v=a("7FZc"),g=n(a("T8xO")),E=n(a("Qkhu")),b=n(a("P5Jw")),y=a("xgZS"),S=a("DKcV"),I=a("uelK"),T=a("dBa0");function C(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(C=function(e){return e?a:t})(e)}function P(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,u.default)(e);if(t){var i=(0,u.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,c.default)(this,a)}}var w=function(e){(0,l.default)(a,e);var t=P(a);function a(e){var n;return(0,r.default)(this,a),(n=t.call(this,e)).state={expanded:!1,showModal:!1,slotConfiguration:{}},n.toggleExpand=n.toggleExpand.bind((0,s.default)(n)),n.openPanel=n.openPanel.bind((0,s.default)(n)),n.closePanel=n.closePanel.bind((0,s.default)(n)),n}return(0,o.default)(a,[{key:"componentDidMount",value:function(){this.getSlotInfo()}},{key:"getSlotInfo",value:function(){var e=this;(0,I.getSlotConfiguration)({slot:T.SLOTS.COLLABORATION_DETAIL_DROPDOWN_MENU_ONE,type:"CURRENT"}).then((function(t){var a=t.data;e.setState({slotConfiguration:a||{}})}))}},{key:"componentDidUpdate",value:function(e){this.props.controlHideMore&&e.controlHideMore!==this.props.controlHideMore&&this.closePanel()}},{key:"render",value:function(){var e,t=this,a=this.state,n=a.expanded,i=a.showModal,r=a.slotConfiguration,o=this.props,s=o.deleteFunction,l=o.viewDescriptionVersion,c=o.copyLink,u=o.copyTitle,p=o.isPermissible,y=o.onIsFullWidthChange,I=o.isFullWidth,C=o.isShowFullWidthOption,P=o.slotCallback,w=(o.copyIssues,p([{function:S.ProjectPermissionFunction.PROJECT_ISSUE,action:S.ProjectPermissionAction.DELETE}]));return f.default.createElement("div",{className:"".concat(h.default.root," ").concat(n?h.default.expandedStyle:"")},f.default.createElement(v.TooltipTrigger,{title:(0,d.t)("\u66f4\u591a")},f.default.createElement("div",{className:h.default.trigger,onClick:this.toggleExpand})),n&&f.default.createElement("ul",{className:h.default.dropdown},f.default.createElement(b.default,{text:c},f.default.createElement("li",{className:h.default.item,onClick:this.onCopy},(0,d.t)("\u590d\u5236\u94fe\u63a5"))),f.default.createElement("li",{className:h.default.divideLine}),f.default.createElement(b.default,{text:"".concat(u,"\r\n").concat(c)},f.default.createElement("li",{className:h.default.item,onClick:this.onCopy},(0,d.t)("\u590d\u5236\u6807\u9898\u548c\u94fe\u63a5"))),f.default.createElement("li",{className:h.default.divideLine}),f.default.createElement("li",{className:h.default.item,onClick:l},(0,d.t)("\u5386\u53f2\u7248\u672c")),C&&f.default.createElement(f.default.Fragment,null,f.default.createElement("li",{className:(0,m.default)(h.default.divideLine,h.default.minWidthHide)}),f.default.createElement("li",{className:(0,m.default)(h.default.item,h.default.minWidthHide),onClick:function(e){e.stopPropagation()},ref:this.fullScreenRef},(0,d.t)("\u5168\u5bbd\u663e\u793a"),f.default.createElement(v.TooltipTrigger,{title:(0,d.t)("\u63cf\u8ff0\u533a\u57df\u4e0d\u9650\u5236\u6700\u5927\u5bbd\u5ea6\u663e\u793a")},f.default.createElement("span",{className:(0,m.default)(h.default.helpIcon,h.default.fullScreenHelpIcon)})),f.default.createElement(g.default,{checked:I,onChange:function(e){y&&y(e),t.closePanel()}}))),(null===r||void 0===r||null===(e=r.slot)||void 0===e?void 0:e.identity)&&f.default.createElement(f.default.Fragment,null,f.default.createElement("li",{className:h.default.divideLine}),f.default.createElement("li",{className:h.default.item,onClick:function(){P(T.SLOTS.COLLABORATION_DETAIL_DROPDOWN_MENU_ONE)}},null===r||void 0===r?void 0:r.triggerText)),w&&f.default.createElement(f.default.Fragment,null,f.default.createElement("li",{className:h.default.divideLine}),f.default.createElement("li",{className:h.default.deleteStyle,onClick:function(){t.setState({showModal:!0})}},(0,d.t)("\u5220\u9664")))),f.default.createElement(E.default,{show:i,type:"EPIC",text:(0,d.t)("\u786e\u5b9a\u8981\u5220\u9664\u5417\uff1f"),onConfirm:function(){s(),t.setState({showModal:!1})},onClose:function(){t.setState({showModal:!1})}}))}},{key:"toggleExpand",value:function(e){var t=this.state.expanded,a=this.props.onClickTrigger;e.stopPropagation(),a&&a(),t?(this.closePanel(),window.removeEventListener("click",this.closePanel,!1)):(this.openPanel(),window.addEventListener("click",this.closePanel,!1))}},{key:"openPanel",value:function(){this.setState({expanded:!0})}},{key:"closePanel",value:function(){this.setState({expanded:!1})}},{key:"onCopy",value:function(e){e.stopPropagation(),(0,y.success)((0,d.t)("\u5df2\u590d\u5236"))}}]),a}(f.Component);w.propTypes={deleteFunction:p.default.func,copyLink:p.default.string,copyTitle:p.default.string,isPermissible:p.default.func,viewDescriptionVersion:p.default.func,onIsFullWidthChange:p.default.func,isFullWidth:p.default.bool,isShowFullWidthOption:p.default.bool,onClickTrigger:p.default.func,controlHideMore:p.default.number,slotCallback:p.default.func,copyIssues:p.default.func};var D=w;t.default=D},JsZx:function(e,t,a){e.exports=a.p+"be67a3315ae3cf2d4a5e8bb6df0ceee9.svg"},"K+UL":function(e,t,a){e.exports={item:"item-3t5UYKur6S","last-child":"last-child-2I-TaANWTD",lastChild:"last-child-2I-TaANWTD","item-hovering":"item-hovering-3fj0L-yTfm",itemHovering:"item-hovering-3fj0L-yTfm","item-icon":"item-icon-_crK7SzL_g",itemIcon:"item-icon-_crK7SzL_g","item-code":"item-code-1ekgRDGFR9",itemCode:"item-code-1ekgRDGFR9","item-name":"item-name-3_sh68mUwd",itemName:"item-name-3_sh68mUwd","item-date":"item-date-3zOpf-wfgK",itemDate:"item-date-3zOpf-wfgK","item-priority":"item-priority-3r3yo1U9FR",itemPriority:"item-priority-3r3yo1U9FR","item-status":"item-status-1POfZd7Rri",itemStatus:"item-status-1POfZd7Rri","item-assignee":"item-assignee-3u2SgOjhmn",itemAssignee:"item-assignee-3u2SgOjhmn","to-right":"to-right-3c-enopYCb",toRight:"to-right-3c-enopYCb","item-arrow":"item-arrow-3UnEPR_e74",itemArrow:"item-arrow-3UnEPR_e74"}},K2MB:function(e,t,a){"use strict";var n=a("cDcd"),i=a.n(n),r=a("qPyV"),o=a.n(r),s=a("UGd4"),l=a("iTKN"),c=a("zqqf"),u=a("fjQX"),d=a("RoFc"),f=a("psb5"),p=a("BKNj"),m=function(){return(m=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},h=function(e,t,a,n){return new(a||(a=Promise))((function(i,r){function o(e){try{l(n.next(e))}catch(t){r(t)}}function s(e){try{l(n.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,s)}l((n=n.apply(e,t||[])).next())}))},v=function(e,t){var a,n,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(l){return function(s){if(a)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(a=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(l){s=[6,l],n=0}finally{a=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},g=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(a[n[i]]=e[n[i]])}return a},E=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},b=function(e){return e.map((function(e){return{id:e.id||e.code,value:e.id||e.code,text:e.name,name:e.name}}))},y=function(e,t){switch(e){case l.ComponentType.TABLE_CELL:return c.a;case l.ComponentType.FORM:return t?u.a:d.a;case l.ComponentType.ICON:return c.a;case l.ComponentType.FILTER:return f.a;case l.ComponentType.BUTTON:default:return c.a}};t.a=function(e){var t=e.componentType,a=e.isBatch,r=e.isMultiple,c=e.show,u=e.useUnspecificItem,d=e.projectID,f=e.triggerExtraProps,S=e.itemExtraProps,I=g(e,["componentType","isBatch","isMultiple","show","useUnspecificItem","projectID","triggerExtraProps","itemExtraProps"]),T=E(Object(n.useState)(!1),2),C=T[0],P=T[1],w=E(Object(n.useState)(!1),2),D=w[0],O=w[1],R=E(Object(n.useState)(u?[l.UNSPECIFIC_ITEM]:[]),2),j=R[0],k=R[1],N=E(Object(n.useState)(1),2),A=N[0],L=N[1],F=E(Object(n.useState)(!0),2),_=F[0],M=F[1],x=E(Object(n.useState)(""),2),B=x[0],U=x[1],W=E(Object(n.useState)([]),2),Y=W[0],H=W[1],V=E(Object(n.useState)(1),2),G=V[0],K=V[1],z=E(Object(n.useState)(!0),2),q=z[0],Z=z[1],J=function(e,t){return void 0===t&&(t=!1),h(void 0,void 0,void 0,(function(){var a,n,i,r;return v(this,(function(l){switch(l.label){case 0:if(!t&&!q||D)return[3,5];O(!0),l.label=1;case 1:return l.trys.push([1,3,4,5]),[4,Object(s.getReleasePageList)(d,{page:t?1:G,pageSize:20,content:{conditions:[{key:"KEYWORD",value:e}],sort:{key:"RELEASE_DATE",value:"DESC"}}})];case 2:return a=l.sent().data,n=a.list,i=a.totalPage,r=b(n),t?(H(o()([].concat(r),"id")),1<i?(K(2),Z(!0)):Z(!1)):(H(o()(Y.concat(r),"id")),G<i?K(G+1):Z(!1)),[3,5];case 3:return l.sent(),[3,5];case 4:return O(!1),[7];case 5:return[2]}}))}))},X=function(){B?J(B):h(void 0,void 0,void 0,(function(){var e,t,a,n;return v(this,(function(i){switch(i.label){case 0:if(!_||D)return[2];O(!0),i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,Object(s.getReleasePageList)(d,{page:A,pageSize:20,content:{conditions:[{key:"KEYWORD",value:B}],sort:{key:"RELEASE_DATE",value:"DESC"}}})];case 2:return e=i.sent().data,t=e.list,a=e.totalPage,n=b(t),k(o()(j.concat(n),"id")),P(!0),A<a?L(A+1):M(!1),[3,5];case 3:return i.sent(),[3,5];case 4:return O(!1),[7];case 5:return[2]}}))}))};return Object(n.useEffect)((function(){B?J(B,!0):(H([]),K(1),Z(!0))}),[B]),Object(n.useEffect)((function(){P(!1),O(!1),k(u?[l.UNSPECIFIC_ITEM]:[]),L(1),M(!0),U(""),H([]),K(1),Z(!0)}),[d]),i.a.createElement(p.default,m({},I,{isMultiple:r,items:B?Y:j,tableCell:t===l.ComponentType.TABLE_CELL,largeSize:t===l.ComponentType.FORM&&!a,smallSize:a,isFilter:t===l.ComponentType.FILTER,isSimple:t===l.ComponentType.ICON||t===l.ComponentType.SIMPLE,dataInited:C,dataFetching:D,onReachBottom:function(e){e&&X()},isLocalSearch:!1,onSearch:function(e){U(e)},disableArrowUp:!0,showPanel:c,Trigger:y(t,r),triggerExtraProps:f,itemExtraProps:S}))}},K2f3:function(e,t,a){"use strict";a("I5cv"),a("RW0V"),a("ioFf"),a("0l/t"),a("mYba"),a("jm62"),a("EK0E"),a("XfO3"),a("Btvt"),a("yt8O"),a("rGqo");var n=a("TqRt"),i=a("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("f3/d"),a("pIFo");var r,o,s,l=n(a("lSNA")),c=n(a("lwsE")),u=n(a("W8MJ")),d=n(a("PJYZ")),f=n(a("7W2i")),p=n(a("a1gu")),m=n(a("Nsbk")),h=a("mVeg"),v=k(a("cDcd")),g=n(a("17x9")),E=n(a("O9Lt")),b=a("/HD1"),y=n(a("x54Q")),S=n(a("G0so")),I=a("dtw8"),T=a("xgZS"),C=a("Z4vw"),P=a("TJpk"),w=k(a("v3Uf")),D=n(a("TT2u")),O=a("17N+"),R=n(a("K2gz"));function j(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(j=function(e){return e?a:t})(e)}function k(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!==typeof e)return{default:e};var a=j(t);if(a&&a.has(e))return a.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=r?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}return n.default=e,a&&a.set(e,n),n}function N(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function A(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?N(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):N(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function L(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,m.default)(e);if(t){var i=(0,m.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,p.default)(this,a)}}var F=(0,w.default)(r=(0,D.default)((s=o=function(e){(0,f.default)(a,e);var t=L(a);function a(e){var n;return(0,c.default)(this,a),(n=t.call(this,e)).getSubIssueCode=function(){return n.props.params.subIssueCode},n.handleFullScreenChange=function(e){n.setState({isFullScreen:e})},n.state={detailInfo:void 0,issueType:void 0,isFullScreen:(0,O.getIsSlideFullScreen)()},n.updateCallback=n.updateCallback.bind((0,d.default)(n)),n.refreshCallback=n.refreshCallback.bind((0,d.default)(n)),n.getSpec=n.getSpec.bind((0,d.default)(n)),n}return(0,u.default)(a,[{key:"getSpec",value:function(){var e=this.state.detailInfo,t=this.props,a=t.params,n=t.workItemList,i=t.largeSize;return v.default.createElement(y.default,{updateCallback:this.updateCallback,onDetailChange:this.props.onDetailChange,refreshCallback:this.refreshCallback,controlUpdateSubWorkItems:this.props.controlUpdateSubWorkItems,expanded:i,params:a,detailInfo:e,workItemList:n,issueCode:this.getSubIssueCode(),issueTypeDetail:e.issueTypeDetail,onFullScreenChange:this.handleFullScreenChange,onCodeChange:this.props.onCodeChange,targetData:this.props.targetData})}},{key:"render",value:function(){var e=this.state,t=e.detailInfo,a=e.isFullScreen,n=this.props,i=n.currentProject,r=n.enterpriseName,o=n.projectPath,s=n.params,l="".concat(o,"/program/plan/work-items/").concat(s.workItemCode,"/detail"),c=a;return v.default.createElement(v.default.Fragment,null,c&&v.default.createElement("div",{className:S.default.fullScreenMask}),v.default.createElement("div",{className:(0,R.default)(S.default.root,S.default.subtaskRoot,"full-screen-style",c&&S.default.fullScreen)},t&&v.default.createElement(P.Helmet,null,v.default.createElement("title",null,"".concat(t.name).concat((0,h.t)(" - \u5de5\u4f5c\u9879\u8be6\u60c5 - ")).concat(i.display_name," - ").concat(r))),v.default.createElement(I.Link,{className:(0,R.default)(S.default.closeButton,c&&S.default.closeButtonFullScreen),to:l}),v.default.createElement("div",{id:"wm-spec",className:S.default.detailRoot},t?this.getSpec():v.default.createElement(E.default,{show:!0}))))}},{key:"componentDidMount",value:function(){this.getDetailInfo()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.params,a=e.currentProject,n=this.props,i=n.params,r=n.currentProject;(a&&a.id!==r.id||t.subIssueCode!==i.subIssueCode)&&this.setState({detailInfo:void 0})}},{key:"componentDidUpdate",value:function(e){var t=e.params,a=e.currentProject,n=e.tableDetailUpdate,i=this.props,r=i.params,o=i.currentProject,s=i.tableDetailUpdate,l=i.controlUpdateWorkItem;(o&&o.id!==a.id||t.subIssueCode!==r.subIssueCode||!n&&s||l&&e.controlUpdateWorkItem!==l)&&this.getDetailInfo()}},{key:"getDetailInfo",value:function(){var e=this,t=this.props,a=t.currentProject,n=t.projectPath,i=t.closeSlideslip,r=t.browserRouter,o=this.getSubIssueCode();a.id&&o&&(0,b.fetchWorkItemDetail)(a.name,o,{withDescriptionMarkup:!0}).then((function(t){var a=t.data;e.setState({detailInfo:a,issueType:a.type})}),(function(e){var t=e.msg;1400===e.code?((0,T.danger)((0,C.getErrorMessage)(t)),r.replace(n)):((0,T.danger)((0,C.getErrorMessage)(t)),i(),r.replace("".concat(n,"/program/plan")))}))}},{key:"updateCallback",value:function(e){var t=this.props.getWorkItems;t&&t(),e?this.setState({detailInfo:e}):this.getDetailInfo()}},{key:"refreshCallback",value:function(){var e=this.props.getWorkItems;e&&e()}}]),a}(v.Component),o.propTypes=A(A({params:g.default.object,currentProject:g.default.object,closeSlideslip:g.default.func,workItemList:g.default.array,controlUpdateWorkItem:g.default.number,controlUpdateSubWorkItems:g.default.number,enterpriseName:g.default.string,projectPath:g.default.string},w.sizeProps),{},{browserRouter:g.default.object,tableDetailUpdate:g.default.bool,onDetailChange:g.default.func,code:g.default.number,onCodeChange:g.default.func,targetData:g.default.object}),r=s))||r)||r;t.default=F},KJCM:function(e,t,a){e.exports={"issues-crumbs":"issues-crumbs-8-HBchemJw",issuesCrumbs:"issues-crumbs-8-HBchemJw","more-button":"more-button-2nSSvF7_ZP",moreButton:"more-button-2nSSvF7_ZP",active:"active-TCGxjBpLOY","code-id-divide-line":"code-id-divide-line-aXFM4pHrLX",codeIdDivideLine:"code-id-divide-line-aXFM4pHrLX",code:"code-35K5gKVdHT",number:"number-w71izU-Q2o","last-number":"last-number-3KjOhhRDlJ",lastNumber:"last-number-3KjOhhRDlJ","last-id":"last-id-1XmC_dYE8I",lastId:"last-id-1XmC_dYE8I","copy-icon":"copy-icon-Kn3pkboCqw",copyIcon:"copy-icon-Kn3pkboCqw","hidden-doc":"hidden-doc-rGuG7mG7fE",hiddenDoc:"hidden-doc-rGuG7mG7fE","show-doc":"show-doc-2PEy6BO8N_",showDoc:"show-doc-2PEy6BO8N_","tool-doc":"tool-doc-3vXw2G8YSD",toolDoc:"tool-doc-3vXw2G8YSD",over:"over-3dcenMFrTu","list-code":"list-code-2-b8ohG3UA",listCode:"list-code-2-b8ohG3UA","show-item":"show-item-_8rG5VWH9k",showItem:"show-item-_8rG5VWH9k","show-hidden-doc":"show-hidden-doc-1Zvt_SVsg0",showHiddenDoc:"show-hidden-doc-1Zvt_SVsg0","detail-menu":"detail-menu-3v4XX174DT",detailMenu:"detail-menu-3v4XX174DT"}},KPKf:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"STATUS",{enumerable:!0,get:function(){return n.STATUS}}),t.FILE_TYPE_TO_EXT_NAME=t.AVAILABLE_FILE_TYPES_TO_EDIT=t.AVAILABLE_FILE_TYPES_TO_CREATE=t.MAYBE_LARGEST_ID=t.MIN_DOWNLOAD_FILES_SIZE=t.TOOLBAR_ACTIONS=t.EDITABLE_FILE_REG=t.TYPE=t.SORT=t.FILE_PAGE_SIZE=t.ACTION=void 0;var n=a("eCz8");t.ACTION={LOAD_PROJECT_FILES:"FILE_LOAD_PROJECT_FILES",SORT_PROJECT_FILES:"FILE_SORT_PROJECT_FILES",DELETE_PROJECT_FILES:"FILE_DELETE_PROJECT_FILE",DELETE_PROJECT_FILES_AND_EMPTY_FOLDERS:"FILE_DELETE_PROJECT_FILES_AND_EMPTY_FOLDERS",RENAME_PROJECT_FILE:"FILE_RENAME_PROJECT_FILE",TOGGLE_SELECT_PROJECT_FILE:"FILE_TOGGLE_SELECT_PROJECT_FILE",TOGGLE_SELECT_ALL_PROJECT_FILE:"FILE_TOGGLE_SELECT_ALL_PROJECT_FILE",DELETE_PROJECT_FOLDER:"FILE_DELETE_PROJECT_FOLDER",ASYNC_DOWNLOAD_FOLDER:"FILE_ASYNC_DOWNLOAD_FOLDER",ASYNC_DOWNLOAD_FILES_AND_FOLDER:"FILE_ASYNC_DOWNLOAD_FILES_AND_FOLDER",FILTER_FILES:"FILE_FILTER_FILES",MKDIR:"FILE_MKDIR",NEW_FOLDER:"FILE_NEW_FOLDER",SAVE_BATCH_FILES:"FILE_SAVE_BATCH_FILES",FOLDER_PATHS:"FILE_FOLDER_PATHS",PREVIEW_FILE:"FILE_PREVIEW_FILE",UPDATE_PREVIEW_FILE:"FILE_UPDATE_PREVIEW_FILE",VIEW_FILE:"FILE_VIEW_FILE",EDIT_FILE:"FILE_EDIT_FILE",DOWNLOAD_URL:"FILE_DOWNLOAD_URL",MARKDOWN_PREVIEW:"FILE_MARKDOWN_PREVIEW",RENAME_PREVIEW_FILE:"FILE_RENAME_PREVIEW_FILE",EDIT_PREVIEW_FILE:"FILE_EDIT_PREVIEW_FILE",FILE_ACTIVITY:"FILE_FILE_ACTIVITY",FILE_HISTORY:"FILE_FILE_HISTORY",DELETE_HISTORY:"FILE_DELETE_HISTORY",CREATE_FILE:"FILE_CREATE_FILE",SET_PREVIEW_ACTIVITY_TAB_KEY:"SET_PREVIEW_ACTIVITY_TAB_KEY",GET_SUB_FOLDERS:"FILE_GET_SUB_FOLDERS",MOVE_FILES:"FILE_MOVE_FILES",SET_FILE_MOVING:"FILE_SET_FILE_MOVING",SHOW_SHARE_MODAL:"FILE_SHOW_SHARE_MODAL",SHARE_FILE:"FILE_SHARE_FILE",STOP_SHARE_FILE:"FILE_STOP_SHARE_FILE",PREVIEW_VERSION_FILE:"PREVIEW_VERSION_FILE"};t.FILE_PAGE_SIZE=500;t.SORT={ASC:"asc",DESC:"desc",NONE:null};var i=n.FILE_TYPE;t.TYPE=i;t.EDITABLE_FILE_REG=/\.(txt|md)$/;t.TOOLBAR_ACTIONS={DOWNLOAD:"download",SHARE:"share",MOVE:"move",RENAME:"rename",DELETE:"delete",EDIT:"edit"};t.MIN_DOWNLOAD_FILES_SIZE=52428800;t.MAYBE_LARGEST_ID=999999999;t.AVAILABLE_FILE_TYPES_TO_CREATE={txt:"TXT",markdown:"Markdown"};t.AVAILABLE_FILE_TYPES_TO_EDIT=["txt","md"];t.FILE_TYPE_TO_EXT_NAME={txt:"txt",markdown:"md"}},Kt96:function(e,t,a){"use strict";a("I5cv"),a("ioFf"),a("mYba"),a("jm62"),a("EK0E");var n=a("TqRt"),i=a("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(a("o0o1"));a("f3/d"),a("Btvt"),a("VRzm"),a("dRSK"),a("bWfx"),a("CX2u"),a("XfO3"),a("yt8O"),a("rGqo"),a("INYr"),a("0l/t"),a("RW0V");var o,s,l,c=n(a("yXPU")),u=n(a("RIqP")),d=n(a("lSNA")),f=n(a("lwsE")),p=n(a("W8MJ")),m=n(a("PJYZ")),h=n(a("7W2i")),v=n(a("a1gu")),g=n(a("Nsbk")),E=a("mVeg"),b=re(a("cDcd")),y=n(a("17x9")),S=n(a("f0Wu")),I=n(a("V/h/")),T=n(a("Zsd2")),C=n(a("E+oP")),P=n(a("Y+p1")),w=n(a("zqxM")),D=a("uKPp"),O=a("7bn+"),R=a("nuIr"),j=a("DgMC"),k=a("DgMC"),N=a("xgZS"),A=a("Z4vw"),L=a("x+BT"),F=a("w3Wo"),_=a("aHEs"),M=a("82Y3"),x=a("h74D"),B=n(a("mSbZ")),U=n(a("htee")),W=n(a("4Fdf")),Y=n(a("sftu")),H=n(a("KUqB")),V=n(a("Th6D")),G=re(a("NI22")),K=n(a("SLo4")),z=n(a("z0hg")),q=n(a("SUhN")),Z=n(a("QPj7")),J=a("885C"),X=n(a("T8xO")),Q=n(a("L8Eh")),$=n(a("XLbL")),ee=a("LC46"),te=n(a("K2gz")),ae=n(a("1hCk")),ne=n(a("246l"));function ie(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(ie=function(e){return e?a:t})(e)}function re(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!==typeof e)return{default:e};var a=ie(t);if(a&&a.has(e))return a.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=r?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}return n.default=e,a&&a.set(e,n),n}function oe(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function se(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(a),!0).forEach((function(t){(0,d.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):oe(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function le(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,g.default)(e);if(t){var i=(0,g.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,v.default)(this,a)}}var ce=(0,x.connect)((function(e){var t=e.APP,a=t.enterprise;return{user:t.user,enterpriseGlobalKey:a.key}}))(o=(0,B.default)(o=(0,U.default)(o=(0,W.default)((l=s=function(e){(0,h.default)(a,e);var t=le(a);function a(e){var n;return(0,f.default)(this,a),(n=t.call(this,e)).initCreatePage=function(){var e=n.props,t=e.currentProject,a=e.issueTypeDetail,i=n.state,r=i.name,o=i.editorType;return(0,G.isBlockType)(o)?(0,_.fetchMarkdownTemplate)(t.name,a.id).then((function(e){var t=e.data;n.setState({initEditorData:{pageId:t.pageId,pageDraftId:t.draftId,historyId:t.historyId},editorAutoFocus:!!r,showDescriptionPlaceholder:!1})})):Promise.resolve()},n.handleAttentionChange=function(e){n.changeAttributes({type:"watchers",value:e})},n.onDescriptionChange=function(e){if(!e.isEmpty){var t="".concat(n.props.currentProject.name,"_").concat(n.props.issueTypeDetail.issueType,"_").concat(n.props.issueTypeDetail.id,"_CREATOR");(0,G.setIssueDescriptionDraft)(t,n.state.initEditorData)}},n.onDescriptionScroll=function(){n.getAttachmentsStickyState()},n.onEditorTypeChange=function(e){if((0,M.setPreferEditorType)(e),n.setState({editorType:e}),(0,G.isBlockType)(e))n.initCreatePage();else{var t="".concat(n.props.currentProject.name,"_").concat(n.props.issueTypeDetail.issueType,"_").concat(n.props.issueTypeDetail.id,"_CREATOR");(0,G.setIssueDescriptionDraft)(t);var a={pageId:n.state.initEditorData.pageId,pageDraftId:n.state.initEditorData.pageDraftId,module:"collaboration",function:"description",scopeType:"project",scopeId:n.props.currentProject.id};(0,G.delPageDraft)(a).then((function(){return n.setState({initEditorData:null})}))}},n.onCancel=function(){n.props.closeHandle()},n.removeDraft=function(){var e,t;null!==(e=n.editorRef)&&void 0!==e&&null!==(t=e.current)&&void 0!==t&&t.removeDraft&&n.editorRef.current.removeDraft()},n.onAttrScroll=function(){n.setState({isElemScroll:!0})},n.quickSave=function(e){n.state.isMac?e.metaKey&&"Enter"===e.key&&n.onSubmit():e.ctrlKey&&"Enter"===e.key&&n.onSubmit()},n.startEditing=function(e){n.state.isMac?e.metaKey||"Enter"!==e.key||n.setState({showDescriptionPlaceholder:!1}):e.ctrlKey||"Enter"!==e.key||n.setState({showDescriptionPlaceholder:!1})},n.getAssigneeFieldWhetherRequired=function(e,t){if(!e||!t.length)return!1;var a=t.find((function(t){return"ASSIGNEE"===e[t].issueField.type}));return e[a].required},n.getHeights=function(){var e=Math.max(320,Math.min(680,document.body.clientHeight-120-300)),t=Math.max(320,Math.min(460,document.body.clientHeight-120-300));n.setState({maxMainBodyHeight:e,editorMinHeight:t},n.getAttachmentsStickyState)},n.getAttachmentsStickyState=function(){var e,t=null===(e=n.bodyRef)||void 0===e?void 0:e.current;n.setState({attachmentsSticky:t&&t.scrollTop+t.offsetHeight<t.scrollHeight&&t.scrollHeight>t.clientHeight})},n.titleInputFocus=function(){var e,t;null===(e=n.inputRef)||void 0===e||null===(t=e.current)||void 0===t||t.focus()},n.combineThirdLinks=function(){var e=n.state,t=e.attachments,a=e.thirdLinks;if(a){var i=a.map((function(e){if(e.name)return e;var t=e.isModao,a=e.isCodesign,n="";return t&&(n=e.modao.title||(0,E.t)("\u58a8\u5200\u9644\u4ef6")),a&&(n=e.codesign.title),se(se({},e),{},{noUpload:!0,isModao:t,isCodesign:a,name:n,createdAt:e.timestamp})})),r=[].concat((0,u.default)(t),(0,u.default)(i));n.setState({allAttachments:n.sortAttachments(r)})}else n.setState({allAttachments:n.sortAttachments(t)})},n.sortAttachments=function(e){var t=(0,u.default)(e);return t.sort((function(e,t){return e.timestamp-t.timestamp})),t},n.onAddThirdLink=function(e){n.hideImportOutResourcePicker(),n.setState({thirdLinks:[].concat((0,u.default)(n.state.thirdLinks),(0,u.default)(e))},n.combineThirdLinks)},n.showImportOutResourcePicker=function(){n.setState({isShowImportOutResourcePicker:!0})},n.hideImportOutResourcePicker=function(){n.setState({isShowImportOutResourcePicker:!1})},n.state={name:e.name,autoNext:"true"===localStorage.getItem("DEFECT_CREATION_AUTO_NEXT"),isPending:!1,isLoading:!0,attributes:{assignee:void 0,priority:void 0,workingHours:void 0,defectType:void 0,dueDate:void 0,projectModule:void 0,requirementType:void 0,labels:[],watchers:[],fields:{},startDate:void 0,progress:void 0},isReloading:!1,iterationCode:e.iterationCode,isElemScroll:!1,isMac:(0,j.isMac)(),initEditorData:null,showDescriptionPlaceholder:!0,editorAutoFocus:!0,attachmentsSticky:!1,maxMainBodyHeight:0,editorMinHeight:0,editorType:(0,M.getPreferEditorType)(),fullscreen:!1,allAttachments:[],attachments:[],isShowImportOutResourcePicker:!1,thirdLinks:[],showButton:!1,toLeft:0},n.inputRef=b.default.createRef(),n.bodyRef=b.default.createRef(),n.editorRef=b.default.createRef(),n.sideRef=b.default.createRef(),n.setDefaultValues=n.setDefaultValues.bind((0,m.default)(n)),n.onTitleChange=n.onTitleChange.bind((0,m.default)(n)),n.onSubmit=n.onSubmit.bind((0,m.default)(n)),n.resetFormData=n.resetFormData.bind((0,m.default)(n)),n.onAutoFlagChange=n.onAutoFlagChange.bind((0,m.default)(n)),n.changeAttributes=n.changeAttributes.bind((0,m.default)(n)),n.timeDetect=n.timeDetect.bind((0,m.default)(n)),n.wrapperRef=b.default.createRef(),n.listRef=b.default.createRef(),n.moveContent=n.moveContent.bind((0,m.default)(n)),n.handleDeleteAttachment=n.handleDeleteAttachment.bind((0,m.default)(n)),n.onFileDropSuccess=n.onFileDropSuccess.bind((0,m.default)(n)),n.onFileDropFail=n.onFileDropFail.bind((0,m.default)(n)),n.onFileDropDelete=n.onFileDropDelete.bind((0,m.default)(n)),n.onFileDropCancel=n.onFileDropCancel.bind((0,m.default)(n)),n.fileUpload=n.fileUpload.bind((0,m.default)(n)),n}return(0,p.default)(a,[{key:"renderAttachmentSection",value:function(){var e=this,t=this.state,a=t.attachments,n=t.allAttachments,i=t.isShowImportOutResourcePicker,r=t.showButton,o=t.toLeft,s=this.props,l=s.enterpriseGlobalKey,c=s.currentProject,u=s.user,d=c.name,f=c.id;return b.default.createElement("div",{className:ae.default.attachementSectionContainer},b.default.createElement("div",{className:ae.default.sectionHeader},b.default.createElement("span",{className:ae.default.title},(0,E.t)("\u9644\u4ef6")),b.default.createElement("span",{className:ae.default.dividerLine}),b.default.createElement(K.default,{onHandleAttachments:this.fileUpload,currentAttachmentNum:a.length,attachmentLimit:n.length>=20},b.default.createElement("a",{className:ae.default.uploadButton},(0,E.t)("\u672c\u5730\u4e0a\u4f20"))),b.default.createElement("div",{className:ae.default.importOutResourceWrap},b.default.createElement(q.default,{onHandleAttachments:this.onAddThirdLink,isShowPicker:i,onShow:this.showImportOutResourcePicker,onHide:this.hideImportOutResourcePicker,attachmentLimit:n.length>=20}))),b.default.createElement("div",{className:ae.default.attachmentSection},n.length?b.default.createElement("div",{className:(0,te.default)(ae.default.attachmentWrapper,r&&ae.default.rightBorder,o<0&&ae.default.leftBorder),ref:this.wrapperRef},b.default.createElement("div",{className:ae.default.attachmentList,ref:this.listRef,style:{left:"".concat(o,"px")}},!!n.length&&b.default.createElement(J.ThemeConsumer,null,(function(t){var a=t.hiddenFolderDirs;return n.map((function(t){return b.default.createElement("div",{className:ae.default.attachmentItem,key:t.fileId},b.default.createElement(z.default,{attachment:t,enterpriseGlobalKey:l,currentProjectName:d,currentProjectId:f,dir:a[R.HIDDEN_FILE_TYPE.EPIC].file_id,uploadFileSuccess:e.onFileDropSuccess,uploadFileFailed:e.onFileDropFail,uploadFileDelete:e.onFileDropDelete,uploadFileCancel:e.onFileDropCancel,allowPreview:!1,userId:u.id}))}))})))):b.default.createElement("div",{className:ae.default.sectionPlaceholder},(0,E.t)("\u5c1a\u672a\u6dfb\u52a0\u9644\u4ef6")),r&&b.default.createElement("a",{className:ae.default.next,onClick:this.moveContent}),o<0&&b.default.createElement("a",{className:ae.default.pre,onClick:function(){return e.moveContent(!1)}})))}},{key:"render",value:function(){var e=this,t=this.state,a=t.name,n=t.autoNext,i=t.isLoading,r=t.attributes,o=t.isReloading,s=t.isMac,l=t.initEditorData,c=t.showDescriptionPlaceholder,u=t.editorAutoFocus,d=t.attachmentsSticky,f=t.maxMainBodyHeight,p=t.editorMinHeight,m=t.isPending,h=this.props,v=(h.enterpriseGlobalKey,h.currentProject),g=h.show,y=h.isShowCreateNext,S=h.user,I=h.epicSchemeFieldArchives,T=h.epicCreationFieldIDs,C=h.labels,P=h.requirementTypes,w=h.bugTypes,D=h.moduleSchemes,O=h.addLabel,R=h.isPermissible,j=h.issueTypeDetail,k={id:S.id,value:S.id,text:S.name,name:S.name,name_pinyin:S.name_pinyin,avatar:S.avatar,media:S.avatar},N=this.getAssigneeFieldWhetherRequired(I,T);return b.default.createElement(Y.default,{className:(0,te.default)(ae.default.wrapper),show:g,outsideClickCloseable:!1,keyboard:!1,enforceFocus:!1},b.default.createElement("span",{className:(0,te.default)(ae.default.closeButton),onClick:this.onCancel}),i&&b.default.createElement("div",{className:ae.default.modalLoading}),!i&&b.default.createElement("div",{className:ae.default.main},b.default.createElement("div",{className:ae.default.mainHeader},b.default.createElement("div",{className:ae.default.headerInfoSection},b.default.createElement("span",{style:{marginRight:"8px"}},(0,E.t)("\u521b\u5efa")),b.default.createElement(H.default,{type:"epic"}),b.default.createElement("span",null,(0,E.t)("\u53f2\u8bd7")),b.default.createElement("div",{className:ae.default.attentionWrapper},b.default.createElement(V.default,{type:"EPIC",projectID:v.id,watchers:r.watchers||[],onChange:this.handleAttentionChange,user:k,action:"create",suffixText:(0,E.t)("\u4eba\u5173\u6ce8\u4e2d"),showTooltip:!0}))),b.default.createElement("div",{className:ae.default.headerTitleSection},b.default.createElement("input",{className:ae.default.titleInput,ref:this.inputRef,autoFocus:!0,placeholder:"".concat((0,E.t)("\u8f93\u5165\u4e8b\u9879\u6807\u9898\uff08")).concat(s?"\u2318":"Ctrl").concat((0,E.t)(" + Enter \u53ef\u5feb\u901f\u521b\u5efa\uff09")),value:a,onChange:this.onTitleChange}))),b.default.createElement("div",{className:ae.default.mainBody,style:{maxHeight:"".concat(f,"px")},ref:this.bodyRef,onScroll:this.onDescriptionScroll},c?b.default.createElement("div",{className:ae.default.descriptionPlaceholder,style:{height:"".concat(p,"px")},onClick:function(){return e.setState({showDescriptionPlaceholder:!1})}},(0,E.t)("\u6309\u56de\u8f66\u6216\u70b9\u6b64\u5f00\u59cb\u7f16\u8f91\u63cf\u8ff0")):b.default.createElement("div",{className:ae.default.editorContainer},b.default.createElement(G.default,{type:this.state.editorType,readOnly:this.state.isPending,isEditing:!0,autofocus:u,minHeight:p,container:this.bodyRef.current,currentProject:v,initEditorData:l,richClientSaveUuid:"EPIC_EDITOR_CREATOR",onEditorChange:this.onDescriptionChange,isDisabled:m,canChangeType:!0,onEditorTypeChangeCallback:function(t){return e.onEditorTypeChange(t)},onFullScreenCallback:function(t){return e.setState({fullscreen:t})},onLoad:function(t){if(t.isError){if((0,G.isBlockType)(e.state.editorType)&&t.isDraftIdNotExist){var a="".concat(v.name,"_").concat(j.issueType,"_").concat(j.id,"_CREATOR");(0,G.setIssueDescriptionDraft)(a),e.setState({initEditorData:null},e.initCreatePage)}}else e.getAttachmentsStickyState()},className:(0,te.default)(ae.default.customSectionZindex,!this.state.fullscreen&&ae.default.editorHeight),ref:this.editorRef}))),b.default.createElement("div",{className:(0,te.default)(ae.default.mainFooter,d&&ae.default.sticky)},this.renderAttachmentSection(),b.default.createElement("div",{className:ae.default.operationsWrapper},b.default.createElement("div",{disabled:o,className:(0,te.default)(ae.default.operationButton,!s&&ae.default.wider,ne.default.newButton,ne.default.primary,ne.default.h32,o&&ne.default.disabled),onClick:this.onSubmit},(0,E.t)("\u521b\u5efa"),b.default.createElement("span",{className:ae.default.key},s?"\u2318":"Ctrl"),b.default.createElement("span",{className:(0,te.default)(ae.default.key,ae.default.enter)})),b.default.createElement("div",{className:(0,te.default)(ae.default.operationButton,ne.default.newButton,ne.default.default,ne.default.h32),onClick:this.onCancel},(0,E.t)("\u53d6\u6d88")),y&&b.default.createElement("span",{className:ae.default.switch},b.default.createElement(X.default,{checked:n,onChange:this.onAutoFlagChange}),b.default.createElement("span",{className:ae.default.switchText},(0,E.t)("\u7ee7\u7eed\u521b\u5efa\u4e0b\u4e00\u4e2a")))))),!i&&b.default.createElement("div",{className:ae.default.aside,onScroll:this.onAttrScroll,ref:this.sideRef},b.default.createElement("div",{className:ae.default.asideContent},b.default.createElement("div",{className:ae.default.issuePropertyContainer},b.default.createElement("div",{className:ae.default.issuePropertySection},b.default.createElement("label",null,(0,E.t)("\u5904\u7406\u4eba"),N&&b.default.createElement("span",{className:ae.default.highlight},"*")),b.default.createElement(Q.default,{clearable:!N,inProject:!0,projectID:v.id,value:r.assignee||null,onSelect:function(t){return e.changeAttributes({type:"assignee",value:t})},onClear:function(){return e.changeAttributes({type:"assignee"})},triggerExtraProps:{initialSelectedItem:(null===r||void 0===r?void 0:r.defaultAssignee)||null}}))),b.default.createElement("div",{className:(0,te.default)(ae.default.issuePropertyContainer,ae.default.hasNoBorder)},b.default.createElement($.default,{isCreate:!0,schemeFieldArchives:I,fieldIds:T,issueType:"EPIC",onChange:this.changeAttributes,customAttributes:r,timeValidDetct:this.timeDetect,labels:C,requirementTypes:P,bugTypes:w,moduleSchemes:D,addLabel:O,projectID:v.id,currentProject:v,isPermissible:R,portalProps:{toRight:!0,portalWrapStyle:{zIndex:1099},isScroll:this.state.isElemScroll,resetIsScroll:function(){e.setState({isElemScroll:!1})}},parentRef:this.sideRef})))))}},{key:"componentDidMount",value:function(){var e=this,t=this.props,a=t.currentProject,n=t.issueTypeDetail,i=this.state,r=i.name,o=i.editorType;document.addEventListener("keydown",this.quickSave),document.addEventListener("keydown",this.startEditing),window.addEventListener("resize",this.getHeights),this.getBasicInfo().then((function(){var t=e.props,a=t.epicSchemeFieldArchives,n=t.epicCreationFieldIDs;e.setDefaultValues(a,n),e.getHeights()})).finally((function(){if((0,G.isBlockType)(o)){var t=(0,G.getIssueDescriptionDraft)("".concat(a.name,"_").concat(n.issueType,"_").concat(n.id,"_CREATOR"));t?e.setState({isLoading:!1,initEditorData:{pageId:t.pageId,pageDraftId:t.pageDraftId,historyId:t.historyId},editorAutoFocus:!!r,showDescriptionPlaceholder:!1}):e.initCreatePage().then((function(){e.setState({isLoading:!1})}))}else e.setState({isLoading:!1,editorAutoFocus:!!r,showDescriptionPlaceholder:!1})}))}},{key:"componentDidUpdate",value:function(e,t){if(t.isReloading!==this.state.isReloading){var a=this.props,n=a.epicSchemeFieldArchives,i=a.epicCreationFieldIDs,r=e.epicSchemeFieldArchives,o=e.epicCreationFieldIDs;if(!(0,P.default)(n,r)&&!(0,P.default)(i,o)){var s=(0,w.default)(i,o);this.setDefaultValues(n,s)}}t.allAttachments.length!==this.state.allAttachments.length&&this.whetherShowMoveButton(),t.editorType!==this.state.editorType&&(0,G.isBlockType)(this.state.editorType)&&!this.state.initEditorData&&this.initCreatePage()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.quickSave),document.removeEventListener("keydown",this.startEditing),window.removeEventListener("resize",this.getHeights)}},{key:"getBasicInfo",value:function(){return Promise.all([this.props.getRequirementScheme(!0),this.props.getBugTypes(),this.props.getRequirementTypes(),this.props.getModuleSchemes(),this.props.getEpicScheme(!0)])}},{key:"onTitleChange",value:function(e){this.setState({name:e.target.value})}},{key:"onAutoFlagChange",value:function(e){this.setState({autoNext:e},(function(){localStorage.setItem("DEFECT_CREATION_AUTO_NEXT",e)}))}},{key:"onSubmit",value:function(){var e=(0,c.default)(r.default.mark((function e(){var t,a,n,i,o,s,l,c,u,d,f,p,m,h,v,g,b,y,S,I,P,w,R,j,F,_,M,x,B,U,W,Y,H,V,K,z,q,J,X,Q,$,te,ae,ne,ie,re=this;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=this.props.currentProject,l=s.id,c=s.project_path,u=s.name,d=this.props,f=d.isShowCreateNext,p=d.epicSchemeFieldArchives,m=d.epicCreationFieldIDs,h=d.closeHandle,v=d.callback,g=d.createCallbackFromTest,b=d.issueTypeDetail,y=d.callbackWithData,S=this.state,I=S.name,P=S.autoNext,w=S.isPending,R=S.allAttachments,j=S.attachments,F=S.iterationCode,_=S.attributes,M=_.assignee,x=_.priority,B=_.dueDate,U=_.labels,W=_.watchers,Y=_.fields,H=_.startDate,V=_.requirementType,K=_.workingHours,z=_.defectType,q=_.projectModule,J=_.progress,X=S.thirdLinks,Q=S.initEditorData,$=S.editorType,null===(t=this.editorRef)||void 0===t||!t.current||!(0,G.isBlockType)(this.state.editorType)){e.next=12;break}return e.prev=4,e.next=7,(0,ee.getBlockEditorFinished)(this.editorRef.current);case 7:e.next=12;break;case 9:return e.prev=9,e.t0=e.catch(4),e.abrupt("return",(0,N.warning)((0,E.t)("\u66f4\u65b0\u63cf\u8ff0\u8d85\u65f6")));case 12:if(!w){e.next=14;break}return e.abrupt("return");case 14:if(!(0,C.default)((0,T.default)(I))){e.next=17;break}return(0,N.warning)((0,E.t)("\u53f2\u8bd7\u6807\u9898\u4e0d\u80fd\u4e3a\u7a7a")),e.abrupt("return");case 17:if(128,!((0,T.default)(I).length>128)){e.next=21;break}return(0,N.warning)((0,E.t)("\u53f2\u8bd7\u540d\u79f0\u6700\u591a\u652f\u6301{{num}}\u4f4d",{num:128})),e.abrupt("return");case 21:if(!(te=m.find((function(e){var t=p[e],a=t.required,n=t.issueField.type;if(a){var i;switch(n){case D.FIELD_TYPE.ASSIGNEE:i=M;break;case D.FIELD_TYPE.PROGRESS:i=J;break;case D.FIELD_TYPE.PRIORITY:i=x;break;case D.FIELD_TYPE.REQUIREMENT_TYPE:i=V;break;case D.FIELD_TYPE.START_DATE:i=H;break;case D.FIELD_TYPE.DUE_DATE:i=B;break;case D.FIELD_TYPE.WORKING_HOURS:i=K;break;case D.FIELD_TYPE.LABEL:i=U;break;case D.FIELD_TYPE.WATCHER:i=W;break;case D.FIELD_TYPE.DEFECT_TYPE:i=z;break;case D.FIELD_TYPE.MODULE:i=q;break;default:i=Y[e]}return!(Array.isArray(i)?i.length:null!==i&&void 0!==i)}return!1})))){e.next=25;break}return(0,N.warning)("".concat((0,E.t)("\u8bf7\u586b\u5199")).concat(p[te].issueField.name)),e.abrupt("return");case 25:if(!(j.length&&j.findIndex((function(e){return e.fileId<0}))>-1)){e.next=28;break}return(0,N.warning)((0,E.t)("\u6709\u9644\u4ef6\u6b63\u5728\u4e0a\u4f20\uff0c\u8bf7\u7a0d\u540e\u63d0\u4ea4")),e.abrupt("return");case 28:this.setState({isPending:!0}),ae=Object.keys(Y).filter((function(e){return void 0!==Y[e]})).map((function(e){var t=p[e].issueField.componentType;return t===O.PROPERTY_TYPE_CONSTANTS.SELECT_ITERATION_MULTI||t===O.PROPERTY_TYPE_CONSTANTS.SELECT_MEMBER_MULTI?{id:e,content:Y[e].map((function(e){return e.id}))}:t===O.PROPERTY_TYPE_CONSTANTS.SELECT_ITERATION_SINGLE||t===O.PROPERTY_TYPE_CONSTANTS.SELECT_MEMBER_SINGLE?{id:e,content:Y[e].id}:{id:e,content:Y[e]}})),ne=(0,Z.default)(R,X).map((function(e){return se(se({createdAt:e.createdAt},e.modao),e.codesign)})),ie=(0,G.isBlockType)($)?se(se({},Q),{},{descriptionType:G.EditorType.BLOCK}):{content:(null===(a=this.editorRef)||void 0===a||null===(n=a.current)||void 0===n?void 0:n.getRichContent())||"",slateRaw:(null===(i=this.editorRef)||void 0===i||null===(o=i.current)||void 0===o?void 0:o.getRichContent("raw"))||"",descriptionType:G.EditorType.MARKDOWN},(0,L.createIssue)(l,{type:"EPIC",iterationCode:F,name:(0,T.default)(I),fileIds:j.map((function(e){return e.fileId})),thirdLinks:ne,customFieldValueMap:ae.length?ae:null,priority:x,dueDate:B,assignee:M,labelIds:U,watchers:W.map((function(e){return e.id})),startDate:H,issueTypeId:b.id,requirementTypeId:V,workingHours:K,defectTypeId:z,projectModuleId:q,progress:J,kmPage:ie},!0).then((function(e){var t=e.data,a="".concat(u,"_").concat(b.issueType,"_").concat(b.id,"_CREATOR");(0,G.setIssueDescriptionDraft)(a),(0,N.success)("".concat((0,E.t)("\u53f2\u8bd7 #")).concat(t.code).concat((0,E.t)(" \u521b\u5efa\u6210\u529f\uff0c\u70b9\u51fb\u67e5\u770b\u53f2\u8bd7\uff01")),{link:"".concat(c,"/epics/issues/").concat(t.code)}),g&&g(t),re.removeDraft(),v&&v(null,t.issueStatusId),y&&y(t),f&&P?re.resetFormData():h()}),(function(e){var t=e.code,a=e.msg;if(8026===t)(0,N.danger)((0,E.t)("\u521b\u5efa\u9875\u5c5e\u6027\u5df2\u53d8\u66f4\uff0c\u8bf7\u68c0\u67e5\u5fc5\u586b\u5c5e\u6027\u5e76\u518d\u6b21\u63d0\u4ea4\u3002")),re.setState({isReloading:!0},(function(){Promise.all([re.props.getEpicScheme(),re.props.getEpicScheme(!0)]).then((function(){re.setState({isReloading:!1})}))}));else{if((0,k.configPlanNotToastMsg)(t))return;(0,N.danger)((0,A.getErrorMessage)(a))}})).finally((function(){re.setState({isPending:!1})}));case 33:case"end":return e.stop()}}),e,this,[[4,9]])})));return function(){return e.apply(this,arguments)}}()},{key:"timeDetect",value:function(e,t){var a=this.state.attributes,n=a.dueDate,i=a.startDate,r=(0,S.default)(e).startOf("day");if("start"===t&&n){var o=(0,S.default)(n).startOf("day");return r.valueOf()>o.valueOf()}if("end"===t&&i){var s=(0,S.default)(i).startOf("day");return r.valueOf()<s.valueOf()}return!1}},{key:"changeAttributes",value:function(e){var t=e.isCustom,a=e.type,n=e.value,i=e.issueFieldId,r=this.state.attributes;this.setState({attributes:se(se({},r),t?{fields:se(se({},r.fields),{},(0,d.default)({},i,n))}:"assignee"===a?{assignee:n?n.value:null,defaultAssignee:n}:(0,d.default)({},a,n))})}},{key:"setDefaultValues",value:function(e,t){var a=this.state.attributes,n=this.props.user,i={id:n.id,value:n.id,text:n.name,name:n.name,name_pinyin:n.name_pinyin,avatar:n.avatar,media:n.avatar};this.setState({attributes:(0,I.default)(a,(function(a){t&&t.forEach((function(t){var r=e[t],o=r.needDefault,s=r.value,l=r.userMap,c=r.iterationMap,d=r.issueField,f=d.type,p=d.componentType;if(o&&null!==s)switch(f){case D.FIELD_TYPE.ASSIGNEE:"VARIABLE"===s.type?(a.assignee=n.id,a.defaultAssignee=i):"CONSTANT"===s.type&&(a.assignee=s.value,a.defaultAssignee=l[s.value]);break;case D.FIELD_TYPE.PRIORITY:a.priority=s.value;break;case D.FIELD_TYPE.DEFECT_TYPE:a.defectType=s.value;break;case D.FIELD_TYPE.START_DATE:a.startDate=s.value;break;case D.FIELD_TYPE.DUE_DATE:a.dueDate=s.value;break;case D.FIELD_TYPE.MODULE:a.projectModule=s.value;break;case D.FIELD_TYPE.LABEL:a.labels=s.value;break;case D.FIELD_TYPE.WATCHER:"VARIABLE"===s.type?a.watchers=(0,u.default)("CREATOR"===s.value?[i]:[]):a.watchers=s.value.map((function(e){return l[e]}));break;case D.FIELD_TYPE.PROGRESS:a.progress=s.value;break;case D.FIELD_TYPE.REQUIREMENT_TYPE:a.requirementType=s.value;break;case D.FIELD_TYPE.WORKING_HOURS:a.workingHours=s.value;break;default:p===O.PROPERTY_TYPE_CONSTANTS.SELECT_MEMBER_SINGLE||p===O.PROPERTY_TYPE_CONSTANTS.SELECT_MEMBER_MULTI?"VARIABLE"===s.type?a.fields[t]=i:Array.isArray(s.value)?a.fields[t]=s.value.map((function(e){return l[e]})):a.fields[t]=l[s.value]:p===O.PROPERTY_TYPE_CONSTANTS.SELECT_ITERATION_SINGLE||p===O.PROPERTY_TYPE_CONSTANTS.SELECT_ITERATION_MULTI?Array.isArray(s.value)?a.fields[t]=s.value.map((function(e){return c[e]})):a.fields[t]=c[s.value]:a.fields[t]=s.value}}))}))})}},{key:"resetFormData",value:function(){var e=this,t=this.props,a=t.epicSchemeFieldArchives,n=t.epicCreationFieldIDs,i=t.iterationCode,r=t.isShowCreateNext,o=this.state.autoNext;this.setState({name:"",attachments:[],thirdLinks:[],isPending:!1,attributes:{assignee:void 0,priority:void 0,defectType:void 0,requirementType:void 0,dueDate:void 0,projectModule:void 0,workingHours:void 0,labels:[],watchers:[],fields:{},startDate:void 0},iterationCode:void 0,initEditorData:null,editorAutoFocus:!0},(function(){e.setDefaultValues(a,n),e.setState({iterationCode:i}),e.combineThirdLinks(),r&&o&&(e.initCreatePage(),e.setState({showDescriptionPlaceholder:!0}),e.titleInputFocus())}))}},{key:"fileUpload",value:function(e){var t=this.state.attachments;this.setState({attachments:[].concat((0,u.default)(t),(0,u.default)(e))},this.combineThirdLinks)}},{key:"handleDeleteAttachment",value:function(e,t){var a=this;(0,F.delAttachment)(e,t).then((function(){a.setState({attachments:(0,I.default)(a.state.attachments,(function(e){var a=e.findIndex((function(e){return e.fileId===t}));e.splice(a,1)}))},a.combineThirdLinks)}))}},{key:"onFileDropSuccess",value:function(e){var t=this;this.setState((function(t){return{attachments:(0,I.default)(t.attachments,(function(t){var a;if(t.find((function(t){return t.fileId===e.fileId}))){(0,N.success)("".concat(e.name).concat((0,E.t)(" \u6587\u4ef6\u5df2\u66f4\u65b0!")));var n=t.findIndex((function(t){return t.timestamp===e.timestamp}));t.splice(n,1),a=t.findIndex((function(t){return t.fileId===e.fileId}))}else a=t.findIndex((function(t){return t.timestamp===e.timestamp}));t[a]=se(se({},t[a]),e)}))}})),this.setState((function(){t.combineThirdLinks()}))}},{key:"onFileDropFail",value:function(e){var t=e.timestamp;this.setState({attachments:(0,I.default)(this.state.attachments,(function(e){var a=e.findIndex((function(e){return e.timestamp===t}));e.splice(a,1)}))})}},{key:"onFileDropDelete",value:function(e){var t=e.fileId,a=e.isModao,n=e.isCodesign,i=this.props.currentProject.id;a||n?this.setState({thirdLinks:this.state.thirdLinks.filter((function(e){return e.fileId!==t}))},this.combineThirdLinks):this.handleDeleteAttachment(i,t)}},{key:"onFileDropCancel",value:function(e){var t=e.timestamp,a=e.isModao,n=e.isCodesign;a||n?this.setState({thirdLinks:this.state.thirdLinks.filter((function(e){return e.timestamp!==t}))},this.combineThirdLinks):this.setState({attachments:(0,I.default)(this.state.attachments,(function(e){var a=e.findIndex((function(e){return e.timestamp===t}));e.splice(a,1)}))},this.combineThirdLinks)}},{key:"whetherShowMoveButton",value:function(){if(this.wrapperRef.current&&this.listRef.current){var e=this.wrapperRef.current.getBoundingClientRect().width,t=this.listRef.current.getBoundingClientRect().width;this.setState({showButton:t>e})}}},{key:"moveContent",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.wrapperRef.current&&this.listRef.current){var t=this.state.toLeft,a=this.wrapperRef.current.getBoundingClientRect(),n=a.width,i=this.listRef.current.getBoundingClientRect(),r=i.width,o=r+t-n;e?o<=n?this.setState({toLeft:t+-1*o,showButton:!1}):this.setState({toLeft:t-n}):o<=n?this.setState({toLeft:0,showButton:!0}):this.setState({toLeft:t+n})}}}]),a}(b.Component),s.propTypes={show:y.default.bool,user:y.default.object,closeHandle:y.default.func,currentProject:y.default.shape({id:y.default.number.isRequired,name:y.default.string,owner_user_name:y.default.string,project_path:y.default.string}),getEpicScheme:y.default.func,getModuleSchemes:y.default.func,epicSchemeFieldArchives:y.default.object,epicCreationFieldIDs:y.default.array,getRequirementTypes:y.default.func,labels:y.default.array,addLabel:y.default.func,isPermissible:y.default.func,isShowCreateNext:y.default.bool,enterpriseGlobalKey:y.default.string,callback:y.default.func,createCallbackFromTest:y.default.func,iterationCode:y.default.number,callbackWithData:y.default.func},s.defaultProps={isShowCreateNext:!0},o=l))||o)||o)||o)||o;t.default=ce},"L/oC":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOfficeEdit=t.getOfficePreview=t.getOfficePdfPreview=t.getTxtPreview=t.getMarkdownPreview=t.getFileContent=void 0;var n=a("Z4vw");t.getFileContent=function(e,t,a,i){return(0,n.get)("/api/user/".concat(e,"/project/").concat(t,"/file/").concat(a,"/history/").concat(i,"/view"))};t.getMarkdownPreview=function(e,t,a){return(0,n.get)("/api/user/".concat(e,"/project/").concat(t,"/files/").concat(a,"/markdown-preview"))};t.getTxtPreview=function(e,t){return(0,n.get)("/api/project/".concat(e,"/files/").concat(t,"/view"))};t.getOfficePdfPreview=function(e,t){return(0,n.get)("/collaboration/api/project/".concat(e,"/attachment/").concat(t,"/preview"))};t.getOfficePreview=function(e,t){return(0,n.get)("/external/platform/project/".concat(e,"/files/").concat(t,"/file-preview"))};t.getOfficeEdit=function(e,t){return(0,n.get)("/external/platform/project/".concat(e,"/files/").concat(t,"/file-edit"))}},L9lg:function(e,t,a){e.exports={item:"item-2OWkUqDzs6","last-child":"last-child-1Uv4bdIPQO",lastChild:"last-child-1Uv4bdIPQO","item-hovering":"item-hovering-CBaRzd205l",itemHovering:"item-hovering-CBaRzd205l","item-icon":"item-icon-20dgDp5WkW",itemIcon:"item-icon-20dgDp5WkW","item-code":"item-code-18YgGyevPg",itemCode:"item-code-18YgGyevPg","item-name":"item-name-3c-VMwDyxb",itemName:"item-name-3c-VMwDyxb","item-date":"item-date-ck1ySyPEjy",itemDate:"item-date-ck1ySyPEjy","item-priority":"item-priority-FwL1rFWvSm",itemPriority:"item-priority-FwL1rFWvSm","item-status":"item-status-148QPO6sV5",itemStatus:"item-status-148QPO6sV5","item-assignee":"item-assignee-dQC56pBn-g",itemAssignee:"item-assignee-dQC56pBn-g","to-right":"to-right-1uvQYZafnH",toRight:"to-right-1uvQYZafnH","item-arrow":"item-arrow-2qfZOdYh-g",itemArrow:"item-arrow-2qfZOdYh-g"}},LD9k:function(e,t,a){"use strict";a("I5cv"),a("mYba"),a("jm62"),a("EK0E");var n=a("TqRt"),i=a("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(a("o0o1")),o=n(a("pVnL")),s=n(a("RIqP")),l=n(a("yXPU")),c=n(a("lSNA")),u=n(a("lwsE")),d=n(a("W8MJ")),f=n(a("PJYZ")),p=n(a("7W2i")),m=n(a("a1gu")),h=n(a("Nsbk"));a("f3/d"),a("0l/t"),a("dRSK"),a("L9s1"),a("Z2Ku"),a("CX2u"),a("Btvt"),a("VRzm"),a("pIFo"),a("INYr"),a("0mN4"),a("bWfx"),a("hhXQ"),a("RW0V"),a("XfO3"),a("yt8O"),a("rGqo"),a("ioFf"),a("HEwt"),a("T39b"),a("OG14"),a("tUrg");var v,g,E,b,y=a("mVeg"),S=gt(a("cDcd")),I=a("h74D"),T=n(a("17x9")),C=a("dtw8"),P=n(a("qLOp")),w=n(a("TsYS")),D=a("7FZc"),O=n(a("P5Jw")),R=n(a("qCZF")),j=n(a("WE/Q")),k=n(a("Yzhn")),N=a("nuIr"),A=n(a("QDR0")),L=n(a("AVuq")),F=n(a("wd/R")),_=n(a("V/h/")),M=n(a("Y+p1")),x=n(a("XLbL")),B=n(a("4qC0")),U=n(a("GoyQ")),W=n(a("UB5X")),Y=n(a("Z0cm")),H=n(a("K2gz")),V=a("FaIw"),G=a("V+QM"),K=a("sWxF"),z=a("w3Wo"),q=a("xgZS"),Z=n(a("8+Mu")),J=n(a("2KQ+")),X=n(a("ai0/")),Q=a("Z4vw"),$=a("DKcV"),ee=a("FpRC"),te=n(a("2CT0")),ae=n(a("L8Eh")),ne=n(a("Th6D")),ie=n(a("n1Xv")),re=n(a("1+AE")),oe=n(a("Zsd2")),se=n(a("wCj3")),le=n(a("XiRy")),ce=a("x+BT"),ue=n(a("OTim")),de=a("885C"),fe=n(a("A97/")),pe=n(a("TT2u")),me=a("5DNL"),he=a("3RH6"),ve=a("AwMv"),ge=n(a("fRA5")),Ee=a("aHEs"),be=n(a("1lUc")),ye=n(a("mSbZ")),Se=n(a("htee")),Ie=n(a("4Fdf")),Te=n(a("uk0h")),Ce=n(a("+Dhf")),Pe=a("jzjO"),we=n(a("begU")),De=n(a("0Zwn")),Oe=n(a("W0/N")),Re=n(a("HtPo")),je=n(a("CF/V")),ke=n(a("iOVS")),Ne=n(a("oIiO")),Ae=n(a("Qkhu")),Le=a("LvDl"),Fe=n(a("7hiy")),_e=n(a("AoGB")),Me=n(a("HwxY")),xe=n(a("KIkv")),Be=n(a("KUqB")),Ue=a("7bn+"),We=n(a("X5YD")),Ye=n(a("xMGB")),He=a("17N+"),Ve=a("LvkV"),Ge=a("9+7+"),Ke=a("lGCG"),ze=n(a("WKBZ")),qe=n(a("cHah")),Ze=n(a("DDpV")),Je=n(a("QWzU")),Xe=n(a("6yKH")),Qe=a("cUHt"),$e=n(a("8lvN")),et=(n(a("IZvD")),n(a("M/Qn")),a("nuIr")),tt=a("DgMC"),at=n(a("ZYwa")),nt=n(a("HQT4")),it=a("DgMC"),rt=n(a("yTui")),ot=n(a("MxQt")),st=n(a("Mh+3")),lt=n(a("q70N")),ct=a("NTFJ"),ut=a("qS/1"),dt=n(a("q18W")),ft=n(a("Se5f")),pt=a("BlBX"),mt=gt(a("Mdvu")),ht=a("AMAM");function vt(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(vt=function(e){return e?a:t})(e)}function gt(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!==typeof e)return{default:e};var a=vt(t);if(a&&a.has(e))return a.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=r?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}return n.default=e,a&&a.set(e,n),n}function Et(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function bt(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Et(Object(a),!0).forEach((function(t){(0,c.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Et(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function yt(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,h.default)(e);if(t){var i=(0,h.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,m.default)(this,a)}}var St=(v=(0,I.connect)((function(e){var t,a;return{enterpriseGlobalKey:e.APP.enterprise.globalKey,enterpriseName:e.APP.enterprise.name,watermark:e.APP.enterprise.watermark,payed:e.APP.enterprise.payed,user:e.APP.user,isSensitiveAdmin:(0,$.checkSensitiveAdmin)(e.CURRENT_USER_ENTERPRISE_PERMISSION_NAMESPACE_FOR_REDUX_STORE.currentEnterprisePermissionList,e.CURRENT_USER_PROJECT_PERMISSION_NAMESPACE_FOR_REDUX_STORE.currentProjectPermissionList),ramOnline:null===(t=e.CURRENT_USER_ENTERPRISE_PERMISSION_NAMESPACE_FOR_REDUX_STORE)||void 0===t||null===(a=t.ramStatus)||void 0===a?void 0:a.ramOnline}})),(0,C.withRouter)(g=v(g=(0,ye.default)(g=(0,Ce.default)(g=(0,Se.default)(g=(0,Te.default)(g=(0,Ie.default)(g=(0,pe.default)(g=(0,me.FlashAnchorDecorator)(g=(0,_e.default)((b=E=function(e){(0,p.default)(a,e);var t=yt(a);function a(e){var n;return(0,u.default)(this,a),(n=t.call(this,e)).isDeleteInFilePreview=!1,n.getFunctionFlags=function(){var e=n.props.currentProjectFunctions;return{codeManagementOpen:e.some((function(e){return e.code===Ve.KEY_CONFIG.CODE_MANAGEMENT&&"1"===e.value})),testManagementOpen:e.some((function(e){return e.code===Ve.KEY_CONFIG.TEST_MANAGEMENT&&"1"===e.value})),issueReviewOpen:Ge.enableIssueReview}},n.elemShow=function(){var e=n.props.currentProjectCooperateSettings,t=e.COOPERATE_MODE,a=e.txcAuthorized;n.dataLoad=(0,Oe.default)({elemInOrder:[a&&"feedBack","SCRUM"===t&&!n.state.detailInfoState.parent&&"subTask","codeRepo","CLASSIC"===t&&"blockingRelation","reference","splitTask","logs","comment"].filter((function(e){return e})),onRenderItem:function(e,t,a,i){n.setState({isRender:bt({},i),isRenderAll:t},(function(){a(),t&&n.setState({controlCaculatePos:Date.now()})}))}}),n.dataLoad("comment")},n.titleInputRef=S.default.createRef(),n.scrollRef=S.default.createRef(),n.renderParentsInfo=function(){var e,t,a=n.state,i=a.tooltipTitle,r=a.detailInfoState,o=a.nameList,s=a.showMoreCrumb,l=n.props,c=l.projectPath,u=l.currentProjectCooperateSettings,d=l.issueCode,f=u&&u.EPIC&&u.EPIC===N.MODULE_SWITCH.OPENED,p=u.COOPERATE_MODE;return S.default.createElement(S.default.Fragment,null,"CLASSIC"===p?S.default.createElement(ke.default,{issueType:null===r||void 0===r||null===(e=r.issueTypeDetail)||void 0===e?void 0:e.iconType,nameList:o,showMoreCrumb:s,toggleDropdown:n.toggleDropdown,projectPath:c}):S.default.createElement("div",{className:P.default.detailId},f&&r.epic&&S.default.createElement(D.TooltipTrigger,{title:"".concat((0,y.t)("\u6240\u5c5e\u53f2\u8bd7\uff1a#")).concat(r.epic.code," ").concat(r.epic.name)},S.default.createElement(C.Link,{to:"".concat(c,"/epics/issues/").concat(r.epic.code,"/detail"),className:(0,H.default)(P.default.code,P.default.number)},S.default.createElement(Be.default,{type:"epic"}),"#",r.epic.code)),f&&r.epic&&S.default.createElement("span",{className:P.default.codeIdDivideLine},"/"),S.default.createElement("span",{className:(0,H.default)(P.default.code,P.default.lastId,P.default.lastNumber)},S.default.createElement(C.Link,{to:"".concat(c,"/assignments/issues/").concat(r.code,"/detail"),className:(0,H.default)(P.default.code,P.default.number)},S.default.createElement(Be.default,{type:null===r||void 0===r||null===(t=r.issueTypeDetail)||void 0===t?void 0:t.iconType}),"#",r.code),S.default.createElement(D.TooltipTrigger,{title:i,onVisibleChange:n.onVisibleChange},S.default.createElement(O.default,{text:"".concat(window.location.origin).concat(c,"/assignments/issues/").concat(d,"/detail")},S.default.createElement("div",{className:P.default.copyIcon,onClick:n.onCopyClick})))),S.default.createElement("div",{className:(0,H.default)(P.default.code,P.default.lastId,P.default.lastNumber),style:{marginLeft:20,fontWeight:600}},"|",S.default.createElement("span",{style:{color:"red",margin:"0 5px"}},"GID"),"#",r.id,S.default.createElement(D.TooltipTrigger,{title:i,onVisibleChange:n.copyGID},S.default.createElement(O.default,{text:r.id},S.default.createElement("div",{className:P.default.copyIcon,onClick:n.onCopyClick}))))))},n.copyGID=function(){n.setState({tooltipTitle:(0,y.t)("\u590d\u5236")})},n.renderTitle=function(e,t,a,i){var r=n.state,o=r.detailInfoState,s=r.inputFocus;return S.default.createElement(rt.default,{value:o.name,ref:!a&&n.titleInputRef,onBlur:function(){n.setState({inputFocus:!1}),n.submitTitleChange()},onChange:function(e){return n.setState({detailInfoState:bt(bt({},o),{},{name:e})})},viewLine:i,onPressEnter:n.submitTitleChange,initFocus:s,onFocus:function(){return n.setState({inputFocus:!0})}})},n.renderScrollTitle=function(e,t,a){return n.state.inputFocus?S.default.createElement(S.default.Fragment,null,n.renderTitle(e,!0,t)):S.default.createElement("div",{className:P.default.scrolledTitleWrap},S.default.createElement("div",{className:(0,H.default)(P.default.titleIconWrap,n.state.noHoverIcon&&P.default.noHoverIcon)},S.default.createElement("div",{className:P.default.titleIcon},S.default.createElement(Be.default,{type:a})),S.default.createElement("div",{className:P.default.breadcrumb},n.renderParentsInfo())),n.renderTitle(e,!0,t,1))},n.getLinkfragment=function(){var e=n.state.detailInfoState,t=n.props,a=t.browserRouter,i=t.projectPath,r=t.location.pathname,o=t.params.epicCode,s=t.iterationCode,l=a.params.subIssueCode,c=(0,tt.currentListPath)(r);return o?"".concat(i,"/epics/issues/").concat(e.epic.code,"/detail/subissues/"):-1!==c.indexOf("iterations")?"".concat(i,"/iterations/").concat(s,"/issues/"):-1!==c.indexOf("releases")?"".concat(i,"/releases/").concat(s,"/issues/"):l?"".concat(i,"/").concat(c,"/issues/").concat(a.params.requirementCode,"/detail/subissues/"):"".concat(i,"/").concat(c,"/issues/")},n.onBtnClick=function(e){n["".concat(e.toLowerCase(),"BtnClicked")]&&n["".concat(e.toLowerCase(),"BtnClicked")]()},n.getEditComp=function(e){n.editComp=e},n.editStatusChanged=function(e,t){n.setState(bt({isDesEditing:e,isShowItemPlaceholder:bt(bt({},n.state.isShowItemPlaceholder),{},{description:void 0!==t?t:!e})},e?{}:{isDescriptionBtnFixed:!1}),(function(){n.setState({controlCaculatePos:Date.now()})}))},n.handleBlockingRelationVisibleChange=function(e){n.setState({isBlockingRelationVisible:e,isShowItemPlaceholder:bt(bt({},n.state.isShowItemPlaceholder),{},{blockingRelation:e})})},n.getCodeRepoSetting=function(){var e=n.props.currentProject,t=n.state.detailInfoState;return(0,K.fetchRepoSettingInfo)(e.name,t.issueTypeDetail.id).then((function(e){var t=e.data.find((function(e){return"RELATE_VCS"===e.configName}));t&&"ON"===t.configValue?(n.setState({codeRepoRelationOpened:!0}),n.getAssociatedCodeRepos()):n.dataLoad("codeRepo")}))},n.getCodeRepos=function(e){var t=n.props,a=t.enterpriseGlobalKey,i=t.currentProject,r=n.state,o=r.associatedCodeRepos,s=r.codeRepoList;e?n.setState({availableCodeRepos:s.filter((function(t){return t.name.toLowerCase().includes(e.toLowerCase())&&!o.some((function(e){return e.id===t.id}))}))}):(0,K.fetchAvailableCodeRepos)(a,i.name).then((function(e){var t=e.data;n.setState({codeRepoList:t,availableCodeRepos:t.filter((function(e){return!o.some((function(t){return t.id===e.id}))}))})}))},n.associateCodeRepo=function(e){var t=n.props.currentProject,a=n.state.detailInfoState.code;(0,K.associateCodeRepo)(t.name,a,e).then((function(){(0,q.success)((0,y.t)("\u66f4\u65b0\u6210\u529f")),n.getAssociatedCodeRepos().then((function(){return n.getCodeRepos()}))}))},n.cancelAssociateCodeRepo=function(e){var t=n.props.currentProject,a=n.state.detailInfoState.code;(0,K.cancelAssociateCodeRepo)(t.name,a,e).then((function(){(0,q.success)((0,y.t)("\u66f4\u65b0\u6210\u529f")),n.getAssociatedCodeRepos().then((function(){return n.getCodeRepos()}))}))},n.cancelCodeRepo=function(){var e=n.state.isShowItemPlaceholder;n.setState({isShowItemPlaceholder:bt(bt({},e),{},{codeRepo:!1})})},n.handleWorkItemRelationVisibleChange=function(e){n.setState({isWorkItemCreationVisible:e,isShowItemPlaceholder:bt(bt({},n.state.isShowItemPlaceholder),{},{workItem:e})})},n.insideProgramCheck=function(e){var t=n.props.currentProject;return e?(0===e.code&&e.data.length>0&&(n.setState({inProgram:!0}),n.getAssociatedWorkItems()),void n.dataLoad("workItem")):(0,K.whetherInProgram)(t.id).then((function(e){e.data.length>0&&n.setState({inProgram:!0}),n.getAssociatedWorkItems()})).finally((function(){n.dataLoad("workItem")}))},n.workItemRelationChanged=function(){n.getAssociatedWorkItems(),n.getActivityList()},n.cancelWorkItem=function(){return n.setState({isShowItemPlaceholder:bt(bt({},n.state.isShowItemPlaceholder),{},{workItem:!1})})},n.scrollToAttechment=function(){var e,t,a;null!==(e=n.scrollRef)&&void 0!==e&&e.current&&null!==(t=n.attechmentRef)&&void 0!==t&&t.current&&null!==(a=n.headerRef)&&void 0!==a&&a.current&&(0,ee.scrollIntoView)(n.scrollRef.current,n.attechmentRef.current,-n.headerRef.current.offsetHeight)},n.handleReviewListChanged=function(){n.fetchIssueReviewList((function(e){0!==e.length?ee.scrollIntoView&&n.setState({activeLogTab:et.MATTER_TABS_TYPE.APPROVAL},(function(){(0,ee.scrollRelatedToTopMenu)("issue-review-list",0,n.scrollRef.current)})):n.setState({activeLogTab:"activity"})})),setTimeout((function(){n.getActivityList()}),1e3)},n.referencesBtnClicked=function(){"activity"===n.state.activeLogTab?n.changeActivityTabAndShow():n.setState({activeLogTab:"activity"},(function(){n.setCommentPosition((function(){setTimeout((function(){n.changeActivityTabAndShow()}),0)}))}))},n.getSplitIssueList=function(){var e=n.props,t=e.detailInfo,a=e.currentProject;return(0,ve.fetchSplitIssueParentList)("mission",a.id,t.code).then((function(e){var t=e.data;n.setState({splitParentRequirement:null!==t&&void 0!==t&&t.Requirement?{Requirement:t.Requirement}:{}})}))},n.changeActivityTabAndShow=function(){"WITHOUT_COMMENT"===n.state.activitiesTab?n.setState({activitiesTab:"ALL",isShowItemPlaceholder:bt(bt({},n.state.isShowItemPlaceholder),{},{reference:!0})},(function(){n.changeTabFn(["ALL"]),n.setCommentPosition((function(){n.doShowReference()}))})):n.doShowReference()},n.doShowReference=function(){n.props.autoToggleComment(n.state.detailInfoState.code,!0)},n.scrollToBottom=function(e){(0,ee.scrollRelatedToTopMenu)("bottom",0,n.scrollRef.current,e)},n.operateSensitive=function(){var e=n.state.isSensitive,t=n.props,a=t.detailInfo,i=t.currentProject;e?n.setState({showDeleteModal:!0}):(0,G.addSensitive)(a.code,i.name).then((function(e){0===e.code&&((0,q.success)((0,y.t)("\u6807\u8bb0\u6210\u529f\uff01")),n.getSensitiveMessage(a.code,i.name))}))},n.sensitiveCtrl=function(){var e=n.state.isSensitive,t=n.props,a=t.detailInfo,i=t.currentProject;e?n.setState({showDeleteModal:!0}):(0,G.addSensitive)(a.code,i.name).then((function(e){0===e.code&&((0,q.success)((0,y.t)("\u6807\u8bb0\u6210\u529f\uff01")),n.getSensitiveMessage(a.code,i.name))}))},n.cancelMark=function(){var e=n.props,t=e.detailInfo,a=e.currentProject;(0,G.cancelSensitive)(t.code,a.name).then((function(e){n.setState({showDeleteModal:!1}),0===e.code&&((0,q.success)((0,y.t)("\u53d6\u6d88\u6807\u8bb0\u6210\u529f\uff01")),n.getSensitiveMessage(t.code))}))},n.getNotUploadElems=function(){var e=n.state,t=e.isDesEditing,a=e.isCommentEditing;return[t&&n.editComp.containerRef.current,a&&n.commentEditorRef&&n.commentEditorRef.current]},n.dragEnterDes=function(e){n.dragEnter(e,"des")},n.dragEnterComment=function(e){n.dragEnter(e,"comment")},n.dragEnter=function(e,t){e.preventDefault(),e.stopPropagation(),n["des"===t?"intoDesCount":"intoCommentCount"]++},n.dragLeaveDes=function(e){n.dragLeave(e,"des")},n.dragLeaveComment=function(e){n.dragLeave(e,"comment")},n.dragLeave=function(e,t){e.preventDefault(),e.stopPropagation();var a="des"===t?"intoDesCount":"intoCommentCount";n[a]--,0===n[a]&&n.setState({notUpload:!1})},n.mouseLeaveDes=function(){n.mouseLeave("des")},n.mouseLeaveComment=function(){n.mouseLeave("comment")},n.renderActivity=function(e){var t=n.state,a=t.isInited,i=t.activities,r=t.detailInfoState,o=t.activitiesTab,s=t.isCommentSticky,l=n.props,c=l.isDetail,u=l.currentProject,d=l.user,f=l.projectPath,p=l.domID;return S.default.createElement(L.default,{isInited:a,scrollRef:n.scrollRef,isDetail:c,currentProject:u,user:d,activities:i,projectPath:f,domID:p,flashAnchor:n.props.flashAnchor,itemType:"ASSIGNMENT",code:r.code,onPublishChildComment:n.postComment,editCommentCallback:n.handleEditCommentCallback,onDeleteComment:n.deleteComment,handleViewRecord:n.viewRecord,activeTab:[o],changeTab:function(e){return n.setState({activitiesTab:e},n.setCommentPosition)},getChangeTabFn:function(e){n.changeTabFn=e},isCommentSticky:s,hideTitle:e,handleEditComment:function(e){return n.setState({isEdittingCommentModalVisible:e})}})},n.changeActivityLogTab=function(e){n.setState({activeLogTab:e.value},(function(){n.setCommentPosition(),"approval"===e.value&&n.fetchIssueReviewList((function(e){0===e.length&&n.setState({activeLogTab:"activity"})}))}))},n.getDropdownPortalToRight=function(){return!n.props.isDetail&&!n.state.isFullScreen},n.getDelAssignmentInfo=function(){var e=n.props.currentProject,t=n.state.detailInfoState;return new Promise((function(a){return(0,Ee.fetchDeleteIssue)(e.id,t.id).then((function(e){var t=e.data;a(t)}))}))},n.formatTypeText=function(e){var t=n.state,a=t.iterationConfirmParams,i=t.isIterationConfirmText,r=t.detailInfoState,o="";if(null===r.iteration&&a&&a.status===pt.ITERATION_STATUS.PROCESSING&&(o=i.MoveIn[e]),r.iteration&&[pt.ITERATION_STATUS.WAIT_PROCESS,pt.ITERATION_STATUS.PROCESSING,pt.ITERATION_STATUS.COMPLETED].includes(r.iteration.status)&&a&&[pt.ITERATION_STATUS.WAIT_PROCESS,pt.ITERATION_STATUS.PROCESSING,pt.ITERATION_STATUS.COMPLETED].includes(a.status)){if(r.iteration&&r.iteration.status===pt.ITERATION_STATUS.PROCESSING&&a&&a.status===pt.ITERATION_STATUS.PROCESSING)return o=i.ToTarget[e];if(r.iteration&&r.iteration.status===pt.ITERATION_STATUS.PROCESSING)return o=i.MoveOut[e];if(a&&a.status===pt.ITERATION_STATUS.PROCESSING)return o=i.MoveIn[e]}return console.log(1111,a,r),void 0===a&&r.iteration&&r.iteration.status===pt.ITERATION_STATUS.PROCESSING&&(o=i.MoveOut[e]),o},n.doScroll=function(){if(!n.state.inputFocus){var e=n.scrollRef.current.scrollTop,t=n.state.isScrolled;e>100&&!t?n.setState({isScrolled:!0}):e<=100&&n.setState({isScrolled:!1})}},n.onAttrScroll=function(){n.setState({isElemScroll:!0})},n.getFeedBackList=function(){var e=n.props.issueCode,t=n.props.currentProject.id;(0,z.fetchFeedBackList)(t,{issueCode:e}).then((function(e){n.setState({feedBackList:e.data}),n.dataLoad("feedBack")}))},n.getParentDetail=function(e){var t=n.state.detailInfoState,a=n.props.currentProject.id,i=n.props.zipRes,r=void 0===i?{}:i,o=r.code,s=r.data;e?0===e.code&&(n.getCrumbs(e.data),n.setState({detailInfoState:bt(bt({},n.state.detailInfoState),{},{parent:e.data.parent||null})}),0===o?n.fetchParentRequirements(void 0,s&&s[st.default.fetchParentRequirements]):n.fetchParentRequirements()):(0,z.getParentIssues)(a,t.code).then((function(e){n.getCrumbs(e.data),n.setState({detailInfoState:bt(bt({},n.state.detailInfoState),{},{parent:e.data.parent})}),n.fetchParentRequirements()}))},n.getCrumbs=function(e){var t=[];n.getNameList(t,e),n.setState({nameList:t})},n.getNameList=function(e,t){e.unshift({code:t.code,name:t.name,type:t.type,id:n.props.detailInfo.id,issueTypeDetail:t.issueTypeDetail}),t.parent&&n.getNameList(e,t.parent)},n.toggleDropdown=function(){var e=n.state.showMoreCrumb;e?document.removeEventListener("click",n.hideDropdown):document.addEventListener("click",n.hideDropdown),n.setState({showMoreCrumb:!e})},n.hideDropdown=function(){n.setState({showMoreCrumb:!1}),document.removeEventListener("click",n.hideDropdown)},n.getSensitiveMessage=function(e){var t=n.props.currentProject;(0,G.getSensitive)(e,t.name).then((function(e){0===e.code&&n.setState({isSensitive:e.data.isSensitive})}))},n.trackEvent=function(e){var t=n.props.currentProject;(0,G.tracking)({projectName:t.name,pageIdentifier:"MISSION_DETAIL",code:e}).then()},n.getTencentMeeting=function(){var e=n.props.currentProject.name,t=n.state.detailInfoState.code;(0,K.getTencentMeetingDetail)(e,t).then((function(e){n.setState({meeting:e.data})}))},n.blockingRelationChanged=function(){n.fetchBlockingRelationList(),n.getActivityList(),n.props.refreshCallback&&n.props.refreshCallback()},n.fetchManHourRecords=function(e){var t=n.props,a=t.currentProject.id,i=t.detailInfo.code;if(!e)return(0,K.getManhourHistories)(a,i).then((function(e){var t=e.data;n.setState({manHourRecords:t})}));0===e.code&&n.setState({manHourRecords:e.data})},n.fetchManHourRecordsAndFetchSpecData=(0,l.default)(r.default.mark((function e(){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.fetchManHourRecords();case 2:return e.next=4,n.changeAttributes({type:""});case 4:case"end":return e.stop()}}),e)}))),n.deleteManhourRecord=function(e,t){var a=n.props.currentProject.id;return(0,K.delManHourHistory)(a,e.id,t).then((function(){n.fetchManHourRecordsAndFetchSpecData()}))},n.fetchParentRequirements=function(e,t){var a=n.props.currentProject,i=n.state.detailInfoState;t?0===t.code&&n.setState({parentRequirements:t.data}):(0,z.fetchParent)(a.id,i.code,{keyword:e}).then((function(e){n.setState({parentRequirements:e.data})}))},n.updateParent=function(e,t){var a=n.props.currentProject,i=n.state.detailInfoState;(0,z.updateParent)(a.id,i.code,{parentRequirementCode:e}).then((function(e){var t;(0,q.success)((0,y.t)("\u66f4\u65b0\u6210\u529f")),n.setState({detailInfoState:bt(bt({},i),{},{iteration:null===(t=e.data)||void 0===t?void 0:t.iteration})}),n.getActivityList(),n.getParentDetail(),n.props.refreshCallback()}),(function(){n.setState({detailInfoState:bt(bt({},i),{},{parent:t})})}))},n.caculateDetailEleHeight=function(){return new Promise((function(e){n.doCaculate(-1,e)}))},n.doCaculate=function(e,t){if(n.detailBodyRef.current){var a,i=null===(a=n.detailBodyRef.current)||void 0===a?void 0:a.offsetHeight;i!==e?setTimeout((function(){n.doCaculate(i,t)}),300):t(i)}},n.setCommentPosition=function(){var e=(0,l.default)(r.default.mark((function e(t){var a,i,o,s,l,c,u,d,f;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n.scrollRef&&n.scrollRef.current&&n.hiddenHeaderRef.current&&n.detailBodyRef.current)){e.next=7;break}return e.next=3,n.caculateDetailEleHeight();case 3:u=e.sent,d=(null===(a=n.scrollRef)||void 0===a||null===(i=a.current)||void 0===i?void 0:i.offsetHeight)-(null===(o=n.hiddenHeaderRef)||void 0===o||null===(s=o.current)||void 0===s?void 0:s.offsetHeight),f=(null===(l=n.commentEditorRef)||void 0===l||null===(c=l.current)||void 0===c?void 0:c.offsetHeight)||140,n.setState(bt({isCommentSticky:u+f>=d},u+f<d?{isDescriptionBtnFixed:!1,isCommentAbsBottom:!1}:{}),(function(){if(n.state.isCommentSticky&&(setTimeout((function(){var e=n.hiddenHeaderRef.current.offsetHeight+(n.detailBodyRef.current.offsetHeight<d?d:n.detailBodyRef.current.offsetHeight);n.setState({isCommentAbsBottom:n.scrollRef.current.offsetHeight-e>=0,minHeight:d})}),0),n.state.isDesEditing)){var e=n.editorRef.current.offsetHeight+24,a=n.scrollRef.current.offsetHeight-n.hiddenHeaderRef.current.offsetHeight-44;n.setState({isDescriptionBtnFixed:e>=a})}"function"===typeof t&&t()}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.validateDefect=function(e,t){var a,i=n.state.attributes,r=null===(a=n.props.assignmentSchemeFieldArchives[e])||void 0===a?void 0:a.issueField,o=["\u81f4\u547d","\u4e25\u91cd"],s=!!r&&r.options.find((function(e){return e.value===t&&o.includes(e.name)}));return!(!r||"\u7f3a\u9677\u4e25\u91cd\u7a0b\u5ea6"!==r.name||!s||i.defectKindIds.length&&i.defectPhaseId)&&((0,q.warning)((0,y.t)("\u8bf7\u5148\u586b\u5199\u201c\u5f15\u5165\u7f3a\u9677\u9636\u6bb5\u201d\u548c\u201c\u7f3a\u9677\u7c7b\u578b\u201d")),!0)},n.renewDescription=function(e){var t=e.historyId,a=e.issueLogId,i=e.description,r=n.props.currentProject,o=n.state.detailInfoState;return(0,z.rollbackDescription)(r.id,o.code,a).then((function(){n.setState({historyId:t,description:i,isDescriptionEmpty:!i.replace(/\n|\s/g,"")}),n.getActivityList(),n.getResourceReference()})).then((function(){mt.default.emit(mt.EventBusType.BlockDesc,mt.EventBusKeys.revertHistoryBlockDesc)}))},n.handleAttentionChange=function(e){n.changeAttributes({type:"watchers",value:e})},n.handleSelfChange=function(e){var t=n.props,a=t.currentProject,i=t.user,r=n.state,o=r.detailInfoState,l=r.watchers;e?(0,z.watchIssue)(a.id,o.code).then((function(){n.setState({watchers:[].concat((0,s.default)(l),[i])}),(0,q.success)((0,y.t)("\u66f4\u65b0\u6210\u529f")),n.callback(),n.getActivityList()})):(0,z.unwatchIssue)(a.id,o.code).then((function(){n.setState({watchers:(0,s.default)(l.filter((function(e){return e.id!==i.id})))}),(0,q.success)((0,y.t)("\u66f4\u65b0\u6210\u529f")),n.callback(),n.getActivityList()}))},n.getSubTasksList=function(e){var t=n.props,a=t.currentProject.id,i=t.issueCode;if(!e)return(0,G.fetchSubtasksList)(a,i).then((function(e){var t=e.data;n.setState({subTasks:t}),n.dataLoad("subTask")})).catch((function(e){(0,q.warning)((0,Q.getErrorMessage)(e.msg)),n.dataLoad("subTask")}));0===e.code?(n.setState({subTasks:e.data}),n.dataLoad("subTask")):n.dataLoad("subTask")},n.handleSubTasksCallback=function(){n.setState({isCreateSubTasksVisible:!0,subTasksInput:""},(function(){(0,ee.scrollRelatedToTopMenu)("subtask-elem",200,n.scrollRef.current),n.subtaskInputRef.current&&n.subtaskInputRef.current.focus()}))},n.handleSubTasksInput=function(e){n.setState({subTasksInput:e.target.value})},n.handleSubTasksInputCancel=function(){n.setState({isCreateSubTasksVisible:!1,subTasksInput:"",isShowItemPlaceholder:bt(bt({},n.state.isShowItemPlaceholder),{},{subtask:!1})})},n.handleSubTasksInputCreate=(0,Le.debounce)((function(){var e,t=n.props.currentProject.id,a=n.props.projectPath,i=n.state,r=i.subTasksInput,o=i.detailInfoState;r?(0,K.fastCreateIssue)(t,{name:(0,oe.default)(r),parentCode:o.code,priority:1,issueType:"SUB_TASK",issueDescriptionType:null!==(e=o.issueDescriptionType)&&void 0!==e?e:getPreferEditorType()},!0).then((function(e){var t=e.data;(0,q.success)((0,y.t)("\u5b50\u5de5\u4f5c\u9879 #{{code}} \u521b\u5efa\u6210\u529f\uff0c\u70b9\u51fb\u67e5\u770b\u5b50\u5de5\u4f5c\u9879\uff01",{code:t.code}),{link:"".concat(a,"/subtasks/issues/").concat(t.code,"/detail")}),n.actionCallback()}),(function(e){var t=e.code;(0,it.configPlanNotToastMsg)(t)||8011!==t&&n.handleSubTasksInputFullCreate()})).finally((function(){n.setState({isPending:!1})})):(0,q.warning)((0,y.t)("\u8bf7\u8f93\u5165\u5b50\u5de5\u4f5c\u9879\u6807\u9898"))}),300),n.handleSubTasksInputFullCreate=function(){n.setState({subTasksInputVisible:!0})},n.cancelCreationModal=function(){n.setState({subTasksInputVisible:!1})},n.handleSort=function(e,t){var a=n.props.currentProject.id,i=n.state.detailInfoState;(0,G.sortSubtask)(a,i.code,{subTaskCode:e,beforeCode:t}).then((function(){(0,q.success)("".concat((0,y.t)("\u6392\u5e8f\u6210\u529f\uff01"))),n.props.refreshCallback&&n.props.refreshCallback(),n.getSubTasksList(i.code)}),(function(e){var t=e.msg;(0,q.danger)((0,Q.getErrorMessage)(t)),n.getSubTasksList(i.code)})).finally((function(){n.setState({isPending:!1})}))},n.onParentUpdate=function(){var e=n.props,t=e.projectPath,a=e.location.pathname,i=e.browserRouter,r=e.updateCallback,o=n.state.detailInfoState;"function"===typeof r&&(/detail\/subissues/.test(a)?i.push("".concat(t,"/epics/issues/").concat(o.epic.code,"/detail")):n.getActivityList(),r())},n.showRequirementSelector=function(e,t){n.setState({parentSelectorStatus:e,isParentModified:!!t,currentSubTask:t||null})},n.onIsFullWidthChange=function(e){n.setState({isFullWidth:e})},n.toggleFullScreenStatus=function(){var e=!n.state.isFullScreen;n.setState({isFullScreen:e}),(0,He.setIsSlideFullScreen)(e),n.props.onFullScreenChange&&n.props.onFullScreenChange(e)},n.handleFullScreenKey=function(e){n.state.isDesEditing||e.target===document.body&&"f"===e.key.toLowerCase()&&n.toggleFullScreenStatus()},n.state={tooltipTitle:(0,y.t)("\u590d\u5236\u94fe\u63a5"),noHoverIcon:!1,useOld:!1,detailInfoState:e.detailInfo,references:{},activities:[],subTasks:[],description:e.detailInfo.descriptionMarkup,isDescriptionEmpty:!e.detailInfo.description.replace(/\n|\s/g,""),markdown:e.detailInfo.description,slateRaw:e.detailInfo.slateRaw,showCopyModal:!1,meetingResource:[],attachmentsState:n.combineThirdLinks(e.detailInfo.files,e.detailInfo.thirdLinks),isFilePreviewVisible:void 0,previewFileID:void 0,attributes:{assignee:void 0,priority:void 0,startDate:void 0,dueDate:void 0,workingHours:void 0,requirementType:void 0,projectModule:void 0,labels:[],watchers:[],fields:{},progress:void 0,wuKongReloadId:void 0,defectKindIds:[],defectPhaseId:void 0,defectSourceId:void 0,estimatedWorkHour:void 0,systemsId:void 0,participants:[],groupTeamId:void 0,iteration:void 0,edition:void 0},defectSource:e.detailInfo.defectSource,assignee:e.detailInfo.assignee,watchers:e.detailInfo.watchers||[],iterationList:[],versionList:[],parentRequirementSearchStr:"",parentRequirements:[],subItems:[],isCreateAssociateVisible:!1,citedSources:{},citingSources:{},isInited:!1,isHistoryRecordVisible:!1,currentLogId:void 0,isCreateSubTasksVisible:!1,subTasksInput:"",subTasksInputVisible:!1,parentSelectorStatus:!1,storypointUseSize:!1,isStorypointShow:!1,currentSubTask:null,showSideslip:!1,isSensitive:!1,showDeleteModal:!1,isShowApproveCreate:!1,issueReviewList:[],activitiesTab:"ALL",activeLogTab:"activity",isCommentSticky:!1,isCommentAbsBottom:!1,isScrolled:!1,inputFocus:!1,isDesEditing:!1,isFullScreen:(0,He.getIsSlideFullScreen)(),isFullWidth:!0,blockBeforeList:[],blockAfterList:[],isBlockingRelationVisible:!1,isShowItemPlaceholder:{description:!0,subtask:!1,workItem:!1,codeRepo:!1,blockingRelation:!1,reference:!1},isRender:{feedBack:!1,subTask:!1,workItem:!1,codeRepo:!1,blockingRelation:!1,reference:!1,logs:!1,comment:!1,splitTask:!1},isRenderAll:!1,showMoreCrumb:!1,nameList:[],manHourRecords:[],delFileId:void 0,showDeleteConfirmModal:!1,isElemScroll:!1,scrollControl:Date.now(),meeting:void 0,feedBackList:[],isEdittingCommentModalVisible:!1,codeRepoRelationOpened:!1,associatedCodeRepos:[],availableCodeRepos:[],isAssociatedCodeRepoFocus:!1,inProgram:!1,isWorkItemCreationVisible:!1,associatedWorkItems:[],availableWorkItems:[],isAssociatedWorkItemFocus:!1,controlHideButtonActionMore:0,codeManagementOpen:!1,testManagementOpen:!1,pageId:e.detailInfo.pageId||void 0,historyId:void 0,controlCaculatePos:0,isDescriptionBtnFixed:!1,identity:"",slotVisible:!1,showCopyIssues:!1,splitParentRequirement:{},isIterationConfirm:!1,iterationConfirmParams:null,isIterationConfirmText:{MoveOut:{title:"\u786e\u8ba4\u79fb\u51fa\u8fed\u4ee3",desc:"\u4e8b\u9879\u79fb\u51fa\u8fed\u4ee3\uff0c\u4f1a\u9020\u6210\u8fed\u4ee3\u5b8c\u6210\u7387\u4e0b\u964d\uff0c\u662f\u5426\u786e\u8ba4\u79fb\u51fa\u5f53\u524d\u8fed\u4ee3?"},MoveIn:{title:"\u786e\u8ba4\u79fb\u5165\u8fed\u4ee3",desc:"\u4e8b\u9879\u79fb\u5165\u8fed\u4ee3\u540e\uff0c\u4f1a\u6c38\u4e45\u7b97\u4f5c\u8fed\u4ee3\u4e8b\u9879\u57fa\u6570\uff0c\u4f1a\u5f71\u54cd\u8fed\u4ee3\u5b8c\u6210\u7387\u7684\u8ba1\u7b97\uff0c\u662f\u5426\u786e\u8ba4\u79fb\u5165\u5f53\u524d\u8fed\u4ee3?"},ToTarget:{title:"\u786e\u8ba4\u79fb\u51fa\u8fed\u4ee3",desc:"\u4e8b\u9879\u79fb\u51fa\u5f53\u524d\u8fed\u4ee3\uff0c\u4f1a\u9020\u6210\u5f53\u524d\u8fed\u4ee3\u5b8c\u6210\u7387\u4e0b\u964d\u3002\u540c\u65f6\uff0c\u4e8b\u9879\u4f1a\u79fb\u5165\u65b0\u7684\u8fed\u4ee3\u540e\uff0c\u4f1a\u6c38\u4e45\u7b97\u4f5c\u65b0\u8fed\u4ee3\u4e8b\u9879\u57fa\u6570\uff0c\u4f1a\u5f71\u54cd\u65b0\u8fed\u4ee3\u5b8c\u6210\u7387\u7684\u8ba1\u7b97\uff0c\u662f\u5426\u786e\u8ba4\u6b64\u64cd\u4f5c?"}}},n.onVisibleChange=n.onVisibleChange.bind((0,f.default)(n)),n.onCopyClick=n.onCopyClick.bind((0,f.default)(n)),n.updateDescription=n.updateDescription.bind((0,f.default)(n)),n.onNameChange=n.onNameChange.bind((0,f.default)(n)),n.callback=n.callback.bind((0,f.default)(n)),n.deleteAssignment=n.deleteAssignment.bind((0,f.default)(n)),n.updateAssignment=n.updateAssignment.bind((0,f.default)(n)),n.postComment=n.postComment.bind((0,f.default)(n)),n.deleteComment=n.deleteComment.bind((0,f.default)(n)),n.fileUpload=n.fileUpload.bind((0,f.default)(n)),n.onFileDropSuccess=n.onFileDropSuccess.bind((0,f.default)(n)),n.onFileDropDelete=n.onFileDropDelete.bind((0,f.default)(n)),n.onFileDropCancel=n.onFileDropCancel.bind((0,f.default)(n)),n.onFileDropFail=n.onFileDropFail.bind((0,f.default)(n)),n.filePreviewHide=n.filePreviewHide.bind((0,f.default)(n)),n.previewItem=n.previewItem.bind((0,f.default)(n)),n.handleDelInPreviewFile=n.handleDelInPreviewFile.bind((0,f.default)(n)),n.onStatusChange=n.onStatusChange.bind((0,f.default)(n)),n.submitTitleChange=n.submitTitleChange.bind((0,f.default)(n)),n.cancelAssociateSubItem=n.cancelAssociateSubItem.bind((0,f.default)(n)),n.changeAttributes=n.changeAttributes.bind((0,f.default)(n)),n.getIterationList=n.getIterationList.bind((0,f.default)(n)),n.getVersionList=n.getVersionList.bind((0,f.default)(n)),n.onIterationChange=n.onIterationChange.bind((0,f.default)(n)),n.actionCallback=n.actionCallback.bind((0,f.default)(n)),n.getResourceReference=n.getResourceReference.bind((0,f.default)(n)),n.onRemoveReference=n.onRemoveReference.bind((0,f.default)(n)),n.toggleRecord=n.toggleRecord.bind((0,f.default)(n)),n.viewRecord=n.viewRecord.bind((0,f.default)(n)),n.handleRemoveEpic=n.handleRemoveEpic.bind((0,f.default)(n)),n.handleModifyParentIssue=n.handleModifyParentIssue.bind((0,f.default)(n)),n.openSlideslip=n.openSlideslip.bind((0,f.default)(n)),n.closeSlideslip=n.closeSlideslip.bind((0,f.default)(n)),n.toggleCopyModal=n.toggleCopyModal.bind((0,f.default)(n)),n.fetchManHourRecordsAndFetchSpecData=n.fetchManHourRecordsAndFetchSpecData.bind((0,f.default)(n)),n.handleDeleteAttachmentConfirm=n.handleDeleteAttachmentConfirm.bind((0,f.default)(n)),n.handleEditCommentCallback=n.handleEditCommentCallback.bind((0,f.default)(n)),n.commentEditorRef=null,n.intoDesCount=0,n.intoCommentCount=0,n.commentStickyContainerRef=null,n.onScroll=n.onScroll.bind((0,f.default)(n)),n.desComp=null,n.headerRef=S.default.createRef(),n.hiddenHeaderRef=S.default.createRef(),n.detailBodyRef=S.default.createRef(),n.desComp=null,n.attechmentRef=S.default.createRef(),n.subtaskInputRef=S.default.createRef(),n.changeTabFn=null,n.editorRef=S.default.createRef(),n.elemShow(),n}return(0,d.default)(a,[{key:"headerRender",value:function(e){var t=this,a=this.state,n=a.detailInfoState,i=a.watchers,r=a.isSensitive,s=a.showDeleteModal,l=a.isDesEditing,c=a.isFullWidth,u=a.inputFocus,d=a.isFullScreen,f=!e&&this.state.isScrolled,p=this.props,m=p.projectPath,h=p.isDetail,v=p.assignmentList,g=p.isPermissible,E=p.user,b=p.location.query,I=p.currentProject,T=p.currentProjectCooperateSettings,C=p.browserRouter,w=p.callFrom,O=p.isSensitiveAdmin,R=p.detailInfo,j=p.zipRes,k="outer"===w,L=I.name,F=(0,Qe.getSlotContext)(R,I.id),_=v&&v.findIndex((function(e){return e.code===n.code}))+1,M=1===_,x=_===(v&&v.length),B=v&&v.find((function(e){return e.code===n.code})),U=g([{function:$.ProjectPermissionFunction.PROJECT_ISSUE,action:$.ProjectPermissionAction.UPDATE}]),W=this.getLinkfragment(),Y=T.COOPERATE_MODE,V=(0,Ge.getAuidtPaymentState)(),G=null,K=null;if(j&&j.data){var z=j.data;if(z[st.default.getParentDetail]&&z[st.default.getParentDetail].data){var q,Z=null===(q=z[st.default.getParentDetail])||void 0===q?void 0:q.data;G=null===Z||void 0===Z?void 0:Z.issueExtend,K=null===Z||void 0===Z?void 0:Z.type}}var J={DESCRIPTION:U,UPLOAD:U,SUBTASK:U,LINK_WORK_ITEM:this.state.inProgram&&U,LINK_CODE_REPO:this.state.codeRepoRelationOpened&&U,RELATION:U,REFERENCES:!0,ISSUE_REVIEW:this.state.issueReviewOpen&&U,IS_RISK:!G||0===G.isRisk,ISSUE_TYPE_RISK:"sub_task"!==K},X=bt(bt({},l?{DESCRIPTION:""}:{}),n.iteration&&n.iteration.status===et.ISSUE_STATUS_TYPES.COMPLETED&&Y===et.PROJECT_MODE.SCRUM?{SUBTASK:(0,y.t)("\u8fed\u4ee3\u5df2\u5b8c\u6210\uff0c\u65e0\u6cd5\u6dfb\u52a0\u5b50\u5de5\u4f5c\u9879")}:{}),Q={};e&&(Q.position="static",Q.visibility="hidden");var ee={};Ge.KA_TASK_COPY_SWITCH&&(ee.copyFunction=this.toggleCopyModal);var te={};return Ge.KA_ISSUE_COPY_COMMITID_SWITCH&&(te.copyCommit="bug:".concat(L," #").concat(n.code," ").concat(n.name)),S.default.createElement("div",{className:(0,H.default)(P.default.specHeader,h&&P.default.detail,this.state.inputFocus&&f&&P.default.scrollFocus,f&&!l&&P.default.fixed,f&&P.default.noBorder),ref:e?this.hiddenHeaderRef:this.headerRef,style:Q},S.default.createElement("div",{className:(0,H.default)(P.default.main,f?P.default.fixed:"",d?P.default.fullScreenMain:"",h?P.default.detail:"")},S.default.createElement("div",{className:(0,H.default)(P.default.headerPanelMenuWrapper,u&&P.default.focus)},this.renderParentsInfo(),S.default.createElement("div",{className:(0,H.default)(P.default.menus,f&&u&&P.default.hide)},S.default.createElement(nt.default,{relationType:"ISSUE",relationId:n.id,inviteText:(0,y.t)("\u53d1\u8d77\u4f1a\u8bae\u8ba8\u8bba")}),S.default.createElement(ne.default,{type:"MISSION",projectID:I.id,watchers:i||[],onChange:this.handleAttentionChange,user:E,showTooltip:!0,readOnly:!U,handleSelfChange:this.handleSelfChange}),!h&&!k&&v&&B&&S.default.createElement("div",{className:P.default.divideLine}),!h&&!k&&v&&B&&S.default.createElement("div",{className:"".concat(P.default.preButton," ").concat(M&&P.default.disabled),title:(0,y.t)("\u4e0a\u4e00\u4e2a\u4e8b\u9879"),onClick:function(){if(!M){var e=v[_-2].code;C.push({pathname:"".concat(W).concat(e),query:bt({},b)})}}}),!h&&!k&&v&&B&&S.default.createElement("div",{className:"".concat(P.default.nextButton," ").concat(x&&P.default.disabled),title:(0,y.t)("\u4e0b\u4e00\u4e2a\u4e8b\u9879"),onClick:function(){if(!x){var e=v[_].code;C.push({pathname:"".concat(W).concat(e),query:bt({},b)})}}}),S.default.createElement("div",{className:P.default.divideLine}),!h&&S.default.createElement(D.TooltipTrigger,{title:this.state.isFullScreen?(0,y.t)("\u5207\u6362\u5230\u4fa7\u680f(F)"):(0,y.t)("\u5168\u5c4f(F)")},S.default.createElement("div",{className:this.state.isFullScreen?P.default.cancelFullScreenBtn:P.default.toFullScreenBtn,onClick:this.toggleFullScreenStatus})),!h&&S.default.createElement(D.TooltipTrigger,{title:(0,y.t)("\u5728\u65b0\u6807\u7b7e\u9875\u6253\u5f00")},S.default.createElement("div",{className:P.default.openNewLink,onClick:function(){window.open("".concat(m,"/assignments/issues/").concat(n.code,"/detail"),"_blank")}})),S.default.createElement(A.default,(0,o.default)({type:"MISSION",deleteFunction:this.deleteAssignment,hasParent:!!n.parent,cancelRelatedFunction:this.cancelAssociateSubItem,onChangeEpic:function(){return t.showRequirementSelector(!0)},hasEpic:!!n.epic,handleRemoveEpic:this.handleRemoveEpic,currentProject:I,currentProjectCooperateSettings:T,isPermissible:g,premiumVersion:!V||this.props.payed,isSensitiveAdmin:O,isSensitive:r,sensitiveCtrlFunction:this.sensitiveCtrl,isShowFullWidthOption:h||!h&&this.state.isFullScreen,issueTypeDetail:n.issueTypeDetail,viewDescriptionVersion:function(){return t.setState({isHistoryRecordVisible:!0})},copyTitle:n.name,copyLink:"".concat(window.location.origin).concat(m,"/assignments/issues/").concat(n.code,"/detail"),isFullWidth:c,onIsFullWidthChange:this.onIsFullWidthChange,controlHideMore:this.state.controlHideOptionMore},ee,te,{onClickTrigger:function(){t.setState({controlHideButtonActionMore:Date.now()})},slotCallback:function(e){return t.setState({identity:e,slotVisible:!0})},fetchCustomTip:this.getDelAssignmentInfo})),S.default.createElement(be.default,{title:(0,y.t)("\u786e\u5b9a\u8981\u53d6\u6d88\u6807\u8bb0"),show:s,onConfirm:this.cancelMark,onClose:function(){t.setState({showDeleteModal:!1})}}))),this.renderTitle(U,!1,e),(!f||f&&!u)&&S.default.createElement(we.default,{projectType:Y,issueType:N.ISSUE_TYPE.ASSIGNMENT,isShow:J,isDisabled:X,onBtnClick:this.onBtnClick,uploadProps:{disabled:!U,currentAttachmentNum:this.state.attachmentsState.length,onHandleAttachments:this.fileUpload},issueStatus:n.issueStatus.type,issueCode:n.code,projectName:L,userId:E.id,projectPath:m,posType:f,isLoaded:!0,controlHideMore:this.state.controlHideButtonActionMore,slotContext:F,onClickTrigger:function(){t.setState({controlHideOptionMore:Date.now()})},onChangeIsRisk:function(){return t.changeAttributes({type:""})},projectID:I.id,gid:R.id})))}},{key:"descriptionBtnClicked",value:function(){var e=this,t=this.editComp;t.show().then((function(){e.setState({isShowItemPlaceholder:bt(bt({},e.state.isShowItemPlaceholder),{},{description:!1})},(function(){var a,n,i;null!==(a=e.scrollRef)&&void 0!==a&&a.current&&null!==(n=e.containerRef)&&void 0!==n&&n.current&&null!==(i=e.headerRef)&&void 0!==i&&i.current&&(0,ee.scrollIntoView)(e.scrollRef.current,t.containerRef.current,-e.headerRef.current.offsetHeight-26),t.onHandle()}))}))}},{key:"subtaskBtnClicked",value:function(){var e=this;this.setState({isCreateSubTasksVisible:!0,subTasksInput:"",isShowItemPlaceholder:bt(bt({},this.state.isShowItemPlaceholder),{},{subtask:!0})},(function(){(0,ee.scrollRelatedToTopMenu)("subtask-elem",200,e.scrollRef.current),e.subtaskInputRef.current&&e.subtaskInputRef.current.focus()}))}},{key:"link_code_repoBtnClicked",value:function(){var e=this;(0,ee.scrollRelatedToTopMenu)("associated-code-repo",200,this.scrollRef.current),this.setState({isShowItemPlaceholder:bt(bt({},this.state.isShowItemPlaceholder),{},{codeRepo:!0})},(function(){return e.setState({isAssociatedCodeRepoFocus:!0})}))}},{key:"getAssociatedCodeRepos",value:function(){var e=this,t=this.props.currentProject,a=this.state.detailInfoState.code;return(0,K.fetchAssociatedCodeRepos)(t.name,a).then((function(t){var a=t.data;e.setState({associatedCodeRepos:a.map((function(e){return bt({},e.depot)}))})})).finally((function(){return e.dataLoad("codeRepo")}))}},{key:"link_work_itemBtnClicked",value:function(){var e=this;this.setState({isWorkItemCreationVisible:!0,controlFocus:Date.now(),isShowItemPlaceholder:bt(bt({},this.state.isShowItemPlaceholder),{},{workItem:!0})},(function(){(0,ee.scrollRelatedToTopMenu)("work-item-relation-input",200,e.scrollRef.current)}))}},{key:"getAssociatedWorkItems",value:function(){var e=this,t=this.props.currentProject,a=this.state.detailInfoState.code;return(0,K.fetchAssociatedWorkItems)(t.name,a).then((function(t){var a=t.data;e.setState({associatedWorkItems:a})})).finally((function(){return e.dataLoad("workItem")}))}},{key:"relationBtnClicked",value:function(){var e=this;this.setState({isBlockingRelationVisible:!0,controlFocus:Date.now(),isShowItemPlaceholder:bt(bt({},this.state.isShowItemPlaceholder),{},{blockingRelation:!0})},(function(){(0,ee.scrollRelatedToTopMenu)("block-relation-input",200,e.scrollRef.current)}))}},{key:"fetchIssueReviewList",value:function(e){var t=this,a=this.props,n=a.currentProject,i=a.detailInfo;(0,Ke.fetchIssueReviewList)(n.id,i.code).then((function(a){var n=a.data;t.setState({issueReviewList:n},(function(){e&&e(n)}))}))}},{key:"issue_reviewBtnClicked",value:function(){this.setState({isShowApproveCreate:!0})}},{key:"mouseLeave",value:function(e){this["des"===e?"intoDesCount":"intoCommentCount"]=0,this.setState({notUpload:!1})}},{key:"render",value:function(){var e,t=this,a=this.state,n=a.detailInfoState,i=a.markdown,r=a.slateRaw,s=a.description,l=a.activities,c=a.attachmentsState,u=a.isFilePreviewVisible,d=a.previewFileID,f=a.citedSources,p=a.citingSources,m=a.isInited,h=a.isHistoryRecordVisible,v=a.currentLogId,g=a.subTasks,E=a.isCreateSubTasksVisible,b=a.subTasksInput,I=a.subTasksInputVisible,T=a.parentSelectorStatus,C=a.isParentModified,w=a.currentSubTask,D=a.showSideslip,O=a.activitiesTab,A=a.isCommentSticky,L=a.isFullWidth,F=a.isShowItemPlaceholder,_=a.isRender,M=a.isRenderAll,x=a.activeLogTab,B=a.blockBeforeList,U=a.blockAfterList,W=a.isBlockingRelationVisible,Y=a.manHourRecords,V=a.showDeleteConfirmModal,G=a.feedBackList,K=a.isEdittingCommentModalVisible,z=a.isWorkItemCreationVisible,q=a.pageId,X=a.historyId,Q=a.isDescriptionEmpty,ee=a.minHeight,ae=a.isDescriptionBtnFixed,ne=a.identity,oe=a.slotVisible,ce=a.showCopyModal,ue=a.splitParentRequirement,pe=this.props,me=pe.params,he=pe.expanded,ve=pe.isDetail,Ee=pe.currentProject,be=pe.user,ye=pe.enterpriseGlobalKey,Se=pe.enterpriseName,Ie=pe.isPermissible,Te=pe.autoshowComment,Ce=pe.domID,Pe=pe.projectPath,we=pe.currentProjectCooperateSettings,Oe=pe.location,ke=pe.targetData,Le=pe.assignmentSchemeFieldArchives,_e=pe.detailInfo,xe=pe.branchsInfo,Be=Ee.name,Ue=Ee.id,He=(0,Qe.getSlotContext)(_e,Ue),Ve=Ie([{function:$.ProjectPermissionFunction.PROJECT_ISSUE,action:$.ProjectPermissionAction.CREATE}]),Ke=we&&we.COOPERATE_MODE,Xe=void 0!==Le&&Object.values(Le).filter((function(e){return"HOUR_RECORD"===e.issueField.type})).length>0,tt=this.state.subTasksInputVisible,nt=this.state.notUpload&&(this.state.isDesEditing||this.state.isCommentEditing)||tt||K||D,it=we.ISSUE_TYPES.find((function(e){return"SUB_TASK"===e.issueType})),rt=A?{minHeight:"".concat(ee,"px"),position:"relative"}:{position:"relative"},st=this.state.issueReviewOpen&&this.state.issueReviewList.length>0,ut=[];_.logs&&ut.push({text:(0,y.t)("\u6d3b\u52a8\u65e5\u5fd7"),value:et.MATTER_TABS_TYPE.ACTIVITY}),Xe&&ut.push({text:(0,y.t)("\u5de5\u65f6\u65e5\u5fd7"),value:et.MATTER_TABS_TYPE.WORK}),st&&ut.push({text:(0,y.t)("\u5ba1\u6279"),value:et.MATTER_TABS_TYPE.APPROVAL});var dt=_.comment&&x!==et.MATTER_TABS_TYPE.WORK&&x!==et.MATTER_TABS_TYPE.APPROVAL&&l.length>0&&O!==et.ACTIVITIES_TAB.WITHOUT_COMMENT;return S.default.createElement(De.default,{currentAttachmentNum:c.length,onHandleAttachments:this.fileUpload,notUpload:nt,notUploadElems:this.getNotUploadElems(),onIntoUploadElems:function(){return t.setState({notUpload:!0})}},S.default.createElement(Me.default.Provider,{value:{scrollControl:this.state.scrollControl}},S.default.createElement("div",{className:P.default.specWrapper,onScroll:this.onAttrScroll},S.default.createElement("div",{className:(0,H.default)(P.default.specDetail,ve?P.default.isDetail:"",L&&P.default.isFullWidth)},this.headerRender(),this.headerRender(!0),S.default.createElement("div",{className:P.default.specMain,ref:this.scrollRef},S.default.createElement("div",{style:rt,className:(0,H.default)(P.default.detailWrapper,ve&&P.default.isDetail)},S.default.createElement("div",{className:"".concat(P.default.detailBody," ").concat(!he&&P.default.isSingleColumned," ").concat(ve&&P.default.isDetail," ").concat(L&&P.default.isFullWidth),ref:this.detailBodyRef,onClick:function(){return t.setState({controlHideButtonActionMore:Date.now()})}},S.default.createElement("div",{className:"".concat(P.default.mainWrapper," ").concat(he&&P.default.mainExpanded)},S.default.createElement("div",{onDragEnter:this.dragEnterDes,onDragLeave:this.dragLeaveDes,onMouseLeave:this.mouseLeaveDes,ref:this.editorRef},S.default.createElement(R.default,{editorType:_e.issueDescriptionType,issueId:_e.id,isInited:m,scrollRef:this.scrollRef,readOnly:!Ve,code:n.code,autoSaveKey:"".concat(Be,"_ASSIGNMENT_DETAIL_DESCRIPTION-").concat(n.code),updateDescription:this.updateDescription,refreshActivity:function(){return t.getActivityList()},updatePageId:function(e){return t.setState({pageId:e})},historyId:X,currentProject:Ee,markdown:i,slateRaw:r,description:s,flashAnchor:this.props.flashAnchor,domID:Ce,enterpriseGlobalKey:ye,getThis:this.getEditComp,editStatusChanged:this.editStatusChanged,isShowPlaceholder:Q&&F.description,location:Oe,userId:be.id,pageId:q,setCommentPosition:this.setCommentPosition,onLoad:function(e){t.dataLoad("description"),e&&t.setState({isDescriptionEmpty:e.isEmpty})},isDescriptionBtnFixed:ae})),c.length>0&&S.default.createElement("div",{className:P.default.sectionWrapper,ref:this.attechmentRef},S.default.createElement(de.ThemeConsumer,null,(function(e){var a=e.hiddenFolderDirs;return S.default.createElement(Z.default,{expanded:he,disabled:!Ve,attachments:c,enterpriseGlobalKey:ye,currentProjectName:Be,currentProjectID:Ue,currentAttachmentNum:c.length,issueCode:n.code,onHandleAttachments:t.fileUpload,uploadFileSuccess:t.onFileDropSuccess,uploadFileFailed:t.onFileDropFail,uploadFileDelete:t.onFileDropDelete,uploadFileCancel:t.onFileDropCancel,dir:a&&a[N.HIDDEN_FILE_TYPE.ASSIGEMENTS]&&a[N.HIDDEN_FILE_TYPE.ASSIGEMENTS].file_id,previewItemHandle:t.previewItem,userID:be.id})}))),_.feedBack&&S.default.createElement("div",{className:P.default.sectionWrapper},S.default.createElement(Fe.default,{feedBackList:G})),"SCRUM"===Ke&&!n.parent&&_.subTask&&(g.length>0||F.subtask)&&S.default.createElement("div",{className:P.default.sectionWrapper},S.default.createElement(ie.default,{params:me,parentType:"assignments",isDetail:ve,isRequirementDeletable:!0,projectID:Ue,requirementCode:n.code,subItems:g,isChild:!!n.parentId,handleCreate:this.showTargetModal,callback:this.actionCallback,handleAssociate:this.handleSubTasksCallback,handleSort:this.handleSort,handleModifyParent:this.showRequirementSelector,currentProject:Ee,isPermissible:Ie,projectPath:Pe,isEditing:E,iterationFinished:n&&n.iteration&&n.iteration.status&&n.iteration.status===et.ISSUE_STATUS_TYPES.COMPLETED,isFullScreen:!ve&&this.state.isFullScreen}),E&&S.default.createElement(re.default,{id:"subtask-elem",ref:this.subtaskInputRef,placeholder:(0,y.t)("\u5b50\u5de5\u4f5c\u9879\u6807\u9898\uff08\u6309\u56de\u8f66\u5feb\u901f\u521b\u5efa\uff0cShift + \u56de\u8f66\u5b8c\u6574\u521b\u5efa\uff09"),className:P.default.subtaskCreationInput,value:b,onChange:this.handleSubTasksInput,onCancel:this.handleSubTasksInputCancel,onCreate:this.handleSubTasksInputCreate,onFullCreate:this.handleSubTasksInputFullCreate,currentProject:Ee,currentProjectCooperateSettings:we})),_.workItem&&(this.state.associatedWorkItems.length>0||F.workItem)&&S.default.createElement("div",{className:P.default.sectionWrapper},S.default.createElement(Ye.default,{projectID:Ue,projectPath:Pe,currentProject:Ee,issueCode:n.code,allowUpdate:Ve,scrollTargetId:"work-item-relation-input",createVisible:z,onCreateVisibleChange:this.handleWorkItemRelationVisibleChange,controlFocus:this.state.controlFocus,list:this.state.associatedWorkItems,callback:this.workItemRelationChanged,isDetail:ve,isFullScreen:!ve&&this.state.isFullScreen})),this.state.codeRepoRelationOpened&&_.codeRepo&&(this.state.associatedCodeRepos.length>0||F.codeRepo)&&S.default.createElement("div",{className:P.default.sectionWrapper},S.default.createElement(We.default,{projectPath:Pe,allowUpdate:Ve,list:this.state.associatedCodeRepos,searchResList:this.state.availableCodeRepos,isFocus:this.state.isAssociatedCodeRepoFocus,onFocusChanged:function(e){return t.setState({isAssociatedCodeRepoFocus:e})},onSearch:this.getCodeRepos,onAssociate:this.associateCodeRepo,onCancelAssociate:this.cancelAssociateCodeRepo,onCancel:this.cancelCodeRepo,isDetail:ve})),"CLASSIC"===Ke&&_.blockingRelation&&(B.length>0||U.length>0||F.blockingRelation)&&S.default.createElement("div",{className:P.default.sectionWrapper},S.default.createElement(ge.default,{projectID:Ue,issueCode:n.code,scrollTargetId:"block-relation-input",createVisible:W,onCreateVisibleChange:this.handleBlockingRelationVisibleChange,blockBeforeList:B,blockAfterList:U,controlFocus:this.state.controlFocus,callback:this.blockingRelationChanged,allowUpdate:Ve,projectPath:Pe,isDetail:ve,currentProject:Ee,isFullScreen:!ve&&this.state.isFullScreen})),_.reference&&(Object.keys(f).length>0||Object.keys(p).length>0||F.reference)&&S.default.createElement("div",{className:P.default.sectionWrapper},S.default.createElement(j.default,{flashAnchor:function(e){t.setState({activeLogTab:et.MATTER_TABS_TYPE.ACTIVITY},(function(){t.props.flashAnchor(e)}))},currentProject:Ee,citedSources:f,citingSources:p,markdown:i,autoToggleComment:this.referencesBtnClicked,code:n.code,onRemoveReference:this.onRemoveReference})),(null===xe||void 0===xe?void 0:xe.length)>0&&S.default.createElement(ot.default,{branchsInfo:xe,headerTitle:"\u5173\u8054\u4ee3\u7801\u4ed3\u5e93",projectPath:Pe}),_.splitTask&&Object.keys(ue).length>0&&S.default.createElement("div",{className:P.default.sectionWrapper},S.default.createElement(lt.default,{type:ct.DM_ITEM_TYPE.ORD_REQUIREMENT,projectID:Ue,currentProject:Ee,issueCode:n.code,allowUpdate:Ve,list:null!==(e=null===ue||void 0===ue?void 0:ue.Requirement)&&void 0!==e?e:[],callback:this.onRemoveReference})),ut.length>=2&&S.default.createElement(S.default.Fragment,null,S.default.createElement("div",{id:"activity-log-tab"}),S.default.createElement(je.default,{tabs:ut,activeTab:x,onChange:this.changeActivityLogTab})),_.logs&&S.default.createElement(S.default.Fragment,null,x===et.MATTER_TABS_TYPE.ACTIVITY&&this.renderActivity(Xe),Xe&&"work"===x&&S.default.createElement(Ne.default,{detailInfo:n,records:Y,onDelete:this.deleteManhourRecord,reloadData:this.fetchManHourRecordsAndFetchSpecData,allowUpdate:Ve,user:be})),S.default.createElement("div",{id:"issue-review-list"},st&&x===et.MATTER_TABS_TYPE.APPROVAL&&S.default.createElement(ze.default,{list:this.state.issueReviewList,onItemChange:this.handleReviewListChanged,onShowCreate:function(){t.setState({isShowApproveCreate:!0})},onShowDetail:function(e){t.setState({issueReviewCode:e})},allowUpdate:Ve}))),Ge.KA_TASK_COPY_SWITCH&&S.default.createElement($e.default,(0,o.default)({show:ce,closeHandle:this.toggleCopyModal,callback:this.updateData,defectCode:n.code,currentProjectCooperateSettings:we},this.state,this.props)))),u&&S.default.createElement(J.default,{isShown:u,previewFiles:c,onFileViewerHide:this.filePreviewHide,enterpriseGlobalKey:ye,currentId:Ue,currentProjectName:Be,currentFileId:d,onHandleDelAttachment:this.handleDeleteAttachmentConfirm}),I&&it&&S.default.createElement(se.default,{parentCode:n.code,title:b,show:!0,callback:this.actionCallback,closeHandle:this.cancelCreationModal,targetData:ke,issueTypeDetail:it}),h&&S.default.createElement(te.default,{show:h,closeHandle:this.toggleRecord,enterpriseGlobalKey:ye,currentProject:Ee,issueType:N.HISTORY_RESCORDS[n.type],parentDescriptionType:n.issueDescriptionType,issueCode:n.code,pageId:q,currentLogId:v,handleUpdate:this.renewDescription,allowUpdate:Ve}),T&&S.default.createElement(le.default,{show:!0,issueCode:n.code,currentSubtaskCode:w&&w.code,projectID:Ue,closeHandle:function(){t.setState({parentSelectorStatus:!1,isParentModified:!1,currentSubTask:null})},currentParentCode:n.parent?n.parent.code:0,onUpdate:this.onParentUpdate,currentProject:Ee,isModification:C,handleSelect:this.handleModifyParentIssue,currentProjectCooperateSettings:we}),D&&S.default.createElement(fe.default,{issueList:g,parentType:"assignments",getList:function(){return t.getSubTasksList(n.code)},params:me,currentProject:Ee,projectPath:Pe,closeSlideslip:this.closeSlideslip,enterpriseName:Se,targetData:ke}),S.default.createElement(Ae.default,{show:V,type:"ATTACHMENT",text:(0,y.t)("\u786e\u5b9a\u8981\u5220\u9664\u5417\uff1f"),onConfirm:function(){t.handleDelInPreviewFile()},onClose:function(){t.setState({showDeleteConfirmModal:!1})}}),this.state.isShowApproveCreate&&S.default.createElement(qe.default,{fromIssueId:this.props.detailInfo.id,onItemChange:function(){return t.handleReviewListChanged(!0)},onCancel:function(){return t.setState({isShowApproveCreate:!1})}}),this.state.issueReviewCode&&S.default.createElement(Ze.default,{allowUpdate:Ve,detailCode:this.state.issueReviewCode,onDetailCodeChange:function(e){t.setState({issueReviewCode:e})},onCancel:function(){t.setState({issueReviewCode:void 0},(function(){t.handleReviewListChanged()}))}}),!M&&S.default.createElement(Re.default,null),S.default.createElement("div",{id:"bottom"}),dt&&S.default.createElement(k.default,{autoToggleComment:this.props.autoToggleComment,autoshowComment:!!Te[n.code],expanded:he,currentProject:Ee,avatar:be.avatar,issueCode:n.code,onPostComment:this.postComment,isCommentSticky:A,isCommentAbsBottom:this.state.isCommentAbsBottom,onEditStatusChanged:function(e,a){t.commentEditorRef=a,t.setState({isCommentEditing:e})},onDragEnterEditor:this.dragEnterComment,onDragLeaveEditor:this.dragLeaveComment,onMouseLeaveEditor:this.mouseLeaveComment,isDetail:ve,userID:be.id,isDescriptionBtnFixed:ae,onRef:function(e){return t.commentStickyContainerRef=e}})),S.default.createElement(Je.default,{slotVisible:oe,identity:ne,context:He,onClose:function(){return t.setState({slotVisible:!1})}})),D?S.default.createElement("div",{className:(0,H.default)(P.default.specAttribute,ve||!ve&&this.state.isFullScreen?P.default.isDetail:P.default.isSpec,L&&P.default.isFullWidth)}):this.renderAttributes())),this.state.showCopyIssues&&S.default.createElement(at.default,{user:this.props.user,enterpriseGlobalKey:ye,sourceProject:this.props.currentProject,sourceIssueTypeDetail:this.props.issueTypeDetail,sourceIssueCode:this.props.issueCode,callback:this.callback,closeHandle:function(){return t.setState({showCopyIssues:!1})}}))}},{key:"getMeetingResource",value:function(){var e=this,t=this.props,a=t.currentProject.name,n=t.issueCode;(0,K.getTencentMeetingResource)(a,n).then((function(t){var a=t.data;if(a&&Array.isArray(a)){var n=a.map((function(e){return bt(bt({},e),{},{isSummary:"MINUTES_OF_MEETING"===e.resourcesType,isVideo:"VIEW_OF_MEETING"===e.resourcesType,fileId:e.id,name:"MINUTES_OF_MEETING"===e.resourcesType?(0,y.t)("\u4f1a\u8bae\u7eaa\u8981"):"VIEW_OF_MEETING"===e.resourcesType?(0,y.t)("\u4f1a\u8bae\u5f55\u5c4f"):"",link:e.resourcesId})}));e.setState({meetingResource:(0,s.default)(n)})}}))}},{key:"isAssignAttrRequired",value:function(e,t){if(!e||!t)return!1;var a=!1;return Object.keys(e).forEach((function(n){var i=e[n]&&e[n].issueField;i&&i.type===t&&(a=e[n].required)})),a}},{key:"renderAttributes",value:function(){var e,t=this,a=this.props,n=a.isDetail,i=a.isPermissible,r=a.currentProjectCooperateSettings,o=a.projectPath,l=a.expanded,c=a.assignmentSchemeFieldArchives,u=a.assignmentUpdateFieldIDs,d=a.currentProject,f=a.bugTypes,p=a.sourceTypes,m=a.requirementTypes,h=a.moduleSchemes,v=a.labels,g=a.addLabel,E=a.detailInfo,b=a.issueCode,I=(a.ramOnline,a.zipRes),T=void 0===I?{}:I,C=a.zipRes3,D=void 0===C?{}:C,O=a.zipRes4,R=void 0===O?{}:O,j=this.state,k=j.detailInfoState,A=j.attributes,L=j.assignee,M=j.iterationList,B=j.watchers,U=j.isFullWidth,W=j.isInited,Y=j.nameList,G=j.parentRequirements,K=j.meeting,z=j.defectSource,q=j.isIterationConfirm,Z=j.versionList,J=(0,Qe.getSlotContext)(E,d.id),Q=i([{function:$.ProjectPermissionFunction.PROJECT_ISSUE,action:$.ProjectPermissionAction.UPDATE}]),te=r&&r.ITERATION&&r.ITERATION===N.MODULE_SWITCH.OPENED,ne=i([{function:$.ProjectPermissionFunction.PROJECT_ITERATION,action:$.ProjectPermissionAction.UPDATE}]),ie=r&&r.STORY_POINT===N.MODULE_SWITCH.OPENED,re=r&&r.STORY_POINT_TYPE===N.STORY_POINT_TYPE.TSHIRT,oe=r&&r.REQUIREMENT&&r.REQUIREMENT===N.MODULE_SWITCH.OPENED,se=r.COOPERATE_MODE,le=[];if(G){var ce=[];""===this.state.parentRequirementSearchStr&&k.parent&&ce.push({isAvailable:!0,code:k.parent.code,name:k.parent.name,projectId:k.parent.projectId,type:k.parent.type,issueTypeDetail:k.parent.issueTypeDetail}),ce=ce.concat(G),le=k.parent?(0,Le.uniqBy)(ce,"code"):G}var de=(0,s.default)(M||[]);return k.iteration&&-1===de.findIndex((function(e){return e.value===k.iteration.code}))&&de.unshift({value:k.iteration.code,text:k.iteration.name}),S.default.createElement("div",{className:(0,H.default)(P.default.specAttribute,n||!n&&this.state.isFullScreen?P.default.isDetail:P.default.isSpec,U&&P.default.isFullWidth)},"outer"===this.props.callFrom&&S.default.createElement("div",{className:(0,H.default)(P.default.issueProperty,n&&P.default.isDetail)},S.default.createElement("div",{className:(0,H.default)(P.default.label,n&&P.default.isDetail)},(0,y.t)("\u7814\u53d1\u7a7a\u95f4")),S.default.createElement("div",{className:(0,H.default)(P.default.customBar,n&&P.default.isDetail)},S.default.createElement(xe.default,{name:this.props.currentProject.display_name,icon:this.props.currentProject.icon,jumpUrl:this.props.currentProject.project_path}))),void 0!==K&&S.default.createElement("div",{className:(0,H.default)(P.default.meetingNotify,K.status===N.MEETING_STATUS.processing?P.default.processing:P.default.waiting)},S.default.createElement("div",{className:P.default.title},"QUICK"===K.type?"".concat(K.creator.name).concat((0,y.t)("\u7684\u5feb\u901f\u4f1a\u8bae")):K.subject),S.default.createElement("div",{className:P.default.desc},(0,V.timeFormat)(K.startTime,"MM\u6708DD\u65e5"),S.default.createElement("span",{className:P.default.time},(0,V.timeFormat)(K.startTime,"HH:mm"),S.default.createElement("span",{className:P.default.line},"-"),(0,V.timeFormat)(K.endTime,"HH:mm")),S.default.createElement("div",{className:(0,H.default)(P.default.enterMeeting,n?P.default.isDetail:""),onClick:function(){window.open(K.joinUrl,"_blank")}},(0,y.t)("\u8fdb\u5165\u4f1a\u8bae")))),S.default.createElement("div",{className:(0,H.default)(P.default.issueProperty,n&&P.default.isDetail)},S.default.createElement("div",{className:(0,H.default)(P.default.label,n&&P.default.isDetail)},(0,y.t)("\u72b6\u6001")),S.default.createElement(w.default,{className:(0,H.default)(P.default.step,P.default.customBar,n&&P.default.isDetail),value:k.issueStatus,projectID:d.id,project:d,issueCode:b,onSelect:this.onStatusChange,disabled:!Q,isDetail:n,itemInfo:E,iterationDropdownList:de,versionList:Z,hoverControlArrow:!0,labelSize:"default"})),S.default.createElement("div",{className:(0,H.default)(P.default.issueProperty,n&&P.default.isDetail)},S.default.createElement("div",{className:(0,H.default)(P.default.label,n&&P.default.isDetail,this.isAssignAttrRequired(c,ut.FIELD_TYPE.ASSIGNEE)&&P.default.required)},(0,y.t)("\u5904\u7406\u4eba")),S.default.createElement("div",{className:(0,H.default)(P.default.customBar,n&&P.default.isDetail)},S.default.createElement(ae.default,{disabled:!Q,value:A.assignee||null,inProject:!0,projectID:d.id,onSelect:function(e){return t.changeAttributes({type:"assignee",value:e.id})},onClear:function(){return t.changeAttributes({type:"assignee"})},triggerExtraProps:{initialSelectedItem:L}}))),S.default.createElement("div",{className:(0,H.default)(P.default.issueProperty,n&&P.default.isDetail)},S.default.createElement("div",{className:(0,H.default)(P.default.label,n&&P.default.isDetail,this.isAssignAttrRequired(c,ut.FIELD_TYPE.PARTICIPANT)&&P.default.required)},(0,y.t)("\u53c2\u4e0e\u4eba")),S.default.createElement("div",{className:(0,H.default)(P.default.customBar,n&&P.default.isDetail)},S.default.createElement(ae.default,{disabled:!Q,value:A.participants.map((function(e){return e.id})),inProject:!0,isMultiple:!0,projectID:d.id,onSelect:function(e){var a=[];a=A.participants.find((function(t){return t.id===e.id}))?A.participants.filter((function(t){return e.id!==t.id})):(0,Le.concat)(A.participants,e),t.changeAttributes({type:"participants",value:a})},onClear:function(){return t.changeAttributes({type:"participants",value:[]})},triggerExtraProps:{initialSelectedItem:A.participants}}))),"CLASSIC"===se&&oe&&S.default.createElement("div",{className:(0,H.default)(P.default.issueProperty,n&&P.default.isDetail)},S.default.createElement("div",{className:(0,H.default)(P.default.label,n&&P.default.isDetail)},(0,y.t)("\u6240\u5c5e\u9700\u6c42")),S.default.createElement(X.default,{requireCode:!0,type:k.parent&&k.parent.issueTypeDetail||null,placeholder:(0,y.t)("\u672a\u5173\u8054\u9700\u6c42"),clearPlaceholder:(0,y.t)("\u89e3\u9664\u5173\u8054"),projectPath:o,className:(0,H.default)(P.default.iteration,n&&P.default.iterationInDetail,P.default.customBar,n&&P.default.isDetail),searchable:!0,value:k.parent&&k.parent.code||0,disabled:!Q,items:le,selectedItem:k.parent,onSearch:function(e){t.setState({parentRequirementSearchStr:e}),t.fetchParentRequirements(e)},onSelect:function(e){var a=e,n=t.state.detailInfoState.parent,i=(0,_.default)(t.state.detailInfoState,(function(e){e.parent=a}));t.setState({detailInfoState:i},(function(){t.updateParent(a.code,n)}))},onClear:function(){var e=(0,_.default)(t.state.detailInfoState,(function(e){e.parent=void 0}));t.setState({detailInfoState:e},(function(){t.updateParent(0)}))},isDetail:n,portalProps:{toRight:this.getDropdownPortalToRight(),popDropdownMenuWidth:n?320:280,portalWrapStyle:{zIndex:1099,width:n?"320px":"280px"},isScroll:this.state.isElemScroll,resetIsScroll:function(){t.setState({isElemScroll:!1})}}})),te&&S.default.createElement("div",{className:(0,H.default)(P.default.issueProperty,n&&P.default.isDetail)},S.default.createElement("div",{className:(0,H.default)(P.default.label,n&&P.default.isDetail)},(0,y.t)("\u8fed\u4ee3")),S.default.createElement(X.default,{type:{issueType:"sprint",iconType:"sprint"},placeholder:(0,y.t)("\u672a\u89c4\u5212\u8fdb\u8fed\u4ee3"),clearPlaceholder:(0,y.t)("\u79fb\u51fa\u8fed\u4ee3"),searchable:!0,value:k.iteration&&k.iteration.code||0,projectPath:o,items:de,onSelect:this.onIterationChange,className:(0,H.default)(P.default.iteration,n&&P.default.iterationInDetail,P.default.customBar,n&&P.default.isDetail),onClear:function(){t.onIterationChange()},disabled:"SCRUM"===se&&(!!k.parentId||!ne)||"CLASSIC"===se&&(Y.length>1||!ne),isDetail:n,portalProps:{toRight:this.getDropdownPortalToRight(),popDropdownMenuWidth:n?320:280,portalWrapStyle:{zIndex:1099,width:n?"320px":"280px"},isScroll:this.state.isElemScroll,resetIsScroll:function(){t.setState({isElemScroll:!1})}}})),te&&q&&S.default.createElement(ft.default,{modalStyle:{width:460},buttonStyle:{flexSpaceAround:!0},onCancel:function(){t.setState({isIterationConfirm:!1,iterationConfirmParams:null})},onHide:function(){t.setState({isIterationConfirm:!1,iterationConfirmParams:null})},show:q,callback:function(){t.setState({isIterationConfirm:!1},(function(){return t.handleIterationChangeConfirm()}))},title:this.formatTypeText("title"),confirmText:(0,y.t)("\u786e\u8ba4"),hideText:(0,y.t)("\u53d6\u6d88")},S.default.createElement("p",null,this.formatTypeText("desc"))),ie&&S.default.createElement("div",{className:(0,H.default)(P.default.issueProperty,n&&P.default.isDetail)},S.default.createElement("div",{className:(0,H.default)(P.default.label,n&&P.default.isDetail)},(0,y.t)("\u6545\u4e8b\u70b9")),S.default.createElement("div",{className:(0,H.default)(P.default.customBar,n&&P.default.isDetail)},S.default.createElement(ue.default,{useSize:re,value:k.storyPoint,disabled:!Q,onSelect:function(e){t.updateAssignment({storyPoint:e})},onClear:function(){t.updateAssignment({storyPoint:-1})}}))),(!this.props.issueTypeDetail.type||"mission"===this.props.issueTypeDetail.type)&&S.default.createElement(dt.default,{status:"isEdit",getInnerVersionList:this.getVersionList,getVersion:function(e){return e},labelStyle:(0,H.default)(P.default.label,n&&P.default.isDetail),boxStyle:(0,H.default)(P.default.issueProperty,n&&P.default.isDetail),projectId:d.id,onChange:this.changeAttributes,planDateValue:k.planDate,versionValue:k.edition,issueId:k.id,isSetDropdownPanelWidth:!0,planDateCustomID:null===(e=Object.values(c).find((function(e){var t;return"\u8ba1\u5212\u4e0a\u7ebf\u65e5\u671f"===(null===(t=e.issueField)||void 0===t?void 0:t.name)})))||void 0===e?void 0:e.issueFieldId,updateActivity:function(){t.getActivityList()},isFieldUpdate:!0,updateVersions:function(e){var a={editionId:e};t.updateAssignment(a)}}),S.default.createElement("div",{className:P.default.splitLine,style:{marginTop:"16px"}}),W&&S.default.createElement(x.default,{user:this.props.user,expanded:l,className:P.default.issueProperties,isCreate:!1,schemeFieldArchives:c,fieldIds:u,issueType:"MISSION",onChange:this.changeAttributes,customAttributes:A,assignee:L,watchers:B,isFromDetailPage:n||l,isDetailPage:n,permissionFunction:$.ProjectPermissionFunction.PROJECT_ISSUE,isPermissible:i,projectID:d.id,currentProject:d,bugTypes:f,sourceTypes:p,requirementTypes:m,moduleSchemes:h,labels:v,addLabel:g,detailInfo:E,activities:this.state.activities,onManHourUpdate:function(){t.fetchManHourRecords().then((function(){t.changeAttributes({type:""})}))},onForwardLogs:function(){(0,ee.scrollRelatedToTopMenu)("activity-log-tab",200,t.scrollRef.current),t.setState({activeLogTab:"work"})},portalProps:{toRight:this.getDropdownPortalToRight(),portalWrapStyle:{zIndex:1099},isScroll:this.state.isElemScroll,resetIsScroll:function(){t.setState({isElemScroll:!1})}},meetingCallback:function(e){t.setState({meeting:e}),t.getActivityList()},productName:z&&"production"===z.valueType?z.name:"",zipRes:T,zipRes3:D,zipRes4:R}),S.default.createElement("div",{className:(0,H.default)(P.default.createTime,P.default.creatorInfo),title:"".concat(k.creator.name).concat((0,y.t)(" \u521b\u5efa\u4e8e ")).concat((0,F.default)((0,V.timeFormat)(k.createdAt,"YYYY-MM-DD HH:mm:ss")).fromNow())},k.creator.name," ",(0,y.t)("\u521b\u5efa\u4e8e")," ",(0,F.default)((0,V.timeFormat)(k.createdAt,"YYYY-MM-DD HH:mm:ss")).fromNow()),S.default.createElement(Xe.default,{context:J}))}},{key:"onScroll",value:function(e){var t=this.state,a=t.isDesEditing,n=t.isDescriptionBtnFixed;if(a){var i,r,o=this.scrollRef.current.scrollTop,s=this.scrollRef.current.getBoundingClientRect().height,l=this.editorRef.current.getBoundingClientRect().height,c=(null===(i=this.commentStickyContainerRef)||void 0===i||null===(r=i.current)||void 0===r?void 0:r.offsetHeight)||0;n=l>=s+o-this.headerRef.current.offsetHeight-c}this.setState({scrollControl:Date.now(),isDescriptionBtnFixed:n}),clearTimeout(this.scrollRunId),e.stopPropagation(),this.scrollRunId=setTimeout(this.doScroll,50)}},{key:"componentDidMount",value:function(){var e=this.props,t=e.user,a=e.watermark,n=e.detailInfo,i=e.payed,r=e.isDetail,o=e.params.subIssueCode,s=e.getLabels,l=e.isSensitiveAdmin,c=e.currentProjectCooperateSettings,u=e.zipRes,d=void 0===u?{}:u,f=d.code,p=d.data;this.scrollRef.current&&this.scrollRef.current.addEventListener("scroll",this.onScroll,!1);var m=(0,Ge.getAuidtPaymentState)(),h=(0,Ge.getWatermarkPaymentState)();if(s&&s(),r&&o&&this.openSlideslip(),this.initAttributesData(n),this.getBasicInfo(0===f&&p),n.pageId?this.state.isDescriptionEmpty&&this.dataLoad("description"):this.dataLoad("description"),!h||i){var v=(0,he.getText)(t);(0,he.watermarkService)(a,v,r)}m&&!i||(this.trackEvent(n.code),l&&this.getSensitiveMessage(n.code)),this.getParentDetail(0===f&&p[st.default.getParentDetail]),c.txcAuthorized&&this.getFeedBackList(),document.addEventListener("keyup",this.handleFullScreenKey)}},{key:"componentWillUnmount",value:function(){var e=this.props,t=e.payed,a=e.isDetail;(0,Ge.getWatermarkPaymentState)()&&!t||(0,he.removeWatermark)(a),document.removeEventListener("keyup",this.handleFullScreenKey)}},{key:"componentDidUpdate",value:function(e,t){var a=this.props,n=a.params,i=a.detailInfo,r=a.issueCode,o=a.isDetail,s=e.params,l=e.detailInfo,c=(t.controlCaculatePos,t.meetingResource),u=this.state,d=(u.controlCaculatePos,u.meetingResource);(0,M.default)(s,n)||(n.assignmentCode!==s.assignmentCode&&(this.props.getAssignmentScheme(),this.getSubTasksList()),o&&n.subIssueCode?this.openSlideslip():this.closeSlideslip()),(0,M.default)(i,l)||this.updateDetailInfo(r,i),(0,M.default)(d,c)||this.setState({attachmentsState:this.combineThirdLinks(i.files,i.thirdLinks)})}},{key:"updateDetailInfo",value:function(e,t){var a=this,n=(0,Ge.getAuidtPaymentState)();this.setState(bt({detailInfoState:t,attachmentsState:(0,s.default)(t.files)},this.isDeleteInFilePreview?{isFilePreviewVisible:!1}:null),(function(){a.isDeleteInFilePreview=!1,a.initAttributesData(t),a.getSubTasksList(e),!a.props.isSensitiveAdmin||n&&!a.props.payed||a.getSensitiveMessage(t.code)}))}},{key:"openSlideslip",value:function(){this.setState({showSideslip:!0})}},{key:"closeSlideslip",value:function(){this.setState({showSideslip:!1})}},{key:"getBasicInfo",value:function(e){var t=this,a=this.props,n=a.currentProjectCooperateSettings,i=a.zipRes3,r=void 0===i?{}:i,o=a.zipRes4,l=void 0===o?{}:o,c=this.getFunctionFlags(),u=c.codeManagementOpen,d=c.issueReviewOpen,f=n&&n.COOPERATE_MODE,p=(r.code,r.data,l.code),m=l.data;this.setState({codeManagementOpen:u,issueReviewOpen:d}),Promise.all([this.props.getRequirementTypes(e&&e[st.default.getRequirementTypes]),this.props.getBugTypes(e&&e[st.default.getBugTypes]),this.props.getModuleSchemes(),this.props.getAssignmentScheme(),this.props.getSourceTypes(e&&e[st.default.getSourceTypes])].concat((0,s.default)(u?[this.getCodeRepoSetting()]:[]),(0,s.default)(d?[this.fetchIssueReviewList()]:[]),[this.getActivityList({needCacuPos:!1})])).then((function(){t.setState({isInited:!0})})),this.getIterationList(e&&e[st.default.getIterationList]),this.getSubTasksList(e&&e[st.default.getSubTasksList]),this.getSplitIssueList().then((function(){t.dataLoad("splitTask")})),this.getResourceReference(0===p&&m).then((function(){t.dataLoad("reference")})),this.fetchManHourRecords(e&&e[st.default.fetchManHourRecords]),u||this.dataLoad("codeRepo"),"CLASSIC"===f&&this.fetchBlockingRelationList(e&&e[st.default.fetchBlockingRelationList]),this.getMeetingResource()}},{key:"fetchBlockingRelationList",value:function(e){var t=this,a=this.props.currentProject,n=this.state.detailInfoState;e?0===e.code?this.setState({blockBeforeList:e.data.blocked_by,blockAfterList:e.data.blocks},(function(){t.dataLoad("blockingRelation")})):this.dataLoad("blockingRelation"):(0,Ee.fetchBlockRelation)(a.id,n.code,{blockType:"ALL"}).then((function(e){var a=e.data;t.setState({blockBeforeList:a.blocked_by,blockAfterList:a.blocks},(function(){t.dataLoad("blockingRelation")}))}),(function(){t.dataLoad("blockingRelation")}))}},{key:"callback",value:function(e,t){var a=this.props.updateCallback;a&&a(e,t)}},{key:"initAttributesData",value:function(e){var t,a,n,i;this.setState({attributes:{assignee:e.assignee&&e.assignee.id||void 0,priority:void 0!==e.priority?e.priority:void 0,startDate:e.startDate||void 0,dueDate:e.dueDate||void 0,projectModule:e.projectModule&&e.projectModule.id||void 0,requirementType:e.requirementType&&e.requirementType.id||void 0,labels:e.labels&&!!e.labels.length&&e.labels.map((function(e){return e.id}))||[],watchers:e.watchers&&!!e.watchers.length&&e.watchers.map((function(e){return e.id}))||[],workingHours:e.workingHours,fields:e.issueSchemeFields||{},progress:e.progress,wuKongReloadId:e.wuKongReloadValue,estimatedWorkHour:(null===e||void 0===e?void 0:e.estimatedWorkHour)||void 0,defectKindIds:e.defectKinds&&e.defectKinds.length&&e.defectKinds.map((function(e){return e.id+""}))||[],defectPhaseId:e.defectPhase&&e.defectPhase.id+""||void 0,defectSourceId:(null===e||void 0===e||null===(t=e.defectSource)||void 0===t?void 0:t.id)||void 0,systemsId:null===(a=e.systemDTO)||void 0===a?void 0:a.systemId,participants:e.participants||[],programId:e.programId,selectedProgram:e.program,milestone:null===(n=e.milestone)||void 0===n?void 0:n.id,groupTeamId:null===(i=e.groupTeam)||void 0===i?void 0:i.id,iteration:e.iteration&&e.iteration.code,edition:e.edition},assignee:e.assignee,watchers:e.watchers||[],defectSource:e.defectSource})}},{key:"changeAttributes",value:function(e){var t,a=e.isCustom,n=e.type,i=e.value,r=e.issueFieldId,o=e.customValue,s=e.operationType,l=e.specCallback,u=this.state.attributes,d=this.props.assignmentSchemeFieldArchives;if(!this.validateDefect()){var f;if(a){var p=u.fields,m=i;!i&&(0,Y.default)(p[r])?m=[]:!i&&((0,U.default)(p[r])||(0,W.default)(p[r])||(0,B.default)(p[r]))&&(m=null),d[r].issueField.componentType!==Ue.PROPERTY_TYPE_CONSTANTS.SELECT_MEMBER_SINGLE&&d[r].issueField.componentType!==Ue.PROPERTY_TYPE_CONSTANTS.SELECT_ITERATION_SINGLE||(m=i?i.id:null),d[r].issueField.componentType!==Ue.PROPERTY_TYPE_CONSTANTS.SELECT_MEMBER_MULTI&&d[r].issueField.componentType!==Ue.PROPERTY_TYPE_CONSTANTS.SELECT_ITERATION_MULTI||(m=i?i.map((function(e){return e.id})):[]),f={customFieldValueMap:[{id:r,content:m}]}}else switch(n){case"requirementType":f={requirementTypeId:i||0};break;case"participants":f=(0,c.default)({},n,i?i.map((function(e){return e.id})):[]);break;case"projectModule":f={projectModuleId:i||0};break;case"priority":case"assignee":f=bt({},(0,c.default)({},n,i||0));break;case"labels":case"watchers":var h=u.labels,v=u.watchers,g="labels"===n?"labelIds":"watchers",E="labels"===n?"delLabelIds":"delWatchers",b="labels"===n?h:v,y=Array.from(new Set(b.concat(i)));if(i)if(y.length===b.length){var S=b.findIndex((function(e){return!i.includes(e)}));f=(0,c.default)({},E,[b[S]])}else f=(0,c.default)({},g,[i[i.length-1]]),"watchers"===n&&(i=y);else f=(0,c.default)({},E,b);break;case"workingHours":f={workingHours:(null===(t=i)||void 0===t?void 0:t.workingHours)||0,estimatedWorkHour:i||void 0};break;case"progress":f={progress:i||0};break;case"systemsId":f={systemsId:i||0};break;case"defectKindIds":f={defectKindIds:i||[],defectPhaseId:o};break;case"defectPhaseId":f={defectPhaseId:i||0,defectKindIds:[]};break;case"programId":f={programId:i.id?i.id:i},s&&(f.operate=s);break;default:f=(0,c.default)({},n,i)}"programId"!==n&&this.setState({attributes:bt(bt({},u),a?{fields:bt(bt({},u.fields),{},(0,c.default)({},r,i))}:(0,c.default)({},n,i))}),this.updateAssignment(f).then((function(){l&&l()}))}}},{key:"onNameChange",value:function(e){var t=(0,_.default)(this.state.detailInfoState,(function(t){t.name=e.target.value}));this.setState({detailInfoState:t})}},{key:"submitTitleChange",value:function(){var e=this,t=this.state.detailInfoState,a=this.props.detailInfo;t.name&&t.name.length<=128?t.name!==a.name&&this.updateAssignment({name:t.name.trim()},(function(){e.titleInputRef&&e.titleInputRef.current&&(e.titleInputRef.current.blur(),e.setState({noHoverIcon:!0},(function(){setTimeout((function(){e.setState({noHoverIcon:!1})}),0)}))),e.setState({detailInfoState:bt(bt({},t),{},{name:t.name.trim()})})})):(0,q.warning)((0,y.t)("\u8bf7\u8f93\u5165\u4e0d\u8d85128\u4f4d\u7684\u4efb\u52a1\u540d\u79f0"))}},{key:"onStatusChange",value:function(e){return this.updateAssignment(e)}},{key:"onVisibleChange",value:function(){this.setState({tooltipTitle:(0,y.t)("\u590d\u5236\u94fe\u63a5")})}},{key:"onCopyClick",value:function(){this.setState({tooltipTitle:(0,y.t)("\u5df2\u590d\u5236")})}},{key:"toggleCopyModal",value:function(){var e=this.state.showCopyModal;this.setState({showCopyModal:!e}),this.callback(),this.getActivityList()}},{key:"updateDescription",value:function(e){var t=this,a=this.props,n=a.currentProject,i=a.issueCode;return(0,z.modifyIssueDescription)(n.id,i,bt({},e)).then((function(e){return(0,ht.clearLocalStorage)(t.props),t.getResourceReference(),e}))}},{key:"actionCallback",value:function(){var e=this.props.isDetail;this.getSubTasksList(),this.getActivityList(),this.setState({subTasksInput:""}),e||this.props.updateCallback()}},{key:"deleteAssignment",value:function(){var e=this.props,t=e.currentProject,a=e.projectPath,n=e.refreshCallback,i=e.iterationCode,r=e.location,o=r.pathname,s=r.search,l=e.browserRouter,c=e.callFrom,u=this.state.detailInfoState,d=(0,tt.currentListPath)(o);(0,G.deleteAssignment)(t.id,u.code).then((function(){if((0,q.success)((0,y.t)("\u5220\u9664\u6210\u529f")),"outer"===c)(0,Pe.emitFromPM)({type:"closeSlide"});else if(/detail\/subissues/.test(o))l.push("".concat(a,"/epics/issues/").concat(u.epic.code,"/detail"));else{var e=-1!==d.indexOf("iterations")?"iterations":"releases";l.push("".concat(a,"/").concat(i?"".concat(e,"/").concat(i,"/issues"):"".concat(d,"/issues")).concat(s))}n(!0)}))}},{key:"updateAssignment",value:function(e,t){var a=this,n=this.props.currentProject,i=this.state.detailInfoState;return(0,G.updateAssignmentDetail)(n.id,i.code,e).then((function(t){var n=t.data;return n.files=a.combineThirdLinks(n.files,n.thirdLinks),a.callback(bt(bt({},n),{},{parent:i.parent}),e.statusId),a.getActivityList(),a.fetchManHourRecords(),a.getSplitIssueList(),(0,q.success)((0,y.t)("\u66f4\u65b0\u6210\u529f")),t}),(function(t){var n=t.code,r=t.data,o=t.msg,l=a.state.attachmentsState;return 8015===n?r.issue_status_id===e.statusId?(a.callback(null,e.statusId),a.getActivityList(),(0,q.success)((0,y.t)("\u66f4\u65b0\u6210\u529f"))):((0,q.danger)((0,y.t)("\u66f4\u65b0\u5931\u8d25\uff0c\u5f53\u524d\u72b6\u6001\u4e0d\u6b63\u786e\u3002")),a.callback(null,r.issue_status_id),a.getActivityList()):((0,q.danger)((0,Q.getErrorMessage)(o)),a.setState({detailInfoState:i,attachmentsState:(0,s.default)(l.filter((function(e){return e.fileId>0})))},(function(){a.initAttributesData(i)}))),t})).finally((function(){"function"===typeof t&&t()}))}},{key:"cancelAssociateSubItem",value:function(){var e=this,t=this.props.currentProject,a=this.state.detailInfoState;(0,G.cancelAssociateSubItem)(t.id,a.code).then((function(){(0,q.success)((0,y.t)("\u53d6\u6d88\u5173\u8054\u6210\u529f")),e.callback(),e.getActivityList()}))}},{key:"handleEditCommentCallback",value:function(e){var t=this;this.getActivityList({callback:function(){setTimeout((function(){(0,ee.scrollRelatedToTopMenu)("comment-".concat(e),0,t.scrollRef.current)}))}}),this.getResourceReference()}},{key:"postComment",value:function(e,t,a,n,i){var r=this,o=this.scrollRef;return(0,G.addAssignmentComment)({projectID:e,assignmentCode:t,content:a,parentID:n}).then((function(e){i&&i(),r.getResourceReference(),r.getActivityList({callback:function(){setTimeout((function(){(0,ee.scrollRelatedToTopMenu)("comment-".concat(e.data.id),0,o.current)}))}})}))}},{key:"deleteComment",value:function(e,t,a,n){var i=this;(0,G.deleteAssignmentComment)(e,t,a).then((function(){n&&n(),i.getResourceReference(),i.getActivityList()}))}},{key:"getActivityList",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{callback:function(){},needCacuPos:!0},a=t.callback,n=t.needCacuPos,i=this.props.issueCode,r=this.props.currentProject.id;return(0,G.fetchAssignmentsActitvites)(r,i).then((function(t){e.setState({activities:t.data},(function(){a&&a(),n&&e.setState({controlCaculatePos:Date.now()})})),e.dataLoad("logs")}))}},{key:"getResourceReference",value:function(){var e=this,t=this.state.detailInfoState,a=this.props.currentProject;return Promise.all([(0,z.fetchCitedResourceReference)(a.id,t.code),(0,z.fetchCitingResourceReference)(a.id,t.code)]).then((function(t){e.setState({citedSources:t[0].data,citingSources:t[1].data})}))}},{key:"onRemoveReference",value:function(){(0,q.success)((0,y.t)("\u53d6\u6d88\u5173\u8054\u6210\u529f")),this.getResourceReference(),this.getActivityList(),this.getSplitIssueList()}},{key:"combineThirdLinks",value:function(e,t){var a;t&&Array.isArray(t)||(t=[]);var n=t.map((function(e){var t="MODAO"===e.thirdType,a="CODESIGN"===e.thirdType,n="";return t&&(n=e.title||(0,y.t)("\u58a8\u5200\u9644\u4ef6")),a&&(n=e.title),bt(bt({},e),{},{isModao:t,isCodesign:a,fileId:e.id,name:n,preview:t&&e.link})})),i=[];null!==(a=this.state)&&void 0!==a&&a.meetingResource&&(i=this.state.meetingResource||[]);var r=[].concat((0,s.default)(e),(0,s.default)(n),(0,s.default)(i));return r.sort((function(e,t){return(e.createdAt||e.created_at)-(t.createdAt||t.created_at)})),r}},{key:"fileUpload",value:function(e){var t=this.state.attachmentsState;this.setState({attachmentsState:[].concat((0,s.default)(t),(0,s.default)(e))})}},{key:"handleDeleteAttachment",value:function(e,t,a){a?this.handleDeleteMeetingResource(e):t?this.handleDeleteModao(e):this.updateAssignment({delFileIds:[e]})}},{key:"handleDeleteModao",value:function(e){var t=this,a=this.props,n=a.currentProject.id,i=a.issueCode;(0,ve.deleteModao)(n,i,e).then((function(){(0,q.success)((0,y.t)("\u5220\u9664\u6210\u529f")),t.setState({attachmentsState:t.state.attachmentsState.filter((function(t){return t.fileId!==e}))}),t.getActivityList()}))}},{key:"onFileDropSuccess",value:function(e){var t=this;if(e.isCanceled)this.setState({attachmentsState:(0,_.default)(this.state.attachmentsState,(function(t){var a=t.findIndex((function(t){return t.timestamp===e.timestamp}));t.splice(a,1)}))});else if(e.isModao||e.isCodesign){(0,q.success)((0,y.t)("\u66f4\u65b0\u6210\u529f"));var a=this.props,n=a.currentProject.id,i=a.issueCode;(0,G.fetchAssignmentDetail)(n,i,{withDescriptionMarkup:!0}).then((function(e){var a=e.data;t.setState({attachmentsState:t.combineThirdLinks(a.files,a.thirdLinks)},(function(){t.scrollToAttechment()}))})),this.getActivityList()}else this.updateAssignment({fileIds:[e.fileId]},(function(){t.scrollToAttechment()}))}},{key:"onFileDropFail",value:function(e){var t=e.timestamp;this.setState({attachmentsState:(0,_.default)(this.state.attachmentsState,(function(e){var a=e.findIndex((function(e){return e.timestamp===t}));e.splice(a,1)}))})}},{key:"onFileDropDelete",value:function(e){var t=e.fileId,a=e.isModao,n=e.isCodesign,i=e.isSummary,r=e.isVideo;this.handleDeleteAttachment(t,a||n,i||r)}},{key:"onFileDropCancel",value:function(e){var t=e.timestamp;this.setState({attachmentsState:(0,_.default)(this.state.attachmentsState,(function(e){var a=e.findIndex((function(e){return e.timestamp===t}));e[a].isCanceled=!0}))})}},{key:"filePreviewHide",value:function(e){this.setState({isFilePreviewVisible:e})}},{key:"previewItem",value:function(e){this.setState({previewFileID:e,isFilePreviewVisible:!0})}},{key:"handleDelInPreviewFile",value:function(){var e=this,t=this.state.deleteFileId;this.isDeleteInFilePreview=!0,this.updateAssignment({delFileIds:[t]},(function(){e.setState({showDeleteConfirmModal:!1,deleteFileId:void 0})}))}},{key:"handleDeleteMeetingResource",value:function(e){var t=this,a=this.props,n=a.currentProject.name,i=a.issueCode;(0,K.deleteTencentMeetingResource)(n,i,e).then((function(){(0,q.success)((0,y.t)("\u5220\u9664\u6210\u529f")),t.setState({attachmentsState:t.state.attachmentsState.filter((function(t){return!((t.isSummary||t.isVideo)&&t.fileId===e)}))}),t.getActivityList()}))}},{key:"handleDeleteAttachmentConfirm",value:function(e,t){this.setState({showDeleteConfirmModal:!0,deleteFileId:t})}},{key:"getVersionList",value:function(e){this.setState({versionList:e})}},{key:"getIterationList",value:function(e){var t=this,a=this.props.currentProject;if(!e)return(0,z.fetchIterationList)(a.id).then((function(e){t.setState({iterationList:t.formatIterationList(e.data)})}));0===e.code&&this.setState({iterationList:this.formatIterationList(e.data)})}},{key:"formatIterationList",value:function(e){return e.map((function(e){return{value:e.code,text:e.name,status:e.status,progress:{finished:e.completedCount,processing:e.processingCount,unstart:e.waitProcessCount}}}))}},{key:"onIterationChange",value:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.props,i=n.currentProject,r=n.iterationCode,o=n.updateCallback,s=this.state.detailInfoState,l=s.iteration&&s.iteration.code||0;if((null===e||void 0===e?void 0:e.value)!==l)if(this.setState({useOld:a}),null===s.iteration&&e&&e.status===pt.ITERATION_STATUS.PROCESSING)this.setState({isIterationConfirm:!0,iterationConfirmParams:e});else if(s.iteration&&[pt.ITERATION_STATUS.WAIT_PROCESS,pt.ITERATION_STATUS.PROCESSING,pt.ITERATION_STATUS.COMPLETED].includes(s.iteration.status)&&e&&[pt.ITERATION_STATUS.WAIT_PROCESS,pt.ITERATION_STATUS.PROCESSING,pt.ITERATION_STATUS.COMPLETED].includes(e.status)&&([pt.ITERATION_STATUS.WAIT_PROCESS,pt.ITERATION_STATUS.COMPLETED].includes(s.iteration.status)&&e.status===pt.ITERATION_STATUS.PROCESSING||s.iteration.status===pt.ITERATION_STATUS.PROCESSING&&[pt.ITERATION_STATUS.WAIT_PROCESS,pt.ITERATION_STATUS.PROCESSING,pt.ITERATION_STATUS.COMPLETED].includes(e.status)))this.setState({isIterationConfirm:!0,iterationConfirmParams:e});else if(void 0===e&&s.iteration&&s.iteration.status===pt.ITERATION_STATUS.PROCESSING)this.setState({isIterationConfirm:!0,iterationConfirmParams:e});else if(a)(0,z.updateIteration)(i.id,s.code,e?e.value:0).then((function(e){var a=e.data;(0,q.success)((0,y.t)("\u66f4\u65b0\u6210\u529f")),o(a),t.callback(),t.getActivityList(),r&&t.props.refreshCallback()}));else{var c={iterationCode:e?e.value:0};this.updateAssignment(c)}}},{key:"handleIterationChangeConfirm",value:function(){var e=this,t=this.props,a=t.currentProject,n=t.iterationCode,i=t.updateCallback,r=this.state,o=r.detailInfoState,s=r.iterationConfirmParams;if(r.useOld)(0,z.updateIteration)(a.id,o.code,s?s.value:0).then((function(t){var a=t.data;(0,q.success)((0,y.t)("\u66f4\u65b0\u6210\u529f")),i(a),e.callback(),e.getActivityList(),n&&e.props.refreshCallback&&e.props.refreshCallback(),e.setState({iterationConfirmParams:null})}));else{var l={iterationCode:s?s.value:0};this.updateAssignment(l)}}},{key:"toggleRecord",value:function(){var e=this.state.isHistoryRecordVisible;this.setState({isHistoryRecordVisible:!e})}},{key:"viewRecord",value:function(e){var t=e.currentId;this.setState({isHistoryRecordVisible:!0,currentLogId:t})}},{key:"handleModifyParentIssue",value:function(){var e=(0,l.default)(r.default.mark((function e(t){var a,n;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=this.state.currentSubTask,n=this.props.currentProject.id,e.next=5,(0,z.modifyParentIssue)(n,a.code,{parentCode:t.code});case 5:this.showRequirementSelector(!1),this.actionCallback(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),window.console.log(e.t0);case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()},{key:"handleRemoveEpic",value:function(){var e=this,t=this.props,a=t.currentProject,n=t.projectPath,i=t.location.pathname,r=t.browserRouter,o=this.state.detailInfoState;(0,ce.deleteIssueFromEpic)(a.id,o.epic.code,o.code).then((function(){(0,q.success)((0,y.t)("\u53d6\u6d88\u5173\u8054\u6210\u529f")),/detail\/subissues/.test(i)?(r.push("".concat(n,"/epics/issues/").concat(o.epic.code,"/detail")),e.callback()):(e.callback(),e.getActivityList())}))}}]),a}(S.Component),E.propTypes=bt(bt({detailInfo:T.default.object,assignmentList:T.default.array,projectPath:T.default.string,params:T.default.object,expanded:T.default.bool,isDetail:T.default.bool,currentProject:T.default.object,labels:T.default.array,user:T.default.object,assignmentSchemeFieldArchives:T.default.object,assignmentUpdateFieldIDs:T.default.array,getAssignmentScheme:T.default.func,updateCallback:T.default.func,refreshCallback:T.default.func,enterpriseGlobalKey:T.default.string,location:T.default.object,enterpriseName:T.default.string,issueCode:T.default.oneOfType([T.default.number,T.default.string]),iterationCode:T.default.oneOfType([T.default.number,T.default.string]),getBugTypes:T.default.func,getRequirementTypes:T.default.func,getModuleSchemes:T.default.func,autoshowComment:T.default.object,autoToggleComment:T.default.func,domID:T.default.string,flashAnchor:T.default.func,scrollRef:T.default.any,watermark:T.default.string,payed:T.default.bool},$.WithProjectPermissionProps),{},{currentProjectCooperateSettings:T.default.object,browserRouter:T.default.object,callFrom:T.default.string,getLabels:T.default.func,targetData:T.default.object,ramOnline:T.default.bool,branchsInfo:T.default.array}),E.defaultProps={expanded:!0,assignmentList:[],isDetail:!1},g=b))||g)||g)||g)||g)||g)||g)||g)||g)||g)||g);t.default=St},LMMh:function(e,t,a){e.exports={wrapper:"wrapper-16rbwZw9-d","input-before":"input-before-UDl-rEUM3a",inputBefore:"input-before-UDl-rEUM3a","icon-task":"icon-task-11l18NJ4yw",iconTask:"icon-task-11l18NJ4yw","icon-requirement":"icon-requirement-2Ru1cOkvkT",iconRequirement:"icon-requirement-2Ru1cOkvkT","input-after":"input-after-yKva8tI8iL",inputAfter:"input-after-yKva8tI8iL","input-clear":"input-clear-3Pi3qAYlyd",inputClear:"input-clear-3Pi3qAYlyd","input-create":"input-create-1dewHBEXVu",inputCreate:"input-create-1dewHBEXVu","input-create-text":"input-create-text-5Y6MmZrpUl",inputCreateText:"input-create-text-5Y6MmZrpUl","input-create-arrow":"input-create-arrow-eijtmInX59",inputCreateArrow:"input-create-arrow-eijtmInX59",popup:"popup-2ugmzHPVHK","popup-item":"popup-item-3Yw2PXg7oT",popupItem:"popup-item-3Yw2PXg7oT","popup-item-text":"popup-item-text-2zK_drWM7R",popupItemText:"popup-item-text-2zK_drWM7R","popup-item-shift":"popup-item-shift-oWMYleNDwm",popupItemShift:"popup-item-shift-oWMYleNDwm","popup-item-enter":"popup-item-enter-3-HFgq8DT9",popupItemEnter:"popup-item-enter-3-HFgq8DT9","input-cancel":"input-cancel-1dULTtais0",inputCancel:"input-cancel-1dULTtais0"}},"LS+K":function(e,t,a){e.exports={tag:"tag-3_ZhSboObg",orange:"orange-B-nRxiTa-U",red:"red-2m5EkMsbMc",gray:"gray-2Eb4zPXJ0w"}},Lg9n:function(e,t,a){e.exports={root:"root-S9UX3dalL9"}},Lnax:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ctrlText=t.isMac=void 0;var n=function(){var e=navigator.userAgent.toLowerCase();return/macintosh|mac os x/i.test(e)};t.isMac=n;t.ctrlText=function(){return n()?"\u2318":"Ctrl"}},Logu:function(e,t,a){e.exports={toolbar:"toolbar-282dCefwZg",item:"item-1vlxwQvYnx",rest:"rest-2CeL_evXt-","rest-item":"rest-item-2iCiCX8TVZ",restItem:"rest-item-2iCiCX8TVZ",tooltip:"tooltip-luaADFmzbl","file-breadcrumb":"file-breadcrumb-2KpwjoFYfL",fileBreadcrumb:"file-breadcrumb-2KpwjoFYfL","file-suffix-name":"file-suffix-name-WfQqBnJbHZ",fileSuffixName:"file-suffix-name-WfQqBnJbHZ","file-viewer":"file-viewer-3rZxJUJiPc",fileViewer:"file-viewer-3rZxJUJiPc","viewer-body":"viewer-body-UZ9Zm7u8JD",viewerBody:"viewer-body-UZ9Zm7u8JD","previous-button":"previous-button-13WAkU8ITV",previousButton:"previous-button-13WAkU8ITV","next-button":"next-button-liECTdiXur",nextButton:"next-button-liECTdiXur","viewer-file-content":"viewer-file-content-36mkULJn2G",viewerFileContent:"viewer-file-content-36mkULJn2G","editor-header":"editor-header-1YHqsoM70L",editorHeader:"editor-header-1YHqsoM70L","name-input":"name-input--iQF4Zg5SM",nameInput:"name-input--iQF4Zg5SM",buttons:"buttons-1Z58lXLFDg","toolbar-item":"toolbar-item-3bjokSyI8l",toolbarItem:"toolbar-item-3bjokSyI8l","preview-file-name":"preview-file-name-2mMargmAQm",previewFileName:"preview-file-name-2mMargmAQm","file-loading":"file-loading-t7D6EurOED",fileLoading:"file-loading-t7D6EurOED","file-error":"file-error-3o3BkuW2wv",fileError:"file-error-3o3BkuW2wv",top:"top-3PhFSN-3hf","fetch-loading":"fetch-loading-2cTeFGix_Q",fetchLoading:"fetch-loading-2cTeFGix_Q","fetch-error":"fetch-error-1CPzKK6ZIz",fetchError:"fetch-error-1CPzKK6ZIz","file-success":"file-success-1ICfy-MCC7",fileSuccess:"file-success-1ICfy-MCC7"}},"M/Qn":function(e,t,a){"use strict";a.r(t),a.d(t,"formatDropdownItem",(function(){return I}));var n=a("cDcd"),i=a.n(n),r=a("qPyV"),o=a.n(r),s=a("V0lW"),l=a("UGd4"),c=a("mVeg"),u=a("Z4vw"),d=a("mTYr"),f=a("xgZS"),p=a("GOSa"),m=a.n(p),h=a("5JFE"),v=a("LvDl"),g=function(e,t,a,n){return new(a||(a=Promise))((function(i,r){function o(e){try{l(n.next(e))}catch(t){r(t)}}function s(e){try{l(n.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,s)}l((n=n.apply(e,t||[])).next())}))},E=function(e,t){var a,n,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(l){return function(s){if(a)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(a=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(l){s=[6,l],n=0}finally{a=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},b=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(a[n[i]]=e[n[i]])}return a},y=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},S=function(e,t,a){if(a||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},I=function(e){return e.map((function(e){return{value:e.id,text:e.name,label:e.name,code:e.code,disabled:1===e.releaseIterationSyncMode}}))};t.default=function(e){e.isBatch;var t=e.value,a=(e.isMultiple,e.show,e.projectId),r=(e.itemExtraProps,e.issueCode),p=e.autoUpdate,T=void 0===p||p,C=e.crossProject,P=void 0!==C&&C,w=e.onSelect,D=e.onSuccess,O=e.releaseCode,R=(b(e,["isBatch","value","isMultiple","show","projectId","itemExtraProps","issueCode","autoUpdate","crossProject","onSelect","onSuccess","releaseCode"]),y(Object(n.useState)(!1),2)),j=R[0],k=R[1],N=y(Object(n.useState)(!1),2),A=N[0],L=N[1],F=y(Object(n.useState)([]),2),_=F[0],M=F[1],x=y(Object(n.useState)([]),2),B=x[0],U=x[1],W=y(Object(n.useState)([]),2),Y=W[0],H=W[1];Object(n.useEffect)((function(){if(t){var e=t.map((function(e){return e.id}));Object(v.isEqual)(e,B)||U(e)}L(!0)}),[t]),Object(n.useEffect)((function(){O&&Object(l.getReleaseDetailsByCode)(a,O).then((function(e){var t=e.data;t&&(U([null===t||void 0===t?void 0:t.id]),null===w||void 0===w||w([null===t||void 0===t?void 0:t.id]))}))}),[O,a]);var V=function(e,t){return g(void 0,void 0,void 0,(function(){var n,i,o;return E(this,(function(l){switch(l.label){case 0:n=e?s.issuseBindRelease:s.issuseUbindRelease,l.label=1;case 1:return l.trys.push([1,3,,4]),i=_.filter((function(e){return t.includes(e.value)})),[4,n(a,r||"",i.map((function(e){return e.code})))];case 2:return l.sent(),Object(f.success)("".concat(e?Object(c.t)("\u7ed1\u5b9a\u7248\u672c\u6210\u529f"):Object(c.t)("\u7248\u672c\u89e3\u7ed1\u6210\u529f"))),D&&D(),[3,4];case 3:throw o=l.sent(),Object(u.alertErrorMessage)(o),new Error(Object(u.getErrorMessage)(o.msg));case 4:return[2]}}))}))};return Object(n.useEffect)((function(){new Promise((function(e,t){if(j)e(!0);else{var n={};P&&(n["IGNORE-TEMPLATE-CHANGE-CHECK"]=!1),Object(s.fetchAllRelease)(a,r,n).then((function(t){var a=t.data,n=I(a),i=S([],y(n),!1).filter((function(e){return e.disabled})).map((function(e){return e.value}));H(i||[]),M(o()(_.concat(n),"value")),k(!0),setTimeout((function(){e(!0)}),0)})).catch((function(){t()}))}}))}),[]),A?i.a.createElement(d.default,{options:_,className:m.a.releaseSelect,placeholder:Object(c.t)("\u672a\u6307\u5b9a"),value:B,multiple:!0,onSelect:function(e){!function(e){g(void 0,void 0,void 0,(function(){var t,a,n,i;return E(this,(function(r){switch(r.label){case 0:return t=[],a=S([],y(B),!1),n=!a.includes(e),T?[4,V(n,[e])]:[3,2];case 1:r.sent(),r.label=2;case 2:return n?t=S(S([],y(a),!1),[e],!1):(i=a.findIndex((function(t){return t===e})),a.splice(i,1),t=a),U(t),null===w||void 0===w||w(t,_.filter((function(e){return t.includes(e.value)}))),[2]}}))}))}(e)},selectorCloseable:!1,onClear:function(){g(void 0,void 0,void 0,(function(){return E(this,(function(e){switch(e.label){case 0:return T?[4,V(!1,B.filter((function(e){return!Y.includes(e)})))]:[3,2];case 1:e.sent(),e.label=2;case 2:return U([]),null===w||void 0===w||w([],[]),[2]}}))}))},maxTagCount:2,optionRender:function(e){return e.disabled?i.a.createElement(h.Tooltip,{title:Object(c.t)("\u4e8b\u9879\u6240\u5728\u8fed\u4ee3\u5df2\u5f00\u542f\u4e0e\u7248\u672c\u300c")+e.label+Object(c.t)("\u300d\u7684\u540c\u6b65\uff0c\u6240\u4ee5\u672c\u4e8b\u9879\u4f1a\u5f3a\u5236\u5173\u8054\u5230\u5f53\u524d\u7248\u672c")},i.a.createElement("div",null,e.label)):i.a.createElement("div",null,e.label)}}):i.a.createElement(i.a.Fragment,null)}},MCRr:function(e,t,a){e.exports=a.p+"d28862ef9e6737fa2c34b93a212bd64d.svg"},MS49:function(e,t,a){e.exports={root:"root-3ANDwI2vVD",link:"link-1ZA6XOWTaH",avatar:"avatar-vCtyEx0YhF"}},MVjx:function(e,t,a){"use strict";a("I5cv"),a("mYba"),a("jm62"),a("EK0E");var n=a("TqRt"),i=a("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(a("o0o1")),o=n(a("RIqP")),s=n(a("yXPU")),l=n(a("lSNA")),c=n(a("lwsE")),u=n(a("W8MJ")),d=n(a("PJYZ")),f=n(a("7W2i")),p=n(a("a1gu")),m=n(a("Nsbk"));a("f3/d"),a("0l/t"),a("XfO3"),a("Btvt"),a("yt8O"),a("rGqo"),a("VRzm"),a("pIFo"),a("INYr"),a("0mN4"),a("hhXQ"),a("RW0V"),a("bWfx"),a("ioFf"),a("HEwt"),a("T39b"),a("L9s1"),a("Z2Ku"),a("OG14"),a("CX2u"),a("tUrg");var h,v,g,E,b=a("mVeg"),y=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!==typeof e)return{default:e};var a=xe(t);if(a&&a.has(e))return a.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=r?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}n.default=e,a&&a.set(e,n);return n}(a("cDcd")),S=a("h74D"),I=n(a("17x9")),T=a("dtw8"),C=n(a("qLOp")),P=n(a("TsYS")),w=n(a("qCZF")),D=n(a("WE/Q")),O=n(a("Yzhn")),R=a("nuIr"),j=n(a("QDR0")),k=n(a("AVuq")),N=n(a("wd/R")),A=a("FaIw"),L=a("AwMv"),F=a("w3Wo"),_=a("xgZS"),M=n(a("V/h/")),x=n(a("2KQ+")),B=n(a("Y+p1")),U=n(a("XLbL")),W=n(a("8+Mu")),Y=n(a("4qC0")),H=n(a("GoyQ")),V=n(a("UB5X")),G=n(a("Z0cm")),K=a("DKcV"),z=n(a("K2gz")),q=a("Z4vw"),Z=a("FpRC"),J=n(a("2CT0")),X=n(a("L8Eh")),Q=n(a("Th6D")),$=a("DgMC"),ee=a("885C"),te=a("sWxF"),ae=n(a("TT2u")),ne=a("5DNL"),ie=a("3RH6"),re=a("IecL"),oe=n(a("1lUc")),se=n(a("mSbZ")),le=n(a("htee")),ce=n(a("4Fdf")),ue=n(a("xM8l")),de=n(a("begU")),fe=n(a("0Zwn")),pe=n(a("W0/N")),me=n(a("HtPo")),he=n(a("Qkhu")),ve=n(a("HwxY")),ge=n(a("AoGB")),Ee=n(a("KUqB")),be=a("7bn+"),ye=a("/HD1"),Se=a("7FZc"),Ie=n(a("P5Jw")),Te=n(a("CF/V")),Ce=n(a("oIiO")),Pe=a("jzjO"),we=n(a("KIkv")),De=a("17N+"),Oe=a("9+7+"),Re=a("9+7+"),je=a("lGCG"),ke=n(a("WKBZ")),Ne=n(a("cHah")),Ae=n(a("DDpV")),Le=n(a("QWzU")),Fe=n(a("6yKH")),_e=a("cUHt"),Me=a("nuIr");function xe(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(xe=function(e){return e?a:t})(e)}function Be(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Ue(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Be(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Be(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function We(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,m.default)(e);if(t){var i=(0,m.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,p.default)(this,a)}}var Ye=(0,$.isSupportsPlaintextEdit)()?"plaintext-only":"true";var He=(h=(0,S.connect)((function(e){return{enterpriseGlobalKey:e.APP.enterprise.globalKey,enterpriseName:e.APP.enterprise.name,watermark:e.APP.enterprise.watermark,payed:e.APP.enterprise.payed,user:e.APP.user,isSensitiveAdmin:(0,K.checkSensitiveAdmin)(e.CURRENT_USER_ENTERPRISE_PERMISSION_NAMESPACE_FOR_REDUX_STORE.currentEnterprisePermissionList,e.CURRENT_USER_PROJECT_PERMISSION_NAMESPACE_FOR_REDUX_STORE.currentProjectPermissionList),currentProjectCooperateSettings:e.APP.currentProjectCooperateSettings,closedMenuKeys:e.PROJECT_FUNCTIONS.closedMenuKeys}})),(0,T.withRouter)(v=h(v=(0,se.default)(v=(0,le.default)(v=(0,ue.default)(v=(0,ce.default)(v=(0,ae.default)(v=(0,ne.FlashAnchorDecorator)(v=(0,ge.default)((E=g=function(e){(0,f.default)(a,e);var t=We(a);function a(e){var n;return(0,c.default)(this,a),(n=t.call(this,e)).isDeleteInFilePreview=!1,n.elemShow=function(){n.dataLoad=(0,pe.default)({elemInOrder:["reference","logs","comment"].filter((function(e){return e})),onRenderItem:function(e,t,a,i){n.setState({isRender:Ue({},i),isRenderAll:t},(function(){a(),t&&n.setState({controlCaculatePos:Date.now()})}))}}),n.dataLoad("comment")},n.titleInputRef=y.default.createRef(),n.scrollRef=y.default.createRef(),n.renderTitle=function(e,t,a){var i=n.state,r=i.detailInfoState,o=i.inputFocus;return y.default.createElement("div",{className:(0,z.default)(C.default.titleInputWrap,o&&t&&C.default.titleInputFocusWrap)},y.default.createElement("div",{className:(0,z.default)(C.default.titleInput,!e&&C.default.titleInputDisabled,t&&C.default.titleInputScrolled),ref:!a&&n.titleInputRef,onFocus:function(){n.setState({inputFocus:!0}),setTimeout((function(){(0,$.setFocus)(n.titleInputRef.current)}),0)},onBlur:function(){n.setState({inputFocus:!1}),n.handleInput(n.titleInputRef.current.innerText)},onKeyDown:function(e){"Enter"===e.key&&(e.preventDefault(),n.handleInput(n.titleInputRef.current.innerText))},contentEditable:e?Ye:"false",suppressContentEditableWarning:!0},r.name))},n.renderParentsInfo=function(){var e=n.state,t=e.tooltipTitle,a=e.detailInfoState,i=n.props.projectPath,r="".concat(i,"/program/risks/").concat(a.code,"/detail");return y.default.createElement("div",{className:C.default.detailId},y.default.createElement("span",{className:(0,z.default)(C.default.code,C.default.lastId,C.default.lastNumber)},y.default.createElement(T.Link,{to:r,className:(0,z.default)(C.default.code,C.default.number)},y.default.createElement(Ee.default,{type:a.issueTypeDetail.iconType}),"#",a.code),y.default.createElement(Se.TooltipTrigger,{title:t,onVisibleChange:n.onVisibleChange},y.default.createElement(Ie.default,{text:"".concat(window.location.origin).concat(i,"/program/risks/").concat(a.code,"/detail")},y.default.createElement("div",{className:C.default.copyIcon,onClick:n.onCopyClick})))),y.default.createElement("div",{className:(0,z.default)(C.default.code,C.default.lastId,C.default.lastNumber),style:{marginLeft:20,fontWeight:600}},"|",y.default.createElement("span",{style:{color:"red",margin:"0 5px"}},"GID"),"#",a.id,y.default.createElement(Se.TooltipTrigger,{title:t,onVisibleChange:n.copyGID},y.default.createElement(Ie.default,{text:a.id},y.default.createElement("div",{className:C.default.copyIcon,onClick:n.onCopyClick})))))},n.copyGID=function(){n.setState({tooltipTitle:(0,b.t)("\u590d\u5236")})},n.renderScrollTitle=function(e,t){var a=n.state,i=a.inputFocus,r=a.detailInfoState;return i?y.default.createElement(y.default.Fragment,null,n.renderTitle(e,!0,t)):y.default.createElement("div",{className:C.default.scrolledTitleWrap},y.default.createElement("div",{className:(0,z.default)(C.default.titleIconWrap,n.state.noHoverIcon&&C.default.noHoverIcon)},y.default.createElement(Ee.default,{type:r.issueTypeDetail.iconType}),y.default.createElement("div",{className:C.default.breadcrumb},n.renderParentsInfo())),n.renderTitle(e,!0,t))},n.onBtnClick=function(e){n["".concat(e.toLowerCase(),"BtnClicked")]&&n["".concat(e.toLowerCase(),"BtnClicked")]()},n.getEditComp=function(e){n.editComp=e},n.editStatusChanged=function(e,t){n.setState(Ue({isDesEditing:e,isShowItemPlaceholder:Ue(Ue({},n.state.isShowItemPlaceholder),{},{description:void 0!==t?t:!e})},e?{}:{isDescriptionBtnFixed:!1}),(function(){n.setState({controlCaculatePos:Date.now()})}))},n.scrollToAttechment=function(){var e,t,a;null!==(e=n.scrollRef)&&void 0!==e&&e.current&&null!==(t=n.attechmentRef)&&void 0!==t&&t.current&&null!==(a=n.headerRef)&&void 0!==a&&a.current&&(0,Z.scrollIntoView)(n.scrollRef.current,n.attechmentRef.current,-n.headerRef.current.offsetHeight)},n.handleReviewListChanged=function(){n.fetchIssueReviewList((function(e){0!==e.length?Z.scrollIntoView&&n.setState({activeLogTab:"approval"},(function(){(0,Z.scrollRelatedToTopMenu)("issue-review-list",0,n.scrollRef.current)})):n.setState({activeLogTab:"activity"})})),setTimeout((function(){n.getActivityList()}),1e3)},n.scrollToBottom=function(e){(0,Z.scrollRelatedToTopMenu)("bottom",0,n.scrollRef.current,e)},n.referencesBtnClicked=function(){"activity"===n.state.activeLogTab?n.changeActivityTabAndShow():n.setState({activeLogTab:"activity"},(function(){n.setCommentPosition((function(){setTimeout((function(){n.changeActivityTabAndShow()}),0)}))}))},n.changeActivityTabAndShow=function(){"WITHOUT_COMMENT"===n.state.activitiesTab?n.setState({activitiesTab:"ALL",isShowItemPlaceholder:Ue(Ue({},n.state.isShowItemPlaceholder),{},{reference:!0})},(function(){n.changeTabFn(["ALL"]),n.setCommentPosition((function(){n.doShowReference()}))})):n.doShowReference()},n.doShowReference=function(){n.props.autoToggleComment(n.state.detailInfoState.code,!0)},n.getNotUploadElems=function(){var e=n.state,t=e.isDesEditing,a=e.isCommentEditing;return[t&&n.editComp.containerRef.current,a&&n.commentEditorRef&&n.commentEditorRef.current]},n.dragEnterDes=function(e){n.dragEnter(e,"des")},n.dragEnterComment=function(e){n.dragEnter(e,"comment")},n.dragEnter=function(e,t){e.preventDefault(),e.stopPropagation(),n["des"===t?"intoDesCount":"intoCommentCount"]++},n.dragLeaveDes=function(e){n.dragLeave(e,"des")},n.dragLeaveComment=function(e){n.dragLeave(e,"comment")},n.dragLeave=function(e,t){e.preventDefault(),e.stopPropagation();var a="des"===t?"intoDesCount":"intoCommentCount";n[a]--,0===n[a]&&n.setState({notUpload:!1})},n.mouseLeaveDes=function(){n.mouseLeave("des")},n.mouseLeaveComment=function(){n.mouseLeave("comment")},n.fetchManHourRecords=function(){var e=n.props,t=e.currentProject.id,a=e.detailInfo.code;return(0,te.getManhourHistories)(t,a).then((function(e){var t=e.data;n.setState({manHourRecords:t})}))},n.fetchManHourRecordsAndFetchSpecData=(0,s.default)(r.default.mark((function e(){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.fetchManHourRecords();case 2:return e.next=4,n.changeAttributes({type:""});case 4:case"end":return e.stop()}}),e)}))),n.deleteManhourRecord=function(e,t){var a=n.props.currentProject.id;return(0,te.delManHourHistory)(a,e.id,t).then((0,s.default)(r.default.mark((function e(){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.fetchManHourRecordsAndFetchSpecData();case 1:case"end":return e.stop()}}),e)}))))},n.renderActivity=function(e){var t=n.state,a=t.isInited,i=t.activities,r=t.detailInfoState,o=t.activitiesTab,s=t.isCommentSticky,l=n.props,c=l.isDetail,u=l.currentProject,d=l.user,f=l.projectPath,p=l.domID;return y.default.createElement(k.default,{isInited:a,scrollRef:n.scrollRef,isDetail:c,currentProject:u,user:d,activities:i,projectPath:f,domID:p,flashAnchor:n.props.flashAnchor,itemType:"RISK",code:r.code,onPublishChildComment:n.postComment,editCommentCallback:n.handleEditCommentCallback,onDeleteComment:n.deleteComment,handleViewRecord:n.viewRecord,activeTab:[o],changeTab:function(e){return n.setState({activitiesTab:e},n.setCommentPosition)},getChangeTabFn:function(e){n.changeTabFn=e},isCommentSticky:s,hideTitle:e,handleEditComment:function(e){return n.setState({isEdittingCommentModalVisible:e})}})},n.changeActivityLogTab=function(e){n.setState({activeLogTab:e.value},(function(){n.setCommentPosition(),"approval"===e.value&&n.fetchIssueReviewList((function(e){0===e.length&&n.setState({activeLogTab:"activity"})}))}))},n.getDropdownPortalToRight=function(){return!n.props.isDetail&&!n.state.isFullScreen},n.doScroll=function(){if(!n.state.inputFocus){var e=n.scrollRef.current.scrollTop,t=n.state.isScrolled;e>100&&!t?n.setState({isScrolled:!0}):e<=100&&n.setState({isScrolled:!1})}},n.onAttrScroll=function(){n.setState({isElemScroll:!0})},n.getSensitiveMessage=function(e,t){return(0,re.getSensitive)(e,t).then((function(e){return 0===e.code?(n.setState({isSensitive:e.data.isSensitive}),e.data.isSensitive):null}))},n.getBasicInfo=function(){Promise.all([n.props.getRequirementTypes(),n.props.getBugTypes(),n.props.getRiskScheme(),n.getActivityList()].concat((0,o.default)(Re.enableIssueReview?[n.fetchIssueReviewList()]:[]))).then((function(){n.setState({isInited:!0})})),n.getIssueStatusTransfers(),n.fetchManHourRecords(),n.getResourceReference().then((function(){n.dataLoad("reference")}))},n.getTencentMeeting=function(){var e=n.props.currentProject.name,t=n.state.detailInfoState.code;(0,te.getTencentMeetingDetail)(e,t).then((function(e){n.setState({meeting:e.data})}))},n.caculateDetailEleHeight=function(){return new Promise((function(e){n.doCaculate(-1,e)}))},n.doCaculate=function(e,t){if(n.detailBodyRef.current){var a=n.detailBodyRef.current.offsetHeight;a!==e?setTimeout((function(){n.doCaculate(a,t)}),300):t(a)}},n.setCommentPosition=function(){var e=(0,s.default)(r.default.mark((function e(t){var a,i,o,s,l;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n.scrollRef&&n.scrollRef.current&&n.hiddenHeaderRef.current&&n.detailBodyRef.current)){e.next=7;break}return e.next=3,n.caculateDetailEleHeight();case 3:o=e.sent,s=n.scrollRef.current.offsetHeight-n.hiddenHeaderRef.current.offsetHeight,l=(null===(a=n.commentEditorRef)||void 0===a||null===(i=a.current)||void 0===i?void 0:i.offsetHeight)||140,n.setState(Ue({isCommentSticky:o+l>=s},o+l<s?{isDescriptionBtnFixed:!1,isCommentAbsBottom:!1}:{}),(function(){if(n.state.isCommentSticky&&(setTimeout((function(){var e=n.hiddenHeaderRef.current.offsetHeight+(n.detailBodyRef.current.offsetHeight<s?s:n.detailBodyRef.current.offsetHeight);n.setState({isCommentAbsBottom:n.scrollRef.current.offsetHeight-e>=0,minHeight:s})}),0),n.state.isDesEditing)){var e=n.editorRef.current.offsetHeight+24,a=n.scrollRef.current.offsetHeight-n.hiddenHeaderRef.current.offsetHeight-44;n.setState({isDescriptionBtnFixed:e>=a})}"function"===typeof t&&t()}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.actionCallback=function(){var e=n.props.isDetail;n.getActivityList(),e||n.props.updateCallback()},n.renewDescription=function(e){var t=e.historyId,a=e.issueLogId,i=e.description,r=n.props.currentProject,o=n.state.detailInfoState;return(0,F.rollbackDescription)(r.id,o.code,a).then((function(){n.setState({historyId:t,description:i,isDescriptionEmpty:!i.replace(/\n|\s/g,"")}),n.getActivityList(),n.getResourceReference()}))},n.sensitiveCtrl=function(){var e=n.state.isSensitive,t=n.props,a=t.detailInfo,i=t.currentProject;e?n.setState({showDeleteModal:!0}):(0,re.addSensitive)(a.code,i.name).then((function(e){0===e.code&&((0,_.success)((0,b.t)("\u6807\u8bb0\u6210\u529f\uff01")),n.getSensitiveMessage(a.code,i.name))}))},n.cancelMark=function(){var e=n.props,t=e.detailInfo,a=e.currentProject;(0,re.cancelSensitive)(t.code,a.name).then((function(e){n.setState({showDeleteModal:!1}),0===e.code&&((0,_.success)((0,b.t)("\u53d6\u6d88\u6807\u8bb0\u6210\u529f\uff01")),n.getSensitiveMessage(t.code,a.name))}))},n.handleAttentionChange=function(e){n.changeAttributes({type:"watchers",value:e})},n.handleSelfChange=function(e){var t=n.props,a=t.currentProject,i=t.user,r=n.state,s=r.detailInfoState,l=r.watchers;e?(0,ye.watchRisk)(a.name,s.code).then((function(){n.setState({watchers:[].concat((0,o.default)(l),[i])}),(0,_.success)((0,b.t)("\u66f4\u65b0\u6210\u529f")),n.callback(),n.getActivityList()})):(0,ye.unWatchRisk)(a.name,s.code).then((function(){n.setState({watchers:(0,o.default)(l.filter((function(e){return e.id!==i.id})))}),(0,_.success)((0,b.t)("\u66f4\u65b0\u6210\u529f")),n.callback(),n.getActivityList()}))},n.onIsFullWidthChange=function(e){n.setState({isFullWidth:e})},n.toggleFullScreenStatus=function(){var e=!n.state.isFullScreen;n.setState({isFullScreen:e}),(0,De.setIsSlideFullScreen)(e),n.props.onFullScreenChange&&n.props.onFullScreenChange(e)},n.handleFullScreenKey=function(e){n.state.isDesEditing||e.target===document.body&&"f"===e.key.toLowerCase()&&n.toggleFullScreenStatus()},n.state={tooltipTitle:(0,b.t)("\u590d\u5236\u94fe\u63a5"),noHoverIcon:!1,detailInfoState:e.detailInfo,activities:[],description:e.detailInfo.descriptionMarkup,isDescriptionEmpty:!e.detailInfo.description.replace(/\n|\s/g,""),markdown:e.detailInfo.description,slateRaw:e.detailInfo.slateRaw,showCopyModal:!1,attachmentsState:n.combineThirdLinks(e.detailInfo.files,e.detailInfo.thirdLinks),isFilePreviewVisible:void 0,previewFileID:void 0,attributes:{assignee:void 0,priority:void 0,requirementType:void 0,defectType:void 0,module:void 0,startDate:void 0,dueDate:void 0,workingHours:void 0,labels:[],watchers:[],fields:{},progress:void 0},assignee:e.detailInfo.assignee,watchers:e.detailInfo.watchers||[],riskStatusTransfers:[],isInited:!1,isHistoryRecordVisible:!1,currentLogId:void 0,showSideslip:!1,isSensitive:!1,showDeleteModal:!1,activitiesTab:"ALL",activeLogTab:"activity",isCommentSticky:!1,isCommentAbsBottom:!1,isScrolled:!1,inputFocus:!1,isDesEditing:!1,isFullScreen:(0,De.getIsSlideFullScreen)(),isFullWidth:!0,isShowItemPlaceholder:{description:!0,reference:!1},isRender:{reference:!1,logs:!1,comment:!1},isRenderAll:!1,delFileId:void 0,showDeleteConfirmModal:!1,isElemScroll:!1,scrollControl:Date.now(),meeting:void 0,isEdittingCommentModalVisible:!1,manHourRecords:[],controlHideButtonActionMore:0,controlHideOptionMore:0,isShowApproveCreate:!1,issueReviewList:[],pageId:e.detailInfo.pageId||void 0,historyId:void 0,controlCaculatePos:0,isDescriptionBtnFixed:!1,identity:"",slotVisible:!1},n.onVisibleChange=n.onVisibleChange.bind((0,d.default)(n)),n.onCopyClick=n.onCopyClick.bind((0,d.default)(n)),n.updateDescription=n.updateDescription.bind((0,d.default)(n)),n.onNameChange=n.onNameChange.bind((0,d.default)(n)),n.callback=n.callback.bind((0,d.default)(n)),n.deleteRisk=n.deleteRisk.bind((0,d.default)(n)),n.updateRisk=n.updateRisk.bind((0,d.default)(n)),n.postComment=n.postComment.bind((0,d.default)(n)),n.deleteComment=n.deleteComment.bind((0,d.default)(n)),n.fileUploadSpec=n.fileUploadSpec.bind((0,d.default)(n)),n.onFileDropSuccessSpec=n.onFileDropSuccessSpec.bind((0,d.default)(n)),n.onFileDropDeleteSpec=n.onFileDropDeleteSpec.bind((0,d.default)(n)),n.onFileDropCancelSpec=n.onFileDropCancelSpec.bind((0,d.default)(n)),n.onFileDropFailSpec=n.onFileDropFailSpec.bind((0,d.default)(n)),n.filePreviewHideSpec=n.filePreviewHideSpec.bind((0,d.default)(n)),n.previewItem=n.previewItem.bind((0,d.default)(n)),n.handleDelInPreviewFileSpec=n.handleDelInPreviewFileSpec.bind((0,d.default)(n)),n.onStatusChange=n.onStatusChange.bind((0,d.default)(n)),n.submitTitleChange=n.submitTitleChange.bind((0,d.default)(n)),n.changeAttributes=n.changeAttributes.bind((0,d.default)(n)),n.getIssueStatusTransfers=n.getIssueStatusTransfers.bind((0,d.default)(n)),n.getResourceReference=n.getResourceReference.bind((0,d.default)(n)),n.onRemoveReference=n.onRemoveReference.bind((0,d.default)(n)),n.toggleRecord=n.toggleRecord.bind((0,d.default)(n)),n.viewRecord=n.viewRecord.bind((0,d.default)(n)),n.openSlideslip=n.openSlideslip.bind((0,d.default)(n)),n.closeSlideslip=n.closeSlideslip.bind((0,d.default)(n)),n.handleDeleteAttachmentConfirm=n.handleDeleteAttachmentConfirm.bind((0,d.default)(n)),n.handleEditCommentCallback=n.handleEditCommentCallback.bind((0,d.default)(n)),n.commentEditorRef=null,n.intoDesCount=0,n.intoCommentCount=0,n.commentStickyContainerRef=null,n.onScroll=n.onScroll.bind((0,d.default)(n)),n.desComp=null,n.headerRef=y.default.createRef(),n.hiddenHeaderRef=y.default.createRef(),n.detailBodyRef=y.default.createRef(),n.desComp=null,n.attechmentRef=y.default.createRef(),n.changeTabFn=null,n.editorRef=y.default.createRef(),n.elemShow(),n}return(0,u.default)(a,[{key:"headerRender",value:function(e){var t=this,a=this.state,n=a.detailInfoState,i=a.watchers,r=a.isSensitive,o=a.showDeleteModal,s=a.isDesEditing,l=a.isFullWidth,c=a.inputFocus,u=a.isFullScreen,d=!e&&this.state.isScrolled,f=this.props,p=f.projectPath,m=f.isDetail,h=f.riskList,v=f.isPermissible,g=f.user,E=f.location.query,S=f.currentProject,I=f.currentProjectCooperateSettings,T=f.browserRouter,P=f.isSensitiveAdmin,w=f.payed,D=f.callFrom,O=f.detailInfo,k="outer"===D,N=S.name,A=h&&h.findIndex((function(e){return e.code===n.code}))+1,L=1===A,F=A===(h&&h.length),_=v([{function:K.ProjectPermissionFunction.PROJECT_ISSUE,action:K.ProjectPermissionAction.UPDATE}]),M="".concat(p,"/program/risks/"),x=(0,Oe.getAuidtPaymentState)(),B={DESCRIPTION:_,UPLOAD:_,REFERENCES:!0,ISSUE_REVIEW:Re.enableIssueReview&&_},U=Ue({},s?{DESCRIPTION:""}:{}),W={};e&&(W.position="static",W.visibility="hidden");var Y=(0,_e.getSlotContext)(O,S.id);return y.default.createElement("div",{className:(0,z.default)(C.default.specHeader,m&&C.default.detail,this.state.inputFocus&&d&&C.default.scrollFocus,d&&!s&&C.default.fixed,d&&C.default.noBorder),ref:e?this.hiddenHeaderRef:this.headerRef,style:W},y.default.createElement("div",{className:(0,z.default)(C.default.main,d?C.default.fixed:"",u?C.default.fullScreenMain:"",m?C.default.detail:"")},y.default.createElement("div",{className:(0,z.default)(C.default.headerPanelMenuWrapper,c&&C.default.focus)},d?y.default.createElement("div",{className:C.default.scrolledTitleInnerWrap,style:{marginRight:c?0:"15px"}},this.renderScrollTitle(_,e)):this.renderParentsInfo(),y.default.createElement("div",{className:(0,z.default)(C.default.menus,d&&c&&C.default.hide)},y.default.createElement(Q.default,{type:"RISK",projectID:S.id,watchers:i||[],onChange:this.handleAttentionChange,user:g,showTooltip:!0,readOnly:!_,handleSelfChange:this.handleSelfChange}),!m&&h&&!k&&y.default.createElement("div",{className:C.default.divideLine}),!m&&h&&!k&&y.default.createElement("div",{className:"".concat(C.default.preButton," ").concat(L&&C.default.disabled),onClick:function(){return!L&&T.push({pathname:"".concat(M).concat(h[A-2].code),query:Ue({},E)})}}),!m&&h&&!k&&y.default.createElement("div",{className:"".concat(C.default.nextButton," ").concat(F&&C.default.disabled),onClick:function(){return!F&&T.push({pathname:"".concat(M).concat(h[A].code),query:Ue({},E)})}}),y.default.createElement("div",{className:C.default.divideLine}),!m&&y.default.createElement(Se.TooltipTrigger,{title:this.state.isFullScreen?(0,b.t)("\u5207\u6362\u5230\u4fa7\u680f(F)"):(0,b.t)("\u5168\u5c4f(F)")},y.default.createElement("div",{className:this.state.isFullScreen?C.default.cancelFullScreenBtn:C.default.toFullScreenBtn,onClick:this.toggleFullScreenStatus})),!m&&y.default.createElement(Se.TooltipTrigger,{title:(0,b.t)("\u5728\u65b0\u6807\u7b7e\u9875\u6253\u5f00")},y.default.createElement("div",{className:C.default.openNewLink,onClick:function(){window.open("".concat(p,"/program/risks/").concat(n.code,"/detail"),"_blank")}})),y.default.createElement(j.default,{deleteFunction:this.deleteRisk,hasParent:!!n.parent,hasEpic:!!n.epic,currentProject:S,currentProjectCooperateSettings:I,premiumVersion:!x||w,isSensitiveAdmin:P,isSensitive:r,sensitiveCtrlFunction:this.sensitiveCtrl,isShowFullWidthOption:m||!m&&this.state.isFullScreen,isPermissible:v,viewDescriptionVersion:function(){return t.setState({isHistoryRecordVisible:!0})},copyTitle:n.name,copyLink:"".concat(window.location.origin).concat(p,"/program/risks/").concat(n.code,"/detail"),isFullWidth:l,onIsFullWidthChange:this.onIsFullWidthChange,type:"RISK",issueTypeDetail:n.issueTypeDetail,controlHideMore:this.state.controlHideOptionMore,onClickTrigger:function(){t.setState({controlHideButtonActionMore:Date.now()})},slotCallback:function(e){return t.setState({identity:e,slotVisible:!0})}}),y.default.createElement(oe.default,{title:(0,b.t)("\u786e\u5b9a\u8981\u53d6\u6d88\u6807\u8bb0"),show:o,onConfirm:this.cancelMark,onClose:function(){t.setState({showDeleteModal:!1})}}))),!d&&this.renderTitle(_,!1,e),(!d||d&&!c)&&y.default.createElement(de.default,{issueType:R.ISSUE_TYPE.RISK,isShow:B,isDisabled:U,onBtnClick:this.onBtnClick,uploadProps:{disabled:!_,currentAttachmentNum:this.state.attachmentsState.length,onHandleAttachments:this.fileUploadSpec},issueStatus:n.issueStatus.type,issueCode:n.code,projectName:N,userId:g.id,projectPath:p,posType:d,isLoaded:!0,controlHideMore:this.state.controlHideButtonActionMore,slotContext:Y,onClickTrigger:function(){t.setState({controlHideOptionMore:Date.now()})}})))}},{key:"descriptionBtnClicked",value:function(){var e=this,t=this.editComp;t.show().then((function(){e.setState({isShowItemPlaceholder:Ue(Ue({},e.state.isShowItemPlaceholder),{},{description:!1})},(function(){var a,n,i;null!==(a=e.scrollRef)&&void 0!==a&&a.current&&null!==(n=t.containerRef)&&void 0!==n&&n.current&&null!==(i=e.headerRef)&&void 0!==i&&i.current&&(0,Z.scrollIntoView)(e.scrollRef.current,t.containerRef.current,-e.headerRef.current.offsetHeight-26),t.onHandle()}))}))}},{key:"fetchIssueReviewList",value:function(e){var t=this,a=this.props,n=a.currentProject,i=a.detailInfo;(0,je.fetchIssueReviewList)(n.id,i.code).then((function(a){var n=a.data;t.setState({issueReviewList:n},(function(){e&&e(n)}))}))}},{key:"issue_reviewBtnClicked",value:function(){this.setState({isShowApproveCreate:!0})}},{key:"mouseLeave",value:function(e){this["des"===e?"intoDesCount":"intoCommentCount"]=0,this.setState({notUpload:!1})}},{key:"render",value:function(){var e=this,t=this.state,a=t.detailInfoState,n=t.markdown,i=t.slateRaw,r=t.description,o=t.citedSources,s=t.citingSources,l=t.activities,c=t.attachmentsState,u=t.isFilePreviewVisible,d=t.previewFileID,f=t.isInited,p=t.isHistoryRecordVisible,m=t.currentLogId,h=t.showSideslip,v=t.activitiesTab,g=t.isCommentSticky,E=t.isFullWidth,S=t.isShowItemPlaceholder,I=t.isRender,T=t.isRenderAll,P=t.activeLogTab,j=t.showDeleteConfirmModal,k=t.isEdittingCommentModalVisible,N=t.manHourRecords,A=t.pageId,L=t.historyId,F=t.isDescriptionEmpty,_=t.minHeight,M=t.isDescriptionBtnFixed,B=t.identity,U=t.slotVisible,Y=this.props,H=Y.expanded,V=Y.isDetail,G=Y.currentProject,q=Y.user,Z=Y.enterpriseGlobalKey,X=Y.isPermissible,Q=Y.autoshowComment,$=Y.domID,te=Y.location,ae=Y.riskSchemeFieldArchives,ne=Y.detailInfo,ie=G.name,re=G.id,oe=(0,_e.getSlotContext)(ne,re),se=void 0!==ae&&Object.values(ae).filter((function(e){return"HOUR_RECORD"===e.issueField.type})).length>0,le=X([{function:K.ProjectPermissionFunction.PROJECT_ISSUE,action:K.ProjectPermissionAction.UPDATE}]),ce=this.state.notUpload&&(this.state.isDesEditing||this.state.isCommentEditing)||k||h,ue=g?{minHeight:"".concat(_,"px"),position:"relative"}:{position:"relative"},de=Re.enableIssueReview&&this.state.issueReviewList.length>0,pe=[];I.logs&&pe.push({text:(0,b.t)("\u6d3b\u52a8\u65e5\u5fd7"),value:Me.MATTER_TABS_TYPE.ACTIVITY}),se&&pe.push({text:(0,b.t)("\u5de5\u65f6\u65e5\u5fd7"),value:Me.MATTER_TABS_TYPE.WORK}),de&&pe.push({text:(0,b.t)("\u5ba1\u6279"),value:Me.MATTER_TABS_TYPE.APPROVAL});var ge=I.comment&&P!==Me.MATTER_TABS_TYPE.WORK&&P!==Me.MATTER_TABS_TYPE.APPROVAL&&l.length>0&&v!==Me.ACTIVITIES_TAB.WITHOUT_COMMENT;return y.default.createElement(fe.default,{currentAttachmentNum:c.length,onHandleAttachments:this.fileUploadSpec,notUpload:ce,notUploadElems:this.getNotUploadElems(),onIntoUploadElems:function(){return e.setState({notUpload:!0})}},y.default.createElement(ve.default.Provider,{value:{scrollControl:this.state.scrollControl}},y.default.createElement("div",{className:C.default.specWrapper,onScroll:this.onAttrScroll,id:"scroll-attr-wrap"},y.default.createElement("div",{className:(0,z.default)(C.default.specDetail,V?C.default.isDetail:"",E&&C.default.isFullWidth)},this.headerRender(),this.headerRender(!0),y.default.createElement("div",{className:C.default.specMain,ref:this.scrollRef},y.default.createElement("div",{style:ue,className:(0,z.default)(C.default.detailWrapper,V&&C.default.isDetail)},y.default.createElement("div",{className:"".concat(C.default.detailBody," ").concat(!H&&V&&C.default.isDetail," ").concat(E&&C.default.isFullWidth),ref:this.detailBodyRef,onClick:function(){return e.setState({controlHideButtonActionMore:Date.now()})}},y.default.createElement("div",{className:"".concat(C.default.mainWrapper," ").concat(H&&C.default.mainExpanded)},y.default.createElement("div",{onDragEnter:this.dragEnterDes,onDragLeave:this.dragLeaveDes,onMouseLeave:this.mouseLeaveDes,ref:this.editorRef},y.default.createElement(w.default,{editorType:ne.issueDescriptionType,issueId:ne.id,isInited:f,scrollRef:this.scrollRef,readOnly:!le,autoSaveKey:"".concat(ie,"_RISK_DETAIL_DESCRIPTION-").concat(a.code),updateDescription:this.updateDescription,refreshActivity:function(){return e.getActivityList()},currentProject:G,markdown:n,slateRaw:i,code:a.code,description:r,updatePageId:function(t){return e.setState({pageId:t})},historyId:L,flashAnchor:this.props.flashAnchor,domID:$,enterpriseGlobalKey:Z,getThis:this.getEditComp,editStatusChanged:this.editStatusChanged,isShowPlaceholder:F&&S.description,location:te,userId:q.id,pageId:A,setCommentPosition:this.setCommentPosition,onLoad:function(t){e.dataLoad("description"),t&&e.setState({isDescriptionEmpty:t.isEmpty})},isDescriptionBtnFixed:M})),c.length>0&&y.default.createElement("div",{className:C.default.sectionWrapper,ref:this.attechmentRef},y.default.createElement(ee.ThemeConsumer,null,(function(t){var n=t.hiddenFolderDirs;return y.default.createElement(W.default,{expanded:H,disabled:!le,attachments:c,enterpriseGlobalKey:Z,currentProjectName:ie,currentProjectID:re,currentAttachmentNum:c.length,issueCode:a.code,onHandleAttachments:e.fileUploadSpec,uploadFileSuccess:e.onFileDropSuccessSpec,uploadFileFailed:e.onFileDropFailSpec,uploadFileDelete:e.onFileDropDeleteSpec,uploadFileCancel:e.onFileDropCancelSpec,dir:n&&n[R.HIDDEN_FILE_TYPE.RISK]&&n[R.HIDDEN_FILE_TYPE.RISK].file_id,previewItemHandle:e.previewItem,userID:q.id})}))),I.reference&&(Object.keys(o).length>0||Object.keys(s).length>0||S.reference)&&y.default.createElement("div",{className:C.default.sectionWrapper},y.default.createElement(D.default,{flashAnchor:function(t){e.setState({activeLogTab:"activity"},(function(){e.props.flashAnchor(t)}))},currentProject:G,citedSources:o,citingSources:s,markdown:n,autoToggleComment:this.referencesBtnClicked,code:a.code,onRemoveReference:this.onRemoveReference})),pe.length>=2&&y.default.createElement(y.default.Fragment,null,y.default.createElement("div",{id:"activity-log-tab"}),y.default.createElement(Te.default,{tabs:pe,activeTab:P,onChange:this.changeActivityLogTab})),I.logs&&y.default.createElement(y.default.Fragment,null,"activity"===P&&this.renderActivity(se),se&&"work"===P&&y.default.createElement(Ce.default,{detailInfo:a,records:N,onDelete:this.deleteManhourRecord,reloadData:this.fetchManHourRecordsAndFetchSpecData,allowUpdate:le})),de&&"approval"===P&&y.default.createElement(ke.default,{isDetail:V,list:this.state.issueReviewList,onItemChange:this.handleReviewListChanged,onShowCreate:function(){e.setState({isShowApproveCreate:!0})},onShowDetail:function(t){e.setState({issueReviewCode:t})},allowUpdate:le}))))),u&&y.default.createElement(x.default,{isShown:u,previewFiles:c,onFileViewerHide:this.filePreviewHideSpec,enterpriseGlobalKey:Z,currentId:re,currentProjectName:ie,currentFileId:d,onHandleDelAttachment:this.handleDeleteAttachmentConfirm}),p&&y.default.createElement(J.default,{show:p,closeHandle:this.toggleRecord,enterpriseGlobalKey:Z,currentProject:G,issueType:R.HISTORY_RESCORDS[a.type],issueCode:a.code,pageId:A,currentLogId:m,handleUpdate:this.renewDescription,allowUpdate:le}),this.state.isShowApproveCreate&&y.default.createElement(Ne.default,{fromIssueId:this.props.detailInfo.id,onItemChange:this.handleReviewListChanged,onCancel:function(){return e.setState({isShowApproveCreate:!1})}}),this.state.issueReviewCode&&y.default.createElement(Ae.default,{allowUpdate:le,detailCode:this.state.issueReviewCode,onDetailCodeChange:function(t){e.setState({issueReviewCode:t})},onCancel:function(){e.setState({issueReviewCode:void 0},(function(){e.handleReviewListChanged()}))}}),y.default.createElement(Le.default,{slotVisible:U,identity:B,context:oe,onClose:function(){return e.setState({slotVisible:!1})}}),!T&&y.default.createElement(me.default,null),y.default.createElement("div",{id:"bottom"}),ge&&y.default.createElement(O.default,{issueType:"RISK",autoToggleComment:this.props.autoToggleComment,autoshowComment:!!Q[a.code],expanded:H,currentProject:G,avatar:q.avatar,issueCode:a.code,onPostComment:this.postComment,isCommentSticky:g,isCommentAbsBottom:this.state.isCommentAbsBottom,onEditStatusChanged:function(t,a){e.commentEditorRef=a,e.setState({isCommentEditing:t})},onDragEnterEditor:this.dragEnterComment,onDragLeaveEditor:this.dragLeaveComment,onMouseLeaveEditor:this.mouseLeaveComment,isDetail:V,userID:q.id,isDescriptionBtnFixed:M,onRef:function(t){return e.commentStickyContainerRef=t}})),h?y.default.createElement("div",{className:(0,z.default)(C.default.specAttribute,V||!V&&this.state.isFullScreen?C.default.isDetail:C.default.isSpec,E&&C.default.isFullWidth)}):this.renderAttributes(),y.default.createElement(he.default,{show:j,type:"ATTACHMENT",text:(0,b.t)("\u786e\u5b9a\u8981\u5220\u9664\u5417\uff1f"),onConfirm:function(){e.handleDelInPreviewFileSpec()},onClose:function(){e.setState({showDeleteConfirmModal:!1})}}))))}},{key:"isAssignAttrRequired",value:function(e){if(!e)return!1;var t=!1;return Object.keys(e).forEach((function(a){var n=e[a]&&e[a].issueField;n&&"ASSIGNEE"===n.type&&(t=e[a].required)})),t}},{key:"renderAttributes",value:function(){var e=this,t=this.props,a=t.isDetail,n=t.isPermissible,i=t.expanded,r=t.riskSchemeFieldArchives,o=t.riskUpdateFieldIDs,s=t.currentProject,l=t.bugTypes,c=t.requirementTypes,u=t.moduleSchemes,d=t.labels,f=t.addLabel,p=t.detailInfo,m=t.issueCode,h=this.state,v=h.detailInfoState,g=h.attributes,E=h.assignee,S=h.watchers,I=h.isFullWidth,T=h.isInited,w=h.meeting,D=(0,_e.getSlotContext)(p,s.id),O=n([{function:K.ProjectPermissionFunction.PROJECT_ISSUE,action:K.ProjectPermissionAction.UPDATE}]);return y.default.createElement("div",{className:(0,z.default)(C.default.specAttribute,a||!a&&this.state.isFullScreen?C.default.isDetail:C.default.isSpec,I&&C.default.isFullWidth)},"outer"===this.props.callFrom&&y.default.createElement("div",{className:(0,z.default)(C.default.issueProperty,a&&C.default.isDetail)},y.default.createElement("div",{className:(0,z.default)(C.default.label,a&&C.default.isDetail)},(0,b.t)("\u9879\u76ee\u96c6")),y.default.createElement("div",{className:(0,z.default)(C.default.customBar,a&&C.default.isDetail)},y.default.createElement(we.default,{name:this.props.currentProject.display_name,icon:this.props.currentProject.icon,jumpUrl:this.props.currentProject.project_path}))),void 0!==w&&y.default.createElement("div",{className:(0,z.default)(C.default.meetingNotify,w.status===R.MEETING_STATUS.processing?C.default.processing:C.default.waiting)},y.default.createElement("div",{className:C.default.title},"QUICK"===w.type?"".concat(w.creator.name).concat((0,b.t)("\u7684\u5feb\u901f\u4f1a\u8bae")):w.subject),y.default.createElement("div",{className:C.default.desc},(0,A.timeFormat)(w.startTime,"MM\u6708DD\u65e5"),y.default.createElement("span",{className:C.default.time},(0,A.timeFormat)(w.startTime,"HH:mm"),y.default.createElement("span",{className:C.default.line},"-"),(0,A.timeFormat)(w.endTime,"HH:mm")),y.default.createElement("div",{className:(0,z.default)(C.default.enterMeeting,a?C.default.isDetail:""),onClick:function(){window.open(w.joinUrl,"_blank")}},(0,b.t)("\u8fdb\u5165\u4f1a\u8bae")))),y.default.createElement("div",{className:(0,z.default)(C.default.issueProperty,a&&C.default.isDetail)},y.default.createElement("div",{className:(0,z.default)(C.default.label,a&&C.default.isDetail)},(0,b.t)("\u72b6\u6001")),y.default.createElement(P.default,{className:(0,z.default)(C.default.step,C.default.customBar,a&&C.default.isDetail),value:v.issueStatus,onSelect:this.onStatusChange,disabled:!O,isDetail:a,hoverControlArrow:!0,labelSize:"default",projectID:s.id,project:s,issueCode:m})),y.default.createElement("div",{className:(0,z.default)(C.default.issueProperty,a&&C.default.isDetail)},y.default.createElement("div",{className:(0,z.default)(C.default.label,a&&C.default.isDetail,this.isAssignAttrRequired(r)&&C.default.required)},(0,b.t)("\u5904\u7406\u4eba")),y.default.createElement("div",{className:(0,z.default)(C.default.customBar,a&&C.default.isDetail)},y.default.createElement(X.default,{disabled:!O,value:g.assignee||null,inProject:!0,projectID:s.id,onSelect:function(t){return e.changeAttributes({type:"assignee",value:t.value})},onClear:function(){return e.changeAttributes({type:"assignee"})},triggerExtraProps:{initialSelectedItem:E}}))),y.default.createElement("div",{className:C.default.splitLine,style:{marginTop:"16px"}}),T&&y.default.createElement(U.default,{user:this.props.user,expanded:i,className:C.default.issueProperties,isCreate:!1,schemeFieldArchives:r,fieldIds:o,issueType:"RISK",onChange:this.changeAttributes,customAttributes:g,assignee:E,watchers:S,isFromDetailPage:a||i,isDetailPage:a,permissionFunction:K.ProjectPermissionFunction.PROJECT_ISSUE,isPermissible:n,projectID:s.id,currentProject:s,bugTypes:l,requirementTypes:c,moduleSchemes:u,labels:d,addLabel:f,detailInfo:p,activities:this.state.activities,onManHourUpdate:function(){e.fetchManHourRecords().then((function(){e.changeAttributes({type:""})}))},onForwardLogs:function(){(0,Z.scrollRelatedToTopMenu)("activity-log-tab",200,e.scrollRef.current),e.setState({activeLogTab:"work"})},portalProps:{toRight:this.getDropdownPortalToRight(),portalWrapStyle:{zIndex:1099},isScroll:this.state.isElemScroll,resetIsScroll:function(){e.setState({isElemScroll:!1})}},meetingCallback:function(t){e.setState({meeting:t}),e.getActivityList()}}),y.default.createElement("div",{className:(0,z.default)(C.default.createTime,C.default.creatorInfo),title:"".concat(v.creator.name).concat((0,b.t)(" \u521b\u5efa\u4e8e ")).concat((0,N.default)((0,A.timeFormat)(v.createdAt,"YYYY-MM-DD HH:mm:ss")).fromNow())},v.creator.name," ",(0,b.t)("\u521b\u5efa\u4e8e")," ",(0,N.default)((0,A.timeFormat)(v.createdAt,"YYYY-MM-DD HH:mm:ss")).fromNow()),y.default.createElement(Fe.default,{context:D}))}},{key:"onScroll",value:function(e){var t=this.state,a=t.isDesEditing,n=t.isDescriptionBtnFixed;if(a){var i,r,o=this.scrollRef.current.scrollTop,s=this.scrollRef.current.getBoundingClientRect().height,l=this.editorRef.current.getBoundingClientRect().height,c=(null===(i=this.commentStickyContainerRef)||void 0===i||null===(r=i.current)||void 0===r?void 0:r.offsetHeight)||0;n=l>=s+o-this.headerRef.current.offsetHeight-c}this.setState({scrollControl:Date.now(),isDescriptionBtnFixed:n}),clearTimeout(this.scrollRunId),e.stopPropagation(),this.scrollRunId=setTimeout(this.doScroll,50)}},{key:"componentDidMount",value:function(){var e=this.props,t=e.user,a=e.watermark,n=e.payed,i=e.isDetail,r=e.params.subIssueCode,o=e.detailInfo,s=e.getLabels,l=e.isSensitiveAdmin;this.scrollRef.current&&this.scrollRef.current.addEventListener("scroll",this.onScroll,!1);var c=(0,Oe.getAuidtPaymentState)(),u=(0,Oe.getWatermarkPaymentState)(),d=this.state.detailInfoState;if(s&&s(),i&&r&&this.openSlideslip(),this.initAttributesData(o),this.getBasicInfo(),o.pageId?this.state.isDescriptionEmpty&&this.dataLoad("description"):this.dataLoad("description"),!u||n){var f=(0,ie.getText)(t);(0,ie.watermarkService)(a,f,i)}c&&!n||(l&&this.getSensitiveMessage(o.code,this.props.currentProject.name),(0,re.track)({projectName:this.props.currentProject.name,pageIdentifier:"RISK_DETAIL",code:d.code})),document.addEventListener("keyup",this.handleFullScreenKey)}},{key:"handleInput",value:function(e){var t=(0,M.default)(this.state.detailInfoState,(function(t){t.name=e}));this.setState({detailInfoState:t},this.submitTitleChange)}},{key:"componentWillUnmount",value:function(){var e=this.props,t=e.payed,a=e.isDetail;(0,Oe.getWatermarkPaymentState)()&&!t||(0,ie.removeWatermark)(a),document.removeEventListener("keyup",this.handleFullScreenKey)}},{key:"componentDidUpdate",value:function(e,t){var a=this.props,n=a.params,i=a.detailInfo,r=a.issueCode,o=a.isDetail,s=e.params,l=e.detailInfo,c=t.controlCaculatePos,u=this.state.controlCaculatePos;(0,B.default)(s,n)||(s.riskCode!==n.riskCode&&(this.getIssueStatusTransfers(),this.props.getRiskScheme()),o&&n.subIssueCode?this.openSlideslip():this.closeSlideslip()),(0,B.default)(i,l)||this.updateDetailInfo(r,i),u!==c&&0!==u&&this.setCommentPosition()}},{key:"updateDetailInfo",value:function(e,t){var a=this;this.setState(Ue({detailInfoState:t,attachmentsState:(0,o.default)(t.files)},this.isDeleteInFilePreview?{isFilePreviewVisible:!1}:null),(function(){a.isDeleteInFilePreview=!1,a.initAttributesData(t)}))}},{key:"initAttributesData",value:function(e){this.setState({attributes:{assignee:e.assignee&&e.assignee.id||void 0,priority:void 0!==e.priority?e.priority:void 0,defectType:e.defectType&&e.defectType.id||void 0,projectModule:e.projectModule&&e.projectModule.id||void 0,requirementType:e.requirementType&&e.requirementType.id||void 0,dueDate:e.dueDate||void 0,startDate:e.startDate||void 0,labels:e.labels&&!!e.labels.length&&e.labels.map((function(e){return e.id}))||[],watchers:e.watchers&&!!e.watchers.length&&e.watchers.map((function(e){return e.id}))||[],workingHours:e.workingHours,fields:e.issueSchemeFields||{},progress:e.progress},assignee:e.assignee,watchers:e.watchers||[]})}},{key:"changeAttributes",value:function(e){var t,a=e.isCustom,n=e.type,i=e.value,r=e.issueFieldId,o=this.state.attributes,s=this.props.riskSchemeFieldArchives;if(a){var c=o.fields,u=i;!i&&(0,G.default)(c[r])?u=[]:!i&&((0,H.default)(c[r])||(0,V.default)(c[r])||(0,Y.default)(c[r]))&&(u=null),s[r].issueField.componentType!==be.PROPERTY_TYPE_CONSTANTS.SELECT_MEMBER_SINGLE&&s[r].issueField.componentType!==be.PROPERTY_TYPE_CONSTANTS.SELECT_ITERATION_SINGLE||(u=i?i.id:null),s[r].issueField.componentType!==be.PROPERTY_TYPE_CONSTANTS.SELECT_MEMBER_MULTI&&s[r].issueField.componentType!==be.PROPERTY_TYPE_CONSTANTS.SELECT_ITERATION_MULTI||(u=i?i.map((function(e){return e.id})):[]),t={customFieldValueMap:[{id:r,content:u}]}}else switch(n){case"defectType":t={defectTypeId:i||0};break;case"requirementType":case"priority":case"assignee":t=Ue({},"requirementType"===n?{requirementTypeId:i||0}:(0,l.default)({},n,i||0));break;case"labels":case"watchers":var d=o.labels,f=o.watchers,p="labels"===n?"labelIds":"watchers",m="labels"===n?"delLabelIds":"delWatchers",h="labels"===n?d:f,v=Array.from(new Set(h.concat(i)));if(i)if(v.length===h.length){var g=h.findIndex((function(e){return!i.includes(e)}));t=(0,l.default)({},m,[h[g]])}else t=(0,l.default)({},p,[i[i.length-1]]),"watchers"===n&&(i=v);else t=(0,l.default)({},m,h);break;case"workingHours":t={workingHours:i||0};break;case"projectModule":t={projectModuleId:i||0};break;case"progress":t={progress:i||0};break;default:t=(0,l.default)({},n,i)}this.setState({attributes:Ue(Ue({},o),a?{fields:Ue(Ue({},o.fields),{},(0,l.default)({},r,i))}:(0,l.default)({},n,i))}),this.updateRisk(t)}},{key:"getIssueStatusTransfers",value:function(){var e=this,t=this.props,a=t.issueCode,n=t.currentProject;return(0,F.fetchIssueStatusTransfers)(n.id,a).then((function(t){var a=t.data;e.setState({riskStatusTransfers:a})}))}},{key:"callback",value:function(e,t){var a=this.props.updateCallback;a&&a(e,t)}},{key:"onNameChange",value:function(e){var t=(0,M.default)(this.state.detailInfoState,(function(t){t.name=e.target.value}));this.setState({detailInfoState:t})}},{key:"submitTitleChange",value:function(){var e=this,t=this.state.detailInfoState,a=this.props.detailInfo;t.name&&t.name.length<=128?t.name!==a.name&&this.updateRisk({name:t.name.trim()},(function(){e.titleInputRef&&e.titleInputRef.current&&(e.titleInputRef.current.blur(),e.setState({noHoverIcon:!0},(function(){setTimeout((function(){e.setState({noHoverIcon:!1})}),0)}))),e.setState({detailInfoState:Ue(Ue({},t),{},{name:t.name.trim()})})})):(0,_.warning)((0,b.t)("\u8bf7\u8f93\u5165\u4e0d\u8d85\u8fc7128\u4f4d\u7684\u98ce\u9669\u540d\u79f0"))}},{key:"onStatusChange",value:function(e){return this.updateRisk(e)}},{key:"onVisibleChange",value:function(){this.setState({tooltipTitle:(0,b.t)("\u590d\u5236\u94fe\u63a5")})}},{key:"onCopyClick",value:function(){this.setState({tooltipTitle:(0,b.t)("\u5df2\u590d\u5236")})}},{key:"updateDescription",value:function(e){var t=this,a=this.props,n=a.currentProject,i=a.issueCode;return(0,F.modifyIssueDescription)(n.id,i,Ue({},e)).then((function(){t.getResourceReference()}))}},{key:"deleteRisk",value:function(){var e=this,t=this.props,a=t.currentProject,n=t.projectPath,i=t.refreshCallback,r=t.location.search,o=t.browserRouter,s=t.callFrom,l=this.state.detailInfoState;(0,ye.deleteRisk)(a.name,l.code).then((function(){(0,_.success)((0,b.t)("\u5220\u9664\u6210\u529f")),"outer"===s?(0,Pe.emitFromPM)({type:"closeSlide"}):o.push("".concat(n,"/program/risks").concat(r)),e.setState({isFilePreviewVisible:!1}),i(!0)}))}},{key:"updateRisk",value:function(e,t){var a=this,n=this.props.currentProject,i=this.state.detailInfoState;return(0,ye.updateRisk)(n.name,i.code,e).then((function(t){var n=t.data;return n.files=a.combineThirdLinks(n.files,n.thirdLinks),a.callback(n,e.statusId),a.getActivityList(),a.fetchManHourRecords(),(0,_.success)((0,b.t)("\u66f4\u65b0\u6210\u529f")),t}),(function(t){var n=t.code,r=t.data,s=t.msg,l=a.state.attachmentsState;return 8015===n?r.issue_status_id===e.statusId?(a.callback(null,e.statusId),a.getActivityList(),(0,_.success)((0,b.t)("\u66f4\u65b0\u6210\u529f"))):((0,_.danger)((0,b.t)("\u66f4\u65b0\u5931\u8d25\uff0c\u5f53\u524d\u72b6\u6001\u4e0d\u6b63\u786e\u3002")),a.callback(null,r.issue_status_id),a.getActivityList()):((0,_.danger)((0,q.getErrorMessage)(s)),a.setState({detailInfoState:i,attachmentsState:(0,o.default)(l.filter((function(e){return e.fileId>0})))},(function(){a.initAttributesData(i)}))),t})).finally((function(){"function"===typeof t&&t()}))}},{key:"handleEditCommentCallback",value:function(e){var t=this;this.getActivityList((function(){setTimeout((function(){(0,Z.scrollRelatedToTopMenu)("comment-".concat(e),0,t.scrollRef.current)}))})),this.getResourceReference()}},{key:"postComment",value:function(e,t,a,n,i){var r=this,o=this.props.currentProject;return(0,ye.addComment)({projectName:o.name,riskCode:t,content:a,parentID:n}).then((function(e){i&&i(),r.getResourceReference(),r.getActivityList((function(){setTimeout((function(){(0,Z.scrollRelatedToTopMenu)("comment-".concat(e.data.id),0,r.scrollRef.current)}))}))}))}},{key:"deleteComment",value:function(e,t,a,n){var i=this,r=this.props.currentProject;(0,ye.deleteComment)(r.name,t,a).then((function(){n&&n(),i.getResourceReference(),i.getActivityList()}))}},{key:"getActivityList",value:function(e){var t=this,a=this.props.issueCode,n=this.props.currentProject.name;return(0,ye.fetchRisksActitvites)(n,a).then((function(a){t.setState({activities:a.data},(function(){e&&e(),setTimeout(t.setCommentPosition,0)}))})).finally((function(){return t.dataLoad("logs")}))}},{key:"getResourceReference",value:function(){var e=this,t=this.state.detailInfoState,a=this.props.currentProject;return Promise.all([(0,F.fetchCitedResourceReference)(a.id,t.code),(0,F.fetchCitingResourceReference)(a.id,t.code)]).then((function(t){e.setState({citedSources:t[0].data,citingSources:t[1].data})}))}},{key:"onRemoveReference",value:function(){(0,_.success)((0,b.t)("\u53d6\u6d88\u5173\u8054\u6210\u529f")),this.getResourceReference(),this.getActivityList()}},{key:"combineThirdLinks",value:function(e,t){if(!t)return e;var a=t.map((function(e){var t="MODAO"===e.thirdType,a="CODESIGN"===e.thirdType,n="";return t&&(n=e.title||(0,b.t)("\u58a8\u5200\u9644\u4ef6")),a&&(n=e.title),Ue(Ue({},e),{},{isModao:t,isCodesign:a,fileId:e.id,name:n,preview:t&&e.link})})),n=[].concat((0,o.default)(e),(0,o.default)(a));return n.sort((function(e,t){return(e.createdAt||e.created_at)-(t.createdAt||t.created_at)})),n}},{key:"fileUploadSpec",value:function(e){var t=this.state.attachmentsState;this.setState({attachmentsState:[].concat((0,o.default)(t),(0,o.default)(e))})}},{key:"handleDeleteAttachment",value:function(e,t){t?this.handleDeleteModao(e):this.updateRisk({delFileIds:[e]})}},{key:"handleDeleteModao",value:function(e){var t=this,a=this.props,n=a.currentProject.id,i=a.issueCode;(0,L.deleteModao)(n,i,e).then((function(){(0,_.success)((0,b.t)("\u5220\u9664\u6210\u529f")),t.setState({attachmentsState:t.state.attachmentsState.filter((function(t){return t.fileId!==e}))}),t.getActivityList()}))}},{key:"onFileDropSuccessSpec",value:function(e){var t=this;if(e.isCanceled)this.setState({attachmentsState:(0,M.default)(this.state.attachmentsState,(function(t){var a=t.findIndex((function(t){return t.timestamp===e.timestamp}));t.splice(a,1)}))});else if(e.isModao||e.isCodesign){(0,_.success)((0,b.t)("\u66f4\u65b0\u6210\u529f"));var a=this.props,n=a.currentProject.name,i=a.issueCode;(0,ye.fetchRiskDetail)(n,i,{withDescriptionMarkup:!0}).then((function(e){var a=e.data;t.setState({attachmentsState:t.combineThirdLinks(a.files,a.thirdLinks)},(function(){t.scrollToAttechment()}))})),this.getActivityList()}else this.updateRisk({fileIds:[e.fileId]},(function(){t.scrollToAttechment()}))}},{key:"onFileDropFailSpec",value:function(e){var t=e.timestamp;this.setState({attachmentsState:(0,M.default)(this.state.attachmentsState,(function(e){var a=e.findIndex((function(e){return e.timestamp===t}));e.splice(a,1)}))})}},{key:"onFileDropDeleteSpec",value:function(e){var t=e.fileId,a=e.isModao,n=e.isCodesign;this.handleDeleteAttachment(t,a||n)}},{key:"onFileDropCancelSpec",value:function(e){var t=e.timestamp;this.setState({attachmentsState:(0,M.default)(this.state.attachmentsState,(function(e){var a=e.findIndex((function(e){return e.timestamp===t}));e[a].isCanceled=!0}))})}},{key:"filePreviewHideSpec",value:function(e){this.setState({isFilePreviewVisible:e})}},{key:"previewItem",value:function(e){this.setState({previewFileID:e,isFilePreviewVisible:!0})}},{key:"handleDelInPreviewFileSpec",value:function(){var e=this,t=this.state.deleteFileId;this.isDeleteInFilePreview=!0,this.updateRisk({delFileIds:[t]},(function(){e.setState({showDeleteConfirmModal:!1,deleteFileId:void 0})}))}},{key:"handleDeleteAttachmentConfirm",value:function(e,t){this.setState({showDeleteConfirmModal:!0,deleteFileId:t})}},{key:"toggleRecord",value:function(){var e=this.state.isHistoryRecordVisible;this.setState({isHistoryRecordVisible:!e})}},{key:"viewRecord",value:function(e){var t=e.currentId;this.setState({isHistoryRecordVisible:!0,currentLogId:t})}},{key:"openSlideslip",value:function(){this.setState({showSideslip:!0})}},{key:"closeSlideslip",value:function(){this.setState({showSideslip:!1})}}]),a}(y.Component),g.propTypes=Ue(Ue({detailInfo:I.default.object,riskList:I.default.array,projectPath:I.default.string,params:I.default.object,expanded:I.default.bool,isDetail:I.default.bool,currentProject:I.default.object,labels:I.default.array,user:I.default.object,riskSchemeFieldArchives:I.default.object,riskUpdateFieldIDs:I.default.array,requirementTypes:I.default.array,getRiskScheme:I.default.func,getRequirementTypes:I.default.func,updateCallback:I.default.func,refreshCallback:I.default.func,enterpriseGlobalKey:I.default.string,enterpriseName:I.default.string,watermark:I.default.string,payed:I.default.bool,location:I.default.object,issueCode:I.default.oneOfType([I.default.number,I.default.string]),iterationCode:I.default.oneOfType([I.default.number,I.default.string]),autoshowComment:I.default.object,autoToggleComment:I.default.func,domID:I.default.string,flashAnchor:I.default.func},K.WithProjectPermissionProps),{},{currentProjectCooperateSettings:I.default.object,browserRouter:I.default.object,getLabels:I.default.func,targetData:I.default.object}),g.defaultProps={expanded:!0,riskList:[],isDetail:!1},v=E))||v)||v)||v)||v)||v)||v)||v)||v)||v);t.default=He},MXfu:function(e,t,a){e.exports={root:"root-29H3PMj-nR","input-wrapper":"input-wrapper-357JAZj408",inputWrapper:"input-wrapper-357JAZj408","is-editing":"is-editing-1M4gURrszS",isEditing:"is-editing-1M4gURrszS","is-error":"is-error-yean3v2yqA",isError:"is-error-yean3v2yqA","operation-wrapper":"operation-wrapper-2Km5UveWBF",operationWrapper:"operation-wrapper-2Km5UveWBF",disabled:"disabled-2_IJlH0n0k",placeholder:"placeholder-jVhN8INebn"}},MYKk:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var n,i=a("te0o"),r=a("w3Wo"),o=a("xgZS"),s=a("mVeg"),l=function(){return(l=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},c=function(e,t,a,n){return new(a||(a=Promise))((function(i,r){function o(e){try{l(n.next(e))}catch(t){r(t)}}function s(e){try{l(n.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,s)}l((n=n.apply(e,t||[])).next())}))},u=function(e,t){var a,n,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(l){return function(s){if(a)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(a=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(l){s=[6,l],n=0}finally{a=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},d=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},f=function(e,t,a){if(a||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))};!function(e){e.Status="StatusList",e.IssueTypes="IssueTypes",e.Labels="Labels",e.DefectTypes="DefectTypes",e.requirementTypes="requirementTypes",e.allSystemList="allSystemList",e.groupTeamList="groupTeamList",e.defectSources="defectSources",e.editionList="editionList"}(n||(n={}));var p=function(e){var t={};return e.forEach((function(e){t[e.name]?(t[e.name].id.push(e.id),t[e.name].value.push(e.id)):t[e.name]=l(l({},e),{id:[e.id],value:[e.id],text:e.name})})),Object.keys(t).reduce((function(e,a){return f(f([],d(e),!1),[t[a]],!1)}),[])},m=function(){function e(){this.cacheInfo={}}return e.prototype.get=function(e){return this.cacheInfo[e]},e.prototype.init=function(e){var t=[this._initStatusList(),this._initIssueTypes(),this._initLabels(),this._initRequirementTypes(),this._initAllSystemList(),this._initGroupTeamList(),this._initDefectSources(),this._initEditionList()];Promise.all(t).finally((function(){e&&e()}))},e.prototype._initStatusList=function(){return c(this,void 0,void 0,(function(){var e;return u(this,(function(t){switch(t.label){case 0:return[4,Object(i.A)()];case 1:return e=t.sent().data,this.cacheInfo[n.Status]=e.map((function(e){return l(l({},e),{value:e.id})})),[2]}}))}))},e.prototype._initIssueTypes=function(){return c(this,void 0,void 0,(function(){var e;return u(this,(function(t){switch(t.label){case 0:return[4,Object(i.x)()];case 1:return e=t.sent().data,this.cacheInfo[n.IssueTypes]=e,[2]}}))}))},e.prototype._initLabels=function(){return c(this,void 0,void 0,(function(){var e;return u(this,(function(t){switch(t.label){case 0:return[4,Object(i.y)()];case 1:return e=t.sent().data,this.cacheInfo[n.Labels]=e.map((function(e){return{name:e.name,value:e.name,id:e.name,color:e.color}})),[2]}}))}))},e.prototype._initDefectTypes=function(){return c(this,void 0,void 0,(function(){var e;return u(this,(function(t){switch(t.label){case 0:return[4,Object(i.w)()];case 1:return e=t.sent().data,this.cacheInfo[n.DefectTypes]=p(e),[2]}}))}))},e.prototype._initRequirementTypes=function(){return c(this,void 0,void 0,(function(){var e;return u(this,(function(t){switch(t.label){case 0:return[4,Object(r.fetchIssueFilterRequirementTypes)()];case 1:return e=t.sent().data,this.cacheInfo[n.requirementTypes]=p(e),[2]}}))}))},e.prototype._initAllSystemList=function(){return c(this,void 0,void 0,(function(){var e;return u(this,(function(t){switch(t.label){case 0:return[4,Object(r.fetchAllSystemList)()];case 1:return e=t.sent().data,this.cacheInfo[n.allSystemList]=e,[2]}}))}))},e.prototype._initGroupTeamList=function(){return c(this,void 0,void 0,(function(){var e=this;return u(this,(function(t){return Object(r.getAllGroupTeam)({keyword:"",page:1,pageSize:99999}).then((function(t){(null===t||void 0===t?void 0:t.data)&&(e.cacheInfo[n.groupTeamList]=t.data)}),(function(e){e.code&&Object(o.danger)(Object(s.t)("\u83b7\u53d6\u8d1f\u8d23\u5c0f\u961f\u5217\u8868\u5931\u8d25"))})),[2]}))}))},e.prototype._initDefectSources=function(){return c(this,void 0,void 0,(function(){var e;return u(this,(function(t){switch(t.label){case 0:return[4,Object(r.fetchAllDefectSources)("")];case 1:return e=t.sent().data,this.cacheInfo[n.defectSources]=p(e),[2]}}))}))},e.prototype._initEditionList=function(){return c(this,void 0,void 0,(function(){var e;return u(this,(function(t){switch(t.label){case 0:return[4,Object(r.allEditIssueseDition)({keyword:"",page:1,pageSize:99999})];case 1:return e=t.sent().data,this.cacheInfo[n.editionList]=e.list.map((function(e){return l(l({},e),{id:e.editionId,value:e.editionId,text:e.name})})),[2]}}))}))},e}();t.b=new m},"Mh+3":function(e,t,a){"use strict";a.r(t),a.d(t,"alertError",(function(){return r})),a.d(t,"noAlertApi",(function(){return o})),a.d(t,"splitIssueTypes",(function(){return s}));a("xgZS"),a("Z4vw");var n,i=a("nuIr");function r(e){}var o=["Nz2Efa","qEfQZr","buMbqm"],s=((n={})[i.REQUIREMENT_LOWER_TYPES.requirement]={splitType:"story",level:1},n);t.default={getDetailInfo:"z2YBFz",fetchHiddenFolderDirs:"Nz2Efa",getParentDetail:"u6RZNf",getNewProductGroupIds:"r6zE3u",getRequirementTypes:"y2Y73u",getBugTypes:"JzuUji",getSourceTypes:"j6jyqi",getIssues:"FJzYNb",getIssueStatusTransfers:"Aj2i6b",getIterationList:"YnIfQv",getSubTasksList:"YV7Zre",fetchManHourRecords:"7FzyUv",fetchAssociatedTestCase:"qa2qm2",fetchIssue:"QZvYBn",fetchBlockingRelationList:"ji6nQn",fetchParentRequirements:"Evqai2",fetchCollaborationSettings:"ZviUZb",fetchIssueTypes:"EJv67r",fetchGlobalProjectCollaborationSplitType:"ueAfM3",getRBLSJXGList:"BRBr2q",getRBLKHXGList:"F3IRnq",getTencentMeetingDetail:"qEfQZr",getAllDepartments:"zm6r22",fetchTeamList:"EV32Y3",getProductGroupSelected:"JVz6Rv",getProductGroupList:"rUBB3y",insideProgramCheck:"iuyMRv",fetchSplitIssueChildList:"ruiyy2",fetchProjects:"YzYvAz",getCurrentProject:"buMbqm",fetchCitedResourceReference:"AVbaEb",fetchCitingResourceReference:"bqmUZn",getSystemsList:"VvYfYn"}},MiOB:function(e,t,a){"use strict";a.r(t);var n=a("mVeg"),i=a("cDcd"),r=a.n(i),o=a("hyWy"),s=a.n(o),l=a("aR47"),c=a("df5+"),u=a("f0Wu"),d=a.n(u),f=a("AUsL"),p=a("eVvw"),m=a("K2gz"),h=a.n(m),v=a("WN9O"),g=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(t,a)};return function(t,a){if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),E=function(){return(E=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},b=function(e,t,a,n){var i,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,a,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(r<3?i(o):r>3?i(t,a,o):i(t,a))||o);return r>3&&o&&Object.defineProperty(t,a,o),o},y=function(e){function t(t){var a=e.call(this,t)||this;return a.onChange=function(e){a.props.onChange(e),a.onToggle()},a.renderDatePop=function(){var e=a.state,t=e.date,n=e.isShowInTop,i=a.props,o=i.dropdownClassName,c=i.transitionClassName,u=i.isDisabled,f=i.dateFormat,p=i.isPortal;return r.a.createElement("div",{className:h()(o,p&&s.a.customSelect,p&&s.a.customSelectPortal,!p&&s.a.customSelectNotPortal,!p&&n&&s.a.customSelectInTop),onClick:a.stopPropagation,ref:a.popRef},r.a.createElement(l.DatePickerPop,{initialSelectedDate:t?d()(t).format(f||"YYYY/MM/DD"):"",onChange:a.onChange,isDateDisabled:a.setDisableDate,transitionName:c,disabled:u,onToggle:a.onToggle}))},a.renderDateTimeProps=function(){var e=a.state,t=e.date,n=e.isShowInTop,i=a.props,o=i.dropdownClassName,l=i.transitionClassName,u=i.isDisabled,f=i.dateFormat,p=i.isPortal;return r.a.createElement("div",{className:h()(o,p&&s.a.customSelect,p&&s.a.customSelectPortal,!p&&s.a.customSelectNotPortal,!p&&n&&s.a.customSelectInTop),onClick:a.stopPropagation,ref:a.popRef},r.a.createElement(c.DateTimePickerPop,{initialSelectedDate:t?d()(t).format(f||"YYYY/MM/DD HH:mm:ss"):"",value:t?d()(t).format(f||"YYYY/MM/DD HH:mm:ss"):"",onChange:a.onChange,isDateDisabled:a.setDisableDate,transitionName:l,disabled:u,onClear:a.clearTime,onToggle:a.onToggle}))},a.getIsShowInTop=function(){var e=a.popRef.current,t=a.triggerRef.current;return t.getBoundingClientRect().y+parseFloat(getComputedStyle(t).height)+parseFloat(getComputedStyle(e).height)>window.innerHeight-20},a.stopPropagation=function(e){e.nativeEvent.stopImmediatePropagation()},a.hide=function(e){void 0===e&&(e=null);var t=!0;a.props.isTimePicker&&e&&e.composedPath().forEach((function(e){var a=e;a.classList&&a.classList.contains("cuk-datetimepicker-menu")&&(t=!1)}));t&&(a.setState({collapsed:!1}),document.removeEventListener("click",a.hide))},a.state={date:null,collapsed:!!a.props.open&&a.props.open,isElemScroll:!1,isShowInTop:!1},a.setDisableDate=a.setDisableDate.bind(a),a.clearTime=a.clearTime.bind(a),a.onToggle=a.onToggle.bind(a),a.triggerRef=Object(i.createRef)(),a.popRef=Object(i.createRef)(),a}return g(t,e),t.prototype.componentDidMount=function(){var e=this.props.value;this.setDate(e),this.props.open&&document.addEventListener("click",this.hide)},t.prototype.componentWillUnmount=function(){document.removeEventListener("click",this.hide)},t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.value!==this.props.value&&this.setDate(e.value)},t.prototype.setDate=function(e){this.setState({date:e})},t.prototype.dateTirgger=function(){var e=this.state,t=e.date,a=e.collapsed,i=this.props,o=i.hasBorder,l=i.isDisabled,c=i.dateFormat,u=i.isPortal,f=i.portalProps,m=i.trigger,g=i.triggerClass,b=i.className;return r.a.createElement("div",{className:h()(s.a.select,!l&&s.a.customSelect,b)},r.a.createElement("div",{ref:this.triggerRef,className:s.a.trigger},m?m({collapsed:a,onToggle:this.onToggle}):r.a.createElement(p.a,{hasBorder:o,placeholder:t?"":Object(n.t)("\u672a\u6307\u5b9a"),title:t?d()(t).format(c||"YYYY/MM/DD"):"",disabled:l,toggleShow:a,onToggle:this.onToggle,className:g})),r.a.createElement(r.a.Fragment,null,a&&(u&&f?r.a.createElement(v.default,E({},f,{relatedElem:this.triggerRef.current}),this.renderDatePop()):this.renderDatePop())))},t.prototype.dateTimeTirgger=function(){var e=this.state,t=e.date,a=e.collapsed,i=this.props,o=i.hasBorder,l=i.isDisabled,c=i.dateFormat,u=i.isPortal,f=i.portalProps,m=i.trigger,g=i.className;return r.a.createElement("div",{className:h()(s.a.select,!l&&s.a.customSelect,g)},r.a.createElement("div",{ref:this.triggerRef,className:s.a.trigger},m?m({collapsed:a,onToggle:this.onToggle}):r.a.createElement(p.a,{hasBorder:o,placeholder:t?"":Object(n.t)("\u672a\u6307\u5b9a"),title:t?d()(t).format(c||"YYYY/MM/DD HH:mm:ss"):"",toggleShow:a,disabled:l,onToggle:this.onToggle})),r.a.createElement(r.a.Fragment,null,a&&(u&&f?r.a.createElement(v.default,E({},f,{relatedElem:this.triggerRef.current}),this.renderDateTimeProps()):this.renderDateTimeProps())))},t.prototype.render=function(){var e=this.props.isTimePicker;return r.a.createElement(r.a.Fragment,null,e?this.dateTimeTirgger():this.dateTirgger())},t.prototype.setDisableDate=function(e){var t=this.props.disableDate;return!(!t||"function"!==typeof t)&&t(e)},t.prototype.setDateStatus=function(e){var t,a=this.props,n=a.placeholder,i=a.needParseDate,o=a.coloredDateText;if(t=e?i?d()(e).format("YYYY/MM/DD"):d()(e).format("YYYY/MM/DD HH:mm:ss"):n,!e)return r.a.createElement("span",{className:s.a.notSpecified},t);var l=d()(e),c=d()(new Date),u=d()(new Date).add(-1,"days");return i&&o&&l.isSame(c,"day")?r.a.createElement("div",{className:h()(s.a.calendarDate,s.a.today)},r.a.createElement("span",null,t)):i&&o&&l.isSameOrBefore(u,"day")?r.a.createElement("div",{className:h()(s.a.calendarDate,s.a.yesterday)},r.a.createElement("span",null,t)):r.a.createElement("div",{className:s.a.calendarDate},r.a.createElement("span",null,t))},t.prototype.clearTime=function(){var e=this.props.onChange;this.setState({collapsed:!1}),document.removeEventListener("click",this.hide),e(d()(""))},t.prototype.onToggle=function(){var e=this,t=this.props,a=t.isDisabled,n=t.calculatePosition;a||this.setState({collapsed:!this.state.collapsed},(function(){n&&n({itemsHeight:303,itemsWidth:200}),e.state.collapsed?(document.addEventListener("click",e.hide),e.props.isPortal||e.setState({isShowInTop:e.getIsShowInTop()})):document.removeEventListener("click",e.hide)}))},t.defaultProps={placeholder:Object(n.t)("\u672a\u6307\u5b9a"),isDisabled:!1,isTimePicker:!1,arrowPosition:"left",needParseDate:!0,coloredDateText:!1,portalContainer:"coding-project-management-frontend"},t=b([f.a],t)}(i.Component);t.default=y},Mukx:function(e,t,a){e.exports={"storypoint-items":"storypoint-items-B0EmPpJaka",storypointItems:"storypoint-items-B0EmPpJaka","storypoint-item":"storypoint-item-1YQXmgF4A_",storypointItem:"storypoint-item-1YQXmgF4A_",active:"active-1DoE6LkHFl","issue-type-items":"issue-type-items-3FPIrkfdux",issueTypeItems:"issue-type-items-3FPIrkfdux","issue-type-fat-items":"issue-type-fat-items-1pcjgjGnJG",issueTypeFatItems:"issue-type-fat-items-1pcjgjGnJG"}},Myje:function(e,t,a){"use strict";var n=a("cDcd"),i=a("DlAp");t.a=function(e){var t=e.currentProject,a=e.isPermissible,r=e.currentProjectCooperateSettings,o=e.user,s=e.currentProjectPermissionList,l=e.mode,c=e.issueType,u=e.iterationInfo,d=Object(n.useContext)(i.b),f=d.dispatch,p=d.state,m=p.activeFilterContent,h=p.customParams;return Object(n.useMemo)((function(){return{issueType:c,currentProject:t,isPermissible:a,currentProjectCooperateSettings:r,user:o,currentProjectPermissionList:s,activeFilterContent:m,customParams:h,mode:l,iterationInfo:u,setCustomParams:function(e){f({type:i.a.setCustomParams,value:e})},setLoading:function(e,t){var a;f({type:i.a.setCustomLoad,value:(a={},a[e]=t,a)})}}}),[e,h,h])}},N0I2:function(e,t,a){e.exports={wrapper:"wrapper-FqzGJXXttq",title:"title-3NoDoir-7-","custom-result":"custom-result-YMNob7kfBi",customResult:"custom-result-YMNob7kfBi","custom-detail":"custom-detail-3tiSdH9Fru",customDetail:"custom-detail-3tiSdH9Fru","belong-iteration":"belong-iteration-11twTpauSn",belongIteration:"belong-iteration-11twTpauSn","custom-search-icon":"custom-search-icon-32pjFry2U9",customSearchIcon:"custom-search-icon-32pjFry2U9",root:"root-343vNagavn","custom-input":"custom-input-1CtpKU6a7r",customInput:"custom-input-1CtpKU6a7r","result-wrapper":"result-wrapper-3lRLD8u8OS",resultWrapper:"result-wrapper-3lRLD8u8OS","result-empty":"result-empty-2URkhPUcxj",resultEmpty:"result-empty-2URkhPUcxj",icon:"icon-2xZujS9Ccj","cancel-btn":"cancel-btn-2s4DHQMkFC",cancelBtn:"cancel-btn-2s4DHQMkFC","result-items":"result-items-3tXIZsy0k1",resultItems:"result-items-3tXIZsy0k1",item:"item-18JDNYei0m","is-disabled":"is-disabled-1kFjBvw_81",isDisabled:"is-disabled-1kFjBvw_81",desc:"desc-2KWBfBT2V6","item-code":"item-code-JeLUrGtWgD",itemCode:"item-code-JeLUrGtWgD","item-detail":"item-detail-1b3Z-X5VTi",itemDetail:"item-detail-1b3Z-X5VTi","item-detail-title":"item-detail-title-2hfaWbZIDN",itemDetailTitle:"item-detail-title-2hfaWbZIDN","result-filter-bar":"result-filter-bar-3QsIuClBFb",resultFilterBar:"result-filter-bar-3QsIuClBFb",detail:"detail-QrmM-8zzkk"}},NAVA:function(e,t,a){e.exports=a.p+"69dbc607f5c4684147ea8422341a56d5.svg"},NTFJ:function(e,t,a){"use strict";var n;a.r(t),a.d(t,"DM_ITEM_TYPE",(function(){return n})),function(e){e.PRD_REQUIREMENT="PRD_REQUIREMENT",e.ORD_REQUIREMENT="ORD_REQUIREMENT"}(n||(n={}))},NdxU:function(e,t,a){"use strict";a("I5cv"),a("ioFf"),a("mYba"),a("jm62"),a("EK0E");var n=a("TqRt"),i=a("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(a("o0o1"));a("f3/d"),a("Btvt"),a("VRzm"),a("bWfx"),a("CX2u"),a("XfO3"),a("yt8O"),a("rGqo"),a("dRSK"),a("INYr"),a("0l/t"),a("RW0V");var o,s,l,c=n(a("yXPU")),u=n(a("RIqP")),d=n(a("lSNA")),f=n(a("lwsE")),p=n(a("W8MJ")),m=n(a("PJYZ")),h=n(a("7W2i")),v=n(a("a1gu")),g=n(a("Nsbk")),E=a("mVeg"),b=re(a("cDcd")),y=n(a("17x9")),S=n(a("V/h/")),I=n(a("Zsd2")),T=n(a("E+oP")),C=n(a("Y+p1")),P=n(a("zqxM")),w=a("IgEJ"),D=a("7bn+"),O=a("nuIr"),R=a("DgMC"),j=a("xgZS"),k=a("Z4vw"),N=a("DKcV"),A=a("/HD1"),L=a("w3Wo"),F=a("aHEs"),_=a("82Y3"),M=a("h74D"),x=n(a("mSbZ")),B=n(a("uk0h")),U=n(a("htee")),W=n(a("4Fdf")),Y=n(a("sftu")),H=n(a("KUqB")),V=n(a("Th6D")),G=re(a("NI22")),K=n(a("SLo4")),z=n(a("z0hg")),q=n(a("SUhN")),Z=n(a("QPj7")),J=a("885C"),X=n(a("T8xO")),Q=n(a("L8Eh")),$=n(a("XLbL")),ee=a("LC46"),te=n(a("K2gz")),ae=n(a("1hCk")),ne=n(a("246l"));function ie(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(ie=function(e){return e?a:t})(e)}function re(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!==typeof e)return{default:e};var a=ie(t);if(a&&a.has(e))return a.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=r?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}return n.default=e,a&&a.set(e,n),n}function oe(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function se(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(a),!0).forEach((function(t){(0,d.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):oe(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function le(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,g.default)(e);if(t){var i=(0,g.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,v.default)(this,a)}}var ce=(0,M.connect)((function(e){var t=e.APP,a=t.enterprise;return{user:t.user,enterpriseGlobalKey:a.key}}))(o=(0,x.default)(o=(0,B.default)(o=(0,U.default)(o=(0,W.default)((l=s=function(e){(0,h.default)(a,e);var t=le(a);function a(e){var n;return(0,f.default)(this,a),(n=t.call(this,e)).initCreatePage=function(){var e=n.props,t=e.currentProject,a=e.issueTypeDetail,i=n.state,r=i.name,o=i.editorType;return(0,G.isBlockType)(o)?(0,F.fetchMarkdownTemplate)(t.name,a.id).then((function(e){var t=e.data;n.setState({initEditorData:{pageId:t.pageId,pageDraftId:t.draftId,historyId:t.historyId},editorAutoFocus:!!r,showDescriptionPlaceholder:!1})})):Promise.resolve()},n.handleAttentionChange=function(e){n.changeAttributes({type:"watchers",value:e})},n.onDescriptionChange=function(e){if(!e.isEmpty){var t="".concat(n.props.currentProject.name,"_").concat(n.props.issueTypeDetail.issueType,"_").concat(n.props.issueTypeDetail.id,"_CREATOR");(0,G.setIssueDescriptionDraft)(t,n.state.initEditorData)}},n.onDescriptionScroll=function(){n.getAttachmentsStickyState()},n.onEditorTypeChange=function(e){if((0,_.setPreferEditorType)(e),n.setState({editorType:e}),(0,G.isBlockType)(e))return n.removeDraft(),void n.initCreatePage();var t="".concat(n.props.currentProject.name,"_").concat(n.props.issueTypeDetail.issueType,"_").concat(n.props.issueTypeDetail.id,"_CREATOR");(0,G.setIssueDescriptionDraft)(t);var a={pageId:n.state.initEditorData.pageId,pageDraftId:n.state.initEditorData.pageDraftId,module:"collaboration",function:"description",scopeType:"project",scopeId:n.props.currentProject.id};(0,G.delPageDraft)(a).then((function(){return n.setState({initEditorData:null})}))},n.onCancel=function(){n.props.closeHandle()},n.removeDraft=function(){var e,t;null!==(e=n.editorRef)&&void 0!==e&&null!==(t=e.current)&&void 0!==t&&t.removeDraft&&n.editorRef.current.removeDraft()},n.onAttrScroll=function(){n.setState({isElemScroll:!0})},n.quickSave=function(e){n.state.isMac?e.metaKey&&"Enter"===e.key&&n.onSubmit():e.ctrlKey&&"Enter"===e.key&&n.onSubmit()},n.startEditing=function(e){n.state.isMac?e.metaKey||"Enter"!==e.key||n.setState({showDescriptionPlaceholder:!1}):e.ctrlKey||"Enter"!==e.key||n.setState({showDescriptionPlaceholder:!1})},n.getHeights=function(){var e=Math.max(320,Math.min(680,document.body.clientHeight-120-300)),t=Math.max(320,Math.min(460,document.body.clientHeight-120-300));n.setState({maxMainBodyHeight:e,editorMinHeight:t},n.getAttachmentsStickyState)},n.getAttachmentsStickyState=function(){var e,t=null===(e=n.bodyRef)||void 0===e?void 0:e.current;n.setState({attachmentsSticky:t&&t.scrollTop+t.offsetHeight<t.scrollHeight&&t.scrollHeight>t.clientHeight})},n.titleInputFocus=function(){var e,t;null===(e=n.inputRef)||void 0===e||null===(t=e.current)||void 0===t||t.focus()},n.combineThirdLinks=function(){var e=n.state,t=e.attachments,a=e.thirdLinks;if(a){var i=a.map((function(e){if(e.name)return e;var t=e.isModao,a=e.isCodesign,n="";return t&&(n=e.modao.title||(0,E.t)("\u58a8\u5200\u9644\u4ef6")),a&&(n=e.codesign.title),se(se({},e),{},{noUpload:!0,isModao:t,isCodesign:a,name:n,createdAt:e.timestamp})})),r=[].concat((0,u.default)(t),(0,u.default)(i));n.setState({allAttachments:n.sortAttachments(r)})}else n.setState({allAttachments:n.sortAttachments(t)})},n.sortAttachments=function(e){var t=(0,u.default)(e);return t.sort((function(e,t){return e.timestamp-t.timestamp})),t},n.onAddThirdLink=function(e){n.hideImportOutResourcePicker(),n.setState({thirdLinks:[].concat((0,u.default)(n.state.thirdLinks),(0,u.default)(e))},n.combineThirdLinks)},n.showImportOutResourcePicker=function(){n.setState({isShowImportOutResourcePicker:!0})},n.hideImportOutResourcePicker=function(){n.setState({isShowImportOutResourcePicker:!1})},n.state={name:e.name,autoNext:"true"===localStorage.getItem("WORK_ITEM_CREATION_AUTO_NEXT"),isPending:!1,isLoading:!0,attributes:{assignee:void 0,priority:void 0,requirementType:void 0,startDate:void 0,dueDate:void 0,workingHours:void 0,projectModule:void 0,defectType:void 0,labels:[],watchers:[],fields:{},progress:void 0},isReloading:!1,isElemScroll:!1,isMac:(0,R.isMac)(),initEditorData:null,showDescriptionPlaceholder:!0,editorAutoFocus:!0,attachmentsSticky:!1,maxMainBodyHeight:0,editorMinHeight:0,editorType:(0,_.getPreferEditorType)(),fullscreen:!1,allAttachments:[],attachments:[],isShowImportOutResourcePicker:!1,thirdLinks:[],showButton:!1,toLeft:0},n.inputRef=b.default.createRef(),n.bodyRef=b.default.createRef(),n.editorRef=b.default.createRef(),n.sideRef=b.default.createRef(),n.setDefaultValues=n.setDefaultValues.bind((0,m.default)(n)),n.onTitleChange=n.onTitleChange.bind((0,m.default)(n)),n.onSubmit=n.onSubmit.bind((0,m.default)(n)),n.resetFormData=n.resetFormData.bind((0,m.default)(n)),n.onAutoFlagChange=n.onAutoFlagChange.bind((0,m.default)(n)),n.changeAttributes=n.changeAttributes.bind((0,m.default)(n)),n.wrapperRef=b.default.createRef(),n.listRef=b.default.createRef(),n.moveContent=n.moveContent.bind((0,m.default)(n)),n.handleDeleteAttachment=n.handleDeleteAttachment.bind((0,m.default)(n)),n.onFileDropSuccess=n.onFileDropSuccess.bind((0,m.default)(n)),n.onFileDropFail=n.onFileDropFail.bind((0,m.default)(n)),n.onFileDropDelete=n.onFileDropDelete.bind((0,m.default)(n)),n.onFileDropCancel=n.onFileDropCancel.bind((0,m.default)(n)),n.fileUpload=n.fileUpload.bind((0,m.default)(n)),n}return(0,p.default)(a,[{key:"renderAttachmentSection",value:function(){var e=this,t=this.state,a=t.attachments,n=t.allAttachments,i=t.isShowImportOutResourcePicker,r=t.showButton,o=t.toLeft,s=this.props,l=s.enterpriseGlobalKey,c=s.currentProject,u=s.user,d=c.name,f=c.id;return b.default.createElement("div",{className:ae.default.attachementSectionContainer},b.default.createElement("div",{className:ae.default.sectionHeader},b.default.createElement("span",{className:ae.default.title},(0,E.t)("\u9644\u4ef6")),b.default.createElement("span",{className:ae.default.dividerLine}),b.default.createElement(K.default,{onHandleAttachments:this.fileUpload,currentAttachmentNum:a.length,attachmentLimit:n.length>=20},b.default.createElement("a",{className:ae.default.uploadButton},(0,E.t)("\u672c\u5730\u4e0a\u4f20"))),b.default.createElement("div",{className:ae.default.importOutResourceWrap},b.default.createElement(q.default,{onHandleAttachments:this.onAddThirdLink,isShowPicker:i,onShow:this.showImportOutResourcePicker,onHide:this.hideImportOutResourcePicker,attachmentLimit:n.length>=20}))),b.default.createElement("div",{className:ae.default.attachmentSection},n.length?b.default.createElement("div",{className:(0,te.default)(ae.default.attachmentWrapper,r&&ae.default.rightBorder,o<0&&ae.default.leftBorder),ref:this.wrapperRef},b.default.createElement("div",{className:ae.default.attachmentList,ref:this.listRef,style:{left:"".concat(o,"px")}},!!n.length&&b.default.createElement(J.ThemeConsumer,null,(function(t){var a=t.hiddenFolderDirs;return n.map((function(t){return b.default.createElement("div",{className:ae.default.attachmentItem,key:t.fileId},b.default.createElement(z.default,{attachment:t,enterpriseGlobalKey:l,currentProjectName:d,currentProjectId:f,dir:a[O.HIDDEN_FILE_TYPE.WORK_ITEM].file_id,uploadFileSuccess:e.onFileDropSuccess,uploadFileFailed:e.onFileDropFail,uploadFileDelete:e.onFileDropDelete,uploadFileCancel:e.onFileDropCancel,allowPreview:!1,userId:u.id}))}))})))):b.default.createElement("div",{className:ae.default.sectionPlaceholder},(0,E.t)("\u5c1a\u672a\u6dfb\u52a0\u9644\u4ef6")),r&&b.default.createElement("a",{className:ae.default.next,onClick:this.moveContent}),o<0&&b.default.createElement("a",{className:ae.default.pre,onClick:function(){return e.moveContent(!1)}})))}},{key:"render",value:function(){var e=this,t=this.state,a=t.name,n=t.autoNext,i=t.isLoading,r=t.attributes,o=t.isReloading,s=t.isMac,l=t.initEditorData,c=t.showDescriptionPlaceholder,u=t.editorAutoFocus,d=t.attachmentsSticky,f=t.maxMainBodyHeight,p=t.editorMinHeight,m=t.isPending,h=this.props,v=(h.enterpriseGlobalKey,h.currentProject),g=h.show,y=h.isShowCreateNext,S=h.workItemSchemeFieldArchives,I=h.workItemCreationFieldIDs,T=h.user,C=h.isPermissible,P=h.labels,w=h.requirementTypes,D=h.addLabel,O=h.bugTypes,R=h.issueTypeDetail,j=this.getAssigneeFieldWhetherRequired(S,I),k={id:T.id,value:T.id,text:T.name,name:T.name,name_pinyin:T.name_pinyin,avatar:T.avatar,media:T.avatar};return b.default.createElement(Y.default,{className:(0,te.default)(ae.default.wrapper),show:g,outsideClickCloseable:!1,keyboard:!1,enforceFocus:!1},b.default.createElement("span",{className:(0,te.default)(ae.default.closeButton),onClick:this.onCancel}),i&&b.default.createElement("div",{className:ae.default.modalLoading}),!i&&b.default.createElement("div",{className:ae.default.main},b.default.createElement("div",{className:ae.default.mainHeader},b.default.createElement("div",{className:ae.default.headerInfoSection},b.default.createElement("span",{style:{marginRight:"8px"}},(0,E.t)("\u521b\u5efa")),b.default.createElement(H.default,{type:R.iconType}),b.default.createElement("span",null,R.name),b.default.createElement("div",{className:ae.default.attentionWrapper},b.default.createElement(V.default,{type:"WORK_ITEM",projectID:v.id,watchers:r.watchers||[],onChange:this.handleAttentionChange,user:k,action:"create",suffixText:(0,E.t)("\u4eba\u5173\u6ce8\u4e2d"),showTooltip:!0}))),b.default.createElement("div",{className:ae.default.headerTitleSection},b.default.createElement("input",{className:ae.default.titleInput,ref:this.inputRef,autoFocus:!0,placeholder:"".concat((0,E.t)("\u8f93\u5165\u4e8b\u9879\u6807\u9898\uff08")).concat(s?"\u2318":"Ctrl").concat((0,E.t)(" + Enter \u53ef\u5feb\u901f\u521b\u5efa\uff09")),value:a,onChange:this.onTitleChange}))),b.default.createElement("div",{className:ae.default.mainBody,style:{maxHeight:"".concat(f,"px")},ref:this.bodyRef,onScroll:this.onDescriptionScroll},c?b.default.createElement("div",{className:ae.default.descriptionPlaceholder,style:{height:"".concat(p,"px")},onClick:function(){return e.setState({showDescriptionPlaceholder:!1})}},(0,E.t)("\u6309\u56de\u8f66\u6216\u70b9\u6b64\u5f00\u59cb\u7f16\u8f91\u63cf\u8ff0")):b.default.createElement("div",{className:ae.default.editorContainer},b.default.createElement(G.default,{type:this.state.editorType,readOnly:this.state.isPending,isEditing:!0,autofocus:u,container:this.bodyRef.current,currentProject:v,initEditorData:l,richClientSaveUuid:"WORK_ITEM_EDITOR_CREATOR",onEditorChange:this.onDescriptionChange,isDisabled:m,canChangeType:!0,onEditorTypeChangeCallback:function(t){return e.onEditorTypeChange(t)},onFullScreenCallback:function(t){return e.setState({fullscreen:t})},onLoad:function(t){if(t.isError){if((0,G.isBlockType)(e.state.editorType)&&t.isDraftIdNotExist){var a="".concat(v.name,"_").concat(R.issueType,"_").concat(R.id,"_CREATOR");(0,G.setIssueDescriptionDraft)(a),e.setState({initEditorData:null},e.initCreatePage)}}else e.getAttachmentsStickyState()},className:(0,te.default)(ae.default.customSectionZindex,!this.state.fullscreen&&ae.default.editorHeight),ref:this.editorRef}))),b.default.createElement("div",{className:(0,te.default)(ae.default.mainFooter,d&&ae.default.sticky)},this.renderAttachmentSection(),b.default.createElement("div",{className:ae.default.operationsWrapper},b.default.createElement("div",{disabled:o,className:(0,te.default)(ae.default.operationButton,!s&&ae.default.wider,ne.default.newButton,ne.default.primary,ne.default.h32,o&&ne.default.disabled),"data-container":!0,"data-title":"\u521b\u5efa".concat(R.name,"-\u786e\u5b9a"),onClick:this.onSubmit},(0,E.t)("\u521b\u5efa"),b.default.createElement("span",{className:ae.default.key},s?"\u2318":"Ctrl"),b.default.createElement("span",{className:(0,te.default)(ae.default.key,ae.default.enter)})),b.default.createElement("div",{className:(0,te.default)(ae.default.operationButton,ne.default.newButton,ne.default.default,ne.default.h32),"data-container":!0,"data-title":"\u521b\u5efa".concat(R.name,"-\u53d6\u6d88"),onClick:this.onCancel},(0,E.t)("\u53d6\u6d88")),y&&b.default.createElement("span",{className:ae.default.switch},b.default.createElement(X.default,{checked:n,onChange:this.onAutoFlagChange}),b.default.createElement("span",{className:ae.default.switchText},(0,E.t)("\u7ee7\u7eed\u521b\u5efa\u4e0b\u4e00\u4e2a")))))),!i&&b.default.createElement("div",{className:ae.default.aside,onScroll:this.onAttrScroll,ref:this.sideRef},b.default.createElement("div",{className:ae.default.asideContent},b.default.createElement("div",{className:ae.default.issuePropertyContainer},b.default.createElement("div",{className:ae.default.issuePropertySection},b.default.createElement("label",null,(0,E.t)("\u5904\u7406\u4eba"),j&&b.default.createElement("span",{className:ae.default.highlight},"*")),b.default.createElement(Q.default,{inProject:!0,projectID:v.id,value:r.assignee||null,clearable:!j,onSelect:function(t){return e.changeAttributes({type:"assignee",value:t})},onClear:function(){return e.changeAttributes({type:"assignee"})},triggerExtraProps:{initialSelectedItem:(null===r||void 0===r?void 0:r.defaultAssignee)||null}}))),b.default.createElement("div",{className:(0,te.default)(ae.default.issuePropertyContainer,ae.default.hasNoBorder)},b.default.createElement($.default,{isCreate:!0,schemeFieldArchives:S,fieldIds:I,issueType:"WORK_ITEM",onChange:this.changeAttributes,customAttributes:r,labels:P,requirementTypes:w,bugTypes:O,moduleSchemes:[],addLabel:D,projectID:v.id,currentProject:v,isPermissible:C,portalProps:{toRight:!0,portalWrapStyle:{zIndex:1099},isScroll:this.state.isElemScroll,resetIsScroll:function(){e.setState({isElemScroll:!1})}},parentRef:this.sideRef})))))}},{key:"componentDidMount",value:function(){var e=this,t=this.props,a=t.currentProject,n=t.issueTypeDetail,i=this.state,r=i.name,o=i.editorType;document.addEventListener("keydown",this.quickSave),document.addEventListener("keydown",this.startEditing),window.addEventListener("resize",this.getHeights),this.getBasicInfo().then((function(){var t=e.props,a=t.workItemCreationFieldIDs,n=t.workItemSchemeFieldArchives;e.setDefaultValues(n,a),e.getHeights()})).finally((function(){if((0,G.isBlockType)(o)){var t=(0,G.getIssueDescriptionDraft)("".concat(a.name,"_").concat(n.issueType,"_").concat(n.id,"_CREATOR"));t?e.setState({isLoading:!1,initEditorData:{pageId:t.pageId,pageDraftId:t.pageDraftId,historyId:t.historyId},editorAutoFocus:!!r,showDescriptionPlaceholder:!1}):e.initCreatePage().then((function(){e.setState({isLoading:!1})}))}else e.setState({isLoading:!1,editorAutoFocus:!!r,showDescriptionPlaceholder:!1})}))}},{key:"componentDidUpdate",value:function(e,t){if(t.isReloading!==this.state.isReloading){var a=this.props,n=a.workItemSchemeFieldArchives,i=a.workItemCreationFieldIDs,r=e.workItemSchemeFieldArchives,o=e.workItemCreationFieldIDs;if(!(0,C.default)(n,r)&&!(0,C.default)(i,o)){var s=(0,P.default)(i,o);this.setDefaultValues(n,s)}}t.allAttachments.length!==this.state.allAttachments.length&&this.whetherShowMoveButton(),t.editorType!==this.state.editorType&&(0,G.isBlockType)(this.state.editorType)&&!this.state.initEditorData&&this.initCreatePage()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.quickSave),document.removeEventListener("keydown",this.startEditing),window.removeEventListener("resize",this.getHeights)}},{key:"getBasicInfo",value:function(){return Promise.all([this.props.getWorkItemScheme(!0),this.props.getRequirementTypes(),this.props.getBugTypes()])}},{key:"onTitleChange",value:function(e){this.setState({name:e.target.value})}},{key:"onAutoFlagChange",value:function(e){this.setState({autoNext:e},(function(){localStorage.setItem("WORK_ITEM_CREATION_AUTO_NEXT",e)}))}},{key:"onSubmit",value:function(){var e=(0,c.default)(r.default.mark((function e(){var t,a,n,i,o,s,l,c,u,d,f,p,m,h,v,g,b,y,S,C,P,O,N,L,F,_,M,x,B,U,W,Y,H,V,K,z,q,J,X,Q,$,te,ae,ne,ie,re,oe,le=this;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=this.props.currentProject,l=s.name,c=s.project_path,u=this.props,d=u.isShowCreateNext,f=u.workItemSchemeFieldArchives,p=u.workItemCreationFieldIDs,m=u.closeHandle,h=u.callback,v=u.parentCode,g=u.relatedCode,b=u.createWithTargetCode,y=u.callbackWithData,S=u.txcPostId,C=u.issueTypeDetail,P=this.state,O=P.name,N=P.autoNext,L=P.isPending,F=P.allAttachments,_=P.attachments,M=P.attributes,x=M.assignee,B=M.priority,U=M.requirementType,W=M.dueDate,Y=M.startDate,H=M.workingHours,V=M.labels,K=M.watchers,z=M.fields,q=M.defectType,J=M.projectModule,X=M.progress,Q=P.thirdLinks,$=P.initEditorData,te=P.editorType,null===(t=this.editorRef)||void 0===t||!t.current||!(0,G.isBlockType)(te)){e.next=12;break}return e.prev=4,e.next=7,(0,ee.getBlockEditorFinished)(this.editorRef.current);case 7:e.next=12;break;case 9:return e.prev=9,e.t0=e.catch(4),e.abrupt("return",(0,j.warning)((0,E.t)("\u66f4\u65b0\u63cf\u8ff0\u8d85\u65f6")));case 12:if(!L){e.next=14;break}return e.abrupt("return");case 14:if(!(0,T.default)((0,I.default)(O))){e.next=17;break}return(0,j.warning)((0,E.t)("\u5de5\u4f5c\u9879\u6807\u9898\u4e0d\u80fd\u4e3a\u7a7a")),e.abrupt("return");case 17:if(128,!((0,I.default)(O).length>128)){e.next=21;break}return(0,j.warning)("".concat((0,E.t)("\u5de5\u4f5c\u9879\u540d\u79f0\u6700\u591a\u652f\u6301")).concat(128).concat((0,E.t)("\u4f4d"))),e.abrupt("return");case 21:if(!(ae=p.find((function(e){var t=f[e],a=t.required,n=t.issueField.type;if(a){var i;switch(n){case w.FIELD_TYPE.ASSIGNEE:i=x;break;case w.FIELD_TYPE.PROGRESS:i=X;break;case w.FIELD_TYPE.PRIORITY:i=B;break;case w.FIELD_TYPE.REQUIREMENT_TYPE:i=U;break;case w.FIELD_TYPE.START_DATE:i=Y;break;case w.FIELD_TYPE.DUE_DATE:i=W;break;case w.FIELD_TYPE.WORKING_HOURS:i=H;break;case w.FIELD_TYPE.LABEL:i=V;break;case w.FIELD_TYPE.WATCHER:i=K;break;case w.FIELD_TYPE.DEFECT_TYPE:i=q;break;case w.FIELD_TYPE.MODULE:i=J;break;default:i=z[e]}return!(Array.isArray(i)?i.length:null!==i&&void 0!==i)}return!1})))){e.next=25;break}return(0,j.warning)("".concat((0,E.t)("\u8bf7\u586b\u5199")).concat(f[ae].issueField.name)),e.abrupt("return");case 25:if(!(_.length&&_.findIndex((function(e){return e.fileId<0}))>-1)){e.next=28;break}return(0,j.warning)((0,E.t)("\u6709\u9644\u4ef6\u6b63\u5728\u4e0a\u4f20\uff0c\u8bf7\u7a0d\u540e\u63d0\u4ea4")),e.abrupt("return");case 28:this.setState({isPending:!0}),ne=Object.keys(z).filter((function(e){return void 0!==z[e]})).map((function(e){var t=f[e].issueField.componentType;return t===D.PROPERTY_TYPE_CONSTANTS.SELECT_MEMBER_MULTI?{id:e,content:z[e].map((function(e){return e.id}))}:t===D.PROPERTY_TYPE_CONSTANTS.SELECT_MEMBER_SINGLE?{id:e,content:z[e].id}:{id:e,content:z[e]}})),ie=(0,Z.default)(F,Q).map((function(e){return se(se({createdAt:e.createdAt},e.modao),e.codesign)})),re=(0,G.isBlockType)(te)?se(se({},$),{},{descriptionType:G.EditorType.BLOCK}):{content:(null===(a=this.editorRef)||void 0===a||null===(n=a.current)||void 0===n?void 0:n.getRichContent())||"",slateRaw:(null===(i=this.editorRef)||void 0===i||null===(o=i.current)||void 0===o?void 0:o.getRichContent("raw"))||"",descriptionType:G.EditorType.MARKDOWN},oe={parentCode:v||0,name:(0,I.default)(O),fileIds:_.map((function(e){return e.fileId})),thirdLinks:ie,customFieldValueMap:ne.length?ne:null,assignee:x,priority:B,requirementTypeId:U,dueDate:W,startDate:Y,workingHours:H,labelIds:V,watchers:K.map((function(e){return e.id})),relatedCode:g,defectTypeId:q,projectModuleId:J,progress:X,issueTypeId:C.id,kmPage:re},b&&(oe.targetSortCode=b),S&&(oe.txcPostId=S),(0,A.createWorkItem)(l,oe,!0).then((function(e){var t=e.data,a="".concat(l,"_").concat(C.issueType,"_").concat(C.id,"_CREATOR");(0,G.setIssueDescriptionDraft)(a),(0,j.success)((0,E.t)("\u5de5\u4f5c\u9879 #{{code}} \u521b\u5efa\u6210\u529f\uff0c\u70b9\u51fb\u67e5\u770b\u5de5\u4f5c\u9879\uff01",{code:t.code}),{link:"".concat(c,"/program/plan/work-items/").concat(t.code,"/detail")}),le.removeDraft(),h&&h(null,t.issueStatusId),y&&y(t),d&&N?le.resetFormData():m()}),(function(e){var t=e.code,a=e.data,n=e.msg;(0,R.configPlanNotToastMsg)(t)||(8026===t&&p.findIndex((function(e){return e===a.issueField.issueFieldId}))<0?((0,j.danger)((0,E.t)("\u521b\u5efa\u9875\u5c5e\u6027\u5df2\u53d8\u66f4\uff0c\u8bf7\u68c0\u67e5\u5fc5\u586b\u5c5e\u6027\u5e76\u518d\u6b21\u63d0\u4ea4\u3002")),le.setState({isReloading:!0},(function(){Promise.all([le.props.getWorkItemScheme(),le.props.getWorkItemScheme(!0)]).then((function(){le.setState({isReloading:!1})}))}))):(0,j.danger)((0,k.getErrorMessage)(n)))})).finally((function(){le.setState({isPending:!1})}));case 36:case"end":return e.stop()}}),e,this,[[4,9]])})));return function(){return e.apply(this,arguments)}}()},{key:"changeAttributes",value:function(e){var t=e.isCustom,a=e.type,n=e.value,i=e.issueFieldId,r=this.state.attributes;this.setState({attributes:se(se({},r),t?{fields:se(se({},r.fields),{},(0,d.default)({},i,n))}:"assignee"===a?{assignee:n?n.value:null,defaultAssignee:n}:(0,d.default)({},a,n))})}},{key:"getAssigneeFieldWhetherRequired",value:function(e,t){if(!e||!t.length)return!1;var a=t.find((function(t){return"ASSIGNEE"===e[t].issueField.type}));return e[a].required}},{key:"setDefaultValues",value:function(e,t){var a=this.state.attributes,n=this.props.user,i={id:n.id,value:n.id,text:n.name,name:n.name,name_pinyin:n.name_pinyin,avatar:n.avatar,media:n.avatar};this.setState({attributes:(0,S.default)(a,(function(a){t&&t.forEach((function(t){var r=e[t],o=r.needDefault,s=r.value,l=r.userMap,c=r.issueField,d=c.type,f=c.componentType;if(o&&null!==s)switch(d){case w.FIELD_TYPE.ASSIGNEE:"VARIABLE"===s.type?(a.assignee=n.id,a.defaultAssignee=i):"CONSTANT"===s.type&&(a.assignee=s.value,a.defaultAssignee=l[s.value]);break;case w.FIELD_TYPE.PRIORITY:a.priority=s.value;break;case w.FIELD_TYPE.REQUIREMENT_TYPE:a.requirementType=s.value;break;case w.FIELD_TYPE.START_DATE:a.startDate=s.value;break;case w.FIELD_TYPE.DUE_DATE:a.dueDate=s.value;break;case w.FIELD_TYPE.MODULE:a.projectModule=s.value;break;case w.FIELD_TYPE.WORKING_HOURS:a.workingHours=s.value;break;case w.FIELD_TYPE.LABEL:a.labels=s.value;break;case w.FIELD_TYPE.WATCHER:"VARIABLE"===s.type?a.watchers=(0,u.default)("CREATOR"===s.value?[i]:[]):a.watchers=s.value.map((function(e){return l[e]}));break;case w.FIELD_TYPE.PROGRESS:a.progress=s.value;break;case w.FIELD_TYPE.DEFECT_TYPE:a.defectType=s.value;break;default:f===D.PROPERTY_TYPE_CONSTANTS.SELECT_MEMBER_SINGLE||f===D.PROPERTY_TYPE_CONSTANTS.SELECT_MEMBER_MULTI?"VARIABLE"===s.type?a.fields[t]=i:Array.isArray(s.value)?a.fields[t]=s.value.map((function(e){return l[e]})):a.fields[t]=l[s.value]:a.fields[t]=s.value}}))}))})}},{key:"resetFormData",value:function(){var e=this,t=this.props,a=t.workItemCreationFieldIDs,n=t.workItemSchemeFieldArchives,i=t.isShowCreateNext,r=this.state.autoNext;this.setState({name:"",attachments:[],thirdLinks:[],isPending:!1,attributes:{assignee:void 0,priority:void 0,requirementType:void 0,defectType:void 0,projectModule:void 0,dueDate:void 0,startDate:void 0,workingHours:void 0,labels:[],watchers:[],fields:{},progress:void 0},initEditorData:null,editorAutoFocus:!0},(function(){e.setDefaultValues(n,a),e.combineThirdLinks(),i&&r&&(e.initCreatePage(),e.setState({showDescriptionPlaceholder:!0}),e.titleInputFocus())}))}},{key:"fileUpload",value:function(e){this.setState({attachments:(0,S.default)(this.state.attachments,(function(t){t.splice.apply(t,[t.length,0].concat((0,u.default)(e)))}))},this.combineThirdLinks)}},{key:"handleDeleteAttachment",value:function(e,t){var a=this;(0,L.delAttachment)(e,t).then((function(){a.setState({attachments:(0,S.default)(a.state.attachments,(function(e){var a=e.findIndex((function(e){return e.fileId===t}));e.splice(a,1)}))},a.combineThirdLinks)}))}},{key:"onFileDropSuccess",value:function(e){var t=this;this.setState((function(t){return{attachments:(0,S.default)(t.attachments,(function(t){var a;if("MODAO"===e.thirdType)(0,j.success)("".concat((0,E.t)("\u5f15\u5165\u6210\u529f"))),a=t.findIndex((function(t){return t.timestamp===e.timestamp}));else if(t.find((function(t){return t.fileId===e.fileId}))){(0,j.success)("".concat(e.name).concat((0,E.t)(" \u6587\u4ef6\u5df2\u66f4\u65b0!")));var n=t.findIndex((function(t){return t.timestamp===e.timestamp}));t.splice(n,1),a=t.findIndex((function(t){return t.fileId===e.fileId}))}else a=t.findIndex((function(t){return t.timestamp===e.timestamp}));t[a]=se(se({},t[a]),e)}))}})),this.setState((function(){t.combineThirdLinks()}))}},{key:"onFileDropFail",value:function(e){var t=e.timestamp;this.setState({attachments:(0,S.default)(this.state.attachments,(function(e){var a=e.findIndex((function(e){return e.timestamp===t}));e.splice(a,1)}))})}},{key:"onFileDropDelete",value:function(e){var t=e.fileId,a=e.isModao,n=e.isCodesign,i=this.props.currentProject.id;a||n?this.setState({thirdLinks:this.state.thirdLinks.filter((function(e){return e.fileId!==t}))},this.combineThirdLinks):this.handleDeleteAttachment(i,t)}},{key:"onFileDropCancel",value:function(e){var t=e.timestamp,a=e.isModao,n=e.isCodesign;a||n?this.setState({thirdLinks:this.state.thirdLinks.filter((function(e){return e.timestamp!==t}))},this.combineThirdLinks):this.setState({attachments:(0,S.default)(this.state.attachments,(function(e){var a=e.findIndex((function(e){return e.timestamp===t}));e.splice(a,1)}))},this.combineThirdLinks)}},{key:"whetherShowMoveButton",value:function(){if(this.wrapperRef.current&&this.listRef.current){var e=this.wrapperRef.current.getBoundingClientRect().width,t=this.listRef.current.getBoundingClientRect().width;this.setState({showButton:t>e})}}},{key:"moveContent",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.wrapperRef.current&&this.listRef.current){var t=this.state.toLeft,a=this.wrapperRef.current.getBoundingClientRect(),n=a.width,i=this.listRef.current.getBoundingClientRect(),r=i.width,o=r+t-n;e?o<=n?this.setState({toLeft:t+-1*o,showButton:!1}):this.setState({toLeft:t-n}):o<=n?this.setState({toLeft:0,showButton:!0}):this.setState({toLeft:t+n})}}}]),a}(b.Component),s.propTypes=se(se({show:y.default.bool,isShowCreateNext:y.default.bool,closeHandle:y.default.func,callback:y.default.func,txcPostId:y.default.string,currentProject:y.default.shape({id:y.default.number.isRequired,name:y.default.string,owner_user_name:y.default.string}),user:y.default.object,labels:y.default.array,addLabel:y.default.func,parentCode:y.default.number,relatedCode:y.default.number,workItemSchemeFieldArchives:y.default.object,workItemCreationFieldIDs:y.default.array,requirementTypes:y.default.array,getWorkItemScheme:y.default.func,getRequirementTypes:y.default.func,bugTypes:y.default.array,getBugTypes:y.default.func,enterpriseGlobalKey:y.default.string,isDetail:y.default.bool,name:y.default.string,currentProjectCooperateSettings:y.default.object,createWithTargetCode:y.default.number},N.WithProjectPermissionProps),{},{callbackWithData:y.default.func}),s.defaultProps={isShowCreateNext:!0,isDetail:!1},o=l))||o)||o)||o)||o)||o;t.default=ce},NelW:function(e,t,a){"use strict";a("EK0E"),a("XfO3"),a("Btvt"),a("yt8O"),a("rGqo"),a("mYba");var n=a("TqRt"),i=a("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("0l/t"),a("KKXr"),a("xfY5");var r=n(a("J4zp")),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!==typeof e)return{default:e};var a=p(t);if(a&&a.has(e))return a.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=r?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}n.default=e,a&&a.set(e,n);return n}(a("cDcd")),s=n(a("rSJF")),l=a("gdfu"),c=n(a("sftu")),u=n(a("zmh9")),d=a("xgZS"),f=a("Z4vw");function p(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(p=function(e){return e?a:t})(e)}var m=function(e){var t=e.data,a=e.projectID,n=e.allowUpdate,i=e.onHourChange,p=(0,o.useState)(),m=(0,r.default)(p,2),h=m[0],v=m[1],g=(0,o.useState)(),E=(0,r.default)(g,2),b=E[0],y=E[1],S=(0,o.useState)(!1),I=(0,r.default)(S,2),T=I[0],C=I[1],P=(0,o.useState)(),w=(0,r.default)(P,2),D=w[0],O=w[1],R=(0,o.useState)(),j=(0,r.default)(R,2),k=j[0],N=j[1],A=function(e){var t=e.split(".").pop();return 1===t.length&&"0"===t[0]?Math.floor(e):e};(0,o.useEffect)((function(){!function(){var e=null===t||void 0===t?void 0:t.budgetedHourDetails.filter((function(e){return e.issueFieldName.indexOf("\u5f00\u53d1\u4f30\u7b97")>-1}))[0],a=null===t||void 0===t?void 0:t.budgetedHourDetails.filter((function(e){return e.issueFieldName.indexOf("\u6d4b\u8bd5\u4f30\u7b97")>-1}))[0];e&&(v(A(e.content)),O(e)),a&&(y(A(a.content)),N(a))}()}),[t]);return o.default.createElement("div",{className:s.default.toolContent,onClick:function(){n&&C(!0)}},o.default.createElement(l.Tooltip,{title:o.default.createElement("div",null,D?o.default.createElement("p",null,"\u5f00\u53d1\u4f30\u7b97\uff1a",Number(null===D||void 0===D?void 0:D.content)?"".concat(A(null===D||void 0===D?void 0:D.content)).concat(null===D||void 0===D?void 0:D.unit):"\u672a\u9884\u4f30"):null,k?o.default.createElement("p",null,"\u6d4b\u8bd5\u4f30\u7b97\uff1a",Number(null===k||void 0===k?void 0:k.content)?"".concat(A(null===k||void 0===k?void 0:k.content)).concat(null===k||void 0===k?void 0:k.unit):"\u672a\u9884\u4f30"):null)},"\u5de5\u65f6"),o.default.createElement(c.default,{className:s.default.toolWrapper,closeButton:!0,show:T,onHide:function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),C(!1)}},o.default.createElement(c.default.Body,{className:s.default.body},D?o.default.createElement("div",{style:{marginBottom:20}},o.default.createElement("p",{className:s.default.tooltitle},"\u5f00\u53d1\u4f30\u7b97"),o.default.createElement("div",{className:s.default.warpper},o.default.createElement(l.InputNumber,{style:{width:"240px"},controls:!1,maxLength:15,value:h,onChange:function(e){v(e)}}),o.default.createElement("span",null,null===D||void 0===D?void 0:D.unit))):null,k?o.default.createElement("div",null,o.default.createElement("p",{className:s.default.tooltitle},"\u6d4b\u8bd5\u4f30\u7b97"),o.default.createElement("div",{className:s.default.warpper},o.default.createElement(l.InputNumber,{style:{width:"240px"},controls:!1,maxLength:15,value:b,onChange:function(e){y(e)}}),o.default.createElement("span",null,k.unit))):null,o.default.createElement("div",{className:s.default.footer},o.default.createElement(u.default,{type:"default",onClick:function(){var e=[];D&&e.push({issueFieldId:D.issueFieldId,value:h||0}),k&&e.push({issueFieldId:k.issueFieldId,value:b||0}),(0,f.postJSON)("/external/collaboration/api/project/".concat(a,"/issues/sub-tasks/").concat(t.code,"/budgetedHours"),e).then((function(){i(),C(!1),(0,d.success)("\u4fee\u6539\u6210\u529f")}))}},"\u786e\u8ba4"),o.default.createElement(u.default,{empty:!0,onClick:function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),C(!1)}},"\u53d6\u6d88")))))};t.default=m},NhxX:function(e,t,a){e.exports={header:"header-3tZrLZ1lLk",text:"text-p_D_3hchLO",divider:"divider-1Hny1JgdFt",add:"add-2NteY6m615",disabled:"disabled-3bElk9f0MG",find:"find-3wzKx3rT1X",list:"list-2TvKvc6djq","dragging-item":"dragging-item-tp5aTcPNCy",draggingItem:"dragging-item-tp5aTcPNCy",item:"item-2miapHFhuB","item-is-over":"item-is-over-18Y1onn7Y9",itemIsOver:"item-is-over-18Y1onn7Y9","header-right":"header-right-2h-C0qUf58",headerRight:"header-right-2h-C0qUf58","tree-expand":"tree-expand-CIA3zn9FaO",treeExpand:"tree-expand-CIA3zn9FaO","tree-expand-open":"tree-expand-open-2yp0eas3_L",treeExpandOpen:"tree-expand-open-2yp0eas3_L","tree-expand-close":"tree-expand-close-17FSc19f9x",treeExpandClose:"tree-expand-close-17FSc19f9x","tree-expand-disabled":"tree-expand-disabled-3xmItiYkXy",treeExpandDisabled:"tree-expand-disabled-3xmItiYkXy",progress:"progress-2KvJmAGevt","progress-bar":"progress-bar-FSPpHXlnAn",progressBar:"progress-bar-FSPpHXlnAn","progress-bar-inner":"progress-bar-inner-1Hl2K1HcpD",progressBarInner:"progress-bar-inner-1Hl2K1HcpD","progress-text":"progress-text-2dC_hSQYwF",progressText:"progress-text-2dC_hSQYwF"}},NphA:function(e,t,a){e.exports={select:"select-nJ-Vsg1YBE","select-arrow-wrapper":"select-arrow-wrapper-1IU1610KiQ",selectArrowWrapper:"select-arrow-wrapper-1IU1610KiQ","menu-top":"menu-top-2AQWnEgOoE",menuTop:"menu-top-2AQWnEgOoE","select-with-label":"select-with-label-2d7kjEUV1r",selectWithLabel:"select-with-label-2d7kjEUV1r","select-trigger":"select-trigger-3QisaQt7bA",selectTrigger:"select-trigger-3QisaQt7bA","has-border":"has-border-3AulGLwsBX",hasBorder:"has-border-3AulGLwsBX","is-block":"is-block-1Tdhu8_d7d",isBlock:"is-block-1Tdhu8_d7d","item-text":"item-text-3Q_FXsTJ5J",itemText:"item-text-3Q_FXsTJ5J","not-selected":"not-selected-1wrtBNNGKZ",notSelected:"not-selected-1wrtBNNGKZ","is-expanded":"is-expanded-3ti_at0Umg",isExpanded:"is-expanded-3ti_at0Umg","inline-dropdown":"inline-dropdown-2uk7mcqbg9",inlineDropdown:"inline-dropdown-2uk7mcqbg9","item-label":"item-label-2LyMYFTM3b",itemLabel:"item-label-2LyMYFTM3b","item-text-ellipsis":"item-text-ellipsis-ZCPXUMi1Dv",itemTextEllipsis:"item-text-ellipsis-ZCPXUMi1Dv","clear-button":"clear-button-1SlUU4cze2",clearButton:"clear-button-1SlUU4cze2","to-top":"to-top-ip0pGGUigb",toTop:"to-top-ip0pGGUigb","to-right":"to-right-nxdhGiwprY",toRight:"to-right-nxdhGiwprY","trigger-background":"trigger-background-DEvWkkJ3qz",triggerBackground:"trigger-background-DEvWkkJ3qz","clear-divider":"clear-divider-2YvWJOMXpy",clearDivider:"clear-divider-2YvWJOMXpy",show:"show-4ZkJ8oM1HL",clear:"clear-3xloVCxlWm",root:"root-O9ZDP2VD56","trigger-wrapper":"trigger-wrapper-1ihuCZVpeK",triggerWrapper:"trigger-wrapper-1ihuCZVpeK",trigger:"trigger-AAdGUCniBD","item-label-ellipsis":"item-label-ellipsis-3Ba_mIl0RY",itemLabelEllipsis:"item-label-ellipsis-3Ba_mIl0RY","input-back-wrapper":"input-back-wrapper-2VI_BhGQNG",inputBackWrapper:"input-back-wrapper-2VI_BhGQNG","title-wrapper":"title-wrapper-12QFeJwHCy",titleWrapper:"title-wrapper-12QFeJwHCy","button-group":"button-group-E7z3DXqDWO",buttonGroup:"button-group-E7z3DXqDWO",button:"button-1Z0aMAbjwQ","align-top":"align-top-3sY7-FBakz",alignTop:"align-top-3sY7-FBakz","custom-title-wrapper":"custom-title-wrapper-2On-e6dw-p",customTitleWrapper:"custom-title-wrapper-2On-e6dw-p"}},OBZ8:function(e,t,a){"use strict";a.r(t);var n=a("mVeg"),i=a("cDcd"),r=a.n(i),o=a("mpRw"),s=a.n(o),l=a("yZ+p"),c=a.n(l),u=a("xgZS"),d=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(t,a)};return function(t,a){if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),f=function(){return(f=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},p=c.a.TextArea,m=function(e){function t(t){var a=e.call(this,t)||this;return a.state={laborValue:t.value,isEditing:!1,isValid:!0},a.handleChange=a.handleChange.bind(a),a.handleConfirm=a.handleConfirm.bind(a),a.handleCancel=a.handleCancel.bind(a),a.handleFocus=a.handleFocus.bind(a),a.keydownHandler=a.keydownHandler.bind(a),a}return d(t,e),t.prototype.componentDidMount=function(){var e=this.props.value;this.initValue(e),document.addEventListener("keydown",this.keydownHandler)},t.prototype.componentWillUnmount=function(){document.removeEventListener("keydown",this.keydownHandler),document.removeEventListener("click",this.handleCancel)},t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.value!==this.props.value&&this.initValue(e.value)},t.prototype.initValue=function(e){this.setState({laborValue:e})},t.prototype.renderDisabled=function(){var e=this.props,t=e.placeholder,a=e.unit,n=this.state.laborValue;return r.a.createElement("div",{className:"".concat(s.a.disabled," ").concat(!n&&s.a.disabledPlaceholder),title:n?"".concat(n," ").concat(a||""):t},!!n&&"".concat(n," ").concat(a||"")||t)},t.prototype.getTextarea=function(){var e=this,t=this.state,a=t.laborValue,n=t.isEditing,i=this.props,o=i.placeholder,s=i.unit;return i.disabled?this.renderDisabled():r.a.createElement(p,{value:n?a:!!a&&"".concat(a," ").concat(s||"")||"",onChange:this.handleChange,onBlur:this.handleConfirm,resizeable:!1,autosize:{minRows:2,maxRows:4},placeholder:o,ref:function(t){e.inputRef=t}})},t.prototype.getInput=function(){var e=this,t=this.state,a=t.laborValue,n=t.isEditing,i=this.props,o=i.maxLength,s=i.placeholder,l=i.unit,u=i.isNumber;return i.disabled?this.renderDisabled():r.a.createElement(c.a,f({},l?{suffix:n&&r.a.createElement("span",null,l)}:{},{value:n?a:!!a&&"".concat(a," ").concat(l||"")||"",onChange:this.handleChange,maxLength:u?o||15:o,placeholder:s,ref:function(t){e.inputRef=t},onBlur:this.handleConfirm}))},t.prototype.render=function(){var e=this,t=this.state,a=t.isEditing,i=t.isValid,o=this.props,l=o.className,c=o.multiple,u=o.isCreate;return r.a.createElement("div",{className:"".concat(s.a.root," ").concat(l," ").concat(!i&&s.a.isError," ").concat(a&&s.a.isEditing),ref:function(t){return e.containerRef=t},title:Object(n.t)("ctrl + enter \u786e\u8ba4")},r.a.createElement("div",{className:"".concat(s.a.inputWrapper," ").concat(c&&u?s.a.isCreation:""),onClick:this.handleFocus},c?this.getTextarea():this.getInput()))},t.prototype.handleChange=function(e){this.setState({laborValue:e.target.value,isEditing:!0})},t.prototype.handleCancel=function(){var e=this.props.value;this.setState({laborValue:e,isEditing:!1,isValid:!0}),document.removeEventListener("click",this.handleCancel)},t.prototype.keydownHandler=function(e){var t=this.state.isEditing;"Enter"===e.key&&e.ctrlKey&&t&&this.handleConfirm()},t.prototype.handleConfirm=function(){var e,t=this,a=this.state.laborValue,i=this.props,r=i.dangerTip,o=i.isNumber,s=i.isDecimals,l=i.maxLength,c=!0,d=o?l||15:l,f=Object(n.t)("\u6700\u5927\u652f\u6301{{num}}\u4f4d\u6570\u5b57",{num:d}),p=Object(n.t)("\u6700\u5927\u652f\u6301{{num}}\u4f4d\u6574\u6570",{num:d});a&&o&&s&&(e=f,c=/^-?(\d+\.?\d*)$/.test(a));if(a&&o&&!s){e=p;var m="^-?(?!0\\d)[0-9]{0,".concat(d,"}$");c=new RegExp(m).test(a)}c?(this.props.onChange({content:a}),this.setState({isValid:c,isEditing:!1}),setTimeout((function(){t.inputRef&&t.inputRef.blur()}))):(this.setState({isValid:c}),Object(u.danger)(e||r))},t.prototype.handleFocus=function(){var e=this;this.props.disabled||(this.setState({isEditing:!0,isValid:!0}),document.addEventListener("click",(function(t){var a;(null===(a=e.containerRef)||void 0===a?void 0:a.contains(t.target))||e.handleCancel()})))},t.defaultProps={placeholder:Object(n.t)("\u8bf7\u8f93\u5165"),isNumber:!1,isDecimals:!1,multiple:!1},t}(i.Component);t.default=m},OCsZ:function(e,t,a){"use strict";a.r(t);var n=a("mVeg"),i=a("cDcd"),r=a.n(i),o=a("K2gz"),s=a.n(o),l=a("ixw1"),c=a.n(l),u=function(e){var t=e.checked,a=e.loading,n=e.disabled,i=e.className,o=e.onChange;return r.a.createElement("div",{className:s()([c.a.switch,t&&c.a.switchChecked,!t&&c.a.switchUnChecked,n&&t&&c.a.activeDisabled,n&&!t&&c.a.disabled,i]),onClick:function(){return n?void 0:o&&o()}},r.a.createElement("div",{className:s()([c.a.on,t&&c.a.checked,!t&&c.a.unChecked])},a&&r.a.createElement("div",{className:s()([c.a.loading])})))},d=a("IGR9"),f=a.n(d),p=function(e){var t=e.className,a=e.dragable,i=void 0!==a&&a,o=e.item,l=e.disabled,c=void 0!==l&&l,d=e.onChange;return r.a.createElement("div",{className:s()([f.a.container,t])},i&&r.a.createElement("div",{className:f.a.drag}),r.a.createElement("div",{className:s()([!i&&f.a.title,f.a.name])},("PROJECT"===o.type?Object(n.t)("\u7814\u53d1\u7a7a\u95f4"):o.name)+(o.unit?" (".concat(o.unit,")"):"")),r.a.createElement(u,{disabled:c,className:f.a.swith,checked:o.visible,onChange:d}))},m=a("l8Oe"),h=a("DDKl"),v=a("d3LG"),g=a.n(v),E=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},b=function(e){var t=e.item,a=e.originalIndex,n=e.moveCard,o=e.onDrop,s=e.onChange,l=null,c=E(Object(m.useDrag)({item:{type:T.SETTING,name:t.name,index:a,visible:t.visible,issueFieldId:t.issueFieldId},collect:function(e){return{isDragging:e.isDragging()}},end:function(e,t){var a=t.getItem(),n=a.name,i=a.issueFieldId;console.log(t.getItem()),t.isDragging()&&o(n,i)},canDrop:function(){return!0}}),3),u=c[0].isDragging,d=c[1],f=c[2],v=E(Object(m.useDrop)({accept:T.SETTING,canDrop:function(){return!0},hover:function(e,t){if(l){var i=e.index,r=a;if(i!==r){var o=l.getBoundingClientRect(),s=(o.bottom-o.top)/2,c=t.getClientOffset();if(c){var u=c.y-o.top;i<r&&u<s||i>r&&u>s||(n(i,r),e.index=r)}}}}}),2)[1];return Object(i.useEffect)((function(){f(Object(h.getEmptyImage)(),{captureDraggingState:!0})}),[]),r.a.createElement("div",{ref:function(e){d(v(e)),l=e}},!u&&r.a.createElement(p,{item:t,dragable:!0,onChange:s}),u&&r.a.createElement("div",{className:g.a.dragging}))},y=function(){return(y=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},S=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},I=function(e,t,a){if(a||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},T={SETTING:"TABLE_SETTING"},C=function(e){var t=e.dragListData,a=e.onChange,n=S(Object(i.useState)(),2),o=n[0],s=n[1],l=S(Object(i.useState)(0),2),c=l[0],u=l[1];Object(i.useEffect)((function(){s(t),u(t.length)}),[e.dragListData]);var d=Object(i.useCallback)((function(e,t){if(o){var a=o.splice(e,1)[0];o.splice(t,0,a),s(I([],S(o),!1))}}),[o]),f=function(e,t){var n,i=function(e,t){var a=null===o||void 0===o?void 0:o.find((function(a){return"\u7248\u672c"===a.name||"\u8fed\u4ee3"===a.name?a.issueFieldId===t:a.name===e}));return{item:a,index:o&&a?o.indexOf(a):-1}}(e,t),r=i.item,s=i.index;console.log(o,r);var l=s>=c?null:o&&o[s+1],u=l?"".concat("CUSTOM"===l.type?"".concat(l.type,"_").concat(l.issueFieldId):l.type):"END",d=l?l.name:"END",f=null!==(n=null===l||void 0===l?void 0:l.issueFieldId)&&void 0!==n?n:2147483648,p=r,m=p.issueFieldId,h=p.type,v=p.name;a({issueFieldId:m,referId:f,type:h,name:v,beforeType:u,beforeName:d})};return r.a.createElement(r.a.Fragment,null,c>0&&(null===o||void 0===o?void 0:o.map((function(e,t){return r.a.createElement(b,{key:e.id,item:e,originalIndex:t,moveCard:d,onDrop:f,onChange:function(){return a(y(y({},e),{visible:!e.visible}))}})}))))},P=a("lAyh"),w=a("E4ga"),D=a.n(w),O=a("z6Fr"),R=function(){return(R=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},j=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o};t.default=function(e){var t=e.settingData,a=e.onChange,o=e.onClose,l=e.onReset,c=j(Object(i.useState)([]),2),u=c[0],d=c[1],f=j(Object(i.useState)([]),2),m=f[0],h=f[1];Object(i.useEffect)((function(){var e,a,n;if(t&&(null===(e=null===t||void 0===t?void 0:t.fields)||void 0===e?void 0:e.length)>0){var i=t.fields.length;"GID"===(null===(n=null===(a=null===t||void 0===t?void 0:t.fields)||void 0===a?void 0:a[0])||void 0===n?void 0:n.type)&&t.fields.shift(),d(t.fields.slice(0,2)),h(t.fields.slice(2,i))}}),[t]);var v=Object(i.useCallback)((function(e){return r.a.createElement(p,{className:D.a.dragLayer,item:e,dragable:!0})}),[]);return r.a.createElement("div",{className:D.a.container,onClick:o},r.a.createElement("div",{className:D.a.main,onClick:function(e){return e.stopPropagation()}},r.a.createElement("div",{className:D.a.sticky},r.a.createElement("div",{className:D.a.paddingContainer},r.a.createElement("div",{className:D.a.content},r.a.createElement("div",{className:D.a.headerTitle}," ",Object(n.t)("\u8868\u683c\u663e\u793a\u8bbe\u7f6e")," "),r.a.createElement("div",{className:D.a.close,onClick:o})),r.a.createElement("div",{className:D.a.content},r.a.createElement("div",{className:D.a.title},Object(n.t)("\u663e\u793a\u5bc6\u5ea6")),r.a.createElement("div",{className:D.a.content},r.a.createElement("div",{className:s()([D.a.comfortable,(null===t||void 0===t?void 0:t.displayType)===O.d.loose&&D.a.checked]),onClick:function(){return a({displayType:O.d.loose})}}),r.a.createElement("div",{className:s()([D.a.compact,(null===t||void 0===t?void 0:t.displayType)===O.d.tight&&D.a.checked]),onClick:function(){return a({displayType:O.d.tight})}})))),r.a.createElement("div",{className:D.a.split}),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:s()([D.a.content,D.a.gap])},r.a.createElement("div",{className:D.a.title},Object(n.t)("\u8868\u5934\u8bbe\u7f6e")),r.a.createElement("label",{className:D.a.reset,htmlFor:Object(n.t)("\u6062\u590d\u9ed8\u8ba4"),onClick:l},Object(n.t)("\u6062\u590d\u9ed8\u8ba4"))),u.map((function(e){return r.a.createElement(p,{key:e.id,item:e,dragable:!1,onChange:function(){return a(R(R({},e),{visible:!e.visible}))},disabled:e.type===O.a.title})}))),r.a.createElement("div",{className:D.a.splitWithText},r.a.createElement("div",{className:D.a.text},Object(n.t)("\u4ee5\u4e0a\u5c5e\u6027\u4e0d\u53ef\u6392\u5e8f")))),r.a.createElement(P.b,{type:T.SETTING,isSort:!0},v),r.a.createElement(C,{dragListData:m,onChange:a})))}},OHfB:function(e,t,a){"use strict";var n=a("mVeg"),i=a("cDcd"),r=a.n(i),o=a("pKat"),s=a.n(o),l=a("K2gz"),c=a.n(l),u=a("dtw8"),d=a("KUqB"),f=a("DTVk"),p=a("ZTlW"),m=a("BXnm"),h=a("5kKY"),v=a("w3Wo"),g=a("xgZS"),E=a("+QRC"),b=a.n(E),y=a("HwxY"),S=a("L8Eh"),I=a("iTKN"),T=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},C=function(e,t,a){if(a||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))};t.a=function(e){var t=e.data,a=e.style,o=e.projectID,l=e.fetchList,E=e.allowUpdate,P=e.projectPath,w=e.className,D=e.issueCode,O=e.blockType,R=(e.isPortal,e.isScroll),j=e.resetIsScroll,k=e.onIssueChange,N=(e.isDetail,e.currentProject),A=e.disabledBottomSpace,L=T(Object(i.useState)(),2),F=L[0],_=L[1];Object(i.useEffect)((function(){(null===t||void 0===t?void 0:t.dueDate)&&_(Math.ceil(((new Date).getTime()-t.dueDate)/864e5))}),[t]);var M=function(e){return Object(v.modifyIssue)(t.type,o,t.code,e).then((function(e){return Object(g.success)(Object(n.t)("\u66f4\u65b0\u6210\u529f")),l(),k&&k(e.data.code),e}))},x=function(){switch(t.type){case f.IssueType.requirement:return"".concat(P,"/requirements/issues/").concat(t.code,"/detail");case f.IssueType.assignment:return"".concat(P,"/assignments/issues/").concat(t.code,"/detail");case f.IssueType.bug:return"".concat(P,"/bug-tracking/issues/").concat(t.code,"/detail");default:return""}},B=function(){return document.querySelector('div[data-frontend-module-container="coding-project-management-frontend"]')},U=C([{id:"copy",name:Object(n.t)("\u590d\u5236\u94fe\u63a5")}],T(E?[{id:"divider",name:"",type:"divider"},{id:"remove",name:Object(n.t)("\u89e3\u9664\u963b\u585e\u5173\u7cfb")}]:[]),!1),W=Object(i.useCallback)((function(e){switch(e.id){case"remove":Object(v.delBlockRelation)(o,D,{blockIssueCode:t.code,blockType:O}).then((function(){Object(g.success)(Object(n.t)("\u89e3\u9664\u963b\u585e\u5173\u7cfb\u6210\u529f")),l(),k&&k(t.code,D)}));break;case"copy":b()("".concat(window.location.origin).concat(x())),Object(g.success)(Object(n.t)("\u6210\u529f\u590d\u5236\u5230\u526a\u5207\u677f"))}}),[]),Y=t.status&&t.status.type&&"COMPLETED"===t.status.type;return r.a.createElement(y.default.Consumer,null,(function(e){var i,l;return r.a.createElement("div",{className:c()(s.a.item,w),style:a},r.a.createElement("div",{className:s.a.itemIcon},r.a.createElement(d.default,{type:null===(i=null===t||void 0===t?void 0:t.issueTypeDetail)||void 0===i?void 0:i.iconType})),r.a.createElement(u.Link,{to:x(),target:"_blank",className:s.a.itemCode},"#",t.code),r.a.createElement(u.Link,{to:x(),target:"_blank",className:s.a.itemName,title:t.name},t.name),!!F&&F>0&&!Y&&r.a.createElement("span",{className:s.a.itemDelay},Object(n.t)("\u903e\u671f {{delay}} \u5929",{delay:F})),t.dueDate&&!(F&&F>0)&&r.a.createElement("div",{className:s.a.itemDate},r.a.createElement(p.a,{date:t.dueDate,isCompleted:Y})),r.a.createElement("div",{className:s.a.itemStatus},r.a.createElement(m.StatusSelect,{value:t.status,projectID:o,project:N,issueCode:t.code,disabled:!E,onSelect:function(e){return M(e)},disabledBottomSpace:A,isPortal:!0,portalProps:{portalContainer:B(),portalWrapStyle:{zIndex:1055},isScroll:R,resetIsScroll:j,toRight:!0,scrollControl:e.scrollControl}})),r.a.createElement("div",{className:s.a.itemAssignee},r.a.createElement(S.default,{componentType:I.ComponentType.ICON,disabled:!E,inProject:!0,projectID:o,value:null===(l=t.assignee)||void 0===l?void 0:l.id,onSelect:function(e){M({assignee:e.id})},onClear:function(){M({assignee:0})},triggerExtraProps:{initialSelectedItem:t.assignee},isPortal:!0,portalProps:{portalContainer:B(),portalWrapStyle:{zIndex:1055},isScroll:R,resetIsScroll:j,toRight:!0,scrollControl:e.scrollControl},disabledBottomSpace:A})),r.a.createElement("div",null,r.a.createElement(h.ItemDropdown,{options:U,onSelect:W,popupStyle:{width:160},isPortal:!0,portalProps:{portalContainer:B(),portalWrapStyle:{zIndex:1055},isScroll:R,resetIsScroll:j,toRight:!0,scrollControl:e.scrollControl}})))}))}},OM2l:function(e,t,a){"use strict";var n=a("mVeg"),i=a("cDcd"),r=a.n(i),o=a("sftu"),s=a.n(o),l=a("yZ+p"),c=a.n(l),u=a("f0yp"),d=a.n(u),f=a("w3Wo"),p=a("xgZS"),m=a("KUqB"),h=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o};t.a=function(e){var t,a=e.onVisibleChange,o=e.projectID,l=e.issueCode,u=e.fetchList,v=Object(i.useRef)(null),g=h(Object(i.useState)(""),2),E=g[0],b=g[1],y=h(Object(i.useState)([]),2),S=y[0],I=y[1],T=function(e){Object(f.fetchParent)(o,l,{keyword:e}).then((function(e){I(e.data)}))},C=Object(i.useCallback)((function(e){var a=e.target.value;b(a),window.clearTimeout(t),t=window.setTimeout((function(){T(a)}),800)}),[]),P=Object(i.useCallback)((function(){b(""),T("")}),[]);return Object(i.useEffect)((function(){T("")}),[]),r.a.createElement(s.a,{closeButton:!0,outsideClickCloseable:!1,show:!0,onHide:function(){return a(!1)},className:d.a.wrapper,keyboard:!1},r.a.createElement("div",{className:d.a.title},Object(n.t)("\u66f4\u6539\u7236\u9700\u6c42")),r.a.createElement(c.a,{value:E,className:d.a.customInput,ref:v,onChange:C,prefix:r.a.createElement("div",{className:d.a.customSearchIcon}),suffix:r.a.createElement("div",{className:d.a.cancelBtn,onClick:P},Object(n.t)("\u53d6\u6d88")),size:"medium",placeholder:Object(n.t)("\u8f93\u5165\u7236\u9700\u6c42 ID \u6216\u6807\u9898")}),r.a.createElement("div",{className:d.a.customResult,onScroll:function(e){return e.stopPropagation()}},r.a.createElement("div",{className:d.a.resultWrapper},!!S.length&&r.a.createElement("div",{className:d.a.resultItems},S.map((function(e){return r.a.createElement("div",{className:d.a.item,key:e.code,onClick:function(){return t=e.code,void Object(f.updateParent)(o,l,{parentRequirementCode:t}).then((function(){Object(p.success)(Object(n.t)("\u66f4\u65b0\u6210\u529f")),a(!1),u()}));var t}},r.a.createElement("div",{className:d.a.itemIcon},r.a.createElement(m.default,{type:e.issueTypeDetail.iconType})),r.a.createElement("div",{className:d.a.itemCode},"#",e.code),r.a.createElement("div",{className:"".concat(d.a.itemDetail," ").concat(d.a.customDetail)},r.a.createElement("div",{className:d.a.itemDetailTitle},e.name)),e.iteration&&r.a.createElement("div",{className:d.a.belongIteration},e.iteration.name))}))),!S.length&&r.a.createElement("div",{className:d.a.resultEmpty},r.a.createElement("div",{className:"".concat(d.a.icon," ").concat(d.a.customSearchIcon)}),Object(n.t)("\u6ca1\u6709\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c")))))}},OTim:function(e,t,a){"use strict";a.r(t),a.d(t,"StoryBadge",(function(){return p}));var n=a("mVeg"),i=a("cDcd"),r=a.n(i),o=a("BKNj"),s=a("iTKN"),l=a("K2gz"),c=a.n(l),u=a("vih4"),d=a.n(u);function f(e,t){return null===e||void 0===e?"-":t?void 0!==s.STORY_POINT_MAP[e]?s.STORY_POINT_MAP[e][1]:"-":s.STORY_POINT_MAP[e][0]}var p=function(e){var t=e.val;return e.useSize?r.a.createElement("span",{className:d.a.storypoint},f(t,!0)):r.a.createElement("span",{className:d.a.storypoint},void 0===t||null===t?"-":t)},m=Object(i.memo)((function(e){var t=e.value,a=e.active,n=e.disabled,i=e.useSize;return r.a.createElement("div",{className:c()(d.a.trigger,a&&d.a.active,n&&d.a.disabled)},r.a.createElement("div",{className:d.a.content},r.a.createElement(p,{val:f(t,!!i)})),r.a.createElement("span",{className:c()(d.a.caret)}))})),h=a("Mukx"),v=a.n(h),g=Object(i.forwardRef)((function(e,t){var a=e.value,n=e.items,i=e.onSelect;return r.a.createElement("div",{className:v.a.storypointItems,ref:t},n.map((function(e){return r.a.createElement("span",{key:e[0],className:c()([v.a.storypointItem,a===e[0]?v.a.active:""]),onClick:function(){i(e[0])}},e[1])})))})),E=Object(i.memo)(g),b=a("h74D"),y=a("nuIr"),S=function(){return(S=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};t.default=Object(b.connect)((function(e){var t;return{currentProjectCooperateSettings:null===(t=null===e||void 0===e?void 0:e.APP)||void 0===t?void 0:t.currentProjectCooperateSettings}}),{})((function(e){var t,a,i=(null===(t=null===e||void 0===e?void 0:e.currentProjectCooperateSettings)||void 0===t?void 0:t.STORY_POINT_TYPE)===y.STORY_POINT_TYPE.TSHIRT;return r.a.createElement(o.default,S({},e,{searchable:!1,clearButtonText:Object(n.t)("\u6e05\u9664\u6545\u4e8b\u70b9"),items:(a=i,a?[[1,"XS"],[2,"S"],[5,"M"],[13,"L"],[20,"XL"],[40,"XXL"]]:[[0,"0"],[.5,"\xbd"],[1,"1"],[2,"2"],[3,"3"],[5,"5"],[8,"8"],[13,"13"],[20,"20"],[40,"40"]]),Trigger:m,triggerExtraProps:{useSize:i},CustomPanel:E,panelExtraProps:e.panelExtraProps}))}))},OWZr:function(e,t,a){e.exports={trigger:"trigger-SA5jcB3BQJ","trigger-icon":"trigger-icon-2AFiSTltlm",triggerIcon:"trigger-icon-2AFiSTltlm","trigger-active":"trigger-active-3PGVjceFDL",triggerActive:"trigger-active-3PGVjceFDL",popup:"popup-1o_azi6yan",option:"option-2GFBPjNbOi","option-name":"option-name-2NARmG8xcU",optionName:"option-name-2NARmG8xcU","option-icon":"option-icon-2K5L9Vmxyi",optionIcon:"option-icon-2K5L9Vmxyi"}},OZ9x:function(e,t,a){e.exports=a.p+"5c618f00b00ef90cb2b5ee1a1bdb5607.svg"},"Oo+0":function(e,t,a){"use strict";a.r(t);var n,i=a("mVeg"),r=a("cDcd"),o=a.n(r),s=a("NhxX"),l=a.n(s),c=a("LMMh"),u=a.n(c),d=a("K2gz"),f=a.n(d),p=a("246l"),m=a.n(p),h=a("yZ+p"),v=a.n(h),g={MISSION:{title:Object(i.t)("\u5b50\u4efb\u52a1"),placeholder:Object(i.t)("\u8f93\u5165\u6807\u9898\u5feb\u901f\u521b\u5efa\u4efb\u52a1"),relate:Object(i.t)("\u5173\u8054\u5df2\u6709\u4efb\u52a1")},REQUIREMENT:{title:Object(i.t)("\u5b50\u9700\u6c42"),placeholder:Object(i.t)("\u8f93\u5165\u6807\u9898\u5feb\u901f\u521b\u5efa\u9700\u6c42"),relate:Object(i.t)("\u5173\u8054\u5df2\u6709\u9700\u6c42")}},E=a("qEFv"),b=a("5kKY"),y=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},S=function(e){var t=e.onCancel,a=e.type,n=e.onFastCreate,s=e.scrollTargetId,l=e.controlFocus,c=e.onFullCreate,d=e.onTitleChange,p=e.clearTitle,h=e.getInstance,S=e.onSelectIssueType,I=e.willCreateIssueType,T=e.issueTypeOptions,C=y(Object(r.useState)(""),2),P=C[0],w=C[1],D=Object(r.useRef)(""),O=Object(r.useCallback)((function(e){var t=e.target.value;w(t),D.current=t,d(t)}),[]),R=y(Object(r.useState)(!1),2),j=R[0],k=R[1],N=Object(r.useCallback)((function(e){k(e)}),[]),A=Object(r.useRef)(null),L=Object(r.useCallback)((function(){w(""),D.current="",d(""),A.current&&A.current.focus()}),[]);Object(r.useEffect)((function(){h(A)}),[]);Object(r.useEffect)((function(){A.current&&A.current.focus()}),[l]),Object(r.useEffect)((function(){L()}),[p]);var F=Object(r.useCallback)((function(e){13===e.keyCode?e.shiftKey?(A.current&&A.current.blur(),c()):n(D.current,L):27===e.keyCode&&t()}),[]);return Object(r.useEffect)((function(){return A.current&&A.current.input&&(A.current.input.onkeydown=F),function(){A.current&&A.current.input&&(A.current.input.onkeydown=null)}}),[]),o.a.createElement("div",{className:u.a.wrapper,id:s},o.a.createElement(v.a,{ref:A,prefix:o.a.createElement(E.CategorySelect,{value:I,onSelect:S,options:T}),suffix:o.a.createElement("div",{className:u.a.inputAfter},P&&o.a.createElement("div",{className:u.a.inputClear,onClick:L}),o.a.createElement(b.Trigger,{visible:j,onVisibleChange:N,popup:o.a.createElement("div",{className:u.a.popup},o.a.createElement("div",{className:u.a.popupItem,onClick:function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),c()}},o.a.createElement("div",{className:u.a.popupItemText},Object(i.t)("\u5b8c\u6574\u521b\u5efa")),o.a.createElement("div",{className:u.a.popupItemShift}),o.a.createElement("div",{className:u.a.popupItemEnter})))},o.a.createElement("div",{className:u.a.inputCreate},o.a.createElement("div",{className:u.a.inputCreateText,onClick:function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),n(P,L)}},Object(i.t)("\u521b\u5efa")),o.a.createElement("div",{className:u.a.inputCreateArrow}))),o.a.createElement("div",{onClick:t,className:f()(u.a.inputCancel,m.a.newButton,m.a.default,m.a.h24)},Object(i.t)("\u53d6\u6d88"))),placeholder:g[a].placeholder,value:P,onChange:O}))},I=a("5hMc"),T=a.n(I),C=a("KUqB"),P=a("w3Wo"),w=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},D=function(e){var t,a=e.onCancel,n=e.type,s=e.projectID,l=e.parentCode,c=e.fetchList,u=w(Object(r.useState)(""),2),d=u[0],p=u[1],h=w(Object(r.useState)([]),2),g=h[0],E=h[1],b=function(e){Object(P.getChildIssues)(s,l,{keyword:e,type:n}).then((function(e){E(e.data)}))},y=Object(r.useCallback)((function(e){var a=e.target.value;p(a),window.clearTimeout(t),t=window.setTimeout((function(){b(a)}),800)}),[]),S=Object(r.useCallback)((function(e){27===e.keyCode&&a()}),[]),I=Object(r.useRef)(),D=Object(r.useCallback)((function(){var e;p(""),b(""),null===(e=null===I||void 0===I?void 0:I.current)||void 0===e||e.focus()}),[]);Object(r.useEffect)((function(){b(d)}),[]);return o.a.createElement("div",{className:T.a.wrapper},o.a.createElement(v.a,{ref:I,autoFocus:!0,prefix:o.a.createElement("div",{className:T.a.inputBefore}),suffix:o.a.createElement("div",{className:T.a.inputAfter},d&&o.a.createElement("div",{className:T.a.inputClear,onClick:D}),o.a.createElement("div",{onClick:a,className:f()(T.a.inputCancel,m.a.newButton,m.a.default,m.a.h24)},Object(i.t)("\u53d6\u6d88"))),placeholder:Object(i.t)("\u8f93\u5165\u4e8b\u9879\u5e94\u7528 ID \u6216\u6807\u9898"),value:d,onChange:y,onKeyDown:S}),o.a.createElement("div",{className:T.a.panel,onScroll:function(e){e.stopPropagation()}},o.a.createElement("div",{className:T.a.panelContainer},g.map((function(e){return o.a.createElement("div",{key:e.code,className:T.a.item,onClick:function(){return t=e.code,void Object(P.relateIssue)(s,l,{childCode:t}).then((function(){D(),c()}));var t}},o.a.createElement(C.default,{type:e.issueTypeDetail.iconType}),o.a.createElement("div",{className:T.a.itemCode},"#",e.code),o.a.createElement("div",{className:T.a.itemName},e.name))}))),!g.length&&o.a.createElement("div",{className:T.a.itemEmpty},Object(i.t)("\u65e0\u641c\u7d22\u7ed3\u679c"))))},O=a("OajT"),R=a.n(O),j=a("DTVk"),k=a("xgZS"),N=a("OM2l"),A=a("l8Oe"),L=a("DDKl"),F=a.n(L),_=a("lAyh"),M=a("K+UL"),x=a.n(M),B=a("ZTlW"),U=a("BXnm"),W=a("+QRC"),Y=a.n(W),H=a("HwxY"),V=a("6Mal"),G=a("L8Eh"),K=a("iTKN"),z=a("nuIr"),q=a("NelW"),Z=a.n(q),J=function(){return(J=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},X=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},Q=function(e,t,a){if(a||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},$=function(e){var t=e.data,a=e.parentCode,n=e.currentCode,s=e.isDetail,l=e.style,c=e.className,u=e.projectID,d=e.fetchList,p=e.allowUpdate,m=e.allowDelete,h=e.projectPath,v=e.onUpdateParent,g=e.onDelete,E=e.draggingIndex,y=e.browserRouter,S=e.query,I=e.isLastChild,T=e.disabledBottomSpace,w=e.copyIssues,D=function(e){return Object(P.modifyIssue)(t.type,u,t.code,e).then((function(e){return Object(k.success)(Object(i.t)("\u66f4\u65b0\u6210\u529f")),d(),e}))},O=function(){switch(t.type){case j.IssueType.requirement:return"".concat(h,"/requirements/issues/").concat(t.code,"/detail");case j.IssueType.assignment:return"".concat(h,"/assignments/issues/").concat(t.code,"/detail");case j.IssueType.bug:return"".concat(h,"/bug-tracking/issues/").concat(t.code,"/detail");default:return""}},R=function(){return document.querySelector('div[data-frontend-module-container="coding-project-management-frontend"]')},N=Q(Q(Q(Q([{id:"detail",name:Object(i.t)("\u65b0\u7a97\u53e3\u6253\u5f00"),link:{path:O()}},{id:"copy",name:Object(i.t)("\u590d\u5236\u94fe\u63a5")}],X(w?[{id:"copyIssues",name:Object(i.t)("\u590d\u5236\u4e8b\u9879")}]:[]),!1),X(m||p?[{id:"divider",name:"",type:"divider"}]:[]),!1),X(p&&!z.KA_DEFECT_EDIT_ENTRY_DISABLE?[{id:"remove",name:Object(i.t)("\u89e3\u9664\u5173\u8054")}]:[]),!1),X(m?[{id:"delete",name:Object(i.t)("\u5220\u9664"),type:"delete"}]:[]),!1),A=Object(r.useCallback)((function(e){switch(e.id){case"parent":v(t.code);break;case"remove":Object(P.detachIssue)(u,t.code).then((function(){Object(k.success)(Object(i.t)("\u53d6\u6d88\u5173\u8054\u6210\u529f")),d()}));break;case"copy":Y()("".concat(window.location.origin).concat(O())),Object(k.success)(Object(i.t)("\u6210\u529f\u590d\u5236\u5230\u526a\u5207\u677f"));break;case"delete":g(t);break;case"copyIssues":w&&w(t)}}),[]),L=t.issueStatus&&t.issueStatus.type&&"COMPLETED"===t.issueStatus.type,F=X(Object(r.useState)(!1),2),_=F[0],M=F[1],W=function(){M(!0)},q=function(){M(!1)},$=function(){y.push(O())},ee=function(){s?y.push({pathname:"".concat(h,"/requirements/issues/").concat(a,"/detail/subissues/").concat(t.code),query:J({},S)}):$()};return o.a.createElement(H.default.Consumer,null,(function(e){var a;return o.a.createElement("div",{className:f()(x.a.item,_&&-1===E&&x.a.itemHovering,n===t.code&&x.a.itemHovering,c,I&&x.a.lastChild),style:l,onMouseEnter:W,onMouseLeave:q},o.a.createElement(C.default,{type:t.issueTypeDetail.iconType}),o.a.createElement("div",{className:x.a.itemCode,onClick:$},"#",t.code),o.a.createElement("div",{className:x.a.itemName,onClick:ee,title:t.name},t.name),t.dueDate&&o.a.createElement("div",{className:x.a.itemDate},o.a.createElement(B.a,{date:t.dueDate,isCompleted:L})),o.a.createElement("div",{className:x.a.itemPriority},o.a.createElement(V.default,{componentType:K.ComponentType.ICON,value:t.priority,disabled:!p,onSelect:function(e){var t=e.id;return D({priority:t})},isPortal:!0,portalProps:{portalContainer:R(),toRight:!0,scrollControl:e.scrollControl},disabledBottomSpace:T})),o.a.createElement("div",{className:x.a.timeTool},(null===t||void 0===t?void 0:t.budgetedHoursShow)?o.a.createElement(Z.a,{data:t,projectID:u,onHourChange:d,allowUpdate:p}):null),o.a.createElement("div",{className:x.a.itemStatus},o.a.createElement(U.StatusSelect,{value:t.issueStatus,projectID:u,project:t.project,issueCode:t.code,disabled:!p,onSelect:function(e){return D(e)},portalContainer:R,portalAlign:{top:21,toRight:!0},disabledBottomSpace:T})),o.a.createElement("div",{className:x.a.itemAssignee},o.a.createElement(G.default,{componentType:K.ComponentType.ICON,disabled:!p,inProject:!0,projectID:u,value:null===(a=t.assignee)||void 0===a?void 0:a.id,onSelect:function(e){D({assignee:e.id})},onClear:function(){D({assignee:0})},triggerExtraProps:{initialSelectedItem:t.assignee},isPortal:!0,portalProps:{portalWrapStyle:{zIndex:1055},portalContainer:R(),toRight:!0,scrollControl:e.scrollControl},disabledBottomSpace:T})),o.a.createElement("div",null,o.a.createElement(b.ItemDropdown,{options:N,onSelect:A,popupStyle:{width:160},portalContainer:R,portalAlign:{top:24,left:-96}})))}))},ee=function(e){var t=e.type,a=e.data,n=e.parentCode,i=e.currentCode,s=e.isDetail,c=e.list,u=e.projectID,d=e.fetchList,p=e.allowUpdate,m=e.allowDelete,h=e.projectPath,v=e.onUpdateParent,g=e.onHover,E=e.onBegin,b=e.onDelete,y=e.onEnd,S=e.draggingIndex,I=e.draggingCode,T=e.browserRouter,C=e.query,P=e.isLastChild,w=e.style,D=e.disabledBottomSpace,O=(e.copyIssues,"$sub-".concat(t)),R=Object(r.useRef)(null),j=function(e,t){if(R.current){var n=e.data.item.code;if(n!==a.code){var i=R.current.getBoundingClientRect(),r=(i.bottom-i.top)/2,o=t.getClientOffset();if(o){var s=o.y-i.top,l=c.findIndex((function(e){return e.code===n})),u=c.findIndex((function(e){return e.code===a.code}));l<u&&s<r||l>u&&s>r||g(n,a.code)}}}};return o.a.createElement(_.a,{type:O,data:{item:a},canDrag:p,onBegin:function(){E(a.code)},onEnd:y},(function(e,t){return o.a.createElement(_.c,{type:O,canDrop:p,onHover:j},(function(e,r){return t(R),r(R),o.a.createElement("div",{ref:R,className:f()(l.a.item,a.code===I&&l.a.itemIsOver),style:w||{}},o.a.createElement($,{allowUpdate:p,allowDelete:m,projectID:u,fetchList:d,data:a,parentCode:n,currentCode:i,isDetail:s,projectPath:h,onUpdateParent:v,onDelete:b,draggingIndex:S,browserRouter:T,query:C,isLastChild:P,disabledBottomSpace:D}))}))}))},te=a("+dhI"),ae=a("mecZ"),ne=a("mFAe"),ie=Object(r.memo)((function(e){var t=e.data,a=e.style,n=e.className,i=e.noMore,s=e.nameClassName,l=e.statusClassName,c=t.issueStatus&&t.issueStatus.type&&"COMPLETED"===t.issueStatus.type;return Object(r.useMemo)((function(){return o.a.createElement("div",{className:f()(x.a.item,n),style:a},t.type===j.IssueType.requirement&&!!t.hasChild&&o.a.createElement("div",{className:x.a.itemArrow}),o.a.createElement(C.default,{type:t.issueTypeDetail.iconType}),o.a.createElement("div",{className:x.a.itemCode},"#",t.code),o.a.createElement("div",{className:f()(x.a.itemName,s)},t.name),t.dueDate&&o.a.createElement("div",{className:x.a.itemDate},o.a.createElement(B.a,{date:t.dueDate,isCompleted:c})),o.a.createElement("div",{className:x.a.itemPriority},o.a.createElement(te.default,{priority:t.priority})),o.a.createElement("div",{className:f()(x.a.itemStatus,l)},o.a.createElement(ne.default,{status:t.issueStatus})),o.a.createElement("div",{className:x.a.itemAssignee},o.a.createElement(ae.a,{assignee:t.assignee})),!i&&o.a.createElement("div",null,o.a.createElement(b.ItemDropdown,{options:[],onSelect:function(){}})))}),[])})),re=a("Qkhu"),oe=a.n(re),se=a("k65d"),le=a("DKcV"),ce=a("iR1w"),ue=a("zDls"),de=a.n(ue),fe=a("9W8b"),pe=a.n(fe),me=a("nbZB"),he=a.n(me),ve=a("7FZc"),ge=function(){return(ge=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Ee=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},be=function(e,t,a){if(a||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},ye=function(e){var t=e.data,a=e.currentCode,n=e.isDetail,s=e.style,l=e.className,c=e.projectID,u=e.fetchList,d=e.allowUpdate,p=e.allowDelete,m=e.projectPath,h=e.onUpdateParent,v=e.onDelete,g=e.onPlan,E=e.draggingIndex,y=e.browserRouter,S=e.query,I=e.isLastChild,T=e.treeData,w=e.depth,D=e.onCollapseChange,O=e.draggingWithParent,R=e.onCreateSubRequirement,N=e.noTree,A=e.detailCode,L=e.currentProjectCooperateSettings,F=e.disabledBottomSpace,_=e.copyIssues,M=function(){switch(t.type){case j.IssueType.requirement:return"".concat(m,"/requirements/issues/").concat(t.code,"/detail");case j.IssueType.assignment:return"".concat(m,"/assignments/issues/").concat(t.code,"/detail");case j.IssueType.bug:return"".concat(m,"/bug-tracking/issues/").concat(t.code,"/detail");default:return""}},x=function(){var e=L.PROJECT_ISSUE_SPLIT_TYPE,a=L.ISSUE_TYPES,n=e.find((function(e){return e.issueTypeDetail.id===t.issueTypeDetail.id}));return n?"ALL_REQUIREMENT"===n.splitType?a.filter((function(e){return e.issueType===j.IssueType.requirement})):n.targetIssueTypes:[]},B=be(be(be(be([{id:"planDate",name:"\u5feb\u901f\u6392\u671f",type:"planDate"},{id:"detail",name:Object(i.t)("\u65b0\u7a97\u53e3\u6253\u5f00"),link:{path:M()}},{id:"copy",name:Object(i.t)("\u590d\u5236\u94fe\u63a5")}],Ee(_?[{id:"copyIssues",name:Object(i.t)("\u590d\u5236\u4e8b\u9879")}]:[]),!1),Ee(p||d?[{id:"divider",name:"",type:"divider"}]:[]),!1),Ee(d?[{id:"remove",name:Object(i.t)("\u89e3\u9664\u5173\u8054")}]:[]),!1),Ee(p?[{id:"delete",name:Object(i.t)("\u5220\u9664"),type:"delete"}]:[]),!1),W=Object(r.useRef)(null),z=function(e){switch(J(!1),e.id){case"parent":h(t.code);break;case"remove":Object(P.detachIssue)(c,t.code).then((function(){Object(k.success)(Object(i.t)("\u53d6\u6d88\u5173\u8054\u6210\u529f")),u()}));break;case"copy":Y()("".concat(window.location.origin).concat(M())),Object(k.success)(Object(i.t)("\u6210\u529f\u590d\u5236\u5230\u526a\u5207\u677f"));break;case"planDate":g(t.id);break;case"delete":v(ge(ge({},t),{subRequirementCount:T.childIssueCodes[t.code]?T.childIssueCodes[t.code].length:0}));break;case"create":R({visible:!0,parent:t,issueTypeOptions:x(),left:W.current.getBoundingClientRect().left+20*w-2,top:W.current.getBoundingClientRect().top+30});break;case"copyIssues":_&&_(t)}},q=Ee(Object(r.useState)(!1),2),Z=q[0],J=q[1],X=function(){J(!0)},Q=function(){J(!1)},$=function(){y.push(M())},ee=function(){n?y.push({pathname:"".concat(m,"/requirements/issues/").concat(A,"/detail/subissues/").concat(t.code),query:ge({},S)}):$()},te=function(){var e=T.treeCollapse,a=T.childIssueCodes;return a[t.code]&&a[t.code].length?e[t.code]?"collapse":"expand":""},ae=function(e){return J(!1),Object(P.modifyIssue)(t.type,c,t.code,e).then((function(e){return Object(k.success)(Object(i.t)("\u66f4\u65b0\u6210\u529f")),u(),e}))},ne=function(){return document.querySelector('div[data-frontend-module-container="coding-project-management-frontend"]')};return o.a.createElement(H.default.Consumer,null,(function(e){var n;return o.a.createElement("div",{className:f()(he.a.item,Z&&-1===E&&he.a.itemHovering,a===t.code&&he.a.itemHovering,l,I&&he.a.lastChild,w&&he.a["item-level".concat(w)],O.indexOf(t.code)>-1&&he.a.itemMultiDragging),ref:W,style:s,onMouseEnter:X,onMouseLeave:Q},N?o.a.createElement("div",{style:{width:10,flexShrink:0}}):o.a.createElement("div",{className:f()(he.a.itemArrow,!te()&&he.a.itemArrowHide,"collapse"===te()&&he.a.itemArrowRight),onClick:function(){return D(t.code)}}),o.a.createElement(ve.TooltipTrigger,{placement:"top",title:t.issueTypeDetail.name},o.a.createElement("div",null,o.a.createElement(C.default,{type:t.issueTypeDetail.iconType}))),o.a.createElement(ve.TooltipTrigger,{placement:"top",title:t.code},o.a.createElement("div",{style:{whiteSpace:"nowrap",maxWidth:130,textOverflow:"ellipsis",overflow:"hidden"},className:he.a.itemCode,onClick:$},"#",t.code)),o.a.createElement(ve.TooltipTrigger,{placement:"top",title:t.name},o.a.createElement("div",{style:{whiteSpace:"nowrap",width:200,textOverflow:"ellipsis",overflow:"hidden"},className:he.a.itemName,onClick:ee},t.name)),t.planDate&&o.a.createElement("span",{style:{background:"red",display:"inline-block",padding:"2px 6px",fontSize:13,marginRight:15,color:"white",borderRadius:"4px"}},"\u8ba1\u5212",t.planDate,"\u4e0a\u7ebf"),o.a.createElement("div",{className:he.a.itemPriority},o.a.createElement(V.default,{componentType:K.ComponentType.ICON,value:t.priority,disabled:!d,onSelect:function(e){var t=e.id;return ae({priority:t})},isPortal:!0,portalProps:{portalContainer:ne(),toRight:!0,scrollControl:e.scrollControl},disabledBottomSpace:F})),o.a.createElement("div",{className:he.a.itemStatus},o.a.createElement(U.StatusSelect,{value:t.issueStatus,projectID:c,project:t.project,issueCode:t.code,disabled:!d,onSelect:function(e){return ae(e)},portalContainer:ne,portalAlign:{top:21,toRight:!0},disabledBottomSpace:F})),o.a.createElement("div",{className:he.a.itemAssignee},o.a.createElement(G.default,{componentType:K.ComponentType.ICON,disabled:!d,inProject:!0,projectID:c,value:null===(n=t.assignee)||void 0===n?void 0:n.id,onSelect:function(e){ae({assignee:e.id})},onClear:function(){ae({assignee:0})},triggerExtraProps:{initialSelectedItem:t.assignee},isPortal:!0,portalProps:{portalWrapStyle:{zIndex:1055},portalContainer:ne(),toRight:!0,scrollControl:e.scrollControl},disabledBottomSpace:F})),o.a.createElement("div",null,o.a.createElement(b.ItemDropdown,{options:B,onSelect:z,popupStyle:{width:160},portalContainer:ne,portalAlign:{top:24,left:-96}})))}))},Se=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(t,a)};return function(t,a){if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),Ie=function(){return(Ie=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};!function(e){e.above="above",e.below="below",e.into="into"}(n||(n={}));var Te=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={position:""},t.canDrag=function(){return!!t.props.allowUpdate},t.itemRef=Object(r.createRef)(),t.isLast=function(e,a){var n=t.props.treeData.childIssueCodes[a];return n.findIndex((function(t){return t===e}))===n.length-1},t.isSubTreeLast=function(e){for(var a=t.props,n=a.issueNode,i=a.treeData.issueNodes,r=a.allowUpdate,o=e.data.item,s=n;s.depth>o.depth&&t.isLast(s.code,s.parentCode);)s=i.find((function(e){return e.code===s.parentCode}));return!(s.depth!==o.depth||s.code===o.code||s.parentCode!==o.parentCode||!r)},t.canDrop=function(e){var a=t.props.issueNode,n=e.data.item;if(n.code!==a.code){var i=a;if(i.depth===n.depth&&n.parentCode===i.parentCode)return!0;if(t.isSubTreeLast(e))return!0}return!1},t.handleHover=function(e,a){if(t.canDrop(e)){var n=t.getPosition(a,e);t.setState({position:n})}else t.setState({position:""})},t.getPosition=function(e,a){var i=t.itemRef.current.getBoundingClientRect(),r=i.top,o=i.bottom,s=(r+o)/2,l=(o-r)/4,c=e.getClientOffset();if(c){var u=c.y,d=t.props,f=d.issueNode,p=d.treeData.issueNodes,m=a.data.item;if(u<=s-l){var h=p.findIndex((function(e){return e.code===f.code})),v=p[h-1];if(v&&v.code===m.code)return"";if(m.depth<f.depth&&t.isSubTreeLast(a))return"";if(m.depth===f.depth){var g=p.findIndex((function(e){return e.code===m.code})),E=p.findIndex((function(e){return e.code===f.code}));if(E-g>1&&p.slice(g+1,E).every((function(e){return e.depth>f.depth})))return""}return n.above}if(u>=s+l){h=p.findIndex((function(e){return e.code===f.code}));var b=p[h+1];return b&&b.code===m.code||b&&b.depth>f.depth?"":n.below}}return""},t.handleDrop=function(e){var a=t.state.position;if(t.canDrop(e)&&a){var r=t.props,o=r.issueNode,s=r.projectID,l=r.treeData.issueNodes,c=e.data.item,u=l.findIndex((function(e){return e.code===o.code})),d=l[u+1],f=null;a===n.above&&(f=o.code),a===n.below&&d&&d.depth===c.depth&&(f=d.code);var p=t.props.fetchList;Object(P.sortIssue)(s,c.code,{beforeCode:f}).then((function(){Object(k.success)(Object(i.t)("\u6392\u5e8f\u6210\u529f")),p()}))}},t.renderDrop=function(e,a){var n=t.state.position,i=t.props,r=i.issueNode,s=i.issueData,l=i.onUpdateParent,c=i.currentCode,u=i.isDetail,d=i.projectID,p=i.fetchList,m=i.allowUpdate,h=i.allowDelete,v=i.projectPath,g=i.onDelete,E=i.onPlan,b=i.draggingIndex,y=i.browserRouter,S=i.query,I=i.isLastChild,T=i.draggingData,C=i.treeData,P=i.dragDropType,w=i.onCollapseChange,D=i.draggingWithParent,O=i.isFirstChild,R=i.onCreateSubRequirement,j=i.noTree,k=i.detailCode,N=i.currentProjectCooperateSettings;i.copyIssues;return o.a.createElement(_.c,{canDrop:!0,type:P,onHover:t.handleHover,onDrop:t.handleDrop},(function(e,i){var P=e.isOver;return a(t.itemRef),i(t.itemRef),o.a.createElement("div",{ref:t.itemRef,className:f()(pe.a.item,P&&n&&pe.a["item-".concat(n)],T&&pe.a["item-level".concat(T.depth)],I&&pe.a.itemLast,O&&pe.a.itemFirst)},o.a.createElement(ye,{depth:r.depth,actualDepth:r.actualDepth,data:s,parentCode:s.parentCode,currentCode:c,detailCode:k,isDetail:u,projectID:d,fetchList:p,allowUpdate:m,allowDelete:h,projectPath:v,onUpdateParent:l,onDelete:g,onPlan:E,draggingIndex:b,browserRouter:y,query:S,isLastChild:I,treeData:C,onCollapseChange:w,draggingWithParent:D,onCreateSubRequirement:R,noTree:j,currentProjectCooperateSettings:N,disabledBottomSpace:t.props.disabledBottomSpace}))}))},t.handleBegin=function(){var e=t.props,a=e.issueNode,n=e.onBegin;document.body.click(),n(a)},t}return Se(t,e),t.prototype.render=function(){var e=this.props,t=e.issueData,a=e.issueNode,n=e.onEnd,i=e.treeData,r=e.dragDropType;return o.a.createElement(_.a,{type:r,data:{item:Ie(Ie({},t),{hasChild:i.childIssueCodes[t.code].length,depth:a.depth})},canDrag:this.canDrag(),onBegin:this.handleBegin,onEnd:n},this.renderDrop)},t}(r.Component),Ce=a("TYy9"),Pe=a.n(Ce),we=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},De=function(e,t,a){if(a||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},Oe=function(e,t){var a=function(e){var n=[],i=t[e];return i&&(n=De(De([],we(i),!1),we(Pe()(i.map((function(e){return a(e)})))),!1)),n};return a(e)},Re=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(t,a)};return function(t,a){if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),je=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},ke=function(e,t,a){if(a||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},Ne=function(e){function t(t){var a=e.call(this,t)||this;return a.handleCollapseChange=function(e){var t=a.props.onCollapseChange,n=a.props.treeData.treeCollapse;n[e]=!n[e],t(n)},a.handleBegin=function(e){var t=a.props.treeData,n=t.childIssueCodes,i=t.issueNodes.findIndex((function(t){return t.code===e.code}));a.setState({draggingIndex:i,draggingWithParent:ke([e.code],je(Oe(e.code,n)),!1),draggingData:e})},a.handleEnd=function(){a.setState({draggingWithParent:[],draggingData:null,draggingIndex:-1})},a.renderRow=function(e){var t=e.index,n=e.style,i=e.data,r=a.props,s=r.onDelete,l=r.onPlan,c=r.onUpdateParent,u=r.currentCode,d=r.isDetail,f=r.projectID,p=r.fetchList,m=r.allowUpdate,h=r.allowDelete,v=r.projectPath,g=r.browserRouter,E=r.query,b=r.dragDropType,y=r.treeData,S=r.onCreateSubRequirement,I=r.noTree,T=r.detailCode,C=r.currentProjectCooperateSettings,P=(r.copyIssues,i.draggingIndex),w=i.draggingData,D=i.draggingWithParent,O=i.disabledBottomSpace,R=y.issueNodes,j=y.issues,k=R[t],N=j[k.code];return o.a.createElement("div",{style:n},o.a.createElement(Te,{issueNode:k,issueData:N,onBegin:a.handleBegin,onEnd:a.handleEnd,onDelete:s,onPlan:l,onUpdateParent:c,currentCode:u,isDetail:d,projectID:f,fetchList:p,allowUpdate:m,allowDelete:h,projectPath:v,browserRouter:g,query:E,draggingIndex:P,draggingData:w,isLastChild:t===R.length-1,isFirstChild:0===t,treeData:y,dragDropType:b,onCollapseChange:a.handleCollapseChange,draggingWithParent:D,onCreateSubRequirement:S,noTree:I,detailCode:T,currentProjectCooperateSettings:C,disabledBottomSpace:O}))},a.getHeight=function(){var e=a.props.treeData.issueNodes;return e.length>10?345:36*e.length},a.handleResize=function(){a.handleWidth()},a.handleWidth=function(){a.setState({width:a.wrapperRef.current.getBoundingClientRect().width})},a.wrapperRef=Object(r.createRef)(),a.state={draggingIndex:-1,draggingData:null,draggingWithParent:[],width:0},a}return Re(t,e),t.prototype.componentDidMount=function(){this.handleWidth(),window.addEventListener("resize",this.handleResize)},t.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.handleResize)},t.prototype.render=function(){var e=this.props.treeData.issueNodes,t=this.state,a=t.draggingIndex,n=t.draggingData,i=t.draggingWithParent,r=t.width;return o.a.createElement("div",{style:{height:this.getHeight(),marginBottom:8},ref:this.wrapperRef},o.a.createElement(ce.FixedSizeList,{className:f()(de.a.subRequirementTree),itemCount:e.length,itemSize:36,width:r,height:this.getHeight(),itemData:{draggingIndex:a,draggingData:n,draggingWithParent:i,disabledBottomSpace:this.props.disabledBottomSpace}},this.renderRow))},t}(r.Component),Ae=a("EUlY"),Le=a("hJbg"),Fe=a("LvDl"),_e=a("82Y3"),Me=a("D5qz"),xe=a.n(Me),Be=a("RnM7"),Ue=a.n(Be),We=a("Z4vw"),Ye=function(){return(Ye=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},He=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},Ve=function(e,t,a){if(a||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))};t.default=R()((function(e){var t=e.sectionExpanded,a=e.SectionToggletrigger,n=e.type,s=e.projectID,c=e.parentCode,u=e.parentDescriptionType,d=void 0===u?0:u,p=e.currentCode,m=e.isDetail,h=e.callback,v=e.list,E=e.createVisible,b=e.onCreateVisibleChange,y=e.controlFocus,I=e.scrollTargetId,T=e.onFullCreate,C=e.projectName,w=e.onListChange,O=e.onTitleChange,R=e.isPermissible,L=e.browserRouter,M=e.query,x=e.clearTitle,B=e.currentIteration,U=e.currentProjectCooperateSettings,W=e.getInstance,Y=e.currentInstanceForceRender,H=e.getCreateInputInstance,V=e.iterationFinished,G=e.issueTypeDetail,K=e.onSelectIssueType,q=e.willCreateIssueType,Z=e.canSplit,J=e.isFullScreen,X=(e.copyIssues,Object(r.useRef)(null));Object(r.useEffect)((function(){W&&W(X)}),[]);var Q=Object(r.useRef)(null),$=He(Object(r.useState)(!1),2),te=$[0],ae=$[1],ne=Object(r.useCallback)((function(e){Q.current=e.current,H&&H(e)}),[]),re=Object(r.useCallback)((function(){b(!0),ae(!1),Q.current&&Q.current.focus()}),[]),ue=Object(r.useCallback)((function(){ae(!0)}),[]),de=He(Object(r.useState)(!1),2),fe=de[0],pe=de[1],me=Object(r.useCallback)((function(e){pe(e)}),[]),he=He(Object(r.useState)(-1),2),ge=he[0],Ee=he[1],be=Object(r.useCallback)((function(e){pe(!0),Ee(e)}),[]);Object(r.useEffect)((function(){ae(!1)}),[y]);var ye=Object(r.useRef)(null);Object(r.useEffect)((function(){ye.current=q}),[q]);var Se=Object(r.useCallback)(Object(Fe.debounce)((function(e,t){var a,n,r;e?Object(P.fastCreateIssue)(s,{parentCode:c,name:e,issueTypeId:null===(n=ye.current)||void 0===n?void 0:n.id,issueType:null===(r=ye.current)||void 0===r?void 0:r.issueType,issueDescriptionType:null!==d&&void 0!==d?d:Object(_e.getPreferEditorType)()}).then((function(){t&&t(),h()}),(function(e){8011!==e.code&&T()})):Object(k.warning)("".concat(Object(i.t)("\u8bf7\u8f93\u5165")).concat(null===(a=ye.current)||void 0===a?void 0:a.name).concat(Object(i.t)("\u6807\u9898")))}),300),[]),Ie="$sub-".concat(n),Te=Object(r.useRef)(null),Ce=function(e,t){var a=Me.current,n=a.findIndex((function(t){return t.code===e})),i=a.findIndex((function(e){return e.code===t})),r=a.splice(n,1)[0];a.splice(i,0,r),w(Ve([],He(a),!1)),je(e)},Pe=He(Object(r.useState)(-1),2),we=Pe[0],De=Pe[1],Oe=He(Object(r.useState)(-1),2),Re=Oe[0],je=Oe[1],ke=function(e){var t=v.findIndex((function(t){return t.code===e}));De(t),je(e)},Me=Object(r.useRef)(v);Object(r.useEffect)((function(){Me.current=v}),[v]);var Be=function(e){var t=Me.current,a=e.data.item.code,n=t.findIndex((function(e){return e.code===a}));if(we!==n){var r=t[n+1];Object(P.sortIssue)(s,a,{beforeCode:r?r.code:null}).then((function(){Object(k.success)(Object(i.t)("\u6392\u5e8f\u6210\u529f")),De(-1),je(-1),h()}))}},Ge=Object(r.useCallback)((function(e){var t=e.data;return o.a.createElement("div",{className:l.a.draggingItem,style:{width:Te.current.getBoundingClientRect().width}},o.a.createElement(ie,{data:t.item,style:{background:"#ffffff"}}))}),[]),Ke=He(Object(r.useState)({}),2),ze=Ke[0],qe=Ke[1],Ze=He(Object(r.useState)(!1),2),Je=Ze[0],Xe=Ze[1],Qe=He(Object(r.useState)({associateDatas:[],message:"",canDelete:!0}),2),$e=Qe[0],et=Qe[1],tt=He(Object(r.useState)(!1),2),at=tt[0],nt=tt[1],it=Object(r.useCallback)((function(e){qe(e),function(e){Xe(!0),nt(!0),Object(P.fetchDeleteIssue)(e.projectId,e.id).then((function(e){var t=e.data;et({associateDatas:window.location.href.indexOf("requiremanage")<0?t.associateDatas:null,message:t.msg,canDelete:t.canDelete})})).finally((function(){nt(!1)}))}(e)}),[]),rt=Object(r.useCallback)((function(){b(!1),O("")}),[]),ot=v.filter((function(e){return e&&"COMPLETED"===e.issueStatusType})).length,st=R([{function:le.ProjectPermissionFunction.PROJECT_ISSUE,action:le.ProjectPermissionAction.UPDATE}]),lt=R([{function:le.ProjectPermissionFunction.PROJECT_ISSUE,action:le.ProjectPermissionAction.DELETE}]),ct=He(Object(r.useState)({childIssueCodes:[],issues:{},rootIssueCodes:[],iterations:{},issueNodes:[],treeCollapse:{}}),2),ut=ct[0],dt=ct[1];Object(r.useEffect)((function(){if(n===j.IssueType.requirement){if(v.length){var e=ut.treeCollapse,t=Object(Ae.organizeIssues)(v);Object.keys(t.issues).forEach((function(a){var n,i;(null===(n=t.childIssueCodes[a])||void 0===n?void 0:n.length)||(e[a]=!1),void 0===e[a]&&(null===(i=t.childIssueCodes[a])||void 0===i?void 0:i.length)&&(e[a]=!0)}));var a=Object(Ae.getIssueNodeList)({issues:t.issues,childIssueCodes:t.childIssueCodes,collapseStatus:e,entryCodes:t.rootIssueCodes});dt(Ye(Ye({},t),{treeCollapse:e,issueNodes:a})),X.current=Ye(Ye({},t),{treeCollapse:e,issueNodes:a})}else dt({childIssueCodes:[],issues:{},rootIssueCodes:[],iterations:{},issueNodes:[],treeCollapse:{}}),X.current={childIssueCodes:[],issues:{},rootIssueCodes:[],iterations:{},issueNodes:[],treeCollapse:{}};Y&&Y()}}),[v]);var ft=function(e){var t=ut.issues,a=ut.childIssueCodes,n=ut.rootIssueCodes,i=Object(Ae.getIssueNodeList)({issues:t,childIssueCodes:a,collapseStatus:e,entryCodes:n});dt(Ye(Ye({},ut),{treeCollapse:e,issueNodes:i})),X.current=Ye(Ye({},ut),{treeCollapse:e,issueNodes:i}),Y&&Y()},pt=function(){var e=ut.treeCollapse,t=ut.childIssueCodes;return Object.keys(e).some((function(a){return t[a]&&t[a].length&&e[a]}))},mt=He(Object(r.useState)({}),2),ht=mt[0],vt=mt[1],gt=function(e){vt(e)},Et=Object(r.useCallback)((function(e){var t=e.index,a=e.style,i=e.data,r=i.list,l=i.isFullScreen,u=r[t];return o.a.createElement(ee,{key:u.code,type:n,parentCode:c,currentCode:i.currentCode,isDetail:m,allowUpdate:st,allowDelete:lt,projectID:s,fetchList:h,data:u,projectPath:"/p/".concat(C),onUpdateParent:be,onDelete:it,onHover:Ce,onBegin:ke,onEnd:Be,list:r,draggingIndex:i.draggingIndex,draggingCode:i.draggingCode,browserRouter:L,query:M,isLastChild:t===r.length-1,style:a,isFullScreen:l,disabledBottomSpace:l?z.FULL_SCREEN.disabledBottomSpace:0})}),[]),bt=He(Object(r.useState)(""),2),yt=bt[0],St=bt[1],It=He(Object(r.useState)(),2),Tt=It[0],Ct=It[1],Pt=He(Object(r.useState)(!1),2),wt=Pt[0],Dt=Pt[1],Ot=ze.subMissionCount||ze.subRequirementCount?Object(i.t)("".concat(ze.issueTypeDetail.name,"\u4e0b\u542b\u6709\u5b50\u4e8b\u9879\uff0c").concat(ze.issueTypeDetail.name,"\u5220\u9664\u540e\u5b50\u4efb\u52a1\u548c\u5b50\u9700\u6c42\u5c06\u4e00\u5e76\u5220\u9664\uff0c\u786e\u8ba4\u5220\u9664\u5417\uff1f")):"",Rt=$e.message||Ot,jt=U&&U.COOPERATE_MODE;return o.a.createElement(A.DndProvider,{backend:F.a},o.a.createElement("div",{className:l.a.wrapper,ref:Te},o.a.createElement(_.b,{type:Ie,isSort:n===j.IssueType.assignment},Ge),ht.visible&&o.a.createElement(Le.a,{projectName:C,projectID:s,currentIteration:Ye(Ye({},B),{code:null===B||void 0===B?void 0:B.iterationCode}),iteration:ht.iteration,parent:ht.parent,issueTypeOptions:ht.issueTypeOptions,style:{top:ht.top,left:ht.left},onCreate:h,onCancel:function(){return gt({})},onFullCreate:h}),o.a.createElement(Ue.a,{allPlanDateVisivile:wt,closeModle:function(){Dt(!1)},handleEnter:function(e){if(e.planDates)if(Dt(!1),"\u6279\u91cf\u6392\u671f"===yt){var t={reqids:v.map((function(e){return e.id})),planDate:e.planDates};Object(We.postJSON)("/external/collaboration/api/project/".concat(s,"/issues/requirements/batchplan"),t).then((function(){h(),Object(k.success)("\u6279\u91cf\u6392\u671f\u6210\u529f")}))}else{t={planDate:e.planDates};Object(We.postJSON)("/external/collaboration/api/project/".concat(s,"/issues/requirements/").concat(Tt,"/plan"),t).then((function(){h(),Object(k.success)("\u5feb\u901f\u6392\u671f\u6210\u529f")}))}else Object(k.warning)("\u8bf7\u5148\u9009\u62e9\u8ba1\u5212\u4e0a\u7ebf\u65e5\u671f")},planTitle:yt}),o.a.createElement("div",{className:l.a.header},o.a.createElement(a,null),o.a.createElement("div",{className:l.a.text},g[n].title),st&&Z&&o.a.createElement("div",{className:l.a.divider}),st&&!V&&Z&&o.a.createElement("div",{style:{display:"flex",alignItems:"center"}},o.a.createElement("div",{className:l.a.add,onClick:re}),"CLASSIC"!==jt?o.a.createElement(xe.a,{onClick:function(){St("\u6279\u91cf\u6392\u671f"),Dt(!0)},style:{cursor:"pointer"}}):null),st&&V&&"MISSION"===n&&o.a.createElement(ve.TooltipTrigger,{title:Object(i.t)("\u8fed\u4ee3\u5df2\u5b8c\u6210\uff0c\u65e0\u6cd5\u6dfb\u52a0\u5b50\u4efb\u52a1")},o.a.createElement("div",{className:f()(l.a.add,l.a.disabled)})),st&&V&&"REQUIREMENT"===n&&o.a.createElement(ve.TooltipTrigger,{title:Object(i.t)("\u8fed\u4ee3\u5df2\u5b8c\u6210\uff0c\u65e0\u6cd5\u5206\u89e3\u9700\u6c42")},o.a.createElement("div",{className:f()(l.a.add,l.a.disabled)})),!!v.length&&o.a.createElement("div",{className:l.a.headerRight},n===j.IssueType.requirement&&!v.every((function(e){return!(e.subIssues&&e.subIssues.length)}))&&o.a.createElement(ve.TooltipTrigger,{title:pt()?Object(i.t)("\u5c55\u5f00\u5b50\u9700\u6c42"):Object(i.t)("\u6298\u53e0\u5b50\u9700\u6c42")},o.a.createElement("div",{className:f()(l.a.treeExpand,pt()?l.a.treeExpandClose:l.a.treeExpandOpen),onClick:function(){var e={},t=ut.treeCollapse,a=ut.childIssueCodes;Object.keys(t).forEach((function(t){a[t]&&a[t].length&&(pt()?e[t]=!1:e[t]=!0)})),ft(e)}})),n===j.IssueType.requirement&&v.every((function(e){return!(e.subIssues&&e.subIssues.length)}))&&o.a.createElement("div",{className:f()(l.a.treeExpand,pt()?l.a.treeExpandClose:l.a.treeExpandOpen,l.a.treeExpandDisabled)}),o.a.createElement("div",{className:l.a.progress},o.a.createElement("div",{className:l.a.progressBar},o.a.createElement("div",{className:l.a.progressBarInner,style:{width:ot/v.length*120}})),o.a.createElement("div",{className:l.a.progressText},ot,"/",v.length),o.a.createElement("div",{className:l.a.progressText},Object(i.t)("\u5df2\u5b8c\u6210"))))),v.length>0&&t&&n===j.IssueType.assignment&&o.a.createElement("div",{className:l.a.list},o.a.createElement(ce.FixedSizeList,{itemCount:v.length,itemSize:36,height:Math.min(345,36*v.length),width:Te.current?Te.current.getBoundingClientRect().width:0,itemData:{list:v,draggingIndex:we,draggingCode:Re,currentCode:p,isFullScreen:J}},Et)),v.length>0&&t&&n===j.IssueType.requirement&&o.a.createElement(Ne,{currentCode:p,isDetail:m,allowUpdate:st,allowDelete:lt,projectID:s,fetchList:h,projectPath:"/p/".concat(C),onUpdateParent:be,onDelete:it,browserRouter:L,query:M,dragDropType:Ie,treeData:ut,onCollapseChange:ft,onCreateSubRequirement:gt,noTree:v.every((function(e){return!(e.subIssues&&e.subIssues.length)})),detailCode:c,currentProjectCooperateSettings:U,disabledBottomSpace:J?z.FULL_SCREEN.disabledBottomSpace:0,onPlan:function(e){Ct(e),St("\u5feb\u901f\u6392\u671f"),Dt(!0)}}),E&&!te&&o.a.createElement(S,{scrollTargetId:I,controlFocus:y,onCancel:rt,type:n,onFastCreate:Se,onFullCreate:function(){B&&"COMPLETED"===B.status&&Object(k.danger)(Object(i.t)("\u8fed\u4ee3\u5df2\u5b8c\u6210\uff0c\u4e0d\u5141\u8bb8\u52a0\u5165")),T()},onTitleChange:O,clearTitle:x,getInstance:ne,onSelectIssueType:K,willCreateIssueType:q,issueTypeOptions:function(){var e=U.PROJECT_ISSUE_SPLIT_TYPE,t=U.ISSUE_TYPES;return n!==j.IssueType.assignment?"ALL_REQUIREMENT"===e.filter((function(e){return e.issueTypeDetail.id===G.id}))[0].splitType?e.filter((function(e){return e.issueTypeDetail.issueType===j.IssueType.requirement})).map((function(e){return e.issueTypeDetail})):e.find((function(e){return e.issueTypeDetail.id===G.id})).targetIssueTypes:t.filter((function(e){return e.issueType===j.IssueType.assignment}))}()}),E&&!te&&o.a.createElement("div",{className:l.a.find,onClick:ue},g[n].relate),te&&o.a.createElement(D,{onCancel:function(){ae(!1),rt()},type:n,projectID:s,parentCode:c,fetchList:h}),fe&&o.a.createElement(N.a,{onVisibleChange:me,projectID:s,issueCode:ge,fetchList:h}),Je&&o.a.createElement(oe.a,{text:Object(i.t)("\u5220\u9664\u4e8b\u9879"),type:ze?ze.type:"",issueTypeDetail:ze.issueTypeDetail,show:Je,onConfirm:function(){var e;n===j.IssueType.requirement&&(e=se.deleteRequirement),n===j.IssueType.assignment&&(e=se.deleteAssignment),e(s,ze.code).then((function(){Object(k.success)(Object(i.t)("\u5220\u9664\u6210\u529f")),Xe(!1),h()}))},onClose:function(){return Xe(!1)},hasType:!Rt,customTip:Rt,isLoading:at,allowDelete:$e.canDelete,associateDatas:$e.associateDatas})))}))},OrPX:function(e,t,a){"use strict";var n=a("cDcd"),i=a.n(n),r=a("iTKN"),o=a("K2gz"),s=a.n(o),l=a("IuC+"),c=a.n(l);t.a=Object(n.memo)((function(e){var t=e.value,a=e.item,n=e.isMultiple,o=e.onSelect,l=e.focused,u=function(){return n?t.some((function(e){return e===a.id})):a.id===t};return i.a.createElement("div",{className:s()(c.a.item,u()&&c.a.checked,l&&c.a.focus),title:a.text,onClick:function(){return o(a)}},a.id===r.UNSPECIFIC?i.a.createElement("span",{className:s()(c.a.avatar)}):i.a.createElement("span",{className:s()(c.a.avatar,a.isProgram&&c.a.isProgram)},i.a.createElement("img",{src:a.media})),i.a.createElement("div",{className:s()(c.a.content,a.id===r.UNSPECIFIC&&c.a.unspecific)},a.text),u()&&i.a.createElement("span",{className:s()(c.a.checked)}))}))},OxxH:function(e,t,a){e.exports=a.p+"625784ba3efb92b61698cc1414144a13.svg"},PW7d:function(e,t,a){e.exports={wrapper:"wrapper-1zUW06MHHJ","input-before":"input-before-3KRpFCa1Tu",inputBefore:"input-before-3KRpFCa1Tu","input-after":"input-after-3tx_r6ZsOV",inputAfter:"input-after-3tx_r6ZsOV","input-clear":"input-clear-32s084q-VI",inputClear:"input-clear-32s084q-VI","input-cancel":"input-cancel-3uPnxX8SLy",inputCancel:"input-cancel-3uPnxX8SLy",panel:"panel-_q_SieLroG","panel-container":"panel-container-2tHAF21g9p",panelContainer:"panel-container-2tHAF21g9p",item:"item-3juBv5VXTD","item-empty":"item-empty-3X0fCX9u5m",itemEmpty:"item-empty-3X0fCX9u5m","item-icon":"item-icon-1uLBy8rJne",itemIcon:"item-icon-1uLBy8rJne","item-code":"item-code-2FHiMMXi3L",itemCode:"item-code-2FHiMMXi3L","item-name":"item-name-1aw_6tAQMa",itemName:"item-name-1aw_6tAQMa"}},Pc5Q:function(e,t,a){e.exports={select:"select-2OE6tP9FMD","select-arrow-wrapper":"select-arrow-wrapper-mrnO93Wc9H",selectArrowWrapper:"select-arrow-wrapper-mrnO93Wc9H","menu-top":"menu-top-9MzBrMIIYX",menuTop:"menu-top-9MzBrMIIYX","select-with-label":"select-with-label-1y9pGlITnS",selectWithLabel:"select-with-label-1y9pGlITnS","select-trigger":"select-trigger-2tHTg6ERsT",selectTrigger:"select-trigger-2tHTg6ERsT","has-border":"has-border-26gt7qpKAy",hasBorder:"has-border-26gt7qpKAy","is-block":"is-block-1NQpJAIzPc",isBlock:"is-block-1NQpJAIzPc","item-text":"item-text-1OV2DlS5iN",itemText:"item-text-1OV2DlS5iN","not-selected":"not-selected-2xXNQjY98E",notSelected:"not-selected-2xXNQjY98E","is-expanded":"is-expanded-2s6VqQg5Fx",isExpanded:"is-expanded-2s6VqQg5Fx","inline-dropdown":"inline-dropdown-SRmNAdpl1U",inlineDropdown:"inline-dropdown-SRmNAdpl1U","item-label":"item-label-3LYSreQrNX",itemLabel:"item-label-3LYSreQrNX","item-text-ellipsis":"item-text-ellipsis-1i4GZXktp0",itemTextEllipsis:"item-text-ellipsis-1i4GZXktp0","clear-button":"clear-button-3JwvTdLqiY",clearButton:"clear-button-3JwvTdLqiY","to-top":"to-top-34F4F1B9C-",toTop:"to-top-34F4F1B9C-","to-right":"to-right-2Tzv10_9yy",toRight:"to-right-2Tzv10_9yy","trigger-background":"trigger-background-2JvgJctgag",triggerBackground:"trigger-background-2JvgJctgag","clear-divider":"clear-divider-10za6PDPCt",clearDivider:"clear-divider-10za6PDPCt",show:"show-2IGhpvK4XA",clear:"clear-3tGKqk-uDb",root:"root-1yariZkugS","trigger-wrapper":"trigger-wrapper-F26eyvtl4f",triggerWrapper:"trigger-wrapper-F26eyvtl4f",trigger:"trigger-3SfZfj_Axv","item-label-ellipsis":"item-label-ellipsis-3gWeL0TrKs",itemLabelEllipsis:"item-label-ellipsis-3gWeL0TrKs","input-back-wrapper":"input-back-wrapper-1f5B15KcWY",inputBackWrapper:"input-back-wrapper-1f5B15KcWY","title-wrapper":"title-wrapper-3vrkdJmVdK",titleWrapper:"title-wrapper-3vrkdJmVdK","button-group":"button-group-1YvWQ7v_rT",buttonGroup:"button-group-1YvWQ7v_rT",button:"button-1cUA4bxCLg","range-wrapper":"range-wrapper-3nZ56WLUsm",rangeWrapper:"range-wrapper-3nZ56WLUsm","input-divider":"input-divider-2_z65WSTSG",inputDivider:"input-divider-2_z65WSTSG","range-input":"range-input-1BtEhcvsNK",rangeInput:"range-input-1BtEhcvsNK","range-input-container":"range-input-container-_6fiaRS9j-",rangeInputContainer:"range-input-container-_6fiaRS9j-","align-top":"align-top-2oTfbX2Qct",alignTop:"align-top-2oTfbX2Qct","cart-down":"cart-down-2sJniXHVeM",cartDown:"cart-down-2sJniXHVeM","custom-title-wrapper":"custom-title-wrapper-K57p183vWm",customTitleWrapper:"custom-title-wrapper-K57p183vWm"}},"PiG+":function(e,t,a){e.exports={wrapper:"wrapper-vyf3BSnXsG",header:"header-A-gxY38kIl","input-label":"input-label-3GxrtONYE4",inputLabel:"input-label-3GxrtONYE4","button-group":"button-group-3DLM_4Ky3O",buttonGroup:"button-group-3DLM_4Ky3O"}},Q95R:function(e,t,a){"use strict";a("I5cv"),a("ioFf"),a("mYba"),a("jm62"),a("EK0E");var n=a("TqRt"),i=a("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(a("o0o1"));a("bWfx"),a("f3/d"),a("Btvt"),a("VRzm"),a("dRSK"),a("0l/t"),a("hhXQ"),a("CX2u"),a("XfO3"),a("yt8O"),a("rGqo"),a("INYr"),a("RW0V");var o,s,l,c=n(a("yXPU")),u=n(a("RIqP")),d=n(a("lSNA")),f=n(a("lwsE")),p=n(a("W8MJ")),m=n(a("PJYZ")),h=n(a("7W2i")),v=n(a("a1gu")),g=n(a("Nsbk")),E=a("mVeg"),b=pe(a("cDcd")),y=n(a("17x9")),S=n(a("V/h/")),I=n(a("Zsd2")),T=n(a("E+oP")),C=n(a("Y+p1")),P=n(a("zqxM")),w=n(a("NIJN")),D=a("LOoY"),O=a("7bn+"),R=a("nuIr"),j=a("DgMC"),k=a("DgMC"),N=a("xgZS"),A=a("Z4vw"),L=a("DKcV"),F=a("YzRi"),_=a("w3Wo"),M=a("sWxF"),x=a("aHEs"),B=a("82Y3"),U=a("h74D"),W=n(a("mSbZ")),Y=n(a("htee")),H=n(a("uk0h")),V=n(a("4Fdf")),G=n(a("sftu")),K=n(a("KUqB")),z=n(a("aWB4")),q=n(a("Th6D")),Z=pe(a("NI22")),J=n(a("SLo4")),X=n(a("z0hg")),Q=a("885C"),$=n(a("T8xO")),ee=n(a("L8Eh")),te=n(a("ai0/")),ae=n(a("OTim")),ne=n(a("XLbL")),ie=(n(a("M/Qn")),n(a("q18W"))),re=a("LC46"),oe=n(a("K2gz")),se=n(a("1hCk")),le=n(a("246l")),ce=a("YstK"),ue=n(a("SUhN")),de=n(a("QPj7"));function fe(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(fe=function(e){return e?a:t})(e)}function pe(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!==typeof e)return{default:e};var a=fe(t);if(a&&a.has(e))return a.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=r?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}return n.default=e,a&&a.set(e,n),n}function me(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function he(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?me(Object(a),!0).forEach((function(t){(0,d.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):me(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function ve(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,g.default)(e);if(t){var i=(0,g.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,v.default)(this,a)}}var ge=(0,U.connect)((function(e){var t,a=e.APP,n=a.enterprise,i=a.user,r=e.CURRENT_USER_ENTERPRISE_PERMISSION_NAMESPACE_FOR_REDUX_STORE;return{user:i,enterpriseGlobalKey:n.key,ramOnline:null===r||void 0===r||null===(t=r.ramStatus)||void 0===t?void 0:t.ramOnline}}))(o=(0,W.default)(o=(0,Y.default)(o=(0,H.default)(o=(0,V.default)((l=s=function(e){(0,h.default)(a,e);var t=ve(a);function a(e){var n,i,o,s,l,d,p;(0,f.default)(this,a),(p=t.call(this,e)).combineThirdLinks=function(){var e=p.state,t=e.attachments,a=e.thirdLinks;if(a){var n=a.map((function(e){if(e.name)return e;var t=e.isModao,a=e.isCodesign,n=t?e.modao.title||(0,E.t)("\u58a8\u5200\u9644\u4ef6"):a?e.codesign.title:"";return he(he({},e),{},{noUpload:!0,name:n,createdAt:e.timestamp})})),i=[].concat((0,u.default)(t),(0,u.default)(n));p.setState({allAttachments:p.sortAttachments(i)})}else p.setState({allAttachments:p.sortAttachments(t)})},p.onAddThirdLink=function(e){p.hideImportOutResourcePicker(),p.setState({thirdLinks:[].concat((0,u.default)(p.state.thirdLinks),(0,u.default)(e))},p.combineThirdLinks)},p.showImportOutResourcePicker=function(){p.setState({isShowImportOutResourcePicker:!0})},p.hideImportOutResourcePicker=function(){p.setState({isShowImportOutResourcePicker:!1})},p.sortAttachments=function(e){var t=(0,u.default)(e);return t.sort((function(e,t){return e.timestamp-t.timestamp})),t},p.getRequirements=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=p.props.currentProject,a=(t.name,t.id);return(0,M.getAvailableRequirementsWithoutCode)(a,{keyword:e}).then((function(e){var t=e.data;p.setState({availableRequirements:t})}))},p.checkDescriptionPageId=(0,c.default)(r.default.mark((function e(){var t,a,n,i,o;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,Z.isBlockType)(p.state.editorType)){e.next=2;break}return e.abrupt("return");case 2:return t=p.props,a=t.defectCode,n=t.currentProject,e.next=5,(0,_.checkDescriptionPageId)(n.id,a);case 5:i=e.sent,o=i.data,p.initCreatePage(o.pageId),p.setState({showDescriptionPlaceholder:!1});case 9:case"end":return e.stop()}}),e)}))),p.initCreatePage=function(){var e=(0,c.default)(r.default.mark((function e(t){var a,n,i,o,s,l,c,u,d,f,m,h;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=p.props,n=a.currentProject,i=a.issueTypeDetail,o=a.currentProjectCooperateSettings,s=p.state,l=s.name,c=s.editorType,(0,Z.isBlockType)(c)){e.next=4;break}return e.abrupt("return",Promise.resolve());case 4:if(u=o.ISSUE_TYPES.find((function(e){return"DEFECT"===e.issueType})),t){e.next=12;break}return e.next=8,(0,x.fetchMarkdownTemplate)(n.name,i.id||u.id);case 8:return d=e.sent,f=d.data,p.setState({initEditorData:{pageId:f.pageId,pageDraftId:f.draftId,historyId:f.historyId},editorAutoFocus:!!l,showDescriptionPlaceholder:!1}),e.abrupt("return",Promise.resolve());case 12:return m=p.props.currentProject.id,(h={module:ce.PROPERTY_ISSUES_COPY_CONSTANTS_ENUM.COLLABORATION,function:ce.PROPERTY_ISSUES_COPY_CONSTANTS_ENUM.DESCRIPTION,scopeType:ce.PROPERTY_ISSUES_COPY_CONSTANTS_ENUM.PROJECT,scopeId:m,projectId:m}).pageId=t,e.abrupt("return",(0,Z.createPageDraft)(h).then((function(e){var t=e.data;p.setState({initEditorData:{pageId:t.pageId,pageDraftId:t.pageDraftId,historyId:t.historyId}})})));case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p.copyCreatePage=function(){var e=(0,c.default)(r.default.mark((function e(t){var a,n,i,o;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=p.props.currentProject,n=p.state.editorType,(0,Z.isBlockType)(n)){e.next=4;break}return e.abrupt("return",Promise.resolve());case 4:return e.next=6,(0,x.copyMarkdownTemplate)(a.id,t);case 6:return i=e.sent,o=i.data,p.setState({initEditorData:{pageId:o.pageId,pageDraftId:o.draftId,historyId:o.historyId}}),e.abrupt("return",Promise.resolve());case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p.onEpicChange=function(e){p.setState({localEpicCode:e})},p.handleAttentionChange=function(e){p.changeAttributes({type:"watchers",value:e})},p.onDescriptionChange=function(e){if(!e.isEmpty){var t=p.props,a=t.currentProjectCooperateSettings,n=t.currentProject,i=t.issueTypeDetail,r=a.ISSUE_TYPES.find((function(e){return"DEFECT"===e.issueType})),o="".concat(n.name,"_").concat(i.issueType||r.issueType,"_").concat(i.id||r.id,"_CREATOR");(0,Z.setIssueDescriptionDraft)(o,p.state.initEditorData)}},p.onDescriptionScroll=function(){p.getAttachmentsStickyState()},p.onUpdateStateAndStorage=function(e,t){p.setState({autoNext:e,autoCopyNext:t},(function(){localStorage.setItem("DEFECT_CREATION_AUTO_NEXT",e),localStorage.setItem("DEFECT_CREATION_AUTO_COPY_NEXT",t)}))},p.onEditorTypeChange=function(e){if((0,B.setPreferEditorType)(e),p.setState({editorType:e}),(0,Z.isBlockType)(e))p.initCreatePage();else{var t="".concat(p.props.currentProject.name,"_").concat(p.props.issueTypeDetail.issueType,"_").concat(p.props.issueTypeDetail.id,"_CREATOR");(0,Z.setIssueDescriptionDraft)(t);var a={pageId:p.state.initEditorData.pageId,pageDraftId:p.state.initEditorData.pageDraftId,module:"collaboration",function:"description",scopeType:"project",scopeId:p.props.currentProject.id};(0,Z.delPageDraft)(a).then((function(){return p.setState({initEditorData:null})}))}},p.onCancel=function(){p.props.closeHandle()},p.removeDraft=function(){var e,t;null!==(e=p.editorRef)&&void 0!==e&&null!==(t=e.current)&&void 0!==t&&t.removeDraft&&p.editorRef.current.removeDraft()},p.onAttrScroll=function(){p.setState({isElemScroll:!0})},p.quickSave=function(e){p.state.isMac?e.metaKey&&"Enter"===e.key&&p.onSubmit():e.ctrlKey&&"Enter"===e.key&&p.onSubmit()},p.startEditing=function(e){p.state.isMac?e.metaKey||"Enter"!==e.key||p.setState({showDescriptionPlaceholder:!1}):e.ctrlKey||"Enter"!==e.key||p.setState({showDescriptionPlaceholder:!1})},p.showEpicDropdown=function(){var e=p.props,t=e.currentProjectCooperateSettings,a=e.epicCode;return t&&t.EPIC===R.MODULE_SWITCH.OPENED&&"SCRUM"===t.COOPERATE_MODE&&!a},p.getHeights=function(){var e=Math.max(320,Math.min(680,document.body.clientHeight-120-300)),t=Math.max(320,Math.min(460,document.body.clientHeight-120-300));p.setState({maxMainBodyHeight:e,editorMinHeight:t},p.getAttachmentsStickyState)},p.getAttachmentsStickyState=function(){var e,t=null===(e=p.bodyRef)||void 0===e?void 0:e.current;p.setState({attachmentsSticky:t&&t.scrollTop+t.offsetHeight<t.scrollHeight&&t.scrollHeight>t.clientHeight})},p.titleInputFocus=function(){var e,t;null===(e=p.inputRef)||void 0===e||null===(t=e.current)||void 0===t||t.focus()};var h=e.detailInfoState,v=e.assignee,g=e.name,y=null!==(n=null===(i=e.relatedIssue)||void 0===i||null===(o=i.projectModule)||void 0===o?void 0:o.id)&&void 0!==n?n:null===(s=e.relatedIssue)||void 0===s?void 0:s.project_module_id,S=Object.prototype.hasOwnProperty.call(e,"detailInfoState");return p.state={name:S?h.name:g,autoNext:"true"===localStorage.getItem("DEFECT_CREATION_AUTO_NEXT"),autoCopyNext:"true"===localStorage.getItem("DEFECT_CREATION_AUTO_COPY_NEXT"),isPending:!1,isLoading:!0,attributes:{assignee:S?null===v||void 0===v?void 0:v.id:void 0,priority:void 0,workingHours:void 0,defectType:S?null===h||void 0===h||null===(l=h.defectType)||void 0===l?void 0:l.id:void 0,startDate:void 0,dueDate:void 0,projectModule:y,requirementType:void 0,labels:[],watchers:[],fields:{},progress:void 0,defectSourceId:void 0,wuKongReloadId:void 0,serialNum:void 0,rblkhxgProperty:void 0,rblsjxgProperty:void 0,systemsId:void 0,participants:[],programId:void 0,selectedProgram:{},milestone:void 0,groupTeamId:void 0,defectKindIds:[],defectPhaseId:void 0,softwareUnitDTO:[]},releaseList:e.releaseInfo?[e.releaseInfo]:[],releaseIds:e.releaseInfo?[e.releaseInfo.id]:[],assigneeRequired:!1,isReloading:!1,iterationCode:S?null===h||void 0===h||null===(d=h.iteration)||void 0===d?void 0:d.code:e.iterationCode,epicCode:e.epicCode,iterationList:[],localEpicCode:void 0,storyPoint:void 0,isElemScroll:!1,availableRequirements:[],relatedRequirement:S?h.relatedRequirement:e.relatedIssue,relateRequirementSearchStr:"",isMac:(0,j.isMac)(),initEditorData:null,showDescriptionPlaceholder:!0,editorAutoFocus:!0,attachmentsSticky:!1,maxMainBodyHeight:0,editorMinHeight:0,editorType:(0,B.getPreferEditorType)(),fullscreen:!1,allAttachments:[],attachments:[],thirdLinks:[],isShowImportOutResourcePicker:!1,showButton:!1,toLeft:0,editionId:e.editionId||void 0},p.inputRef=b.default.createRef(),p.bodyRef=b.default.createRef(),p.editorRef=b.default.createRef(),p.sideRef=b.default.createRef(),p.setDefaultValues=p.setDefaultValues.bind((0,m.default)(p)),p.onTitleChange=p.onTitleChange.bind((0,m.default)(p)),p.onSubmit=p.onSubmit.bind((0,m.default)(p)),p.resetFormData=p.resetFormData.bind((0,m.default)(p)),p.resetPartialFormData=p.resetPartialFormData.bind((0,m.default)(p)),p.onAutoFlagChange=p.onAutoFlagChange.bind((0,m.default)(p)),p.onAutoCopyFlagChange=p.onAutoCopyFlagChange.bind((0,m.default)(p)),p.onUpdateStateAndStorage=p.onUpdateStateAndStorage.bind((0,m.default)(p)),p.onIterationChange=p.onIterationChange.bind((0,m.default)(p)),p.changeAttributes=p.changeAttributes.bind((0,m.default)(p)),p.wrapperRef=b.default.createRef(),p.listRef=b.default.createRef(),p.moveContent=p.moveContent.bind((0,m.default)(p)),p.handleDeleteAttachment=p.handleDeleteAttachment.bind((0,m.default)(p)),p.onFileDropSuccess=p.onFileDropSuccess.bind((0,m.default)(p)),p.onFileDropFail=p.onFileDropFail.bind((0,m.default)(p)),p.onFileDropDelete=p.onFileDropDelete.bind((0,m.default)(p)),p.onFileDropCancel=p.onFileDropCancel.bind((0,m.default)(p)),p.fileUpload=p.fileUpload.bind((0,m.default)(p)),p}return(0,p.default)(a,[{key:"renderAttachmentSection",value:function(){var e=this,t=this.state,a=t.attachments,n=t.allAttachments,i=t.isShowImportOutResourcePicker,r=t.showButton,o=t.toLeft,s=this.props,l=s.enterpriseGlobalKey,c=s.currentProject,u=s.user,d=c.name,f=c.id;return b.default.createElement("div",{className:se.default.attachementSectionContainer},b.default.createElement("div",{className:se.default.sectionHeader},b.default.createElement("span",{className:se.default.title},(0,E.t)("\u9644\u4ef6")),b.default.createElement("span",{className:se.default.dividerLine}),b.default.createElement(J.default,{onHandleAttachments:this.fileUpload,currentAttachmentNum:a.length,attachmentLimit:n.length>=20},b.default.createElement("a",{className:se.default.uploadButton},(0,E.t)("\u672c\u5730\u4e0a\u4f20"))),b.default.createElement("div",{className:se.default.importOutResourceWrap},b.default.createElement(ue.default,{onHandleAttachments:this.onAddThirdLink,isShowPicker:i,onShow:this.showImportOutResourcePicker,onHide:this.hideImportOutResourcePicker,attachmentLimit:n.length>=20}))),b.default.createElement("div",{className:se.default.attachmentSection},n.length?b.default.createElement("div",{className:(0,oe.default)(se.default.attachmentWrapper,r&&se.default.rightBorder,o<0&&se.default.leftBorder),ref:this.wrapperRef},b.default.createElement("div",{className:se.default.attachmentList,ref:this.listRef,style:{left:"".concat(o,"px")}},!!n.length&&b.default.createElement(Q.ThemeConsumer,null,(function(t){var a=t.hiddenFolderDirs;return n.map((function(t){return b.default.createElement("div",{className:se.default.attachmentItem,key:t.fileId},b.default.createElement(X.default,{attachment:t,enterpriseGlobalKey:l,currentProjectName:d,currentProjectId:f,dir:a[R.HIDDEN_FILE_TYPE.DEFECTS].file_id,uploadFileSuccess:e.onFileDropSuccess,uploadFileFailed:e.onFileDropFail,uploadFileDelete:e.onFileDropDelete,uploadFileCancel:e.onFileDropCancel,allowPreview:!1,userId:u.id}))}))})))):b.default.createElement("div",{className:se.default.sectionPlaceholder},(0,E.t)("\u5c1a\u672a\u6dfb\u52a0\u9644\u4ef6")),r&&b.default.createElement("a",{className:se.default.next,onClick:this.moveContent}),o<0&&b.default.createElement("a",{className:se.default.pre,onClick:function(){return e.moveContent(!1)}})))}},{key:"render",value:function(){var e,t=this,a=this.state,n=a.name,i=a.autoNext,r=a.autoCopyNext,o=a.isLoading,s=a.attributes,l=a.isReloading,c=a.iterationCode,u=a.iterationList,d=a.localEpicCode,f=a.storyPoint,p=a.availableRequirements,m=a.relatedRequirement,h=a.isMac,v=a.initEditorData,g=a.showDescriptionPlaceholder,y=a.editorAutoFocus,S=a.attachmentsSticky,I=a.maxMainBodyHeight,C=a.editorMinHeight,P=a.isPending,O=a.editionId,j=this.props,k=(j.enterpriseGlobalKey,j.currentProject),N=j.show,A=j.isShowCreateNext,F=j.bugSchemeFieldArchives,_=j.bugCreationFieldIDs,M=j.user,x=j.currentProjectCooperateSettings,B=j.isPermissible,U=j.labels,W=j.bugTypes,Y=j.sourceTypes,H=j.requirementTypes,V=j.moduleSchemes,J=j.addLabel,X=j.issueTypeDetail,Q=j.createCallbackFromTest,re=(j.ramOnline,j.releaseCode,x&&x.ITERATION&&x.ITERATION===R.MODULE_SWITCH.OPENED),ce=B([{function:L.ProjectPermissionFunction.PROJECT_ITERATION,action:L.ProjectPermissionAction.UPDATE}]),ue=x&&x.REQUIREMENT&&x.REQUIREMENT===R.MODULE_SWITCH.OPENED,de=this.getAssigneeFieldWhetherRequired(F,_),fe=this.getAssigneeFieldWhetherRequired(F,_,D.FIELD_TYPE.PARTICIPANT),pe=x&&x.STORY_POINT===R.MODULE_SWITCH.OPENED,me=x&&x.STORY_POINT_TYPE===R.STORY_POINT_TYPE.TSHIRT,he={id:M.id,value:M.id,text:M.name,name:M.name,name_pinyin:M.name_pinyin,avatar:M.avatar,media:M.avatar},ve=Q?x.ISSUE_TYPES.find((function(e){return"DEFECT"===e.issueType})):null;return b.default.createElement(G.default,{className:(0,oe.default)(se.default.wrapper),show:N,outsideClickCloseable:!1,keyboard:!1,enforceFocus:!1},b.default.createElement("span",{className:(0,oe.default)(se.default.closeButton),onClick:this.onCancel}),o&&b.default.createElement("div",{className:se.default.modalLoading}),!o&&b.default.createElement("div",{className:se.default.main},b.default.createElement("div",{className:se.default.mainHeader},b.default.createElement("div",{className:se.default.headerInfoSection},b.default.createElement("span",{style:{marginRight:"8px"}},(0,E.t)("\u521b\u5efa")),b.default.createElement(K.default,{type:X.iconType||ve.iconType}),b.default.createElement("span",null,X.name||ve.name),this.showEpicDropdown()&&b.default.createElement(b.default.Fragment,null,b.default.createElement("span",{className:se.default.dividerLine}),b.default.createElement(z.default,{currentProject:k,value:d,onSelect:this.onEpicChange})),b.default.createElement("div",{className:se.default.attentionWrapper},b.default.createElement(q.default,{type:"DEFECT",projectID:k.id,watchers:s.watchers||[],onChange:this.handleAttentionChange,user:he,action:"create",suffixText:(0,E.t)("\u4eba\u5173\u6ce8\u4e2d"),showTooltip:!0}))),b.default.createElement("div",{className:se.default.headerTitleSection},b.default.createElement("input",{className:se.default.titleInput,ref:this.inputRef,autoFocus:!0,placeholder:"".concat((0,E.t)("\u8f93\u5165\u4e8b\u9879\u6807\u9898\uff08")).concat(h?"\u2318":"Ctrl").concat((0,E.t)(" + Enter \u53ef\u5feb\u901f\u521b\u5efa\uff09")),value:n,onChange:this.onTitleChange}))),b.default.createElement("div",{className:se.default.mainBody,style:{maxHeight:"".concat(I,"px")},ref:this.bodyRef,onScroll:this.onDescriptionScroll},g?b.default.createElement("div",{className:se.default.descriptionPlaceholder,style:{height:"".concat(C,"px")},onClick:function(){return t.setState({showDescriptionPlaceholder:!1})}},(0,E.t)("\u6309\u56de\u8f66\u6216\u70b9\u6b64\u5f00\u59cb\u7f16\u8f91\u63cf\u8ff0")):b.default.createElement("div",{className:se.default.editorContainer},b.default.createElement(Z.default,{type:this.state.editorType,readOnly:this.state.isPending,isEditing:!0,autofocus:y,container:this.bodyRef.current,currentProject:k,initEditorData:v,richClientSaveUuid:"BUG_EDITOR_CREATOR",onEditorChange:this.onDescriptionChange,isDisabled:P,canChangeType:!0,onLoad:function(e){if(e.isError){if((0,Z.isBlockType)(t.state.editorType)&&e.isDraftIdNotExist){var a=(0,T.default)(X)?"".concat(k.name,"_").concat(ve.issueType,"_").concat(ve.id,"_CREATOR"):"".concat(k.name,"_").concat(X.issueType,"_").concat(X.id,"_CREATOR");(0,Z.setIssueDescriptionDraft)(a),t.setState({initEditorData:null},t.initCreatePage)}}else t.getAttachmentsStickyState()},className:(0,oe.default)(se.default.customSectionZindex,!this.state.fullscreen&&se.default.editorHeight),ref:this.editorRef,onEditorTypeChangeCallback:function(e){return t.onEditorTypeChange(e)},onFullScreenCallback:function(e){t.setState({fullscreen:e})}}))),b.default.createElement("div",{className:(0,oe.default)(se.default.mainFooter,S&&se.default.sticky)},this.renderAttachmentSection(),b.default.createElement("div",{className:se.default.operationsWrapper},b.default.createElement("div",{disabled:l,className:(0,oe.default)(se.default.operationButton,!h&&se.default.wider,le.default.newButton,le.default.primary,le.default.h32,l&&le.default.disabled),onClick:this.onSubmit,"data-container":!0,"data-title":"\u521b\u5efa".concat(X.name,"-\u786e\u5b9a")},(0,E.t)("\u521b\u5efa"),b.default.createElement("span",{className:se.default.key},h?"\u2318":"Ctrl"),b.default.createElement("span",{className:(0,oe.default)(se.default.key,se.default.enter)})),b.default.createElement("div",{className:(0,oe.default)(se.default.operationButton,le.default.newButton,le.default.default,le.default.h32),onClick:this.onCancel,"data-container":!0,"data-title":"\u521b\u5efa".concat(X.name,"-\u53d6\u6d88")},(0,E.t)("\u53d6\u6d88")),A&&b.default.createElement(b.default.Fragment,null,b.default.createElement("span",{className:se.default.switch},b.default.createElement($.default,{checked:i,onChange:this.onAutoFlagChange}),b.default.createElement("span",{className:se.default.switchText},(0,E.t)("\u7ee7\u7eed\u521b\u5efa\u4e0b\u4e00\u4e2a"))),b.default.createElement("span",{className:se.default.switch},b.default.createElement($.default,{checked:r,onChange:this.onAutoCopyFlagChange}),b.default.createElement("span",{className:se.default.switchText},(0,E.t)("\u590d\u5236\u5e76\u65b0\u5efa\u4e0b\u4e00\u4e2a"))))))),!o&&b.default.createElement("div",{className:se.default.aside,onScroll:this.onAttrScroll,ref:this.sideRef},b.default.createElement("div",{className:se.default.asideContent},b.default.createElement("div",{className:se.default.issuePropertyContainer},b.default.createElement("div",{className:se.default.issuePropertySection},b.default.createElement("label",null,(0,E.t)("\u5904\u7406\u4eba"),de&&b.default.createElement("span",{className:se.default.highlight},"*")),b.default.createElement(ee.default,{inProject:!0,projectID:k.id,value:s.assignee||null,clearable:!de,onSelect:function(e){t.changeAttributes({type:"assignee",value:e});var a=s.participants;a.some((function(t){return t.id===e.id}))||setTimeout((function(){t.changeAttributes({type:"participants",value:(0,w.default)(a,e)})}))},onClear:function(){return t.changeAttributes({type:"assignee"})},triggerExtraProps:{initialSelectedItem:(null===s||void 0===s?void 0:s.defaultAssignee)||this.props.assignee}})),b.default.createElement("div",{className:se.default.issuePropertySection},b.default.createElement("label",null,(0,E.t)("\u53c2\u4e0e\u4eba"),fe&&b.default.createElement("span",{className:se.default.highlight},"*")),b.default.createElement(ee.default,{inProject:!0,projectID:k.id,value:s.participants.map((function(e){return e.id})),clearable:!fe,isMultiple:!0,onSelect:function(e){var a=s.participants,n=[];n=a.find((function(t){return t.id===e.id}))?a.filter((function(t){return e.id!==t.id})):(0,w.default)(a,e),t.changeAttributes({type:"participants",value:n})},onClear:function(){return t.changeAttributes({type:"participants"})},triggerExtraProps:{initialSelectedItem:s.participants||[]},dropdownStyle:se.default.dropdownStyle,triggerStyle:se.default.triggerStyle,panelCustomStyle:se.default.panelCustomStyle})),re&&b.default.createElement("div",{className:se.default.issuePropertySection},b.default.createElement("label",null,(0,E.t)("\u6240\u5c5e\u8fed\u4ee3")),b.default.createElement(te.default,{type:{issueType:"sprint",iconType:"sprint"},placeholder:(0,E.t)("\u672a\u89c4\u5212\u8fdb\u8fed\u4ee3"),clearPlaceholder:(0,E.t)("\u79fb\u51fa\u8fed\u4ee3"),searchPlaceholder:(0,E.t)("\u5feb\u901f\u7b5b\u9009"),searchable:!0,value:c,items:u,isBase:!0,onSelect:this.onIterationChange,onClear:function(){return t.onIterationChange()},projectPath:k.project_path,disabled:!ce,portalProps:{toRight:!0,popDropdownMenuWidth:280,portalWrapStyle:{zIndex:1049,width:"280px"},isScroll:this.state.isElemScroll,resetIsScroll:function(){t.setState({isElemScroll:!1})}}})),ue&&b.default.createElement("div",{className:se.default.issuePropertySection},b.default.createElement("label",null,(0,E.t)("\u5173\u8054\u9700\u6c42")),b.default.createElement(te.default,{requireCode:!0,type:m&&m.issueTypeDetail||null,placeholder:(0,E.t)("\u672a\u5173\u8054\u9700\u6c42"),clearPlaceholder:(0,E.t)("\u6e05\u9664\u5df2\u9009"),searchable:!0,singleReturn:!0,projectPath:k.project_path,value:m?m.code:null,items:p,selectedItem:m,onSearch:function(e){t.setState({relateRequirementSearchStr:e}),t.getRequirements(e)},onSelect:function(e){t.setState({relatedRequirement:e})},onClear:function(){t.setState({relatedRequirement:void 0})},isBase:!0,portalProps:{toRight:!0,popDropdownMenuWidth:280,portalWrapStyle:{zIndex:1049,width:"280px"},isScroll:this.state.isElemScroll,resetIsScroll:function(){t.setState({isElemScroll:!1})}}})),pe&&b.default.createElement("div",{className:se.default.issuePropertySection},b.default.createElement("label",null,(0,E.t)("\u6545\u4e8b\u70b9")),b.default.createElement(ae.default,{useSize:me,value:f,onSelect:function(e){t.setState({storyPoint:e>-1?e:void 0})},onClear:function(){t.setState({storyPoint:void 0})}})),b.default.createElement(ie.default,{status:"isCreate",getVersion:function(e){return t.setState({editionId:e})},versionValue:{id:O},boxStyle:se.default.issuePropertySection,projectId:k.id,isSetDropdownPanelWidth:!0,onChange:this.changeAttributes,planDateCustomID:null===(e=Object.values(F).find((function(e){var t;return"\u8ba1\u5212\u4e0a\u7ebf\u65e5\u671f"===(null===(t=e.issueField)||void 0===t?void 0:t.name)})))||void 0===e?void 0:e.issueFieldId})),b.default.createElement("div",{className:(0,oe.default)(se.default.issuePropertyContainer,se.default.hasNoBorder)},b.default.createElement(ne.default,{isCreate:!0,schemeFieldArchives:F,fieldIds:_,issueType:"DEFECT",onChange:this.changeAttributes,customAttributes:s,labels:U,bugTypes:W,sourceTypes:Y,moduleSchemes:V,addLabel:J,projectID:k.id,currentProject:k,requirementTypes:H,isPermissible:B,portalProps:{toRight:!0,portalWrapStyle:{zIndex:1099},isScroll:this.state.isElemScroll,resetIsScroll:function(){t.setState({isElemScroll:!1})}},parentRef:this.sideRef})))))}},{key:"componentDidMount",value:function(){var e=this,t=this.props,a=t.currentProject,n=t.issueTypeDetail,i=t.defectCode,r=this.state,o=r.name,s=r.editorType;document.addEventListener("keydown",this.quickSave),document.addEventListener("keydown",this.startEditing),window.addEventListener("resize",this.getHeights),this.getBasicInfo().then((function(){var t=e.props,a=t.bugSchemeFieldArchives,n=t.bugCreationFieldIDs;e.setDefaultValues(a,n),e.getHeights()})).finally((function(){if((0,Z.isBlockType)(s)){var t=(0,Z.getIssueDescriptionDraft)("".concat(a.name,"_").concat(n.issueType,"_").concat(n.id,"_CREATOR"));if(!i&&!t)return void e.initCreatePage().then((function(){e.setState({isLoading:!1})}));if(!i&&t)return void e.setState({isLoading:!1,initEditorData:{pageId:t.pageId,pageDraftId:t.pageDraftId,historyId:t.historyId},editorAutoFocus:!!o,showDescriptionPlaceholder:!1})}e.setState({isLoading:!1,editorAutoFocus:!!o,showDescriptionPlaceholder:!1})}))}},{key:"componentDidUpdate",value:function(e,t){if(t.isReloading!==this.state.isReloading){var a=this.props,n=a.bugSchemeFieldArchives,i=a.bugCreationFieldIDs,r=e.bugSchemeFieldArchives,o=e.bugCreationFieldIDs;if(!(0,C.default)(n,r)&&!(0,C.default)(i,o)){var s=(0,P.default)(i,o);this.setDefaultValues(n,s)}}t.allAttachments.length!==this.state.allAttachments.length&&this.whetherShowMoveButton(),t.editorType!==this.state.editorType&&(0,Z.isBlockType)(this.state.editorType)&&!this.state.initEditorData&&this.initCreatePage()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.quickSave),document.removeEventListener("keydown",this.startEditing),window.removeEventListener("resize",this.getHeights)}},{key:"getBasicInfo",value:function(){return Promise.all([this.getIterationList(),this.getRequirements(),this.props.getRequirementTypes(),this.props.getBugTypes(),this.props.getSourceTypes(),this.props.getModuleSchemes(),this.props.getBugScheme(!0)].concat((0,u.default)(this.props.defectCode?[this.checkDescriptionPageId()]:[])))}},{key:"getIterationList",value:function(){var e=this,t=this.props.currentProject;(0,_.fetchIterationList)(t.id).then((function(t){e.setState({iterationList:e.formatIterationList(t.data)})}))}},{key:"formatIterationList",value:function(e){return e.map((function(e){return{value:e.code,text:e.name,progress:{finished:e.completedCount,processing:e.processingCount,unstart:e.waitProcessCount}}}))}},{key:"onTitleChange",value:function(e){this.setState({name:e.target.value})}},{key:"onAutoFlagChange",value:function(e){this.onUpdateStateAndStorage(e,!e&&this.state.autoCopyNext)}},{key:"onAutoCopyFlagChange",value:function(e){this.onUpdateStateAndStorage(!e&&this.state.autoNext,e)}},{key:"onSubmit",value:function(){var e=(0,c.default)(r.default.mark((function e(){var t,a,n,i,o,s,l,c,u,d,f,p,m,h,v,g,b,y,S,C,P,w,R,j,L,_,M,x,B,U,W,Y,H,V,G,K,z,q,J,X,Q,$,ee,te,ae,ne,ie,oe,se,le,ce,ue,fe,pe,me,ve,ge,Ee,be,ye,Se,Ie,Te,Ce,Pe,we,De,Oe,Re=this;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=this.props.currentProject,l=s.id,c=s.project_path,u=s.name,null===(t=this.editorRef)||void 0===t||!t.current||!(0,Z.isBlockType)(this.state.editorType)){e.next=10;break}return e.prev=2,e.next=5,(0,re.getBlockEditorFinished)(this.editorRef.current);case 5:e.next=10;break;case 7:return e.prev=7,e.t0=e.catch(2),e.abrupt("return",(0,N.warning)((0,E.t)("\u66f4\u65b0\u63cf\u8ff0\u8d85\u65f6")));case 10:if(d=this.props,f=d.isShowCreateNext,p=d.bugSchemeFieldArchives,m=d.bugCreationFieldIDs,h=d.closeHandle,v=d.callback,g=d.createCallbackFromTest,b=d.createWithTargetCode,y=d.callbackWithData,S=d.txcPostId,C=d.issueTypeDetail,P=d.currentProjectCooperateSettings,w=this.state,R=w.name,j=w.autoNext,L=w.autoCopyNext,_=w.isPending,M=w.allAttachments,x=w.attachments,B=w.iterationCode,U=w.epicCode,W=w.localEpicCode,Y=w.storyPoint,H=w.editionId,V=w.attributes,G=V.assignee,K=V.priority,z=V.defectType,q=V.startDate,J=V.dueDate,X=V.projectModule,Q=V.workingHours,$=V.estimatedWorkHour,ee=V.labels,te=V.watchers,ae=V.requirementType,ne=V.fields,ie=V.progress,oe=V.defectSourceId,se=V.wuKongReloadId,le=V.serialNum,ce=V.systemsId,ue=V.participants,fe=V.programId,pe=V.milestone,me=V.groupTeamId,ve=V.defectKindIds,ge=V.defectPhaseId,Ee=V.softwareUnitDTO,be=w.relatedRequirement,ye=w.thirdLinks,Se=w.initEditorData,Ie=w.releaseIds,Te=w.editorType,!_){e.next=14;break}return e.abrupt("return");case 14:if(!(0,T.default)((0,I.default)(R))){e.next=17;break}return(0,N.warning)((0,E.t)("\u7f3a\u9677\u6807\u9898\u4e0d\u80fd\u4e3a\u7a7a")),e.abrupt("return");case 17:if(128,!((0,I.default)(R).length>128)){e.next=21;break}return(0,N.warning)((0,E.t)("\u7f3a\u9677\u540d\u79f0\u6700\u591a\u652f\u6301{{num}}\u4f4d",{num:128})),e.abrupt("return");case 21:if(!(Ce=m.find((function(e){var t=p[e],a=t.required,n=t.issueField.type;if(a){var i;switch(n){case D.FIELD_TYPE.ASSIGNEE:i=G;break;case D.FIELD_TYPE.PROGRESS:i=ie;break;case D.FIELD_TYPE.PRIORITY:i=K;break;case D.FIELD_TYPE.DEFECT_KIND:i=ve;break;case D.FIELD_TYPE.DEFECT_PHASE:i=ge;break;case D.FIELD_TYPE.DEFECT_TYPE:i=z;break;case D.FIELD_TYPE.START_DATE:i=q;break;case D.FIELD_TYPE.DUE_DATE:i=J;break;case D.FIELD_TYPE.MODULE:i=X;break;case D.FIELD_TYPE.LABEL:i=ee;break;case D.FIELD_TYPE.WATCHER:i=te;break;case D.FIELD_TYPE.REQUIREMENT_TYPE:i=ae;break;case D.FIELD_TYPE.WORKING_HOURS:i=Q;break;case D.FIELD_TYPE.DEFECT_SOURCE:i=oe;break;case D.FIELD_TYPE.WUKONG_RELOAD:i=se;break;case D.FIELD_TYPE.SERIAL_NUM:i=le;break;case D.FIELD_TYPE.SYSTEM:i=ce;break;case D.FIELD_TYPE.GROUP_TEAM:i=me;break;case D.FIELD_TYPE.PARTICIPANT:i=ue;break;case D.FIELD_TYPE.INPROGRAM:i=fe;break;case D.FIELD_TYPE.MILESTONE:i=pe;break;default:i=ne[e]}return!(Array.isArray(i)?i.length:null!==i&&void 0!==i)}return!1})))){e.next=25;break}return(0,N.warning)("".concat((0,E.t)("\u8bf7\u586b\u5199")).concat(p[Ce].issueField.name)),e.abrupt("return");case 25:if(!(x.length&&x.findIndex((function(e){return e.fileId<0}))>-1)){e.next=28;break}return(0,N.warning)((0,E.t)("\u6709\u9644\u4ef6\u6b63\u5728\u4e0a\u4f20\uff0c\u8bf7\u7a0d\u540e\u63d0\u4ea4")),e.abrupt("return");case 28:this.setState({isPending:!0}),Pe=Object.keys(ne).filter((function(e){return void 0!==ne[e]})).map((function(e){var t=p[e].issueField.componentType;return t===O.PROPERTY_TYPE_CONSTANTS.SELECT_ITERATION_MULTI||t===O.PROPERTY_TYPE_CONSTANTS.SELECT_MEMBER_MULTI?{id:e,content:ne[e].map((function(e){return e.id}))}:t===O.PROPERTY_TYPE_CONSTANTS.SELECT_ITERATION_SINGLE||t===O.PROPERTY_TYPE_CONSTANTS.SELECT_MEMBER_SINGLE?{id:e,content:ne[e].id}:{id:e,content:ne[e]}})),we=P.ISSUE_TYPES.find((function(e){return"DEFECT"===e.issueType})),De=(0,de.default)(M,ye).map((function(e){return he(he({createdAt:e.createdAt},e.modao),e.codesign)})),Oe=(0,Z.isBlockType)(Te)?he(he({},Se),{},{descriptionType:Z.EditorType.BLOCK}):{content:(null===(a=this.editorRef)||void 0===a||null===(n=a.current)||void 0===n?void 0:n.getRichContent())||"",slateRaw:(null===(i=this.editorRef)||void 0===i||null===(o=i.current)||void 0===o?void 0:o.getRichContent("raw"))||"",descriptionType:Z.EditorType.MARKDOWN},(0,F.createIssue)(l,he(he({type:"DEFECT",iterationCode:B||0,epicCode:U||W&&W.code,relatedIssueCode:null===be||void 0===be?void 0:be.code,storyPoint:Y,name:(0,I.default)(R),fileIds:x.map((function(e){return e.fileId})),thirdLinks:De,customFieldValueMap:Pe.length?Pe:null,priority:K,startDate:q,dueDate:J,assignee:G,workingHours:Q,estimatedWorkHour:$,defectTypeId:z,requirementTypeId:ae,projectModuleId:X,labelIds:ee,watchers:te.map((function(e){return e.id})),targetSortCode:b,progress:ie,txcPostId:S},C?{issueTypeId:C.id||we.id}:{}),{},{kmPage:Oe,releaseIds:Ie,defectSourceId:oe,defectKindIds:ve,defectPhaseId:ge,wuKongReloadId:se,serialNum:le,systemsId:ce,participants:ue.map((function(e){return e.id})),programId:fe,milestoneId:pe,groupTeamId:me,editionId:H,softwareUnitIds:Ee.map((function(e){return e.id}))}),!0).then((function(e){var t=e.data,a="".concat(u,"_").concat(C.issueType||we.issueType,"_").concat(C.id||we.id,"_CREATOR");(0,Z.setIssueDescriptionDraft)(a),(0,N.success)("".concat((0,E.t)("\u7f3a\u9677 #")).concat(t.code).concat((0,E.t)(" \u521b\u5efa\u6210\u529f\uff0c\u70b9\u51fb\u67e5\u770b\u7f3a\u9677\uff01")),{link:"".concat(c,"/bug-tracking/issues/").concat(t.code,"/detail")}),g&&g(t),Re.removeDraft(),v&&v(null,t.issueStatusId,B),y&&y(t),f&&j?Re.resetFormData():f&&L?Re.resetPartialFormData(t.id):h()}),(function(e){var t=e.code,a=e.data,n=e.msg;if(8026===t)m.findIndex((function(e){return e===a.issueField.issueFieldId}))<0?((0,N.danger)((0,E.t)("\u521b\u5efa\u9875\u5c5e\u6027\u5df2\u53d8\u66f4\uff0c\u8bf7\u68c0\u67e5\u5fc5\u586b\u5c5e\u6027\u5e76\u518d\u6b21\u63d0\u4ea4\u3002")),Re.setState({isReloading:!0},(function(){Promise.all([Re.props.getBugScheme(),Re.props.getBugScheme(!0)]).then((function(){Re.setState({isReloading:!1})}))}))):(0,N.danger)((0,A.getErrorMessage)(n));else{if((0,k.configPlanNotToastMsg)(t))return;(0,N.danger)((0,A.getErrorMessage)(n))}})).finally((function(){Re.setState({isPending:!1})}));case 34:case"end":return e.stop()}}),e,this,[[2,7]])})));return function(){return e.apply(this,arguments)}}()},{key:"onIterationChange",value:function(e){this.setState({iterationCode:e?e.value:void 0})}},{key:"changeAttributes",value:function(e){var t=e.isCustom,a=e.type,n=e.value,i=e.issueFieldId,r=e.customValue,o=this.state.attributes;this.setState({attributes:(0,S.default)(o,(function(e){switch(t&&(e.fields=he(he({},o.fields),{},(0,d.default)({},i,n))),a){case"assignee":e.assignee=n?n.value:null,e.defaultAssignee=n;break;case"participants":e.participants=n||[];break;case"softwareUnitDTO":e.softwareUnitDTO=n||[];break;case"systemsId":e.systemsId=n,e.softwareUnitDTO=[];break;case"proposer":e.proposerDept=void 0,e.proposer=n;break;case"programId":e.programId=null!==n&&void 0!==n&&n.id?n.id:n,e.selectedProgram=n||{},e.milestone=0;break;case"defectKindIds":e.defectPhaseId=r,e.defectKindIds=n;break;case"defectPhaseId":e.defectPhaseId=n,e.defectKindIds=[];break;case"workingHours":e.workingHours=null===n||void 0===n?void 0:n.workingHours,e.estimatedWorkHour=n;break;default:e[a]=n}}))})}},{key:"getAssigneeFieldWhetherRequired",value:function(e,t){if(!e||!t.length)return!1;var a=t.find((function(t){return"ASSIGNEE"===e[t].issueField.type}));return e[a].required}},{key:"setDefaultValues",value:function(e,t){var a=this.state.attributes,n=this.props,i=n.user,r=n.defaultProgramId,o={id:i.id,value:i.id,text:i.name,name:i.name,name_pinyin:i.name_pinyin,avatar:i.avatar,media:i.avatar};this.setState({attributes:(0,S.default)(a,(function(a){a.participants=[o],t&&t.forEach((function(t){var n=e[t],s=n.needDefault,l=n.value,c=n.userMap,d=n.iterationMap,f=n.issueField,p=f.type,m=f.componentType;if("INPROGRAM"===p&&r&&(a.programId=+r),s&&null!==l)switch(p){case D.FIELD_TYPE.ASSIGNEE:"VARIABLE"===l.type?(a.assignee=i.id,a.defaultAssignee=o):"CONSTANT"===l.type&&(a.assignee=l.value,a.defaultAssignee=c[l.value]);break;case D.FIELD_TYPE.PRIORITY:a.priority=l.value;break;case D.FIELD_TYPE.DEFECT_TYPE:a.defectType=l.value;break;case D.FIELD_TYPE.DEFECT_KIND:a.defectKindIds=l.value;break;case D.FIELD_TYPE.DEFECT_PHASE:a.defectPhaseId=l.value;break;case D.FIELD_TYPE.START_DATE:a.startDate=l.value;break;case D.FIELD_TYPE.DUE_DATE:a.dueDate=l.value;break;case D.FIELD_TYPE.MODULE:a.projectModule=l.value;break;case D.FIELD_TYPE.PROGRESS:a.progress=l.value;break;case D.FIELD_TYPE.LABEL:a.labels=l.value;break;case D.FIELD_TYPE.WATCHER:"VARIABLE"===l.type?a.watchers=(0,u.default)("CREATOR"===l.value?[o]:[]):a.watchers=l.value.map((function(e){return c[e]}));break;case D.FIELD_TYPE.REQUIREMENT_TYPE:a.requirementType=l.value;break;case D.FIELD_TYPE.WORKING_HOURS:a.workingHours=l.value;break;case D.FIELD_TYPE.WUKONG_RELOAD:a.wuKongReloadId=l.value;break;case D.FIELD_TYPE.RBLKHXG:a.rblkhxgProperty=l.value;break;case D.FIELD_TYPE.RBLSJXG:a.rblsjxgProperty=l.value;break;case D.FIELD_TYPE.PARTICIPANT:a.participants=l.value&&l.value.length?l.value.map((function(e){return c[e]})):[];break;case D.FIELD_TYPE.INPROGRAM:a.programId=l.value;break;case D.FIELD_TYPE.DEFECT_SOURCE:a.defectSourceId=l.value;break;default:m===O.PROPERTY_TYPE_CONSTANTS.SELECT_MEMBER_SINGLE||m===O.PROPERTY_TYPE_CONSTANTS.SELECT_MEMBER_MULTI?"VARIABLE"===l.type?a.fields[t]=o:Array.isArray(l.value)?a.fields[t]=l.value.map((function(e){return c[e]})):a.fields[t]=c[l.value]:m===O.PROPERTY_TYPE_CONSTANTS.SELECT_ITERATION_SINGLE||m===O.PROPERTY_TYPE_CONSTANTS.SELECT_ITERATION_MULTI?Array.isArray(l.value)?a.fields[t]=l.value.map((function(e){return d[e]})):a.fields[t]=d[l.value]:a.fields[t]=l.value}}))}))})}},{key:"resetFormData",value:function(){var e=this,t=this.props,a=t.bugSchemeFieldArchives,n=t.bugCreationFieldIDs,i=t.iterationCode,r=t.isShowCreateNext,o=this.state.autoNext;this.setState({name:"",storyPoint:void 0,attachments:[],isPending:!1,editionId:void 0,attributes:{assignee:void 0,priority:void 0,defectType:void 0,requirementType:void 0,startDate:void 0,dueDate:void 0,projectModule:void 0,workingHours:void 0,labels:[],watchers:[],fields:{},progress:void 0,wuKongReloadId:void 0,serialNum:void 0,defectSourceId:void 0,participants:[],systemsId:void 0,groupTeamId:void 0,defectKindIds:[],defectPhaseId:void 0},iterationCode:void 0,localEpicCode:void 0,relatedRequirement:void 0,initEditorData:null,editorAutoFocus:!0},(function(){e.setDefaultValues(a,n),e.setState({iterationCode:i}),e.combineThirdLinks(),r&&o&&(e.initCreatePage(),e.setState({showDescriptionPlaceholder:!0}),e.titleInputFocus())})),getHeights=function(){var t=Math.max(320,Math.min(680,document.body.clientHeight-120-300)),a=Math.max(320,Math.min(460,document.body.clientHeight-120-300));e.setState({maxMainBodyHeight:t,editorMinHeight:a},e.getAttachmentsStickyState)},getAttachmentsStickyState=function(){var t,a=null===(t=e.bodyRef)||void 0===t?void 0:t.current;e.setState({attachmentsSticky:a&&a.scrollTop+a.offsetHeight<a.scrollHeight&&a.scrollHeight>a.clientHeight})}}},{key:"resetPartialFormData",value:function(e){var t=this,a=this.props.isShowCreateNext,n=this.state,i=n.autoCopyNext,r=n.attributes;this.setState({name:"",attachments:[],thirdLinks:[],isPending:!1,attributes:he(he({},r),{},{workingHours:void 0,estimatedWorkHour:void 0}),initEditorData:null},(function(){t.combineThirdLinks(),a&&i&&(t.copyCreatePage(e),t.titleInputFocus())}))}},{key:"fileUpload",value:function(e){this.setState({attachments:(0,S.default)(this.state.attachments,(function(t){t.splice.apply(t,[t.length,0].concat((0,u.default)(e)))}))},this.combineThirdLinks)}},{key:"handleDeleteAttachment",value:function(e,t){var a=this;(0,_.delAttachment)(e,t).then((function(){a.setState({attachments:(0,S.default)(a.state.attachments,(function(e){var a=e.findIndex((function(e){return e.fileId===t}));e.splice(a,1)}))},a.combineThirdLinks)}))}},{key:"onFileDropSuccess",value:function(e){var t=this;this.setState((function(t){return{attachments:(0,S.default)(t.attachments,(function(t){var a;if(t.find((function(t){return t.fileId===e.fileId}))){(0,N.success)("".concat(e.name).concat((0,E.t)(" \u6587\u4ef6\u5df2\u66f4\u65b0!")));var n=t.findIndex((function(t){return t.timestamp===e.timestamp}));t.splice(n,1),a=t.findIndex((function(t){return t.fileId===e.fileId}))}else a=t.findIndex((function(t){return t.timestamp===e.timestamp}));t[a]=he(he({},t[a]),e)}))}})),this.setState((function(){t.combineThirdLinks()}))}},{key:"onFileDropFail",value:function(e){var t=e.timestamp;this.setState({attachments:(0,S.default)(this.state.attachments,(function(e){var a=e.findIndex((function(e){return e.timestamp===t}));e.splice(a,1)}))})}},{key:"onFileDropDelete",value:function(e){var t=e.fileId,a=e.isModao,n=e.isCodesign,i=this.props.currentProject.id;a||n?this.setState({thirdLinks:this.state.thirdLinks.filter((function(e){return e.fileId!==t}))},this.combineThirdLinks):this.handleDeleteAttachment(i,t)}},{key:"onFileDropCancel",value:function(e){var t=e.timestamp,a=e.isModao,n=e.isCodesign;a||n?this.setState({thirdLinks:this.state.thirdLinks.filter((function(e){return e.timestamp!==t}))},this.combineThirdLinks):this.setState({attachments:(0,S.default)(this.state.attachments,(function(e){var a=e.findIndex((function(e){return e.timestamp===t}));e.splice(a,1)}))},this.combineThirdLinks)}},{key:"whetherShowMoveButton",value:function(){if(this.wrapperRef.current&&this.listRef.current){var e=this.wrapperRef.current.getBoundingClientRect().width,t=this.listRef.current.getBoundingClientRect().width;this.setState({showButton:t>e})}}},{key:"moveContent",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.wrapperRef.current&&this.listRef.current){var t=this.state.toLeft,a=this.wrapperRef.current.getBoundingClientRect(),n=a.width,i=this.listRef.current.getBoundingClientRect(),r=i.width,o=r+t-n;e?o<=n?this.setState({toLeft:t+-1*o,showButton:!1}):this.setState({toLeft:t-n}):o<=n?this.setState({toLeft:0,showButton:!0}):this.setState({toLeft:t+n})}}}]),a}(b.Component),s.propTypes=he(he({show:y.default.bool,closeHandle:y.default.func,currentProject:y.default.shape({id:y.default.number.isRequired,name:y.default.string,owner_user_name:y.default.string}),user:y.default.object,txcPostId:y.default.string,getBugScheme:y.default.func,getIssueStatus:y.default.func,getBugTypes:y.default.func,bugTypes:y.default.array,sourceTypes:y.default.array,requirementTypes:y.default.array,getModuleSchemes:y.default.func,bugSchemeFieldArchives:y.default.object,bugCreationFieldIDs:y.default.array,getRequirementTypes:y.default.func,labels:y.default.array,addLabel:y.default.func,moduleSchemes:y.default.array,isShowCreateNext:y.default.bool,enterpriseGlobalKey:y.default.string,callback:y.default.func,createCallbackFromTest:y.default.func,iterationCode:y.default.number,epicCode:y.default.number,relatedIssue:y.default.object,storyPoint:y.default.number,name:y.default.string,currentProjectCooperateSettings:y.default.object,createWithTargetCode:y.default.number,hiddenFolderDirs:y.default.object,emitMountEvt:y.default.func},L.WithProjectPermissionProps),{},{callbackWithData:y.default.func,releaseInfo:y.default.object,ramOnline:y.default.bool,releaseCode:y.default.number}),s.defaultProps={isShowCreateNext:!0},o=l))||o)||o)||o)||o)||o;t.default=ge},QATL:function(e,t,a){e.exports=a.p+"3ba10615f3000f0720b5e76a6fea3174.svg"},QDLY:function(e,t,a){e.exports={"modal-title":"modal-title-1JCIsm--oD",modalTitle:"modal-title-1JCIsm--oD","button-group":"button-group-1vZL3rhkHg",buttonGroup:"button-group-1vZL3rhkHg","flex-space-around":"flex-space-around-32XCiUdFxC",flexSpaceAround:"flex-space-around-32XCiUdFxC"}},QEh4:function(e,t,a){"use strict";a.r(t),a.d(t,"formatIterationItemInPM",(function(){return f})),a.d(t,"ListIterationTrigger",(function(){return p})),a.d(t,"IterationTrigger",(function(){return m})),a.d(t,"UndefineIterationItem",(function(){return h}));var n=a("mVeg"),i=a("cDcd"),r=a.n(i),o=a("K2gz"),s=a.n(o),l=a("TPfW"),c=a.n(l),u=a("7FZc"),d=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},f=function(e){return void 0===e?[]:e.map((function(e){return{value:e.code,id:e.code,text:e.name,name:e.name}}))},p=function(e){var t=e.value,a=e.selected;if(a&&a.length>0){var i=d(a,1)[0];return r.a.createElement("div",{className:c.a.simpleTrigger},r.a.createElement("span",{className:c.a.pName},i.name),r.a.createElement("div",{className:c.a.caretDown}))}return t?r.a.createElement("div",{className:c.a.simpleTrigger},r.a.createElement("span",{className:c.a.pName},t.name),r.a.createElement("div",{className:c.a.caretDown})):r.a.createElement("div",{className:c.a.simpleTrigger},r.a.createElement("span",{className:c.a.defaultName},Object(n.t)("\u672a\u6307\u5b9a")),r.a.createElement("div",{className:c.a.caretDown}))},m=function(e){var t=e.title,a=e.selected,i=e.undefinedConst,o=e.valueChanged,s=void 0!==o&&o,l=e.noMatched,d=Object(n.t)("\u90e8\u5206\u8fed\u4ee3\u4e0d\u5b58\u5728\u6216\u65e0\u6743\u9650\uff0c\u76f8\u5173\u4e8b\u9879\u4e0d\u4f1a\u663e\u793a\u5728\u641c\u7d22\u7ed3\u679c\u4e2d");return void 0===a||0===(null===a||void 0===a?void 0:a.length)?r.a.createElement("div",{className:"trigger-w100 ".concat(c.a.trigger)},t?r.a.createElement("span",{className:"".concat(c.a.title," newfilter-hidden")},t):null,r.a.createElement("span",{className:c.a.projectName},l?Object(n.t)("\u672a\u5339\u914d"):i?Object(n.t)("\u672a\u89c4\u5212\u8fdb\u8fed\u4ee3"):Object(n.t)("\u5168\u90e8")),r.a.createElement("div",{className:c.a.caretDown}),s&&r.a.createElement(u.TooltipTrigger,{title:d},r.a.createElement("div",{className:c.a.configError}))):r.a.createElement("div",{className:"trigger-w100 ".concat(c.a.trigger)},t?r.a.createElement("span",{className:"".concat(c.a.title," newfilter-hidden")},t):null,r.a.createElement("span",{className:c.a.projectName},(null===a||void 0===a?void 0:a.filter((function(e){return void 0!==e})).map((function(e){return e.name})).join(","))+(i?Object(n.t)(",\u672a\u89c4\u5212\u8fdb\u8fed\u4ee3"):"")),r.a.createElement("div",{className:c.a.caretDown}),s&&r.a.createElement(u.TooltipTrigger,{title:d},r.a.createElement("div",{className:c.a.configError})))},h=function(e){var t=e.iteration,a=e.undefinedConst,i=e.setUndefined;return r.a.createElement("div",{className:s()([c.a.menuItem,t&&c.a.iterationList]),onClick:i},t&&r.a.createElement("div",{className:c.a.nameUndefinedIcon}),r.a.createElement("span",{className:c.a.iterationNameUndefined},Object(n.t)("\u672a\u89c4\u5212\u8fdb\u8fed\u4ee3")),a&&r.a.createElement("span",{className:c.a.checked}))};t.default=function(e){var t=e.iteration,a=e.item,n=e.selected,o=e.onSelect,l=(null===n||void 0===n?void 0:n.filter((function(e){return void 0!==e})).filter((function(e){return e.id===a.id})).length)>0,u=d(Object(i.useState)(null===n||void 0===n?void 0:n.includes(a)),2),f=u[0],p=u[1];return Object(i.useEffect)((function(){p(l)})),r.a.createElement("div",{className:s()([c.a.menuItem,t&&c.a.iterationList]),onClick:function(){p(!f),o()}},r.a.createElement("div",{className:c.a.iteration,title:a.name},t&&r.a.createElement("div",{className:c.a.iterationNameIcon}),r.a.createElement("div",{className:c.a.iterationName},a.name)),t&&r.a.createElement("div",{className:c.a.projectNameWithIteration,title:a.projectName},a.projectName),f&&r.a.createElement("span",{className:c.a.checked,title:a.projectName}))}},QOal:function(e,t,a){e.exports={"issue-modal":"issue-modal-ZonfDK1yCM",issueModal:"issue-modal-ZonfDK1yCM",title:"title-1kSrbjPWhX",close:"close-2afN_vCC37","search-area":"search-area-3FgMvWxtgs",searchArea:"search-area-3FgMvWxtgs","custom-input":"custom-input-1zdtNKfVl-",customInput:"custom-input-1zdtNKfVl-","search-icon":"search-icon-1ybRk5AC_u",searchIcon:"search-icon-1ybRk5AC_u","filter-bar":"filter-bar-311OKSksbM",filterBar:"filter-bar-311OKSksbM","custom-project-dropdown":"custom-project-dropdown-2Js0jlFg8R",customProjectDropdown:"custom-project-dropdown-2Js0jlFg8R",arrow:"arrow-1B22rSjqqi",result:"result-iMp_SD1eMG",empty:"empty-IMWUjGbnEN",tip:"tip-3rR4sfp6cR","item-bar":"item-bar-ZALgAlqj1O",itemBar:"item-bar-ZALgAlqj1O",active:"active-3GRHfT7i0W",item:"item-1OoESIAJti","type-icon":"type-icon-1akW3JYJJj",typeIcon:"type-icon-1akW3JYJJj","issue-id":"issue-id-23Luzoofin",issueId:"issue-id-23Luzoofin","issue-detail":"issue-detail-1uvvWPFJJ0",issueDetail:"issue-detail-1uvvWPFJJ0",btn:"btn-2xGK0NLT95","keyboard-icon":"keyboard-icon-3adXPEz6df",keyboardIcon:"keyboard-icon-3adXPEz6df","load-more":"load-more-vyRA6yvdFj",loadMore:"load-more-vyRA6yvdFj","load-icon":"load-icon-Drhk-jNpBt",loadIcon:"load-icon-Drhk-jNpBt","dot-flashing":"dot-flashing-2if-j_VbPK",dotFlashing:"dot-flashing-2if-j_VbPK","tip-bars":"tip-bars-mWuM7OeVos",tipBars:"tip-bars-mWuM7OeVos",txt:"txt-2dufEN9Nlu","has-padding":"has-padding-1FKcVTCGOW",hasPadding:"has-padding-1FKcVTCGOW",tab:"tab-1PNXhjhAza",up:"up-2k9tfglIlZ",down:"down-3tjSF-YWuZ",return:"return-2nIaLBixHx",esc:"esc-gobW3XxJ0j",shift:"shift-9or8Gaih7m","filter-tab":"filter-tab-2p1Qkzr0NB",filterTab:"filter-tab-2p1Qkzr0NB"}},QP9f:function(e,t,a){e.exports={wrapper:"wrapper-1TIm8a1A-F","input-after":"input-after-2xhmO7Y1z3",inputAfter:"input-after-2xhmO7Y1z3","input-clear":"input-clear-7b42T11RZx",inputClear:"input-clear-7b42T11RZx","input-cancel":"input-cancel-2k3C7s2riI",inputCancel:"input-cancel-2k3C7s2riI",panel:"panel-1b6awyKU97","panel-container":"panel-container-1LofB0IFxD",panelContainer:"panel-container-1LofB0IFxD",item:"item-1L8YK0YyvZ","item-empty":"item-empty-3lAkV5dpy-",itemEmpty:"item-empty-3lAkV5dpy-","item-icon":"item-icon-1CvkoGJWXr",itemIcon:"item-icon-1CvkoGJWXr","item-code":"item-code-1o0OrjzYUJ",itemCode:"item-code-1o0OrjzYUJ","item-name":"item-name-2ZW4OzkpGR",itemName:"item-name-2ZW4OzkpGR"}},QWzU:function(e,t,a){"use strict";a.r(t);var n=a("cDcd"),i=a.n(n),r=a("uelK"),o=a.n(r),s=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(a[n[i]]=e[n[i]])}return a},l=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o};t.default=function(e){var t=e.slotVisible,a=e.identity,r=e.context,c=e.onClose,u=l(Object(n.useMemo)((function(){var e=r||{};return[e.projectId,s(e,["projectId"])]}),[null===r||void 0===r?void 0:r.projectId]),2),d=u[0],f=u[1];if(!a)return null;var p=function(){c()};return i.a.createElement(o.a,{identity:a,context:f,project:{id:d},modalProps:{visible:t,onCancel:p},drawerProps:{visible:t,onClose:p},buttonProps:{style:{display:"none"}}})}},QYLJ:function(e,t,a){"use strict";a("I5cv"),a("RW0V"),a("ioFf"),a("0l/t"),a("mYba"),a("jm62"),a("EK0E"),a("XfO3"),a("Btvt"),a("yt8O"),a("rGqo");var n=a("TqRt"),i=a("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("bWfx"),a("f3/d");var r,o,s,l=n(a("lSNA")),c=n(a("lwsE")),u=n(a("W8MJ")),d=n(a("7W2i")),f=n(a("a1gu")),p=n(a("Nsbk")),m=a("mVeg"),h=I(a("cDcd")),v=n(a("17x9")),g=a("dtw8"),E=n(a("CVru")),b=a("DKcV"),y=I(a("OajT"));function S(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(S=function(e){return e?a:t})(e)}function I(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!==typeof e)return{default:e};var a=S(t);if(a&&a.has(e))return a.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=r?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}return n.default=e,a&&a.set(e,n),n}function T(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function C(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?T(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):T(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function P(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,p.default)(e);if(t){var i=(0,p.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,f.default)(this,a)}}var w=(0,y.default)((s=o=function(e){(0,d.default)(a,e);var t=P(a);function a(){return(0,c.default)(this,a),t.apply(this,arguments)}return(0,u.default)(a,[{key:"render",value:function(){var e=this.props,t=e.relationTests,a=e.projectPath,n=e.isPermissible,i=e.sectionExpanded,r=e.SectionToggletrigger,o=n([{function:b.ProjectPermissionFunction.PROJECT_TESTING,action:b.ProjectPermissionAction.VIEW}]);return h.default.createElement("div",null,h.default.createElement("header",{className:E.default.title},(0,m.t)("\u5173\u8054\u6d4b\u8bd5\u4efb\u52a1"),h.default.createElement(r,null)),i&&(t.length>0?h.default.createElement("ul",{className:E.default.defectWrapper},t.map((function(e){var t,n;return h.default.createElement("li",{key:e.id},h.default.createElement("i",{className:E.default.defectIcon}),o?h.default.createElement(h.default.Fragment,null,h.default.createElement(g.Link,{className:E.default.defectId,target:"_blank",to:"".concat(a,"/testing/planning/testmodel/").concat(e.testRun&&e.testRun.sequence,"/").concat(e.sequence)},"#",(null===e||void 0===e||null===(t=e.testCase)||void 0===t?void 0:t.sequence)||(null===e||void 0===e?void 0:e.sequence)||(null===e||void 0===e?void 0:e.id)||0),h.default.createElement(g.Link,{className:E.default.defectTitle,target:"_blank",to:"".concat(a,"/testing/planning/testmodel/").concat(e.testRun&&e.testRun.sequence,"/").concat(e.sequence)},e.testCase&&e.testCase.title)):h.default.createElement(h.default.Fragment,null,h.default.createElement("span",{className:E.default.defectId},"#",(null===e||void 0===e||null===(n=e.testCase)||void 0===n?void 0:n.sequence)||(null===e||void 0===e?void 0:e.sequence)||(null===e||void 0===e?void 0:e.id)||0),h.default.createElement("span",{className:E.default.defectTitle},e.testCase&&e.testCase.title)),h.default.createElement("span",{className:E.default.defectTag},e.testRun&&e.testRun.name))}))):h.default.createElement("p",{className:E.default.empty},(0,m.t)("\u5c1a\u672a\u5173\u8054\u6d4b\u8bd5\u4efb\u52a1"))))}}]),a}(h.Component),o.propTypes=C(C({relationTests:v.default.array,projectPath:v.default.string},b.WithProjectPermissionProps),y.ToggleSectionWrapperProps),r=s))||r;t.default=w},"R+/C":function(e,t,a){e.exports=a.p+"66d8e4de7b009a1ec501391597e309c0.svg"},R094:function(e,t,a){e.exports=a.p+"a37c114dd1bfd675473deb0c806ef811.svg"},RnM7:function(e,t,a){"use strict";a("EK0E"),a("XfO3"),a("Btvt"),a("yt8O"),a("rGqo"),a("mYba");var n=a("TqRt"),i=a("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(a("J4zp")),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!==typeof e)return{default:e};var a=d(t);if(a&&a.has(e))return a.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=r?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}n.default=e,a&&a.set(e,n);return n}(a("cDcd")),s=n(a("aR47")),l=n(a("yZ+p")),c=n(a("sftu")),u=n(a("zmh9"));function d(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(d=function(e){return e?a:t})(e)}var f=function(e){var t=e.allPlanDateVisivile,a=e.closeModle,n=e.planTitle,i=e.handleEnter,d=(0,o.useState)(""),f=(0,r.default)(d,2),p=f[0],m=f[1];return(0,o.useEffect)((function(){t||m("")}),[t]),o.default.createElement(c.default,{closeButton:!0,show:t,onHide:a,style:{width:400,maxHeight:620},getContainer:function(){return document.querySelector('[data-frontend-module-container="coding-project-management-frontend"]')||document.body}},o.default.createElement(c.default.Header,null,o.default.createElement("span",null,n)),o.default.createElement(c.default.Body,null,o.default.createElement("div",{style:{padding:"20px 24px"}},o.default.createElement("p",{style:{marginBottom:15}},"\u8ba1\u5212\u4e0a\u7ebf\u65e5\u671f",o.default.createElement("span",{style:{color:"red"}},"*")),o.default.createElement(s.default,{dateFormat:"YYYY-MM-DD",onChange:function(e){if(e.isValid()){m(e.format("YYYY-MM-DD"))}else m("")}},o.default.createElement(l.default,{value:p,readOnly:!0,placeholder:"\u8bf7\u9009\u62e9"})))),o.default.createElement(c.default.Footer,null,o.default.createElement("div",{style:{display:"flex",justifyContent:"space-around"}},o.default.createElement(u.default,{onClick:function(){i({planDates:p})},type:"default"},"\u4fdd\u5b58"),o.default.createElement(u.default,{onClick:a,empty:!0},"\u53d6\u6d88"))))};t.default=f},RvEQ:function(e,t,a){e.exports={root:"root-2iwtNjUk1l",tag:"tag-3JCUbEv8Q6"}},Rwbr:function(e,t,a){"use strict";a.r(t),a.d(t,"IssueTypeTrigger",(function(){return m}));var n=a("mVeg"),i=a("cDcd"),r=a.n(i),o=a("SJgX"),s=a.n(o),l=a("K2gz"),c=a.n(l),u=a("e6EU"),d=a.n(u),f=a("7FZc"),p=a("KUqB"),m=function(e){var t=e.label,a=e.defaultText,i=e.selected,o=e.valueChanged,l=e.noMatched,u=e.noMatchedText,p=e.toolTipText,m=e.list,h="";return h=i&&i.length&&m&&m.length?m.filter((function(e){return i.includes(e.id)})).map((function(e){return e.name})).join(","):l?u||Object(n.t)("\u672a\u5339\u914d"):a||Object(n.t)("\u5168\u90e8"),r.a.createElement("div",{className:"".concat(d.a.trigger," trigger-w100")},t&&r.a.createElement("span",{className:"newfilter-hidden ".concat(d.a.title)},t),r.a.createElement("span",{className:c()(d.a.name,s.a.customLabelName)},h),r.a.createElement("div",{className:d.a.caretDown}),o&&r.a.createElement(f.TooltipTrigger,{title:p},r.a.createElement("div",{className:d.a.configError})))};t.default=function(e){var t=e.index,a=e.item,n=e.selected,i=e.onSelect,o=n&&n.length&&n.filter((function(e){return e===a.id})).length||!1;return r.a.createElement("div",{className:d.a.menuItem,onClick:i,key:"".concat(a.id,"-").concat(t)},(null===a||void 0===a?void 0:a.iconType)&&r.a.createElement("div",{className:c()(s.a.icon)},r.a.createElement(p.default,{type:null===a||void 0===a?void 0:a.iconType})),r.a.createElement("div",{className:d.a.menuItemName},a.name),o&&r.a.createElement("div",{className:d.a.menuItemChecked}))}},SJgX:function(e,t,a){e.exports={icon:"icon-2ZKXL02981"}},Sc0l:function(e,t,a){e.exports={"viewer-file-bar":"viewer-file-bar-3dDkoLheEE",viewerFileBar:"viewer-file-bar-3dDkoLheEE","attachments-item-logo":"attachments-item-logo-5Y4SqI2MX8",attachmentsItemLogo:"attachments-item-logo-5Y4SqI2MX8","viewer-file-name":"viewer-file-name-2l8U_5uKNM",viewerFileName:"viewer-file-name-2l8U_5uKNM","viewer-file-name-input":"viewer-file-name-input-2NMZzRrMBQ",viewerFileNameInput:"viewer-file-name-input-2NMZzRrMBQ","viewer-file-action":"viewer-file-action-3pdMLoiqMI",viewerFileAction:"viewer-file-action-3pdMLoiqMI","preview-btn":"preview-btn-1ylPGeOR4N",previewBtn:"preview-btn-1ylPGeOR4N",more:"more-8JQZLRZyML",close:"close-LRpaXUXhB6","more-btn":"more-btn-NiGN2d8BZo",moreBtn:"more-btn-NiGN2d8BZo",drowdown:"drowdown-2M1tzjxofn",item:"item-1xY6P9B_AN","item-hide":"item-hide-3NhO6k_Lct",itemHide:"item-hide-3NhO6k_Lct","more-btn-active":"more-btn-active-33EEdgv9kn",moreBtnActive:"more-btn-active-33EEdgv9kn"}},Se5f:function(e,t,a){"use strict";a.r(t);var n=a("mVeg"),i=a("cDcd"),r=a.n(i),o=a("sftu"),s=a.n(o),l=a("K2gz"),c=a.n(l),u=a("246l"),d=a.n(u),f=a("QDLY"),p=a.n(f),m=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(t,a)};return function(t,a){if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),h=function(){return(h=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.render=function(){var e,t=this.props,a=t.onHide,i=t.show,o=t.callback,l=t.confirmText,u=t.title,f=t.desc,m=t.children,v=t.buttonStyle;return r.a.createElement(s.a,h({},{onHide:a,show:i},{style:{width:400}}),r.a.createElement(s.a.Header,null,r.a.createElement("p",{className:p.a.modalTitle},u)),r.a.createElement(s.a.Body,null,m||r.a.createElement("div",null,f)),r.a.createElement(s.a.Footer,null,r.a.createElement("div",{className:c()(p.a.buttonGroup,(e={},e[p.a.flexSpaceAround]=v.flexSpaceAround,e))},r.a.createElement("div",{className:c()(d.a.newButton,d.a.danger,d.a.h32),onClick:o},l),r.a.createElement("div",{className:c()(d.a.newButton,d.a.default,d.a.h32),onClick:a},Object(n.t)("\u53d6\u6d88")))))},t}(r.a.PureComponent);t.default=v},Slup:function(e,t,a){e.exports={status:"status-EQoDn_ZXxL","status-todo":"status-todo-14fv6wwuG3",statusTodo:"status-todo-14fv6wwuG3","status-processing":"status-processing-2a97C2g8QI",statusProcessing:"status-processing-2a97C2g8QI","status-completed":"status-completed-uInxhuP4IE",statusCompleted:"status-completed-uInxhuP4IE"}},TFOv:function(e,t,a){e.exports={"table-wrapper":"table-wrapper-3zofEoJ60J",tableWrapper:"table-wrapper-3zofEoJ60J","workbench-table-wrapper":"workbench-table-wrapper-2sp8cdbdKA",workbenchTableWrapper:"workbench-table-wrapper-2sp8cdbdKA","header-cell":"header-cell-1By3CB8NHH",headerCell:"header-cell-1By3CB8NHH",cell:"cell-PNIZ-UVRk6","sticky-box-shadow":"sticky-box-shadow-1oYuu0yzTa",stickyBoxShadow:"sticky-box-shadow-1oYuu0yzTa","sticky-box-background":"sticky-box-background-3ctqYsEAZZ",stickyBoxBackground:"sticky-box-background-3ctqYsEAZZ","resize-column":"resize-column-2HYE26w6S3",resizeColumn:"resize-column-2HYE26w6S3",loading:"loading-3_caqhJXHP","issue-type-name":"issue-type-name-3BrgYsTPWY",issueTypeName:"issue-type-name-3BrgYsTPWY","no-padding":"no-padding-3XmpSKPXcj",noPadding:"no-padding-3XmpSKPXcj","anomaly-mark":"anomaly-mark-1U0loYOzdx",anomalyMark:"anomaly-mark-1U0loYOzdx","empty-search-container":"empty-search-container-3F3q7jfEGa",emptySearchContainer:"empty-search-container-3F3q7jfEGa","empty-title":"empty-title-3Uip0m8m7t",emptyTitle:"empty-title-3Uip0m8m7t","empty-tip":"empty-tip-2xOq5WG9sP",emptyTip:"empty-tip-2xOq5WG9sP","empty-table-container":"empty-table-container-2C8E0RMX-6",emptyTableContainer:"empty-table-container-2C8E0RMX-6",pointer:"pointer-ghY9FlLnzW",loose:"loose-2a4uXKpBtr",tight:"tight-2AYdIwOX5e",active:"active-3WNnEtE4Au",sticky:"sticky-3N4ezphAjj","table-setting":"table-setting-36teZU9c5t",tableSetting:"table-setting-36teZU9c5t","workbench-row":"workbench-row-2A3mxThexx",workbenchRow:"workbench-row-2A3mxThexx",priority:"priority-33xAgTALBF","product-list":"product-list-2O5Xt7PGL9",productList:"product-list-2O5Xt7PGL9"}},TNCg:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateCurrentProjectCooperateSettings=function(e){return function(t){return t({type:r.ACTION.UPDATE_CURRENT_PROJECT_COOPERATE_SETTINGS,data:e})}},t.getAllIssueStatus=t.getMoreFilterFields=t.getProjectIssueFields=void 0;var n=a("w3Wo"),i=a("eCz8"),r=a("ZC3d");t.getProjectIssueFields=function(e,t){return function(a){var o=(0,n.fetchProjectIssueFields)(e,t);return o.then((function(e){a({type:r.ACTION.UPDATE_PROEJCT_ISSUE_FIELD_ARCHIVES,data:e.data,status:i.STATUS.SUCCESS})})),o}};t.getMoreFilterFields=function(e){return function(t){var a=(0,n.fetchMoreFilterFields)(e,"ALL");return a.then((function(e){t({type:r.ACTION.UPDATE_MORE_FILTER_FIELDS,data:e.data,status:i.STATUS.SUCCESS})})),a}};t.getAllIssueStatus=function(e){return function(t){var a=(0,n.fetchAllIssueStatus)(e);return a.then((function(e){t({type:r.ACTION.UPDATE_ALL_ISSUE_STATUS,data:e.data,status:i.STATUS.SUCCESS})})),a}}},TPfW:function(e,t,a){e.exports={"dropdown-wrapper":"dropdown-wrapper-3o0GbpDSeb",dropdownWrapper:"dropdown-wrapper-3o0GbpDSeb",disabled:"disabled-23nGyUULbE",dropdown:"dropdown-3c30FXoc2_",top:"top-1qYGMtkKPo",fat:"fat-2XEHgVvln7",iteration:"iteration-nBFJIYDn8w","menu-wrapper":"menu-wrapper-2x8CBt2Bhx",menuWrapper:"menu-wrapper-2x8CBt2Bhx","menu-item":"menu-item-3-Q1wkKHLv",menuItem:"menu-item-3-Q1wkKHLv",name:"name-29HKhWAzSl",avatar:"avatar-23kW0kvkn3","default-avatar":"default-avatar-20P2McrOg-",defaultAvatar:"default-avatar-20P2McrOg-","project-avatar":"project-avatar-1SMQ1XatFA",projectAvatar:"project-avatar-1SMQ1XatFA","name-undefined":"name-undefined-cNegwvRGSO",nameUndefined:"name-undefined-cNegwvRGSO","p-name":"p-name-1AH4dU177F",pName:"p-name-1AH4dU177F","iteration-name":"iteration-name-13ige6Z_I5",iterationName:"iteration-name-13ige6Z_I5","project-name-with-iteration":"project-name-with-iteration-3W_zozGFJB",projectNameWithIteration:"project-name-with-iteration-3W_zozGFJB","iteration-name-icon":"iteration-name-icon-EqxlCC76Y1",iterationNameIcon:"iteration-name-icon-EqxlCC76Y1","iteration-name-undefined":"iteration-name-undefined-2MFnLHUzkB",iterationNameUndefined:"iteration-name-undefined-2MFnLHUzkB","name-undefined-icon":"name-undefined-icon-1s8slia4ty",nameUndefinedIcon:"name-undefined-icon-1s8slia4ty","pre-icon":"pre-icon-32ACAnDVGz",preIcon:"pre-icon-32ACAnDVGz",checked:"checked-3abwH7c6V9","iteration-list":"iteration-list-3AYWrvhfzl",iterationList:"iteration-list-3AYWrvhfzl","search-input":"search-input-1yQxTgDpPo",searchInput:"search-input-1yQxTgDpPo","search-icon":"search-icon-23ZWCZdAtF",searchIcon:"search-icon-23ZWCZdAtF",input:"input-U4Bh74TKiX",close:"close-vyNj6UrYhV",selections:"selections-3Xshm6KYHG",scrolling:"scrolling-2qHHbkJ2rx",divider:"divider-1baNhOrJqr",text:"text-1baVFhQcKK","text-light":"text-light-2hec9Z9yi6",textLight:"text-light-2hec9Z9yi6","clear-single":"clear-single-22QJKlMgqK",clearSingle:"clear-single-22QJKlMgqK",clear:"clear-2PCoDYmCUF",list:"list-2vay2wItDB","no-item":"no-item-a3r-NUTap_",noItem:"no-item-a3r-NUTap_","inline-trigger":"inline-trigger-xyEweCWBDU",inlineTrigger:"inline-trigger-xyEweCWBDU","simple-trigger":"simple-trigger-2jICmwmNRG",simpleTrigger:"simple-trigger-2jICmwmNRG","caret-down":"caret-down-9ma7Jl3Zfy",caretDown:"caret-down-9ma7Jl3Zfy",active:"active-2F5XDaCRBY","trigger-wrapper":"trigger-wrapper-1-E6k4Sh1n",triggerWrapper:"trigger-wrapper-1-E6k4Sh1n","no-padding":"no-padding-1c0KqHjQzI",noPadding:"no-padding-1c0KqHjQzI",trigger:"trigger-13MU8CEqFh",title:"title-1UvG_eUjLx","avatar-overlap":"avatar-overlap-1r71uUZpaW",avatarOverlap:"avatar-overlap-1r71uUZpaW","avatar-fake":"avatar-fake-2HokbxFjuK",avatarFake:"avatar-fake-2HokbxFjuK","project-name":"project-name-Dx7FxfI6IV",projectName:"project-name-Dx7FxfI6IV",expand:"expand-8wVotzgqpp","no-assginee":"no-assginee-2HhHKzV3Os",noAssginee:"no-assginee-2HhHKzV3Os","default-name":"default-name-14mf3RzJPn",defaultName:"default-name-14mf3RzJPn","config-error":"config-error-wvAU4bxjWs",configError:"config-error-wvAU4bxjWs","align-top":"align-top-2VF93q_58W",alignTop:"align-top-2VF93q_58W","clear-button":"clear-button-1CGdt2BmMv",clearButton:"clear-button-1CGdt2BmMv","requirement-trigger":"requirement-trigger-28xS6GgBJ2",requirementTrigger:"requirement-trigger-28xS6GgBJ2","sub-wrapper":"sub-wrapper-32kVWBkxym",subWrapper:"sub-wrapper-32kVWBkxym",tail:"tail-tJ3fu2qvqH","go-to":"go-to-SDGfiz5Jk_",goTo:"go-to-SDGfiz5Jk_","requirement-icon":"requirement-icon-22yTq0vdL5",requirementIcon:"requirement-icon-22yTq0vdL5","caret-down-no-data":"caret-down-no-data-1rRu60KBba",caretDownNoData:"caret-down-no-data-1rRu60KBba","item-name":"item-name-1d1P5m4m8O",itemName:"item-name-1d1P5m4m8O"}},TT2u:function(e,t,a){"use strict";a("I5cv"),a("EK0E"),a("XfO3"),a("Btvt"),a("yt8O"),a("rGqo"),a("mYba");var n=a("TqRt"),i=a("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(a("pVnL")),o=n(a("lwsE")),s=n(a("W8MJ")),l=n(a("7W2i")),c=n(a("a1gu")),u=n(a("Nsbk")),d=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!==typeof e)return{default:e};var a=p(t);if(a&&a.has(e))return a.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=r?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}n.default=e,a&&a.set(e,n);return n}(a("cDcd")),f=n(a("BIzk"));function p(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(p=function(e){return e?a:t})(e)}function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,u.default)(e);if(t){var i=(0,u.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,c.default)(this,a)}}t.default=function(e){return function(t){(0,l.default)(n,t);var a=m(n);function n(){return(0,o.default)(this,n),a.apply(this,arguments)}return(0,s.default)(n,[{key:"render",value:function(){var t=this;return d.default.createElement(f.default.Consumer,null,(function(a){var n=a.browserRouter;return d.default.createElement(e,(0,r.default)({},t.props,{browserRouter:n}))}))}}]),n}(d.Component)}},TsYS:function(e,t,a){"use strict";a.r(t),a.d(t,"dropdownItem",(function(){return R})),a.d(t,"loadingDropdown",(function(){return j})),a.d(t,"emptyDropdown",(function(){return k}));var n=a("mVeg"),i=a("cDcd"),r=a.n(i),o=a("K2gz"),s=a.n(o),l=a("mO28"),c=a.n(l),u=a("vCmj"),d=a("mFAe"),f=a("AUsL"),p=a("BQhn"),m=a.n(p),h=a("aHEs"),v=a("+3Ur"),g=a("Z4vw"),E=a("xgZS"),b=a("AwMv"),y=a("IgEJ"),S=a("w3Wo"),I=a("V/h/"),T=a("h74D"),C=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(t,a)};return function(t,a){if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),P=function(){return(P=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},w=function(e,t,a,n){var i,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,a,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(r<3?i(o):r>3?i(t,a,o):i(t,a))||o);return r>3&&o&&Object.defineProperty(t,a,o),o},D=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},O=function(e,t,a){if(a||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},R=function(e){var t=e.item;return r.a.createElement("div",{className:"cuk-dropdown-menu-item-media",title:t.stepName,"data-container":!0,"data-title":"\u4fee\u6539\u72b6\u6001"},r.a.createElement("div",{className:c.a.name},t.stepName),r.a.createElement("div",{className:c.a.arrow}),r.a.createElement("div",{className:c.a.statusWrapper},r.a.createElement(d.default,{className:c.a.stepStatus,status:t.endIssueStatus})))},j=function(){return r.a.createElement("div",{className:c.a.loadingPanel},[46,54,38,44].map((function(e){return r.a.createElement("div",{key:e,className:c.a.loadingItem},r.a.createElement("div",{className:c.a.name},r.a.createElement(m.a,{rectangle:!0,style:{width:e}})),r.a.createElement("div",{className:c.a.arrow,style:{opacity:.1}}),r.a.createElement("div",{className:c.a.statusWrapper},r.a.createElement(m.a,{rectangle:!0,style:{width:48,height:16}})))})))},k=function(){return r.a.createElement("div",{className:c.a.emptyStep},r.a.createElement("div",{className:c.a.emptyIcon}),r.a.createElement("p",null,Object(n.t)("\u6ca1\u6709\u53ef\u6267\u884c\u7684\u6b65\u9aa4")))},N=function(e){function t(t){var a=e.call(this,t)||this;a.defaultProps={constantHeight:0},a.validateStoryStatusChange=function(e){var t=a.props,n=t.projectID,i=t.issueCode;Object(b.checkStoryStatusChange)(n,i).then((function(t){if(t.data){if(!t.data.isAllMeet){var n="";t.data.workflow.isMeet||t.data.review.isMeet?t.data.review.isMeet?t.data.workflow.isMeet||(n="W".concat(t.data.workflow.status)):n="R".concat(t.data.review.status):n="A".concat(t.data.review.status).concat(t.data.workflow.status);var i=n&&y.STORY_WARN_MSG[n]?y.STORY_WARN_MSG[n]:"\u7528\u6237\u6545\u4e8b\u4fee\u6539\u72b6\u6001\u6821\u9a8c\u5931\u8d25";return void Object(E.warning)(i)}a.nextAction(e)}else a.nextAction(e)}))},a.onSelect=function(e){console.log(e),"requirement"===a.props.detailType?a.validateStoryStatusChange(e):a.nextAction(e)},a.nextAction=function(e){console.log(e);var t=a.props,n=t.onSelect,i=t.updateTransferObject,r=t.value,o=t.issueCode,s=t.project;a.executeAction(e,i,r,n,s,o)},a.executeActionLast=function(e,t,n,i,r,o,s,l){var c,u,d,f,p,m,h,v,g,E,b,y,S,I,T,C,P=a.props.detailType,w=a.props,D=w.detailInfo,O=w.bugSchemeFieldArchives;D=D||s,O=O||l;var R=e.projectIssueTransferAdditionalFields||[];if("defect"===P&&"\u5df2\u5173\u95ed"===e.endIssueStatus.name){var j=!1;R.forEach((function(e){var t;"\u7f3a\u9677\u4e25\u91cd\u7a0b\u5ea6"===(null===(t=e.issueField)||void 0===t?void 0:t.name)&&(j=!0)}));var k=null,N=null,A=[];for(var L in O)"\u7f3a\u9677\u4e25\u91cd\u7a0b\u5ea6"===(null===(c=O[L].issueField)||void 0===c?void 0:c.name)&&(k=O[L].issueField.id,N=null===(u=null===D||void 0===D?void 0:D.issueSchemeFields)||void 0===u?void 0:u[k],null===(p=null===(f=null===(d=O[L])||void 0===d?void 0:d.issueField)||void 0===f?void 0:f.options)||void 0===p||p.forEach((function(e){"\u4e25\u91cd"!==(null===e||void 0===e?void 0:e.name)&&"\u81f4\u547d"!==(null===e||void 0===e?void 0:e.name)||A.push(null===e||void 0===e?void 0:e.value)})));var F=(null===D||void 0===D?void 0:D.defectPhase)&&(null===(m=null===D||void 0===D?void 0:D.defectPhase)||void 0===m?void 0:m.id)+""||void 0,_=(null===D||void 0===D?void 0:D.defectKinds)&&(null===(h=null===D||void 0===D?void 0:D.defectKinds)||void 0===h?void 0:h.length)&&(null===(v=null===D||void 0===D?void 0:D.defectKinds)||void 0===v?void 0:v.map((function(e){return e.id+""})))||[];if(A.includes(N)&&(!F||_.length<1))for(var M in O)j||"\u7f3a\u9677\u4e25\u91cd\u7a0b\u5ea6"!==(null===(g=O[M].issueField)||void 0===g?void 0:g.name)||R.push({defaultValueType:"KEEP_CURRENT",errorMsg:null,id:O[M].issueField.id,isDisabled:!1,isRequired:!0,issueField:O[M].issueField,issueFieldId:O[M].issueField.id,originalValue:"",projectIssueTransferId:O[M].issueField.id,sort:1,type:"ISSUE_FIELD",value:N}),"\u5f15\u5165\u7f3a\u9677\u9636\u6bb5"===(null===(E=O[M].issueField)||void 0===E?void 0:E.name)&&R.push({defaultValueType:"KEEP_CURRENT",errorMsg:null,id:O[M].issueField.id,isDisabled:!1,isRequired:!0,issueField:O[M].issueField,issueFieldId:O[M].issueField.id,originalValue:"",projectIssueTransferId:O[M].issueField.id,sort:1,type:"ISSUE_FIELD",value:(null===D||void 0===D?void 0:D.defectPhase)&&(null===(b=null===D||void 0===D?void 0:D.defectPhase)||void 0===b?void 0:b.id)+""||void 0}),"\u7f3a\u9677\u7c7b\u578b"===(null===(y=O[M].issueField)||void 0===y?void 0:y.name)&&R.push({defaultValueType:"KEEP_CURRENT",errorMsg:null,id:O[M].issueField.id,isDisabled:!1,isRequired:!0,issueField:O[M].issueField,issueFieldId:O[M].issueField.id,originalValue:"",projectIssueTransferId:O[M].issueField.id,sort:1,type:"ISSUE_FIELD",value:(null===D||void 0===D?void 0:D.defectKinds)&&(null===(S=null===D||void 0===D?void 0:D.defectKinds)||void 0===S?void 0:S.length)&&(null===(I=null===D||void 0===D?void 0:D.defectKinds)||void 0===I?void 0:I.map((function(e){return e.id+""})))||[]});else R=R.filter((function(e){var t;return"\u7f3a\u9677\u4e25\u91cd\u7a0b\u5ea6"!==(null===(t=e.issueField)||void 0===t?void 0:t.name)}))}var x=e.projectIssueTransferAdditionalFields||[],B=null,U=null;x.length>0&&x.forEach((function(e){var t;"\u7f3a\u9677\u4e25\u91cd\u7a0b\u5ea6"===(null===(t=e.issueField)||void 0===t?void 0:t.name)&&(B=e.issueFieldId,U=e.value)})),e.projectIssueTransferAdditionalFields=R,R.length>0&&t?t({startIssueStatus:n,transfer:e,callback:i,project:r,issueCode:o,detailType:a.props.detailType,attributes:a.props.attributes,itemInfo:a.props.itemInfo,systemId:a.props.systemId,iterationDropdownList:(null===(T=a.props)||void 0===T?void 0:T.iterationDropdownList)||[],versionList:(null===(C=a.props)||void 0===C?void 0:C.versionList)||[]}):B?a.onStatusChange({customFieldValueMap:[{id:B,content:U}],fetchParentProgress:!0,statusId:e.endStatusId,item:e.endIssueStatus,statusName:e.stepName}):a.onStatusChange({statusId:e.endStatusId,item:e.endIssueStatus,statusName:e.stepName})},a.executeAction=function(e,t,n,i,r,o){var s=a.props,l=s.bugSchemeFieldArchives,c=s.currentProjectCooperateSettings,u=s.projectID;!l&&"REQUIREMENT"!==e.issueType&&(null===c||void 0===c?void 0:c.ISSUE_TYPES)?Object(h.fetchIssueDetailByCode)(u,o,{withDescriptionMarkup:!0}).then((function(s){var l=s.data,u=c.ISSUE_TYPES.find((function(e){return"DEFECT"===e.issueType})).id;return Object(S.fetchIssueTypesScheme)(r.name,u,"DETAIL").then((function(s){var c={bugSchemeFieldArchives:{},bugCreationFieldIDs:[],bugUpdateFieldIDs:[]},u=(c=Object(I.default)(c,(function(e){var t=s.data.schemeFields.reduce((function(e,t){var a,n=e.archives,i=e.ids;return{archives:P(P({},n),(a={},a[t.issueFieldId]=t,a)),ids:O(O([],D(i),!1),[t.issueFieldId],!1)}}),{archives:{},ids:[]}),a=t.archives,n=t.ids;e.bugSchemeFieldArchives=P(P({},e.bugSchemeFieldArchives||{}),a),e.bugUpdateFieldIDs=n}))).bugSchemeFieldArchives;a.executeActionLast(e,t,n,i,r,o,l,u)}))}),(function(e){var t=e.msg;e.code;Object(E.danger)(Object(g.getErrorMessage)(t))})):a.executeActionLast(e,t,n,i,r,o)},a.emptyList=function(){return a.state.isLoading?j():k()},a.getTransferStatusByKey=function(){var e=a.props,t=e.projectID,n=e.issueCode,i=e.calculatePosition,r=e.constantHeight,o=e.itemsWidth,s=e.detailType;a.state.isLoading||(a.setState({isLoading:!0,list:[]}),("prd_requirement"===s?h.fetchPrdIssueStatusTransfers:h.fetchIssueStatusTransfers)(t,n).then((function(e){var t=e.data;a.setState({list:t,isLoading:!1});var n=36*t.length+(r||0);i&&i({itemsHeight:n,itemsWidth:o})})).finally((function(){a.setState({isLoading:!1})})))};var n=t.open;return a.onToggle=a.onToggle.bind(a),a.trigger=a.trigger.bind(a),a.Dropdown=Object(u.hocDropdown)(a.trigger,R),a.state={expanded:void 0!==n&&n,isLoading:!1,list:[]},a}return C(t,e),t.getDerivedStateFromProps=function(e,t){var a=e.open,n=t.expanded;return void 0!==a&&a!==n?{expanded:a}:{}},t.prototype.trigger=function(){var e=this.props,t=e.disabled,a=e.value,i=e.needCartDown,o=e.darkHover,l=e.hoverControlArrow,u=e.isInline,f=e.labelSize,p=e.triggerClass,m=e.trigger,h=this.state,v=h.expanded,g=h.isLoading;return m?m({expanded:v,isLoading:g}):r.a.createElement("div",{className:s()([c.a.selectTrigger,t&&c.a.selectTriggerDisabled,t||u?"":c.a.customSelectTrigger,l&&v?c.a.expanded:"",o?c.a.darkHover:"",o&&v?c.a.darkStyle:"",l?c.a.controlArrow:"",p])},a?r.a.createElement(d.default,{className:c.a.selectTriggerStatus,status:a,size:f}):Object(n.t)("\u8bf7\u9009\u62e9"),i&&!t&&r.a.createElement("span",{className:"".concat(c.a.selectArrowWrapper," ").concat(v&&c.a.isExpanded)},r.a.createElement("div",{className:c.a.cartDown})))},t.prototype.onStatusChange=function(e){this.props.onSelect(e)},t.prototype.render=function(){var e=this.props,t=e.open,a=e.toTop,n=e.toRight,i=e.className,o=e.isDetail,l=e.isInline,u=this.state,d=u.expanded,f=u.list;return r.a.createElement("div",{className:s()(c.a.select,l&&c.a.isInline,a&&c.a.toTop,n&&c.a.toRight,i,o&&c.a.isDetail)},r.a.createElement(this.Dropdown,{items:f,onSelect:this.onSelect,open:void 0!==t?t:d,onToggle:this.onToggle,emptyList:this.emptyList()}))},t.prototype.componentDidMount=function(){var e=this.props,t=e.open,a=e.calculatePosition,n=e.items,i=e.constantHeight,r=e.itemsWidth;if(void 0!==t){var o=36*n.length+(i||0);a&&a({itemsHeight:o,itemsWidth:r})}},t.prototype.onToggle=function(e){var t=this.props,a=t.disabled,n=t.onToggle,i=t.calculatePosition,r=t.updateTransferObject,o=t.constantHeight,s=t.itemsWidth,l=this.state.isLoading;if(!a&&!l){if(this.setState({expanded:!e}),!e)i&&i({itemsHeight:144+(o||0),itemsWidth:s}),r&&r(void 0),this.getTransferStatusByKey();n&&n(e)}},t.defaultProps={items:[],needCartDown:!0},t=w([f.a,v.withAttributeFormModalContext],t)}(r.a.Component);t.default=Object(T.connect)((function(e){return{currentProjectCooperateSettings:e.APP.currentProjectCooperateSettings}}))(N)},UGd4:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getProjectAllIssues=t.createLabel=t.fetchIterationIssuesList=t.autoSyncSwicth=t.disassociateIteration=t.releasesAssociatedIteration=t.fetchReleasesAssociatedIterationList=t.fetchReleasesStatistics=t.fetchAllRelease=t.fetchReleaseByFilter=t.fetchReleaseIssuesBoard=t.fetchReleaseIssuesTree=t.fetchReleaseIssuesList=t.delRelease=t.getReleaseDetailsByCode=t.updateRelease=t.createRelease=t.getReleasePageList=t.getReleaseIssueInfo=void 0;var n=a("Z4vw");t.getReleaseIssueInfo=function(e){return(0,n.get)("/collaboration/api/project/".concat(e,"/settings/issue-types/release/detail"))};t.getReleasePageList=function(e,t){return(0,n.postJSON)("/collaboration/api/project/".concat(e,"/releases/search"),t)};t.createRelease=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,n.postJSON)("/collaboration/api/project/".concat(e,"/releases/create"),t,a)};t.updateRelease=function(e,t,a){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return(0,n.patchJSON)("/collaboration/api/project/".concat(e,"/releases/").concat(t,"/fields"),a,i)};t.getReleaseDetailsByCode=function(e,t){return(0,n.get)("/collaboration/api/project/".concat(e,"/releases/").concat(t))};t.delRelease=function(e,t){return(0,n.del)("/collaboration/api/project/".concat(e,"/releases/").concat(t))};t.fetchReleaseIssuesList=function(e,t,a){return(0,n.get)("/collaboration/api/project/".concat(e,"/releases/").concat(t,"/issues?").concat((0,n.buildParams)(a)))};t.fetchReleaseIssuesTree=function(e,t,a){return(0,n.get)("/collaboration/api/project/".concat(e,"/releases/").concat(t,"/issues/subtask-tree?").concat((0,n.buildParams)(a)))};t.fetchReleaseIssuesBoard=function(e,t,a){return(0,n.get)("/collaboration/api/project/".concat(e,"/releases/").concat(t,"/issues/kanban?").concat((0,n.buildParams)(a)))};t.fetchReleaseByFilter=function(e,t,a,i){return(0,n.postJSON)("/collaboration/api/project/".concat(e,"/releases/").concat(t,"/issues/").concat(a),i)};t.fetchAllRelease=function(e){return(0,n.get)("/collaboration/api/project/".concat(e,"/releases/list"),!0)};t.fetchReleasesStatistics=function(e,t){return(0,n.get)("/collaboration/api/project/".concat(e,"/releases/iterations/statistics/").concat(t),!0)};t.fetchReleasesAssociatedIterationList=function(e,t){return(0,n.get)("/collaboration/api/project/".concat(e,"/releases/iterations/list/").concat(t),!0)};t.releasesAssociatedIteration=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,n.postJSON)("/collaboration/api/project/".concat(e,"/releases/iterations/associate/").concat(t.releaseId,"/").concat(t.iterationId,"/").concat(t.syncMode),t,a)};t.disassociateIteration=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,n.postJSON)("/collaboration/api/project/".concat(e,"/releases/iterations/disassociate/").concat(t.releaseId,"/").concat(t.iterationId),t,a)};t.autoSyncSwicth=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,n.postJSON)("/collaboration/api/project/".concat(e,"/releases/iterations/auto-sync-switch/").concat(t.releaseId,"/").concat(t.iterationId,"/").concat(t.syncMode),t,a)};t.fetchIterationIssuesList=function(e,t,a){return(0,n.postJSON)("/api/project/".concat(e,"/iterations/").concat(t,"/issues/list"),a,!1)};t.createLabel=function(e,t,a){return(0,n.post)("/api/platform/project/".concat(e,"/label"),{name:t,color:a})};t.getProjectAllIssues=function(e,t){return(0,n.postJSON)("/api/project/".concat(e,"/issues/ALL/list"),t,!1)}},UeSW:function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjBweCIgaGVpZ2h0PSIyMHB4IiB2aWV3Qm94PSIwIDAgMjAgMjAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDUyLjUgKDY3NDY5KSAtIGh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaCAtLT4KICAgIDx0aXRsZT5maWxlLXR5cGUvdHh0PC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9Iue8uumZty/or6bmg4UiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSLpmYTku7YiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0zMzYuMDAwMDAwLCAtNjYwLjAwMDAwMCkiPgogICAgICAgICAgICA8ZyBpZD0iZmlsZS10eXBlL3R4dCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzM2LjAwMDAwMCwgNjYwLjAwMDAwMCkiPgogICAgICAgICAgICAgICAgPHBhdGggZD0iTTIsMCBMMTgsMCBDMTkuMTA0NTY5NSwtMi4wMjkwNjEyNWUtMTYgMjAsMC44OTU0MzA1IDIwLDIgTDIwLDE4IEMyMCwxOS4xMDQ1Njk1IDE5LjEwNDU2OTUsMjAgMTgsMjAgTDIsMjAgQzAuODk1NDMwNSwyMCAtMy40MTc0NDI5M2UtMTUsMTkuMTA0NTY5NSAtMy41NTI3MTM2OGUtMTUsMTggTC0zLjU1MjcxMzY4ZS0xNSwyIEMtMy42ODc5ODQ0M2UtMTUsMC44OTU0MzA1IDAuODk1NDMwNSwyLjAyOTA2MTI1ZS0xNiAyLDAgWiIgaWQ9IlJlY3RhbmdsZS0zNyIgZmlsbD0iI0MxQ0FEQiI+PC9wYXRoPgogICAgICAgICAgICAgICAgPHBhdGggZD0iTTcuMjUzOTA2MjUsOC4wNTg1OTM3NSBMNS41NDY4NzUsOC4wNTg1OTM3NSBMNS41NDY4NzUsMTIuNjg3NSBMNC4xNzU3ODEyNSwxMi42ODc1IEw0LjE3NTc4MTI1LDguMDU4NTkzNzUgTDIuNSw4LjA1ODU5Mzc1IEwyLjUsNyBMNy4yNTM5MDYyNSw3IEw3LjI1MzkwNjI1LDguMDU4NTkzNzUgWiBNOS45NTMxMjUsOC44OTA2MjUgTDEwLjg4MjgxMjUsNyBMMTIuNDQ5MjE4OCw3IEwxMC44NTkzNzUsOS44MjAzMTI1IEwxMi40OTIxODc1LDEyLjY4NzUgTDEwLjkxMDE1NjIsMTIuNjg3NSBMOS45NTMxMjUsMTAuNzYxNzE4OCBMOC45OTYwOTM3NSwxMi42ODc1IEw3LjQxNzk2ODc1LDEyLjY4NzUgTDkuMDQ2ODc1LDkuODIwMzEyNSBMNy40NjA5Mzc1LDcgTDkuMDIzNDM3NSw3IEw5Ljk1MzEyNSw4Ljg5MDYyNSBaIE0xNy40MDIzNDM4LDguMDU4NTkzNzUgTDE1LjY5NTMxMjUsOC4wNTg1OTM3NSBMMTUuNjk1MzEyNSwxMi42ODc1IEwxNC4zMjQyMTg4LDEyLjY4NzUgTDE0LjMyNDIxODgsOC4wNTg1OTM3NSBMMTIuNjQ4NDM3NSw4LjA1ODU5Mzc1IEwxMi42NDg0Mzc1LDcgTDE3LjQwMjM0MzgsNyBMMTcuNDAyMzQzOCw4LjA1ODU5Mzc1IFoiIGlkPSJUWFQiIGZpbGw9IiNGRkZGRkYiPjwvcGF0aD4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+"},UurN:function(e,t,a){e.exports={loading:"loading-1hobqiDtcS","loading-child":"loading-child-Zc27M5trce",loadingChild:"loading-child-Zc27M5trce","loading-child-point":"loading-child-point-3KPS3G6Xsh",loadingChildPoint:"loading-child-point-3KPS3G6Xsh",loader10m:"loader10m-27dRxVFuHq",loader10M:"loader10m-27dRxVFuHq",loader10g:"loader10g-MZFE5j0kAT",loader10G:"loader10g-MZFE5j0kAT",loader10d:"loader10d-1GabZsRnPY",loader10D:"loader10d-1GabZsRnPY"}},"V+QM":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSensitive=function(e,t){return(0,n.get)("/audit-log/api/v1/project/".concat(t,"/resources/").concat(e,"/sensitive"))},t.cancelSensitive=function(e,t){return(0,n.del)("/audit-log/api/v1/project/".concat(t,"/resources/").concat(e,"/sensitive"))},t.addSensitive=function(e,t){return(0,n.post)("/audit-log/api/v1/project/".concat(t,"/resources/").concat(e,"/sensitive"))},t.tracking=function(e){return(0,n.get)("/audit-log/api/v1/track?".concat((0,n.buildParams)(e)))},t.updateChildStatus=t.sortSubtask=t.fetchAssignmentsActitvites=t.deleteAssignmentComment=t.addAssignmentComment=t.updateAssignmentDescription=t.fetchAssignmentActivities=t.updateAssignmentStatus=t.updateAssignmentDetail=t.fetchAssignmentDescription=t.deleteAssignment=t.fetchAssignmentDetail=t.fetchSubtasksList=t.checkInitialization=t.createAssignment=t.batchUpdateAssignments=void 0;var n=a("Z4vw");t.batchUpdateAssignments=function(e,t){return(0,n.postJSON)("/api/project/".concat(e,"/issues/missions/batch/update"),t)};t.createAssignment=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,n.postJSON)("/external/collaboration/api/project/".concat(e,"/issues/missions"),t,a)};t.checkInitialization=function(e){return(0,n.get)("/api/project/".concat(e,"/issues/missions/is-inited"),!0)};t.fetchSubtasksList=function(e,t){return(0,n.get)("/api/project/".concat(e,"/issues/missions/").concat(t,"/sub-tasks"))};t.fetchAssignmentDetail=function(e,t,a){return(0,n.get)("/api/project/".concat(e,"/issues/missions/").concat(t,"?").concat((0,n.buildParams)(a)))};t.deleteAssignment=function(e,t){return(0,n.del)("/external/collaboration/api/project/".concat(e,"/issues/missions/").concat(t))};t.fetchAssignmentDescription=function(e,t){return(0,n.get)("/api/project/".concat(e,"/issues/missions/").concat(t,"/description"))};t.updateAssignmentDetail=function(e,t,a){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return(0,n.patchJSON)("/external/collaboration/api/project/".concat(e,"/issues/missions/").concat(t,"/fields"),a,i)};t.updateAssignmentStatus=function(e,t,a){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return(0,n.putJSON)("/external/collaboration/api/project/".concat(e,"/issues/missions/").concat(t,"/kanban/status"),a,i)};t.fetchAssignmentActivities=function(e,t){return(0,n.get)("/external/collaboration/api/project/".concat(e,"/issues/missions/").concat(t,"/activities"))};t.updateAssignmentDescription=function(e,t,a){return(0,n.put)("/api/project/".concat(e,"/issues/missions/").concat(t,"/description"),a)};t.addAssignmentComment=function(e){var t=e.projectID,a=e.assignmentCode,i=e.content,r=e.parentID;return(0,n.post)("/external/collaboration/api/project/".concat(t,"/issues/missions/").concat(a,"/comments"),{content:i,parentId:r})};t.deleteAssignmentComment=function(e,t,a){return(0,n.del)("/api/project/".concat(e,"/issues/missions/").concat(t,"/comments/").concat(a))};t.fetchAssignmentsActitvites=function(e,t){return(0,n.get)("/external/collaboration/api/project/".concat(e,"/issues/missions/").concat(t,"/activities"))};t.sortSubtask=function(e,t,a){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return(0,n.postJSON)("/api/project/".concat(e,"/issues/missions/").concat(t,"/sub-tasks/sort"),a,i)};t.updateChildStatus=function(e,t,a){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return(0,n.putJSON)("/external/collaboration/api/project/".concat(e,"/issues/missions/").concat(t,"/kanban/subTaskStatus"),a,i)}},V2rr:function(e,t,a){e.exports={flexBetween:"flexBetween-3AjlZ6Nl60",flex1:"flex1-211gV3M244",space:"space-3CB_Ro0Jwz",title:"title-3SB2hHV8Ja",selectTrigger:"selectTrigger-2rkB5Kbhfg",downIcon:"downIcon-2co3ByZP5F"}},VFNB:function(e,t,a){e.exports={"loading-trunk":"loading-trunk-1wWLH4Tp_9",loadingTrunk:"loading-trunk-1wWLH4Tp_9",first:"first-GYimWid_mC","skeleton-loading":"skeleton-loading-29Hlekisjb",skeletonLoading:"skeleton-loading-29Hlekisjb"}},VVDc:function(e,t,a){e.exports={body:"body-jDG1Op0OTe",title:"title-R_lQMUM4iS","next-title":"next-title-jP8IFwYr8Q",nextTitle:"next-title-jP8IFwYr8Q",list:"list-3J0HIRCqEM"}},W4WD:function(e,t,a){e.exports={"creation-wrapper":"creation-wrapper-1QvTkdOs9-",creationWrapper:"creation-wrapper-1QvTkdOs9-","creation-wrapper-single":"creation-wrapper-single-1Yfbh0zkUT",creationWrapperSingle:"creation-wrapper-single-1Yfbh0zkUT","creation-trigger":"creation-trigger-1VggF1Fmp6",creationTrigger:"creation-trigger-1VggF1Fmp6",disabled:"disabled-7ve9jPtAbo","dropdown-menu":"dropdown-menu-VbOUYScZBg",dropdownMenu:"dropdown-menu-VbOUYScZBg",item:"item-4CfIEaMmPh","item-icon":"item-icon-r-s85yMPGb",itemIcon:"item-icon-r-s85yMPGb","item-name":"item-name-1rnjEVkxGa",itemName:"item-name-1rnjEVkxGa"}},"WEK+":function(e,t,a){"use strict";a.r(t),a.d(t,"formatDropdownItem",(function(){return A}));var n,i=a("cDcd"),r=a.n(i),o=a("BKNj"),s=a("BJkK"),l=a("8ZF6"),c=a("OrPX"),u=a("iTKN"),d=a("GOSa"),f=a.n(d),p=a("mVeg"),m=a("K2gz"),h=a.n(m),v=a("hlQ/"),g=a.n(v),E=a("AZzP"),b=a.n(E),y=a("vCmj"),S=a("AUsL"),I=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(t,a)};return function(t,a){if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),T=function(){return(T=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},C=function(e,t,a,n){var i,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,a,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(r<3?i(o):r>3?i(t,a,o):i(t,a))||o);return r>3&&o&&Object.defineProperty(t,a,o),o},P=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},w=function(e,t,a){if(a||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))};!function(e){e.UNSPECIFIC="UNSPECIFIC"}(n||(n={}));var D=[{text:Object(p.t)("\u672a\u6307\u5b9a"),value:n.UNSPECIFIC}],O=(function(e){function t(t){var a=e.call(this,t)||this;return a.state={expanded:t.expanded||!1,showDel:!1},a.trigger=a.trigger.bind(a),a.onToggle=a.onToggle.bind(a),a.dropdownItem=a.dropdownItem.bind(a),a.Dropdown=Object(y.hocDropdown)(a.trigger,t.itemRender||a.dropdownItem),a}I(t,e),t.prototype.trigger=function(){var e,t=this.props,a=t.value,n=t.constValue,i=t.placeholder,o=t.hasBorder,s=t.isBlock,l=t.className,c=t.defaultValue,u=t.labelClassName,d=t.label,f=this.state,p=f.expanded,m=f.showDel;return r.a.createElement("div",{className:h()(g.a.selectTrigger,o&&g.a.hasBorder,s&&g.a.isBlock,g.a.triggerBackground,(m||p)&&g.a.isExpanded,l)},d&&r.a.createElement("span",{className:g.a.itemLabel},d),r.a.createElement("span",{className:h()(g.a.itemText,g.a.itemTextEllipsis,(e={},e[g.a.notSelected]=!(a&&0!==a.length||c),e),u)},r.a.createElement("span",null,a&&0!==a.length||n&&0!==n.length?this.getValueState():c||i)),r.a.createElement("span",{className:"".concat(g.a.selectArrowWrapper," ").concat(p&&g.a.isExpanded)},r.a.createElement("div",{className:g.a.cartDown})))},t.prototype.dropdownItem=function(e){var t=this.props.constValue,a=e.item,i=e.multiple,o=e.selectedItem,s=a.value,l=a.text,c=h()("cuk-dropdown-menu-item-check-icon",{active:i&&o&&o.find((function(e){return e&&e.value===a.value}))||t&&t.some((function(e){return e===s}))});return r.a.createElement("div",{className:"cuk-dropdown-menu-item-media"},i&&r.a.createElement(b.a,{className:c}),r.a.createElement("span",{className:h()(g.a.inlineDropdownIcon,g.a["priority".concat(s)])}),a.media&&r.a.createElement("span",{className:"".concat(g.a.color,"  mr-10"),style:{background:a.media}}),r.a.createElement("span",{className:h()("cuk-dropdown-menu-item-text",s===n.UNSPECIFIC?g.a.unspecificUser:"")},l))},t.prototype.render=function(){var e=this,t=this.props,a=t.className,n=t.value,i=t.items,o=t.multiple,s=t.onSelect,l=t.searchable,c=t.onSearch,u=t.clearable,d=t.onClear,f=t.isMenuTop,p=t.searchPlaceholder,m=t.onClearProp,v=t.toTop,E=t.toRight,b=t.withConstValue,y=this.state,S=y.showDel,I=y.expanded,C=this.Dropdown;return r.a.createElement("div",{className:g.a.selectWithLabel,onMouseLeave:function(){return e.setState({showDel:!1})}},r.a.createElement("div",{className:h()(g.a.select,g.a.inlineDropdown,a,v&&g.a.toTop,E&&g.a.toRight,f&&g.a.menuTop),onMouseEnter:function(){return e.setState({showDel:!0})},onMouseOver:function(){return e.setState({showDel:!0})}},r.a.createElement(C,T({items:w(w([],P(b?D:[]),!1),P(i),!1)},{value:n,multiple:o,onSelect:s,searchable:l,onSearch:c,clearable:u,onClear:d,searchPlaceholder:p,open:I},{onToggle:this.onToggle}))),(S||I)&&m&&r.a.createElement("a",{className:h()(g.a.clearButton,g.a.alignTop),onClick:m}))},t.prototype.getValueState=function(){var e=this.props,t=e.items,a=e.value,n=e.constValue,i=e.withConstValue,r=this.getValue(t,a),o=i&&this.getValue(D,n);return o?"".concat(o).concat(r?","+r:""):r},t.prototype.getValue=function(e,t){return e.reduce((function(e,a){return t&&t.some((function(e){return a.value===e}))&&a.text?e+","+a.text:e}),"").slice(1)},t.prototype.onToggle=function(e){var t=this,a=this.props,n=a.calculatePosition,i=a.searchable,r=a.clearable,o=a.items,s=a.onToggle;if(e)this.setState({expanded:!e});else{n({itemsHeight:36*o.length+(i?42:0)+(r?36:0),itemsWidth:200,callback:function(){t.setState({expanded:!e},(function(){s&&"function"===typeof s&&s()}))}})}},t=C([S.a],t)}(r.a.Component),a("fmVk")),R=a("w3Wo"),j=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(t,a)};return function(t,a){if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),k=function(){return(k=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},N=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(a[n[i]]=e[n[i]])}return a},A=function(e){return e.map((function(e){return{id:e.id,value:e.id,text:e.display_name||e.displayName,name:e.display_name||e.displayName,media:e.icon,avatar:e.icon,pinyin:""}}))},L=function(e){function t(t){var a=e.call(this,t)||this;return a.getProgramList=function(){var e=a.state.dataFetching,t=a.props,i=t.isBatchOperation,r=t.unCompleted,o=void 0!==r&&r;e||(a.setState({dataFetching:!0}),Object(R.fetchPrograms)({page:1,pageSize:99999,unCompleted:o}).then((function(e){var t=e.data;t[0].id!==n.UNSPECIFIC&&t.unshift({id:n.UNSPECIFIC,display_name:"\u672a\u6307\u5b9a",icon:""}),i&&t.shift();var r=A(t);a.setState({dataInited:!0,projects:r})})).finally((function(){a.setState({dataFetching:!1})})))},a.state={dataInited:!1,dataFetching:!1,projects:t.useUnspecificItem?[u.UNSPECIFIC_ITEM]:[]},a}return j(t,e),t.prototype.componentDidMount=function(){this.getProgramList()},t.prototype.render=function(){var e=this.state,t=e.projects,a=e.dataInited,n=e.dataFetching,i=this.props,s=i.componentType,l=i.show,d=i.Trigger,p=i.triggerExtraProps,m=i.itemExtraProps,h=i.value,v=N(i,["componentType","show","Trigger","triggerExtraProps","itemExtraProps","value"]);return r.a.createElement(o.default,k({},v,{value:h,items:t,tableCell:s!==u.ComponentType.FILTER,isFilter:s===u.ComponentType.FILTER,dataInited:a,dataFetching:n,disableArrowUp:!0,showPanel:l,Trigger:d||this.getTrigger(s),triggerExtraProps:p,Item:c.a,itemExtraProps:m,panelCustomStyle:f.a.fieldPanel}))},t.prototype.getProjectId=function(){var e;return null===(e=O.store.getState().APP.currentProject)||void 0===e?void 0:e.id},t.prototype.getTrigger=function(e){switch(e){case u.ComponentType.FILTER:return l.a;default:return s.a}},t}(r.a.Component);t.default=L},WkTa:function(e,t,a){e.exports=a.p+"1a14718934ec82c6eb930b04811aee91.svg"},Wxmb:function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjRweCIgaGVpZ2h0PSIyNHB4IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+ZmlsZS1pY29ucy8yNHB4L3NrZXRjaDwvdGl0bGU+CiAgICA8ZGVmcz4KICAgICAgICA8cGF0aCBkPSJNNS4yNSwyIEwxNSwyIEwxNSwyIEwyMSw4IEwyMSwxOS43NSBDMjEsMjAuOTkyNjQwNyAxOS45OTI2NDA3LDIyIDE4Ljc1LDIyIEw1LjI1LDIyIEM0LjAwNzM1OTMxLDIyIDMsMjAuOTkyNjQwNyAzLDE5Ljc1IEwzLDQuMjUgQzMsMy4wMDczNTkzMSA0LjAwNzM1OTMxLDIgNS4yNSwyIFoiIGlkPSJwYXRoLTEiPjwvcGF0aD4KICAgICAgICA8ZmlsdGVyIHg9Ii04LjMlIiB5PSItNy41JSIgd2lkdGg9IjExNi43JSIgaGVpZ2h0PSIxMTUuMCUiIGZpbHRlclVuaXRzPSJvYmplY3RCb3VuZGluZ0JveCIgaWQ9ImZpbHRlci0yIj4KICAgICAgICAgICAgPGZlT2Zmc2V0IGR4PSIwIiBkeT0iMCIgaW49IlNvdXJjZUFscGhhIiByZXN1bHQ9InNoYWRvd09mZnNldE91dGVyMSI+PC9mZU9mZnNldD4KICAgICAgICAgICAgPGZlR2F1c3NpYW5CbHVyIHN0ZERldmlhdGlvbj0iMC41IiBpbj0ic2hhZG93T2Zmc2V0T3V0ZXIxIiByZXN1bHQ9InNoYWRvd0JsdXJPdXRlcjEiPjwvZmVHYXVzc2lhbkJsdXI+CiAgICAgICAgICAgIDxmZUNvbG9yTWF0cml4IHZhbHVlcz0iMCAwIDAgMCAwICAgMCAwIDAgMCAwICAgMCAwIDAgMCAwICAwIDAgMCAwLjA1IDAiIHR5cGU9Im1hdHJpeCIgaW49InNoYWRvd0JsdXJPdXRlcjEiPjwvZmVDb2xvck1hdHJpeD4KICAgICAgICA8L2ZpbHRlcj4KICAgIDwvZGVmcz4KICAgIDxnIGlkPSJQYWdlLTEiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSJJY29ucy9GaWxlLzI0cHgvU2tldGNoIj4KICAgICAgICAgICAgPGcgaWQ9IlJlY3RhbmdsZS1Db3B5Ij4KICAgICAgICAgICAgICAgIDx1c2UgZmlsbD0iYmxhY2siIGZpbGwtb3BhY2l0eT0iMSIgZmlsdGVyPSJ1cmwoI2ZpbHRlci0yKSIgeGxpbms6aHJlZj0iI3BhdGgtMSI+PC91c2U+CiAgICAgICAgICAgICAgICA8dXNlIGZpbGw9IiNGRkI5MzYiIGZpbGwtcnVsZT0iZXZlbm9kZCIgeGxpbms6aHJlZj0iI3BhdGgtMSI+PC91c2U+CiAgICAgICAgICAgIDwvZz4KICAgICAgICAgICAgPHBvbHlnb24gaWQ9IlJlY3RhbmdsZSIgZmlsbD0iI0YyRjRGNiIgcG9pbnRzPSI5LjY1NjI1IDExLjc4Mjg5NDcgMTIgMTEuMjUgMTQuNDMxNjQwNiAxMS43ODI4OTQ3IDE1Ljc1IDEzLjk0NDA3ODkgMTIgMTggOC4yNSAxMy45NDQwNzg5Ij48L3BvbHlnb24+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0xNSwyIEwyMSw4IEwxNy4yNSw4IEMxNi4wMDczNTkzLDggMTUsNi45OTI2NDA2OSAxNSw1Ljc1IEwxNSwyIEwxNSwyIFoiIGlkPSJSZWN0YW5nbGUtQ29weS0zIiBmaWxsPSIjRkZGRkZGIiBvcGFjaXR5PSIwLjQwMDAwMDAwNiI+PC9wYXRoPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+"},X2ZP:function(e,t,a){e.exports={root:"root-3TPMOZ8Xo0",link:"link-160zz1JNPa"}},X4JO:function(e,t,a){e.exports={"radio-group":"radio-group-2D8TS8VxJm",radioGroup:"radio-group-2D8TS8VxJm","radio-group-slider":"radio-group-slider-2ub2wAD1js",radioGroupSlider:"radio-group-slider-2ub2wAD1js","radio-button-wrapper":"radio-button-wrapper-3xvMYAH1gG",radioButtonWrapper:"radio-button-wrapper-3xvMYAH1gG","radio-button":"radio-button-2pSV_WW7jd",radioButton:"radio-button-2pSV_WW7jd","radio-button-input":"radio-button-input-1_nRj-Qam7",radioButtonInput:"radio-button-input-1_nRj-Qam7","radio-button-inner":"radio-button-inner-1lMjOX1oF2",radioButtonInner:"radio-button-inner-1lMjOX1oF2"}},X7Wg:function(e,t,a){e.exports={dropdown:"dropdown-3rYgfsOBLx","dropdown-open":"dropdown-open-3fyH0HZeJ1",dropdownOpen:"dropdown-open-3fyH0HZeJ1",arrow:"arrow-GSpQJ0Lf_K",text:"text-3H-fPuUDgQ",divider:"divider-pzfOSS8HrZ",popup:"popup-3oHUzDOnIM","popup-title":"popup-title-32uvzALkbx",popupTitle:"popup-title-32uvzALkbx","popup-item":"popup-item-3KQed5SW9B",popupItem:"popup-item-3KQed5SW9B","popup-item-active":"popup-item-active-GbyDxeePPU",popupItemActive:"popup-item-active-GbyDxeePPU"}},X9In:function(e,t,a){e.exports={"subitem-wrapper":"subitem-wrapper-FM07-llUlk",subitemWrapper:"subitem-wrapper-FM07-llUlk","subitem-header":"subitem-header-1KdTnfKUPy",subitemHeader:"subitem-header-1KdTnfKUPy",title:"title-2nAah62RHl",operation:"operation-2gd5Caczl1",progress:"progress-35rhpTAW-1",migration:"migration-1IsWowPt7u","create-button":"create-button-3qpFmHiJ6N",createButton:"create-button-3qpFmHiJ6N","find-button":"find-button-204tDnBytv",findButton:"find-button-204tDnBytv","link-button":"link-button-1sSvZRsBKx",linkButton:"link-button-1sSvZRsBKx","subitem-detail":"subitem-detail-tL6wzoDhgn",subitemDetail:"subitem-detail-tL6wzoDhgn",items:"items-3bq6PMXqKT","last-item":"last-item-3CCw3YnIFc",lastItem:"last-item-3CCw3YnIFc",active:"active-1x4fRr0M_U","item-icon":"item-icon-1XWNsh1pO9",itemIcon:"item-icon-1XWNsh1pO9","item-left":"item-left-1uaJNA4cFO",itemLeft:"item-left-1uaJNA4cFO","item-right":"item-right-2FmQ5VNdDK",itemRight:"item-right-2FmQ5VNdDK","item-priority":"item-priority-1-TUcX8qAk",itemPriority:"item-priority-1-TUcX8qAk","item-status":"item-status-1ZnAq5bX6-",itemStatus:"item-status-1ZnAq5bX6-","status-tag":"status-tag-gt8v05gjp6",statusTag:"status-tag-gt8v05gjp6","item-assignee":"item-assignee-3XThu_W1bZ",itemAssignee:"item-assignee-3XThu_W1bZ","item-detail":"item-detail-1nZy07rXhU",itemDetail:"item-detail-1nZy07rXhU","item-code":"item-code-2PpWPtB8YW",itemCode:"item-code-2PpWPtB8YW","item-spec":"item-spec-1y1UXBES4p",itemSpec:"item-spec-1y1UXBES4p","item-title":"item-title-2BoJ8H0uv2",itemTitle:"item-title-2BoJ8H0uv2",avatar:"avatar-2ddsOLE2Ot","default-avatar":"default-avatar-mm1NOafQ8D",defaultAvatar:"default-avatar-mm1NOafQ8D","label-wrapper":"label-wrapper-NAYYeqUgMI",labelWrapper:"label-wrapper-NAYYeqUgMI",disabled:"disabled-1b3lRmnK2W",step:"step-PaXsS1-9VT","empty-tip":"empty-tip-1cu4RC65-f",emptyTip:"empty-tip-1cu4RC65-f","requirement-icon":"requirement-icon-NuhdCbLJzk",requirementIcon:"requirement-icon-NuhdCbLJzk","assignment-icon":"assignment-icon-HRUQq9e_9J",assignmentIcon:"assignment-icon-HRUQq9e_9J","defect-icon":"defect-icon-I4kq37jEFU",defectIcon:"defect-icon-I4kq37jEFU","to-right":"to-right-1G82uDuQFb",toRight:"to-right-1G82uDuQFb","member-right":"member-right-2p-AhZ3cuD",memberRight:"member-right-2p-AhZ3cuD",tag:"tag-1j8fmzyqBg",orange:"orange-UIPNmvbt94",red:"red-2JrIDXaOxs",gray:"gray-UtBm4s41_D","due-date":"due-date-3OTUbgQlkE",dueDate:"due-date-3OTUbgQlkE","dragging-item":"dragging-item-1f6stMSl-L",draggingItem:"dragging-item-1f6stMSl-L","item-is-dragging":"item-is-dragging-37a0BYtAZ4",itemIsDragging:"item-is-dragging-37a0BYtAZ4","item-is-moving":"item-is-moving-a8KO9Wwjdr",itemIsMoving:"item-is-moving-a8KO9Wwjdr"}},XWeJ:function(e,t,a){e.exports={checkbox:"checkbox-196wrEJhDi","checkbox-disabled":"checkbox-disabled-38pQvpf1AI",checkboxDisabled:"checkbox-disabled-38pQvpf1AI","checkbox-active":"checkbox-active-12MolzHqoH",checkboxActive:"checkbox-active-12MolzHqoH"}},XauF:function(e,t,a){"use strict";a("I5cv"),a("RW0V"),a("ioFf"),a("0l/t"),a("mYba"),a("jm62"),a("EK0E"),a("XfO3"),a("Btvt"),a("yt8O"),a("rGqo");var n=a("TqRt"),i=a("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("f3/d");var r,o,s,l=n(a("lSNA")),c=n(a("RIqP")),u=n(a("lwsE")),d=n(a("W8MJ")),f=n(a("PJYZ")),p=n(a("7W2i")),m=n(a("a1gu")),h=n(a("Nsbk")),v=a("mVeg"),g=G(a("cDcd")),E=n(a("17x9")),b=a("h74D"),y=a("dtw8"),S=a("TJpk"),I=a("Z4vw"),T=n(a("O9Lt")),C=a("xgZS"),P=a("w3Wo"),w=a("nuIr"),D=n(a("jxzD")),O=n(a("LD9k")),R=n(a("9Aei")),j=n(a("YJB4")),k=n(a("CYfE")),N=n(a("x54Q")),A=n(a("MVjx")),L=G(a("v3Uf")),F=n(a("885C")),_=a("+3Ur"),M=n(a("axW5")),x=a("17N+"),B=n(a("K2gz")),U=n(a("e7hk")),W=n(a("G0so")),Y=a("n6b2"),H=n(a("Mh+3"));function V(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(V=function(e){return e?a:t})(e)}function G(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!==typeof e)return{default:e};var a=V(t);if(a&&a.has(e))return a.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=r?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}return n.default=e,a&&a.set(e,n),n}function K(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function z(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,h.default)(e);if(t){var i=(0,h.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,m.default)(this,a)}}var q=(0,b.connect)((function(e){var t=e.APP,a=t.enterprise,n=t.user;return{enterpriseGlobalKey:a.key,enterpriseName:a.name,user:n}}))(r=(0,y.withRouter)(r=(0,F.default)(r=(0,L.default)(r=(0,_.updateAttributeFormModalContext)(r=(0,Y.updateCompressInterfaceContainer)((s=o=function(e){(0,p.default)(a,e);var t=z(a);function a(e){var n;return(0,u.default)(this,a),(n=t.call(this,e)).renderSpec=function(){var e=n.state,t=e.detailInfo,a=e.isScrolled,i=e.branchsInfo,r=e.zipRes,o=e.zipRes3,s=e.zipRes4,l=n.props,c=l.largeSize,u=l.targetData;switch(u.type){case w.ISSUE_TYPE.REQUIREMENT:return g.default.createElement(D.default,{callFrom:"outer",targetData:u,updateCallback:n.updateIssueDetail,refreshCallback:n.refreshCallback,expanded:c,detailInfo:t,scrollRef:n.scrollRef,isScrolled:a,issueCode:u.code,params:{project:u.projectName,requirementCode:u.code},issueTypeDetail:t.issueTypeDetail,onFullScreenChange:n.handleFullScreenChange,zipRes:r,zipRes3:o,zipRes4:s});case w.ISSUE_TYPE.ASSIGNMENT:return g.default.createElement(O.default,{callFrom:"outer",targetData:u,updateCallback:n.updateIssueDetail,refreshCallback:n.refreshCallback,expanded:c,detailInfo:t,scrollRef:n.scrollRef,isScrolled:a,issueCode:u.code,params:{project:u.projectName,assignmentCode:u.code},issueTypeDetail:t.issueTypeDetail,onFullScreenChange:n.handleFullScreenChange,branchsInfo:i,zipRes:r,zipRes3:o,zipRes4:s});case w.ISSUE_TYPE.SUB_TASK:return g.default.createElement(j.default,{callFrom:"outer",targetData:u,updateCallback:n.updateIssueDetail,refreshCallback:n.refreshCallback,expanded:c,detailInfo:t,scrollRef:n.scrollRef,isScrolled:a,issueCode:u.code,params:{project:u.projectName,subtaskCode:u.code},issueTypeDetail:t.issueTypeDetail,onFullScreenChange:n.handleFullScreenChange});case w.ISSUE_TYPE.DEFECT:return g.default.createElement(R.default,{callFrom:"outer",targetData:u,updateCallback:n.updateIssueDetail,refreshCallback:n.refreshCallback,expanded:c,detailInfo:t,scrollRef:n.scrollRef,isScrolled:a,issueCode:u.code,params:{project:u.projectName,issueCode:u.code},issueTypeDetail:t.issueTypeDetail,onFullScreenChange:n.handleFullScreenChange});case w.ISSUE_TYPE.EPIC:return g.default.createElement(k.default,{callFrom:"outer",targetData:u,updateCallback:n.updateIssueDetail,refreshCallback:n.refreshCallback,expanded:c,detailInfo:t,scrollRef:n.scrollRef,isScrolled:a,issueCode:u.code,params:{project:u.projectName,epicCode:u.code},issueTypeDetail:t.issueTypeDetail,onFullScreenChange:n.handleFullScreenChange});case w.ISSUE_TYPE.RISK:return g.default.createElement(A.default,{callFrom:"outer",targetData:u,updateCallback:n.updateIssueDetail,refreshCallback:n.refreshCallback,expanded:c,detailInfo:t,scrollRef:n.scrollRef,isScrolled:a,issueCode:u.code,params:{project:u.projectName,epicCode:u.code},issueTypeDetail:t.issueTypeDetail,onFullScreenChange:n.handleFullScreenChange});case w.ISSUE_TYPE.WORK_ITEM:return g.default.createElement(N.default,{callFrom:"outer",targetData:u,updateCallback:n.updateIssueDetail,refreshCallback:n.refreshCallback,expanded:c,detailInfo:t,scrollRef:n.scrollRef,isScrolled:a,issueCode:u.code,params:{project:u.projectName,epicCode:u.code},issueTypeDetail:t.issueTypeDetail,onFullScreenChange:n.handleFullScreenChange});default:return g.default.createElement("div",null,"\u672a\u652f\u6301\u7684\u7c7b\u578b ",u.type)}},n.updateIssueDetail=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=n.props.slideUpdateCallback;e&&!a?n.setState({detailInfo:e}):n.getDetailInfo(!0),i()},n.refreshCallback=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=n.props,a=t.getIssues,i=t.slideUpdateCallback;a&&a(),i&&i(e)},n.handleFullScreenChange=function(e){n.setState({isFullScreen:e})},n.state={isScrolled:!1,isFetchingDetail:!0,detailInfo:void 0,noViewPermission:!1,isFullScreen:(0,x.getIsSlideFullScreen)(),branchsInfo:[],zipRes:{},zipRes3:{},zipRes4:{}},n.onScroll=n.onScroll.bind((0,f.default)(n)),n.scrollRef=g.default.createRef(),n}return(0,d.default)(a,[{key:"getIssueBranchs",value:function(e){var t=this,a=this.props.targetData;"MISSION"===a.type||"SUB_TASK"===a.type?(0,P.fetchIssueBranchs)(a.projectId,e).then((function(e){var a=e.data;a&&t.setState({branchsInfo:(0,c.default)(a)})})):this.setState({branchsInfo:[]})}},{key:"render",value:function(){var e=this.state.isFullScreen,t=this.props,a=t.closeHandle,n=t.enterpriseName,i=this.state,r=i.noViewPermission,o=i.isFetchingDetail,s=i.detailInfo,l=i.issueType,c=w.ISSUE_NAME[l];return g.default.createElement(g.default.Fragment,null,e&&g.default.createElement("div",{className:U.default.fullScreenMask}),g.default.createElement("div",{className:(0,B.default)(U.default.slideWrapper,"full-screen-style",e&&U.default.fullScreen)},s&&g.default.createElement(S.Helmet,null,g.default.createElement("title",null,"".concat(s.name," - ").concat(c,"\u8be6\u60c5 - ").concat(n))),g.default.createElement("span",{className:(0,B.default)(W.default.closeButton,e&&W.default.closeButtonFullScreen),onClick:a}),g.default.createElement(M.default,null),g.default.createElement("div",{id:"wm-spec",className:W.default.detailRoot,onScroll:this.onScroll,ref:this.scrollRef},!o&&s&&this.renderSpec(),!o&&r&&g.default.createElement("div",{className:(0,B.default)(U.default.noViewPermissionContainer)},g.default.createElement("div",{className:(0,B.default)(U.default.pic)}),g.default.createElement("div",{className:(0,B.default)(U.default.title)},(0,v.t)("\u5bf9\u4e0d\u8d77\uff0c\u60a8\u6ca1\u6709\u8bbf\u95ee\u8be5\u4e8b\u9879\u7684\u6743\u9650")),g.default.createElement("div",{className:(0,B.default)(U.default.tip)},(0,v.t)("\u5982\u9700\u8bbf\u95ee\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458"))),o&&g.default.createElement(T.default,{show:!0}))))}},{key:"componentDidMount",value:function(){var e=this,t=this.props,a=t.changeHiddenFloderDirsFromZip,n=t.getAgileApi;t.isUseZipData?n().then((function(t){var n=t.zipRes,i=t.zipRes3,r=t.zipRes4,o=n.data;a(o[H.default.fetchHiddenFolderDirs]),e.setState({zipRes:n,zipRes3:i,zipRes4:r},(function(){e.getDetailInfo(!1,o[H.default.getDetailInfo])}))})).catch((function(){a(),e.getDetailInfo()})):(a(),this.getDetailInfo())}},{key:"componentDidUpdate",value:function(e){var t=this,a=e.tableDetailUpdate,n=this.props,i=n.targetData,r=n.tableDetailUpdate,o=n.changeHiddenFloderDirsFromZip,s=n.getAgileApi,l=n.isUseZipData;if(e.targetData.projectName!==i.projectName||e.targetData.code!==i.code||!a&&r){if(l)return this.setState({detailInfo:void 0}),void s(null,"itType").then((function(e){var a=e.zipRes,n=e.zipRes3,i=e.zipRes4,r=a.data;o(r[H.default.fetchHiddenFolderDirs]),t.setState({zipRes:a,zipRes3:n,zipRes4:i},(function(){t.getDetailInfo(!1,r[H.default.getDetailInfo])}))})).catch((function(){o(),t.getDetailInfo()}));this.getDetailInfo()}}},{key:"getDetailInfo",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=arguments.length>1?arguments[1]:void 0,n=this.props.targetData;if(t||this.setState({isFetchingDetail:!0}),a)if(0===a.code){var i=a.data;this.setState({detailInfo:i,issueType:i.type,isFetchingDetail:!1,noViewPermission:!1}),this.getIssueBranchs(i.id)}else 1400===a.code&&this.setState({noViewPermission:!0,isFetchingDetail:!1});else(0,P.fetchIssueDetailByCode)(n.projectId,n.code,{withDescriptionMarkup:!0},!0).then((function(t){var a=t.data;e.setState({detailInfo:a,issueType:a.type,isFetchingDetail:!1,noViewPermission:!1}),e.getIssueBranchs(a.id)}),(function(t){var a=t.code,n=t.msg;1400===a?e.setState({noViewPermission:!0,isFetchingDetail:!1}):(0,C.danger)((0,I.getErrorMessage)(n))}))}},{key:"onScroll",value:function(e){var t=this.state.isScrolled;e.target.scrollTop>1&&!t?this.setState({isScrolled:!0}):e.target.scrollTop<=1&&this.setState({isScrolled:!1})}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a=e.targetData,n=t.detailInfo;return(null===a||void 0===a?void 0:a.code)!==(null===n||void 0===n?void 0:n.code)||(null===a||void 0===a?void 0:a.projectId)!==(null===n||void 0===n?void 0:n.projectId)?{detailInfo:void 0}:null}}]),a}(g.Component),o.propTypes=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?K(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):K(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({targetData:E.default.object,closeHandle:E.default.func,slideUpdateCallback:E.default.func,tableDetailUpdate:E.default.bool,isUseZipData:E.default.bool},L.sizeProps),r=s))||r)||r)||r)||r)||r)||r;t.default=q},Xc7o:function(e,t,a){e.exports={item:"item-1Xq_huQvsV","item-icon":"item-icon-hEBFirUrbV",itemIcon:"item-icon-hEBFirUrbV","item-code":"item-code-2yffRv06wB",itemCode:"item-code-2yffRv06wB","item-name":"item-name-2rvudyCuqv",itemName:"item-name-2rvudyCuqv","item-priority":"item-priority-2vr-KVKEvD",itemPriority:"item-priority-2vr-KVKEvD","to-right":"to-right-1_w2yUNoAm",toRight:"to-right-1_w2yUNoAm"}},YJB4:function(e,t,a){"use strict";a("I5cv"),a("mYba"),a("jm62"),a("EK0E");var n=a("TqRt"),i=a("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(a("o0o1"));a("f3/d"),a("0l/t"),a("dRSK"),a("L9s1"),a("Z2Ku"),a("Btvt"),a("VRzm"),a("pIFo"),a("CX2u"),a("XfO3"),a("yt8O"),a("rGqo"),a("INYr"),a("0mN4"),a("bWfx"),a("hhXQ"),a("RW0V"),a("tUrg"),a("ioFf"),a("HEwt"),a("T39b");var o,s,l,c,u,d=n(a("RIqP")),f=n(a("yXPU")),p=n(a("lwsE")),m=n(a("W8MJ")),h=n(a("PJYZ")),v=n(a("7W2i")),g=n(a("a1gu")),E=n(a("Nsbk")),b=n(a("lSNA")),y=a("mVeg"),S=ze(a("cDcd")),I=a("h74D"),T=n(a("17x9")),C=a("dtw8"),P=n(a("qLOp")),w=n(a("TsYS")),D=a("7FZc"),O=n(a("P5Jw")),R=n(a("qCZF")),j=n(a("KUqB")),k=n(a("WE/Q")),N=n(a("Yzhn")),A=a("nuIr"),L=n(a("AVuq")),F=n(a("wd/R")),_=a("FaIw"),M=a("vi3I"),x=a("sWxF"),B=a("w3Wo"),U=a("xgZS"),W=n(a("V/h/")),Y=n(a("2KQ+")),H=n(a("Y+p1")),V=n(a("XiRy")),G=n(a("XLbL")),K=n(a("8+Mu")),z=n(a("4qC0")),q=n(a("GoyQ")),Z=n(a("UB5X")),J=n(a("Z0cm")),X=a("DKcV"),Q=n(a("K2gz")),$=a("Z4vw"),ee=a("FpRC"),te=n(a("2CT0")),ae=n(a("kwSY")),ne=n(a("L8Eh")),ie=n(a("Th6D")),re=a("DgMC"),oe=a("885C"),se=a("5DNL"),le=a("3RH6"),ce=a("AwMv"),ue=a("V+QM"),de=n(a("1lUc")),fe=n(a("mSbZ")),pe=n(a("htee")),me=n(a("4Fdf")),he=n(a("uk0h")),ve=n(a("+Dhf")),ge=a("jzjO"),Ee=n(a("oIiO")),be=n(a("CF/V")),ye=n(a("begU")),Se=n(a("0Zwn")),Ie=n(a("W0/N")),Te=n(a("HtPo")),Ce=n(a("Qkhu")),Pe=n(a("AoGB")),we=n(a("KIkv")),De=a("7bn+"),Oe=n(a("X5YD")),Re=a("17N+"),je=n(a("HwxY")),ke=a("LvkV"),Ne=a("9+7+"),Ae=a("9+7+"),Le=a("lGCG"),Fe=n(a("WKBZ")),_e=n(a("cHah")),Me=n(a("DDpV")),xe=n(a("QWzU")),Be=n(a("6yKH")),Ue=a("cUHt"),We=a("nuIr"),Ye=n(a("NIJN")),He=n(a("MxQt")),Ve=ze(a("Mdvu")),Ge=a("AMAM");function Ke(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(Ke=function(e){return e?a:t})(e)}function ze(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!==typeof e)return{default:e};var a=Ke(t);if(a&&a.has(e))return a.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=r?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}return n.default=e,a&&a.set(e,n),n}function qe(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Ze(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?qe(Object(a),!0).forEach((function(t){(0,b.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):qe(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Je(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,E.default)(e);if(t){var i=(0,E.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,g.default)(this,a)}}var Xe=(0,re.isSupportsPlaintextEdit)()?"plaintext-only":"true",Qe=(o={},(0,b.default)(o,A.ISSUE_TYPE.REQUIREMENT,"requirements"),(0,b.default)(o,A.ISSUE_TYPE.ASSIGNMENT,"assignments"),(0,b.default)(o,A.ISSUE_TYPE.DEFECT,"bug-tracking"),o);var $e=(s=(0,I.connect)((function(e){return{enterpriseGlobalKey:e.APP.enterprise.globalKey,enterpriseName:e.APP.enterprise.name,watermark:e.APP.enterprise.watermark,payed:e.APP.enterprise.payed,user:e.APP.user,isSensitiveAdmin:(0,X.checkSensitiveAdmin)(e.CURRENT_USER_ENTERPRISE_PERMISSION_NAMESPACE_FOR_REDUX_STORE.currentEnterprisePermissionList,e.CURRENT_USER_PROJECT_PERMISSION_NAMESPACE_FOR_REDUX_STORE.currentProjectPermissionList),currentProjectCooperateSettings:e.APP.currentProjectCooperateSettings}})),(0,C.withRouter)(l=s(l=(0,fe.default)(l=(0,ve.default)(l=(0,pe.default)(l=(0,he.default)(l=(0,me.default)(l=(0,se.FlashAnchorDecorator)(l=(0,Pe.default)((u=c=function(e){(0,v.default)(a,e);var t=Je(a);function a(e){var n;return(0,p.default)(this,a),(n=t.call(this,e)).isDeleteInFilePreview=!1,n.getFunctionFlags=function(){var e=n.props.currentProjectFunctions;return{codeManagementOpen:e.some((function(e){return e.code===ke.KEY_CONFIG.CODE_MANAGEMENT&&"1"===e.value})),testManagementOpen:e.some((function(e){return e.code===ke.KEY_CONFIG.TEST_MANAGEMENT&&"1"===e.value})),issueReviewOpen:Ae.enableIssueReview}},n.elemShow=function(){n.dataLoad=(0,Ie.default)({elemInOrder:["codeRepo","reference","logs","comment"].filter((function(e){return e})),onRenderItem:function(e,t,a,i){n.setState({isRender:Ze({},i),isRenderAll:t},(function(){a(),t&&n.setState({controlCaculatePos:Date.now()})}))}}),n.dataLoad("comment")},n.titleInputRef=S.default.createRef(),n.scrollRef=S.default.createRef(),n.renderParentsInfo=function(){var e,t,a,i,r,o,s,l,c=n.state,u=c.tooltipTitle,d=c.detailInfoState,f=n.props.projectPath;return"REQUIREMENT"===(null===(e=d.parent)||void 0===e?void 0:e.type)&&(l="requirements"),"MISSION"===(null===(t=d.parent)||void 0===t?void 0:t.type)&&(l="assignments"),"DEFECT"===(null===(a=d.parent)||void 0===a?void 0:a.type)&&(l="bug-tracking"),S.default.createElement("div",{className:P.default.detailId},d.parent&&S.default.createElement(D.TooltipTrigger,{title:"".concat((0,y.t)("\u6240\u5c5e\u4e8b\u9879\uff1a#")).concat(null===(i=d.parent)||void 0===i?void 0:i.code," ").concat(null===(r=d.parent)||void 0===r?void 0:r.name)},S.default.createElement(C.Link,{to:"".concat(f,"/").concat(l,"/issues/").concat(null===(o=d.parent)||void 0===o?void 0:o.code,"/detail"),className:(0,Q.default)(P.default.code,P.default.number)},S.default.createElement(j.default,{type:d.parent.issueTypeDetail.iconType}),"#",null===(s=d.parent)||void 0===s?void 0:s.code)),d.parent&&S.default.createElement("span",{className:P.default.codeIdDivideLine},"/"),S.default.createElement("span",{className:(0,Q.default)(P.default.code,P.default.lastId,P.default.lastNumber)},S.default.createElement(C.Link,{to:"".concat(f,"/subtasks/issues/").concat(d.code,"/detail"),className:(0,Q.default)(P.default.code,P.default.number)},S.default.createElement(j.default,{type:d.issueTypeDetail.iconType}),"#",d.code),S.default.createElement(D.TooltipTrigger,{title:u,onVisibleChange:n.onVisibleChange},S.default.createElement(O.default,{text:"".concat(window.location.origin).concat(f,"/subtasks/issues/").concat(d.code,"/detail")},S.default.createElement("div",{className:P.default.copyIcon,onClick:n.onCopyClick})))),S.default.createElement("div",{className:(0,Q.default)(P.default.code,P.default.lastId,P.default.lastNumber),style:{marginLeft:20,fontWeight:600}},"|",S.default.createElement("span",{style:{color:"red",margin:"0 5px"}},"GID"),"#",d.id,S.default.createElement(D.TooltipTrigger,{title:u,onVisibleChange:n.copyGID},S.default.createElement(O.default,{text:d.id},S.default.createElement("div",{className:P.default.copyIcon,onClick:n.onCopyClick})))))},n.copyGID=function(){n.setState({tooltipTitle:(0,y.t)("\u590d\u5236")})},n.renderTitle=function(e,t,a){var i=n.state,r=i.detailInfoState,o=i.inputFocus;return S.default.createElement("div",{className:(0,Q.default)(P.default.titleInputWrap,o&&t&&P.default.titleInputFocusWrap)},S.default.createElement("div",{className:(0,Q.default)(P.default.titleInput,!e&&P.default.titleInputDisabled,t&&P.default.titleInputScrolled),ref:!a&&n.titleInputRef,onFocus:function(){n.setState({inputFocus:!0}),setTimeout((function(){(0,re.setFocus)(n.titleInputRef.current)}),0)},onBlur:function(){n.setState({inputFocus:!1}),n.handleInput(n.titleInputRef.current.innerText)},onKeyDown:function(e){"Enter"===e.key&&(e.preventDefault(),n.handleInput(n.titleInputRef.current.innerText))},contentEditable:e?Xe:"false",suppressContentEditableWarning:!0},r.name))},n.renderScrollTitle=function(e,t){var a=n.state,i=a.inputFocus,r=a.detailInfoState;return i?S.default.createElement(S.default.Fragment,null,n.renderTitle(e,!0,t)):S.default.createElement("div",{className:P.default.scrolledTitleWrap},S.default.createElement("div",{className:(0,Q.default)(P.default.titleIconWrap,n.state.noHoverIcon&&P.default.noHoverIcon)},S.default.createElement(j.default,{type:r.issueTypeDetail.iconType}),S.default.createElement("div",{className:P.default.breadcrumb},n.renderParentsInfo())),n.renderTitle(e,!0,t))},n.onBtnClick=function(e){n["".concat(e.toLowerCase(),"BtnClicked")]&&n["".concat(e.toLowerCase(),"BtnClicked")]()},n.getEditComp=function(e){n.editComp=e},n.editStatusChanged=function(e,t){n.setState(Ze({isDesEditing:e,isShowItemPlaceholder:Ze(Ze({},n.state.isShowItemPlaceholder),{},{description:void 0!==t?t:!e})},e?{}:{isDescriptionBtnFixed:!1}),(function(){n.setState({controlCaculatePos:Date.now()})}))},n.scrollToAttechment=function(){var e,t,a;null!==(e=n.scrollRef)&&void 0!==e&&e.current&&null!==(t=n.attechmentRef)&&void 0!==t&&t.current&&null!==(a=n.headerRef)&&void 0!==a&&a.current&&(0,ee.scrollIntoView)(n.scrollRef.current,n.attechmentRef.current,-n.headerRef.current.offsetHeight)},n.handleReviewListChanged=function(){n.fetchIssueReviewList((function(e){0!==e.length?ee.scrollIntoView&&n.setState({activeLogTab:"approval"},(function(){(0,ee.scrollRelatedToTopMenu)("issue-review-list",0,n.scrollRef.current)})):n.setState({activeLogTab:"activity"})})),setTimeout((function(){n.getActivityList()}),1e3)},n.getCodeRepoSetting=function(){var e=n.props.currentProject,t=n.state.detailInfoState;return(0,x.fetchRepoSettingInfo)(e.name,t.issueTypeDetail.id).then((function(e){var t=e.data.find((function(e){return"RELATE_VCS"===e.configName}));t&&"ON"===t.configValue?(n.setState({codeRepoRelationOpened:!0}),n.getAssociatedCodeRepos()):n.dataLoad("codeRepo")}))},n.getCodeRepos=function(e){var t=n.props,a=t.enterpriseGlobalKey,i=t.currentProject,r=n.state,o=r.associatedCodeRepos,s=r.codeRepoList;e?n.setState({availableCodeRepos:s.filter((function(t){return t.name.toLowerCase().includes(e.toLowerCase())&&!o.some((function(e){return e.id===t.id}))}))}):(0,x.fetchAvailableCodeRepos)(a,i.name).then((function(e){var t=e.data;n.setState({codeRepoList:t,availableCodeRepos:t.filter((function(e){return!o.some((function(t){return t.id===e.id}))}))})}))},n.associateCodeRepo=function(e){var t=n.props.currentProject,a=n.state.detailInfoState.code;(0,x.associateCodeRepo)(t.name,a,e).then((function(){(0,U.success)((0,y.t)("\u66f4\u65b0\u6210\u529f")),n.getAssociatedCodeRepos().then((function(){return n.getCodeRepos()}))}))},n.cancelAssociateCodeRepo=function(e){var t=n.props.currentProject,a=n.state.detailInfoState.code;(0,x.cancelAssociateCodeRepo)(t.name,a,e).then((function(){(0,U.success)((0,y.t)("\u66f4\u65b0\u6210\u529f")),n.getAssociatedCodeRepos().then((function(){return n.getCodeRepos()}))}))},n.cancelCodeRepo=function(){return n.setState({isShowItemPlaceholder:Ze(Ze({},n.state.isShowItemPlaceholder),{},{codeRepo:!1})})},n.referencesBtnClicked=function(){"activity"===n.state.activeLogTab?n.changeActivityTabAndShow():n.setState({activeLogTab:"activity"},(function(){n.setCommentPosition((function(){setTimeout((function(){n.changeActivityTabAndShow()}),0)}))}))},n.changeActivityTabAndShow=function(){"WITHOUT_COMMENT"===n.state.activitiesTab?n.setState({activitiesTab:"ALL"},(function(){n.changeTabFn(["ALL"]),n.setCommentPosition((function(){n.doShowReference()}))})):n.doShowReference()},n.doShowReference=function(){n.props.autoToggleComment(n.state.detailInfoState.code,!0)},n.scrollToBottom=function(e){(0,ee.scrollRelatedToTopMenu)("bottom",0,n.scrollRef.current,e)},n.getNotUploadElems=function(){var e=n.state,t=e.isDesEditing,a=e.isCommentEditing;return[t&&n.editComp.containerRef.current,a&&n.commentEditorRef&&n.commentEditorRef.current]},n.dragEnterDes=function(e){n.dragEnter(e,"des")},n.dragEnterComment=function(e){n.dragEnter(e,"comment")},n.dragEnter=function(e,t){e.preventDefault(),e.stopPropagation(),n["des"===t?"intoDesCount":"intoCommentCount"]++},n.dragLeaveDes=function(e){n.dragLeave(e,"des")},n.dragLeaveComment=function(e){n.dragLeave(e,"comment")},n.dragLeave=function(e,t){e.preventDefault(),e.stopPropagation();var a="des"===t?"intoDesCount":"intoCommentCount";n[a]--,0===n[a]&&n.setState({notUpload:!1})},n.mouseLeaveDes=function(){n.mouseLeave("des")},n.mouseLeaveComment=function(){n.mouseLeave("comment")},n.renderActivity=function(e){var t=n.state,a=t.isInited,i=t.activities,r=t.detailInfoState,o=t.activitiesTab,s=t.isCommentSticky,l=n.props,c=l.isDetail,u=l.currentProject,d=l.user,f=l.projectPath,p=l.domID;return S.default.createElement(L.default,{isInited:a,scrollRef:n.scrollRef,isDetail:c,currentProject:u,user:d,activities:i,projectPath:f,domID:p,flashAnchor:n.props.flashAnchor,itemType:"SUB_TASK",code:r.code,onPublishChildComment:n.postComment,editCommentCallback:n.handleEditCommentCallback,onDeleteComment:n.deleteComment,handleViewRecord:n.viewRecord,activeTab:[o],changeTab:function(e){return n.setState({activitiesTab:e},n.setCommentPosition)},getChangeTabFn:function(e){n.changeTabFn=e},isCommentSticky:s,hideTitle:e,handleEditComment:function(e){return n.setState({isEdittingCommentModalVisible:e})}})},n.changeActivityLogTab=function(e){n.fetchManHourRecords(),n.setState({activeLogTab:e.value},(function(){n.setCommentPosition(),"approval"===e.value&&n.fetchIssueReviewList((function(e){0===e.length&&n.setState({activeLogTab:"activity"})}))}))},n.getDropdownPortalToRight=function(){return!n.props.isDetail&&!n.state.isFullScreen},n.doScroll=function(){if(!n.state.inputFocus){var e=n.scrollRef.current.scrollTop,t=n.state.isScrolled;e>100&&!t?n.setState({isScrolled:!0}):e<=100&&n.setState({isScrolled:!1})}},n.onAttrScroll=function(){n.setState({isElemScroll:!0})},n.getSensitiveMessage=function(e){var t=n.props.currentProject;(0,ue.getSensitive)(e,t.name).then((function(e){0===e.code&&n.setState({isSensitive:e.data.isSensitive})}))},n.operateSensitive=function(){var e=n.state.isSensitive,t=n.props,a=t.detailInfo,i=t.currentProject;e?n.setState({showDeleteModal:!0}):(0,ue.addSensitive)(a.code,i.name).then((function(e){0===e.code&&((0,U.success)((0,y.t)("\u6807\u8bb0\u6210\u529f\uff01")),n.getSensitiveMessage(a.code))}))},n.cancelMark=function(){var e=n.props,t=e.detailInfo,a=e.currentProject;(0,ue.cancelSensitive)(t.code,a.name).then((function(e){n.setState({showDeleteModal:!1}),0===e.code&&((0,U.success)((0,y.t)("\u53d6\u6d88\u6807\u8bb0\u6210\u529f\uff01")),n.getSensitiveMessage(t.code))}))},n.trackEvent=function(e){n.setState({showSensitive:!0});var t=n.props.currentProject;(0,ue.tracking)({projectName:t.name,pageIdentifier:"SUB_TASK_DETAIL",code:e}).then()},n.validateDefect=function(e,t){var a,i=n.state.attributes,r=null===(a=n.props.subtaskSchemeFieldArchives[e])||void 0===a?void 0:a.issueField,o=["\u81f4\u547d","\u4e25\u91cd"],s=!!r&&r.options.find((function(e){return e.value===t&&o.includes(e.name)}));return!(!r||"\u7f3a\u9677\u4e25\u91cd\u7a0b\u5ea6"!==r.name||!s||i.defectKindIds.length&&i.defectPhaseId)&&((0,U.warning)((0,y.t)("\u8bf7\u5148\u586b\u5199\u201c\u5f15\u5165\u7f3a\u9677\u9636\u6bb5\u201d\u548c\u201c\u7f3a\u9677\u7c7b\u578b\u201d")),!0)},n.fetchManHourRecords=function(){var e=n.props,t=e.currentProject.id,a=e.detailInfo.code;return(0,x.getManhourHistories)(t,a).then((function(e){var t=e.data;n.setState({manHourRecords:t})}))},n.fetchManHourRecordsAndFetchSpecData=(0,f.default)(r.default.mark((function e(){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.fetchManHourRecords();case 2:return e.next=4,n.changeAttributes({type:""});case 4:case"end":return e.stop()}}),e)}))),n.deleteManhourRecord=function(e,t){var a=n.props.currentProject.id;return(0,x.delManHourHistory)(a,e.id,t).then((function(){n.fetchManHourRecordsAndFetchSpecData()}))},n.getTencentMeeting=function(){var e=n.props.currentProject.name,t=n.state.detailInfoState.code;(0,x.getTencentMeetingDetail)(e,t).then((function(e){n.setState({meeting:e.data})}))},n.caculateDetailEleHeight=function(){return new Promise((function(e){n.doCaculate(-1,e)}))},n.doCaculate=function(e,t){if(n.detailBodyRef.current){var a=n.detailBodyRef.current.offsetHeight;a!==e?setTimeout((function(){n.doCaculate(a,t)}),300):t(a)}},n.setCommentPosition=function(){var e=(0,f.default)(r.default.mark((function e(t){var a,i,o,s,l;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n.scrollRef&&n.scrollRef.current&&n.hiddenHeaderRef.current&&n.detailBodyRef.current)){e.next=7;break}return e.next=3,n.caculateDetailEleHeight();case 3:o=e.sent,s=n.scrollRef.current.offsetHeight-n.hiddenHeaderRef.current.offsetHeight,l=(null===(a=n.commentEditorRef)||void 0===a||null===(i=a.current)||void 0===i?void 0:i.offsetHeight)||140,n.setState(Ze({isCommentSticky:o+l>=s},o+l<s?{isDescriptionBtnFixed:!1,isCommentAbsBottom:!1}:{}),(function(){if(n.state.isCommentSticky&&(setTimeout((function(){var e=n.hiddenHeaderRef.current.offsetHeight+(n.detailBodyRef.current.offsetHeight<s?s:n.detailBodyRef.current.offsetHeight);n.setState({isCommentAbsBottom:n.scrollRef.current.offsetHeight-e>=0,minHeight:s})}),0),n.state.isDesEditing)){var e=n.editorRef.current.offsetHeight+24,a=n.scrollRef.current.offsetHeight-n.hiddenHeaderRef.current.offsetHeight-44;n.setState({isDescriptionBtnFixed:e>=a})}"function"===typeof t&&t()}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.renewDescription=function(e){var t=e.historyId,a=e.issueLogId,i=e.description,r=n.props.currentProject,o=n.state.detailInfoState;return(0,B.rollbackDescription)(r.id,o.code,a).then((function(){n.setState({historyId:t,description:i,isDescriptionEmpty:!i.replace(/\n|\s/g,"")}),n.getActivityList(),n.getResourceReference()})).then((function(){Ve.default.emit(Ve.EventBusType.BlockDesc,Ve.EventBusKeys.revertHistoryBlockDesc)}))},n.updateSubtask=function(e,t,a){var i,r=n.props.currentProject,o=n.state.detailInfoState;a?e.parentCode=a:e.parentCode=null===(i=o.parent)||void 0===i?void 0:i.code;return(0,M.updateSubtaskDetail)(r.id,o.code,Ze({},e)).then((function(t){var a=t.data;return a.files=n.combineThirdLinks(a.files,a.thirdLinks),n.callback(a,e.statusId),n.getActivityList(),(0,U.success)((0,y.t)("\u66f4\u65b0\u6210\u529f")),n.cancelParentSelector(),t}),(function(t){var a=t.code,i=t.data,r=t.msg,s=n.state.attachmentsState;return 8015===a?i.issue_status_id===e.statusId?(n.callback(null,e.statusId),n.getActivityList(),(0,U.success)((0,y.t)("\u66f4\u65b0\u6210\u529f"))):((0,U.danger)((0,y.t)("\u66f4\u65b0\u5931\u8d25\uff0c\u5f53\u524d\u72b6\u6001\u4e0d\u6b63\u786e\u3002")),n.callback(null,i.issue_status_id),n.getActivityList()):((0,U.danger)((0,$.getErrorMessage)(r)),n.setState({detailInfoState:o,attachmentsState:(0,d.default)(s.filter((function(e){return e.fileId>0})))},(function(){n.initAttributesData(o)}))),t})).finally((function(){"function"===typeof t&&t()}))},n.showRequirementSelector=function(){n.setState({parentSelectorStatus:!0})},n.getActivityList=function(e){var t=n.props.issueCode,a=n.props.currentProject.id;return(0,M.fetchSubtasksActitvites)(a,t).then((function(t){n.setState({activities:t.data},(function(){e&&e()})),n.dataLoad("logs")}))},n.getResourceReference=function(){var e=n.state.detailInfoState,t=n.props.currentProject;return Promise.all([(0,B.fetchCitedResourceReference)(t.id,e.code),(0,B.fetchCitingResourceReference)(t.id,e.code)]).then((function(e){n.setState({citedSources:e[0].data,citingSources:e[1].data})}))},n.handleAttentionChange=function(e){n.changeAttributes({type:"watchers",value:e})},n.handleSelfChange=function(e){var t=n.props,a=t.currentProject,i=t.user,r=n.state,o=r.detailInfoState,s=r.watchers;e?(0,B.watchIssue)(a.id,o.code).then((function(){n.setState({watchers:[].concat((0,d.default)(s),[i])}),(0,U.success)((0,y.t)("\u66f4\u65b0\u6210\u529f")),n.callback(),n.getActivityList()})):(0,B.unwatchIssue)(a.id,o.code).then((function(){n.setState({watchers:(0,d.default)(s.filter((function(e){return e.id!==i.id})))}),(0,U.success)((0,y.t)("\u66f4\u65b0\u6210\u529f")),n.callback(),n.getActivityList()}))},n.handleDeleteSubtask=function(){var e,t,a,i=n.props,r=i.currentProject,o=i.projectPath,s=i.refreshCallback,l=i.location,c=l.pathname,u=l.query,d=i.isDetail,f=i.router,p=i.callFrom,m=n.state.detailInfoState,h=(0,re.currentListPath)(c);d&&("REQUIREMENT"===(null===(e=m.parent)||void 0===e?void 0:e.type)&&(h="requirements"),"MISSION"===(null===(t=m.parent)||void 0===t?void 0:t.type)&&(h="assignments"),"DEFECT"===(null===(a=m.parent)||void 0===a?void 0:a.type)&&(h="bug-tracking"));(0,M.deleteSubtask)(r.id,m.code).then((function(){var e,t;((0,U.success)((0,y.t)("\u5220\u9664\u6210\u529f")),"outer"===p)?(0,ge.emitFromPM)({type:"closeSlide"}):/detail\/subissues/.test(c)?f.push({pathname:"".concat(o,"/").concat(Qe[null===(e=m.parent)||void 0===e?void 0:e.type],"/issues/").concat(null===(t=m.parent)||void 0===t?void 0:t.code,"/detail"),query:u}):f.push({pathname:"".concat(o,"/".concat(h,"/issues")),query:u});n.setState({isFilePreviewVisible:!1}),s&&s(!0)}))},n.cancelParentSelector=function(){n.setState({parentSelectorStatus:!1})},n.onIsFullWidthChange=function(e){n.setState({isFullWidth:e})},n.toggleFullScreenStatus=function(){var e=!n.state.isFullScreen;n.setState({isFullScreen:e}),(0,Re.setIsSlideFullScreen)(e),n.props.onFullScreenChange&&n.props.onFullScreenChange(e)},n.handleFullScreenKey=function(e){n.state.isDesEditing||e.target===document.body&&"f"===e.key.toLowerCase()&&n.toggleFullScreenStatus()},n.state={tooltipTitle:(0,y.t)("\u590d\u5236\u94fe\u63a5"),noHoverIcon:!1,detailInfoState:e.detailInfo,references:{},activities:[],description:e.detailInfo.descriptionMarkup,isDescriptionEmpty:!e.detailInfo.description.replace(/\n|\s/g,""),markdown:e.detailInfo.description,slateRaw:e.detailInfo.slateRaw,attachmentsState:n.combineThirdLinks(e.detailInfo.files,e.detailInfo.thirdLinks),isFilePreviewVisible:void 0,previewFileID:void 0,attributes:{assignee:void 0,priority:void 0,requirementType:void 0,defectType:void 0,module:void 0,dueDate:void 0,startDate:void 0,workingHours:void 0,labels:[],watchers:[],fields:{},progress:void 0,defectKindIds:[],defectPhaseId:void 0,estimatedWorkHour:void 0,wuKongReloadId:void 0,serialNum:void 0,defectSourceId:void 0,rblkhxgProperty:void 0,rblsjxgProperty:void 0,systemsId:void 0,participants:[]},assignee:e.detailInfo.assignee,watchers:e.detailInfo.watchers||[],citedSources:{},citingSources:{},isInited:!1,isHistoryRecordVisible:!1,currentLogId:void 0,parentSelectorStatus:!1,isSensitive:!1,showDeleteModal:!1,showSensitive:!1,isShowApproveCreate:!1,issueReviewList:[],activitiesTab:"ALL",activeLogTab:"activity",isCommentSticky:!1,isCommentAbsBottom:!1,isScrolled:!1,inputFocus:!1,isDesEditing:!1,isFullScreen:(0,Re.getIsSlideFullScreen)(),isFullWidth:!0,isShowItemPlaceholder:{description:!0,codeRepo:!1,reference:!1},isRender:{codeRepo:!1,reference:!1,logs:!1,comment:!1},isRenderAll:!1,manHourRecords:[],delFileId:void 0,showDeleteConfirmModal:!1,isElemScroll:!1,scrollControl:Date.now(),meeting:void 0,isEdittingCommentModalVisible:!1,codeRepoRelationOpened:!1,associatedCodeRepos:[],availableCodeRepos:[],isAssociatedCodeRepoFocus:!1,controlHideButtonActionMore:0,controlHideOptionMore:0,codeManagementOpen:!1,testManagementOpen:!1,pageId:e.detailInfo.pageId||void 0,historyId:void 0,controlCaculatePos:0,isDescriptionBtnFixed:!1,identity:"",slotVisible:!1,defectSource:e.detailInfo.defectSource},n.onVisibleChange=n.onVisibleChange.bind((0,h.default)(n)),n.onCopyClick=n.onCopyClick.bind((0,h.default)(n)),n.updateDescription=n.updateDescription.bind((0,h.default)(n)),n.onNameChange=n.onNameChange.bind((0,h.default)(n)),n.callback=n.callback.bind((0,h.default)(n)),n.onParentUpdate=n.onParentUpdate.bind((0,h.default)(n)),n.postComment=n.postComment.bind((0,h.default)(n)),n.deleteComment=n.deleteComment.bind((0,h.default)(n)),n.fileUploadSpec=n.fileUploadSpec.bind((0,h.default)(n)),n.onFileDropSuccessSpec=n.onFileDropSuccessSpec.bind((0,h.default)(n)),n.onFileDropDeleteSpec=n.onFileDropDeleteSpec.bind((0,h.default)(n)),n.onFileDropCancelSpec=n.onFileDropCancelSpec.bind((0,h.default)(n)),n.onFileDropFailSpec=n.onFileDropFailSpec.bind((0,h.default)(n)),n.filePreviewHideSpec=n.filePreviewHideSpec.bind((0,h.default)(n)),n.previewItem=n.previewItem.bind((0,h.default)(n)),n.handleDelInPreviewFileSpec=n.handleDelInPreviewFileSpec.bind((0,h.default)(n)),n.onStatusChange=n.onStatusChange.bind((0,h.default)(n)),n.submitTitleChange=n.submitTitleChange.bind((0,h.default)(n)),n.changeAttributes=n.changeAttributes.bind((0,h.default)(n)),n.onRemoveReference=n.onRemoveReference.bind((0,h.default)(n)),n.toggleRecord=n.toggleRecord.bind((0,h.default)(n)),n.viewRecord=n.viewRecord.bind((0,h.default)(n)),n.fetchManHourRecordsAndFetchSpecData=n.fetchManHourRecordsAndFetchSpecData.bind((0,h.default)(n)),n.commentEditorRef=null,n.intoDesCount=0,n.intoCommentCount=0,n.commentStickyContainerRef=null,n.onScroll=n.onScroll.bind((0,h.default)(n)),n.desComp=null,n.headerRef=S.default.createRef(),n.hiddenHeaderRef=S.default.createRef(),n.detailBodyRef=S.default.createRef(),n.desComp=null,n.attechmentRef=S.default.createRef(),n.changeTabFn=null,n.editorRef=S.default.createRef(),n.elemShow(),n.handleDeleteAttachmentConfirm=n.handleDeleteAttachmentConfirm.bind((0,h.default)(n)),n.handleEditCommentCallback=n.handleEditCommentCallback.bind((0,h.default)(n)),n}return(0,m.default)(a,[{key:"headerRender",value:function(e){var t,a,n,i=this,r=this.state,o=r.detailInfoState,s=r.watchers,l=r.isSensitive,c=r.showDeleteModal,u=r.showSensitive,d=r.isDesEditing,f=r.isFullWidth,p=r.inputFocus,m=r.isFullScreen,h=!e&&this.state.isScrolled,v=this.props,g=v.projectPath,E=v.isDetail,b=v.affairList,I=v.isPermissible,T=v.iterationCode,C=v.user,w=v.router,O=v.location,R=O.pathname,j=O.query,k=v.callFrom,N=v.isSensitiveAdmin,L=v.currentProject,F=v.detailInfo,_="outer"===k,M=L.name,x=b&&b.findIndex((function(e){return e.code===o.code}))+1,B=1===x,U=x===(b&&b.length),W=b&&b.find((function(e){return e.code===o.code})),Y=I([{function:X.ProjectPermissionFunction.PROJECT_ISSUE,action:X.ProjectPermissionAction.UPDATE}]),H=I([{function:X.ProjectPermissionFunction.PROJECT_ISSUE,action:X.ProjectPermissionAction.DELETE}]),V=(0,re.currentListPath)(R);/detail\/subissues/.test(R)?t="".concat(g,"/").concat(Qe[null===(a=o.parent)||void 0===a?void 0:a.type],"/issues/").concat(null===(n=o.parent)||void 0===n?void 0:n.code,"/detail/subissues/"):t=T?"".concat(g,"/iterations/").concat(T,"/issues/"):"".concat(g,"/").concat(V,"/issues/");var G=(0,Ne.getAuidtPaymentState)(),K={DESCRIPTION:Y,UPLOAD:Y,LINK_CODE_REPO:this.state.codeRepoRelationOpened&&Y,REFERENCES:!0,ISSUE_REVIEW:this.state.issueReviewOpen&&Y},z=Ze({},d?{DESCRIPTION:""}:{}),q={};e&&(q.position="static",q.visibility="hidden");var Z=(0,Ue.getSlotContext)(F,L.id);return S.default.createElement("div",{className:(0,Q.default)(P.default.specHeader,E&&P.default.detail,this.state.inputFocus&&h&&P.default.scrollFocus,h&&!d&&P.default.fixed,h&&P.default.noBorder),ref:e?this.hiddenHeaderRef:this.headerRef,style:q},S.default.createElement("div",{className:(0,Q.default)(P.default.main,h?P.default.fixed:"",m?P.default.fullScreenMain:"",E?P.default.detail:"")},S.default.createElement("div",{className:(0,Q.default)(P.default.headerPanelMenuWrapper,p&&P.default.focus)},this.renderParentsInfo(),S.default.createElement("div",{className:(0,Q.default)(P.default.menus,h&&p&&P.default.hide)},S.default.createElement(ie.default,{type:"SUBTASK",projectID:L.id,watchers:s||[],onChange:this.handleAttentionChange,user:C,showTooltip:!0,readOnly:!Y,handleSelfChange:this.handleSelfChange}),!E&&b&&!_&&W&&S.default.createElement("div",{className:P.default.divideLine}),!E&&b&&!_&&W&&S.default.createElement("div",{className:"".concat(P.default.preButton," ").concat(B&&P.default.disabled),title:(0,y.t)("\u4e0a\u4e00\u4e2a\u4e8b\u9879"),onClick:function(){if(!B){var e=b[x-2].code;w.push({pathname:"".concat(t).concat(e),query:Ze({},j)})}}}),!E&&b&&!_&&W&&S.default.createElement("div",{className:"".concat(P.default.nextButton," ").concat(U&&P.default.disabled),title:(0,y.t)("\u4e0b\u4e00\u4e2a\u4e8b\u9879"),onClick:function(){if(!U){var e=b[x].code;w.push({pathname:"".concat(t).concat(e),query:Ze({},j)})}}}),S.default.createElement("div",{className:P.default.divideLine}),!E&&S.default.createElement(D.TooltipTrigger,{title:this.state.isFullScreen?(0,y.t)("\u5207\u6362\u5230\u4fa7\u680f(F)"):(0,y.t)("\u5168\u5c4f(F)")},S.default.createElement("div",{className:this.state.isFullScreen?P.default.cancelFullScreenBtn:P.default.toFullScreenBtn,onClick:this.toggleFullScreenStatus})),!E&&S.default.createElement(D.TooltipTrigger,{title:(0,y.t)("\u5728\u65b0\u6807\u7b7e\u9875\u6253\u5f00")},S.default.createElement("div",{className:P.default.openNewLink,onClick:function(){window.open("".concat(g,"/subtasks/issues/").concat(o.code,"/detail"),"_blank")}})),S.default.createElement(ae.default,{onChangeParent:this.showRequirementSelector,onDelete:this.handleDeleteSubtask,allowDelete:H,allowUpdate:Y,isSensitiveAdmin:N,isSensitive:l,premiumVersion:!G||this.props.payed,operateSensitive:this.operateSensitive,showSensitive:u,isShowFullWidthOption:E||!E&&this.state.isFullScreen,viewDescriptionVersion:function(){return i.setState({isHistoryRecordVisible:!0})},copyTitle:o.name,copyLink:"".concat(window.location.origin).concat(g,"/subtasks/issues/").concat(o.code,"/detail"),isFullWidth:f,onIsFullWidthChange:this.onIsFullWidthChange,controlHideMore:this.state.controlHideOptionMore,onClickTrigger:function(){i.setState({controlHideButtonActionMore:Date.now()})},slotCallback:function(e){return i.setState({identity:e,slotVisible:!0})}}),S.default.createElement(de.default,{title:(0,y.t)("\u786e\u5b9a\u8981\u53d6\u6d88\u6807\u8bb0"),show:c,onConfirm:this.cancelMark,onClose:function(){i.setState({showDeleteModal:!1})}}))),this.renderTitle(Y,!1,e),(!h||h&&!p)&&S.default.createElement(ye.default,{projectType:"SCRUM",issueType:A.ISSUE_TYPE.REQUIREMENT,isShow:K,onBtnClick:this.onBtnClick,isDisabled:z,uploadProps:{disabled:!Y,currentAttachmentNum:this.state.attachmentsState.length,onHandleAttachments:this.fileUploadSpec},issueStatus:o.issueStatus.type,issueCode:o.code,projectName:M,userId:C.id,projectPath:g,posType:h,isLoaded:!0,controlHideMore:this.state.controlHideButtonActionMore,slotContext:Z,onClickTrigger:function(){i.setState({controlHideOptionMore:Date.now()})}})))}},{key:"descriptionBtnClicked",value:function(){var e=this,t=this.editComp;t.show().then((function(){e.setState({isShowItemPlaceholder:Ze(Ze({},e.state.isShowItemPlaceholder),{},{description:!1})},(function(){var a,n,i;null!==(a=e.scrollRef)&&void 0!==a&&a.current&&null!==(n=t.containerRef)&&void 0!==n&&n.current&&null!==(i=e.headerRef)&&void 0!==i&&i.current&&(0,ee.scrollIntoView)(e.scrollRef.current,t.containerRef.current,-e.headerRef.current.offsetHeight-26),t.onHandle()}))}))}},{key:"fetchIssueReviewList",value:function(e){var t=this,a=this.props,n=a.currentProject,i=a.detailInfo;(0,Le.fetchIssueReviewList)(n.id,i.code).then((function(a){var n=a.data;t.setState({issueReviewList:n},(function(){e&&e(n)}))}))}},{key:"issue_reviewBtnClicked",value:function(){this.setState({isShowApproveCreate:!0})}},{key:"link_code_repoBtnClicked",value:function(){var e=this;(0,ee.scrollRelatedToTopMenu)("associated-code-repo",200,this.scrollRef.current),this.setState({isShowItemPlaceholder:Ze(Ze({},this.state.isShowItemPlaceholder),{},{codeRepo:!0})},(function(){return e.setState({isAssociatedCodeRepoFocus:!0})}))}},{key:"getAssociatedCodeRepos",value:function(){var e=this,t=this.props.currentProject,a=this.state.detailInfoState.code;return(0,x.fetchAssociatedCodeRepos)(t.name,a).then((function(t){var a=t.data;e.setState({associatedCodeRepos:a.map((function(e){return Ze({},e.depot)}))})})).finally((function(){return e.dataLoad("codeRepo")}))}},{key:"mouseLeave",value:function(e){this["des"===e?"intoDesCount":"intoCommentCount"]=0,this.setState({notUpload:!1})}},{key:"render",value:function(){var e=this,t=this.state,a=t.detailInfoState,n=t.markdown,i=t.slateRaw,r=t.description,o=t.activities,s=t.attachmentsState,l=t.isFilePreviewVisible,c=t.previewFileID,u=t.citedSources,d=t.citingSources,f=t.isInited,p=t.isHistoryRecordVisible,m=t.currentLogId,h=t.parentSelectorStatus,v=t.activitiesTab,g=t.isCommentSticky,E=t.isFullWidth,b=t.isShowItemPlaceholder,I=t.isRender,T=t.isRenderAll,C=t.activeLogTab,w=t.manHourRecords,D=t.showDeleteConfirmModal,O=t.isEdittingCommentModalVisible,j=t.pageId,L=t.historyId,F=t.isDescriptionEmpty,_=t.minHeight,M=t.isDescriptionBtnFixed,x=t.identity,B=t.slotVisible,U=this.props,W=U.expanded,H=U.isDetail,G=U.currentProject,z=U.projectPath,q=U.user,Z=U.enterpriseGlobalKey,J=U.isPermissible,$=U.autoshowComment,ee=U.domID,ae=U.location,ne=U.subtaskSchemeFieldArchives,ie=U.detailInfo,re=U.branchsInfo,se=G.name,le=G.id,ce=(0,Ue.getSlotContext)(ie,le),ue=J([{function:X.ProjectPermissionFunction.PROJECT_ISSUE,action:X.ProjectPermissionAction.UPDATE}]),de=void 0!==ne&&Object.values(ne).filter((function(e){return"HOUR_RECORD"===e.issueField.type})).length>0,fe=g?{minHeight:"".concat(_,"px"),position:"relative"}:{position:"relative"},pe=this.state.issueReviewOpen&&this.state.issueReviewList.length>0,me=[];I.logs&&me.push({text:(0,y.t)("\u6d3b\u52a8\u65e5\u5fd7"),value:We.MATTER_TABS_TYPE.ACTIVITY}),de&&me.push({text:(0,y.t)("\u5de5\u65f6\u65e5\u5fd7"),value:We.MATTER_TABS_TYPE.WORK}),pe&&me.push({text:(0,y.t)("\u5ba1\u6279"),value:We.MATTER_TABS_TYPE.APPROVAL});var he=I.comment&&C!==We.MATTER_TABS_TYPE.WORK&&C!==We.MATTER_TABS_TYPE.APPROVAL&&o.length>0&&v!==We.ACTIVITIES_TAB.WITHOUT_COMMENT;return S.default.createElement(je.default.Provider,{value:{scrollControl:this.state.scrollControl}},S.default.createElement(Se.default,{currentAttachmentNum:s.length,onHandleAttachments:this.fileUploadSpec,notUpload:this.state.notUpload&&(this.state.isDesEditing||this.state.isCommentEditing)||O,notUploadElems:this.getNotUploadElems(),onIntoUploadElems:function(){return e.setState({notUpload:!0})}},S.default.createElement("div",{className:P.default.specWrapper,onScroll:this.onAttrScroll},S.default.createElement("div",{className:(0,Q.default)(P.default.specDetail,H?P.default.isDetail:"",E&&P.default.isFullWidth)},this.headerRender(),this.headerRender(!0),S.default.createElement("div",{className:P.default.specMain,ref:this.scrollRef},S.default.createElement("div",{style:fe,className:(0,Q.default)(P.default.detailWrapper,H&&P.default.isDetail)},S.default.createElement("div",{className:"".concat(P.default.detailBody," ").concat(!W&&P.default.isSingleColumned," ").concat(H&&P.default.isDetail," ").concat(E&&P.default.isFullWidth),ref:this.detailBodyRef,onClick:function(){return e.setState({controlHideButtonActionMore:Date.now()})}},S.default.createElement("div",{className:"".concat(P.default.mainWrapper," ").concat(W&&P.default.mainExpanded)},S.default.createElement("div",{onDragEnter:this.dragEnterDes,onDragLeave:this.dragLeaveDes,onMouseLeave:this.mouseLeaveDes,ref:this.editorRef},S.default.createElement(R.default,{editorType:ie.issueDescriptionType,issueId:ie.id,isInited:f,scrollRef:this.scrollRef,readOnly:!ue,code:a.code,autoSaveKey:"".concat(se,"_SUBTASK_DETAIL_DESCRIPTION-").concat(a.code),enterpriseGlobalKey:Z,currentProject:G,markdown:n,slateRaw:i,description:r,updateDescription:this.updateDescription,refreshActivity:function(){return e.getActivityList()},updatePageId:function(t){return e.setState({pageId:t})},historyId:L,flashAnchor:this.props.flashAnchor,domID:ee,getThis:this.getEditComp,editStatusChanged:this.editStatusChanged,isShowPlaceholder:F&&b.description,location:ae,userId:q.id,pageId:j,setCommentPosition:this.setCommentPosition,onLoad:function(t){e.dataLoad("description"),t&&e.setState({isDescriptionEmpty:t.isEmpty})},isDescriptionBtnFixed:M})),s.length>0&&S.default.createElement("div",{className:P.default.sectionWrapper,ref:this.attechmentRef},S.default.createElement(oe.ThemeConsumer,null,(function(t){var n=t.hiddenFolderDirs;return S.default.createElement(K.default,{expanded:W,disabled:!ue,attachments:s,enterpriseGlobalKey:Z,currentProjectName:se,currentProjectID:le,currentAttachmentNum:s.length,issueCode:a.code,onHandleAttachments:e.fileUploadSpec,uploadFileSuccess:e.onFileDropSuccessSpec,uploadFileFailed:e.onFileDropFailSpec,uploadFileDelete:e.onFileDropDeleteSpec,uploadFileCancel:e.onFileDropCancelSpec,dir:n&&n[A.HIDDEN_FILE_TYPE.SUB_TASK]&&n[A.HIDDEN_FILE_TYPE.SUB_TASK].file_id,previewItemHandle:e.previewItem,userID:q.id})}))),this.state.codeRepoRelationOpened&&I.codeRepo&&(this.state.associatedCodeRepos.length>0||b.codeRepo)&&S.default.createElement("div",{className:P.default.sectionWrapper},S.default.createElement(Oe.default,{projectPath:z,allowUpdate:ue,list:this.state.associatedCodeRepos,searchResList:this.state.availableCodeRepos,isFocus:this.state.isAssociatedCodeRepoFocus,onFocusChanged:function(t){return e.setState({isAssociatedCodeRepoFocus:t})},onSearch:this.getCodeRepos,onAssociate:this.associateCodeRepo,onCancelAssociate:this.cancelAssociateCodeRepo,onCancel:this.cancelCodeRepo,isDetail:H})),I.reference&&(Object.keys(u).length>0||Object.keys(d).length>0||b.reference)&&S.default.createElement("div",{className:P.default.sectionWrapper},S.default.createElement(k.default,{flashAnchor:function(t){e.setState({activeLogTab:"activity"},(function(){e.props.flashAnchor(t)}))},currentProject:G,citedSources:u,citingSources:d,markdown:n,autoToggleComment:this.referencesBtnClicked,code:a.code,onRemoveReference:this.onRemoveReference})),(null===re||void 0===re?void 0:re.length)>0&&S.default.createElement(He.default,{branchsInfo:re,headerTitle:"\u5173\u8054\u4ee3\u7801\u4ed3\u5e93",projectPath:z}),me.length>=2&&S.default.createElement(S.default.Fragment,null,S.default.createElement("div",{id:"activity-log-tab"}),S.default.createElement(be.default,{tabs:me,activeTab:C,onChange:this.changeActivityLogTab})),I.logs&&S.default.createElement(S.default.Fragment,null,"activity"===C&&this.renderActivity(de),de&&"work"===C&&S.default.createElement(Ee.default,{detailInfo:a,records:w,onDelete:this.deleteManhourRecord,reloadData:this.fetchManHourRecordsAndFetchSpecData,allowUpdate:ue,user:q})),pe&&"approval"===C&&S.default.createElement("div",{id:"issue-review-list"},S.default.createElement(Fe.default,{isDetail:H,list:this.state.issueReviewList,onItemChange:this.handleReviewListChanged,onShowCreate:function(){e.setState({isShowApproveCreate:!0})},onShowDetail:function(t){e.setState({issueReviewCode:t})},allowUpdate:ue})))))),l&&S.default.createElement(Y.default,{isShown:l,previewFiles:s,onFileViewerHide:this.filePreviewHideSpec,enterpriseGlobalKey:Z,currentId:le,currentProjectName:se,currentFileId:c,onHandleDelAttachment:this.handleDeleteAttachmentConfirm}),p&&S.default.createElement(te.default,{show:p,closeHandle:this.toggleRecord,enterpriseGlobalKey:Z,currentProject:G,issueType:A.HISTORY_RESCORDS[a.type],parentDescriptionType:a.issueDescriptionType,issueCode:a.code,pageId:j,currentLogId:m,handleUpdate:this.renewDescription,allowUpdate:ue}),h&&S.default.createElement(V.default,{show:!0,issueCode:a.code,projectID:le,closeHandle:this.cancelParentSelector,isModification:!0,currentParentCode:a.parent?a.parent.code:0,onUpdate:this.onParentUpdate,handleSelect:this.onParentUpdate,currentProject:G}),S.default.createElement(Ce.default,{show:D,type:"ATTACHMENT",text:(0,y.t)("\u786e\u5b9a\u8981\u5220\u9664\u5417\uff1f"),onConfirm:function(){e.handleDelInPreviewFileSpec()},onClose:function(){e.setState({showDeleteConfirmModal:!1})}}),this.state.isShowApproveCreate&&S.default.createElement(_e.default,{fromIssueId:this.props.detailInfo.id,onItemChange:function(){return e.handleReviewListChanged(!0)},onCancel:function(){return e.setState({isShowApproveCreate:!1})}}),this.state.issueReviewCode&&S.default.createElement(Me.default,{allowUpdate:ue,detailCode:this.state.issueReviewCode,onDetailCodeChange:function(t){e.setState({issueReviewCode:t})},onCancel:function(){e.setState({issueReviewCode:void 0},(function(){e.handleReviewListChanged()}))}}),S.default.createElement(xe.default,{slotVisible:B,identity:x,context:ce,onClose:function(){return e.setState({slotVisible:!1})}}),!T&&S.default.createElement(Te.default,null),S.default.createElement("div",{id:"bottom"}),he&&S.default.createElement(N.default,{autoToggleComment:this.props.autoToggleComment,autoshowComment:!!$[a.code],expanded:W,currentProject:G,avatar:q.avatar,issueCode:a.code,onPostComment:this.postComment,isCommentSticky:g,isCommentAbsBottom:this.state.isCommentAbsBottom,onEditStatusChanged:function(t,a){e.commentEditorRef=a,e.setState({isCommentEditing:t})},onDragEnterEditor:this.dragEnterComment,onDragLeaveEditor:this.dragLeaveComment,onMouseLeaveEditor:this.mouseLeaveComment,isDetail:H,userID:q.id,isDescriptionBtnFixed:M,onRef:function(t){return e.commentStickyContainerRef=t}})),this.renderAttributes())))}},{key:"isAssignAttrRequired",value:function(e,t){if(!e||!t)return!1;var a=!1;return Object.keys(e).forEach((function(n){var i=e[n]&&e[n].issueField;i&&i.type===t&&(a=e[n].required)})),a}},{key:"renderAttributes",value:function(){var e=this,t=this.props,a=t.isDetail,n=t.isPermissible,i=t.expanded,r=t.subtaskSchemeFieldArchives,o=t.subtaskUpdateFieldIDs,s=t.currentProject,l=t.bugTypes,c=t.requirementTypes,u=t.moduleSchemes,d=t.labels,f=t.addLabel,p=t.detailInfo,m=t.sourceTypes,h=this.state,v=h.detailInfoState,g=h.attributes,E=h.assignee,b=h.watchers,I=h.isFullWidth,T=h.isInited,C=h.meeting,D=h.defectSource,O=(0,Ue.getSlotContext)(p,s.id),R=n([{function:X.ProjectPermissionFunction.PROJECT_ISSUE,action:X.ProjectPermissionAction.UPDATE}]);return S.default.createElement("div",{className:(0,Q.default)(P.default.specAttribute,a||!a&&this.state.isFullScreen?P.default.isDetail:P.default.isSpec,I&&P.default.isFullWidth)},"outer"===this.props.callFrom&&S.default.createElement("div",{className:(0,Q.default)(P.default.issueProperty,a&&P.default.isDetail)},S.default.createElement("div",{className:(0,Q.default)(P.default.label,a&&P.default.isDetail)},(0,y.t)("\u7814\u53d1\u7a7a\u95f4")),S.default.createElement("div",{className:(0,Q.default)(P.default.customBar,a&&P.default.isDetail)},S.default.createElement(we.default,{name:this.props.currentProject.display_name,icon:this.props.currentProject.icon,jumpUrl:this.props.currentProject.project_path}))),void 0!==C&&S.default.createElement("div",{className:(0,Q.default)(P.default.meetingNotify,C.status===A.MEETING_STATUS.processing?P.default.processing:P.default.waiting)},S.default.createElement("div",{className:P.default.title},"QUICK"===C.type?"".concat(C.creator.name).concat((0,y.t)("\u7684\u5feb\u901f\u4f1a\u8bae")):C.subject),S.default.createElement("div",{className:P.default.desc},(0,_.timeFormat)(C.startTime,"MM\u6708DD\u65e5"),S.default.createElement("span",{className:P.default.time},(0,_.timeFormat)(C.startTime,"HH:mm"),S.default.createElement("span",{className:P.default.line},"-"),(0,_.timeFormat)(C.endTime,"HH:mm")),S.default.createElement("div",{className:(0,Q.default)(P.default.enterMeeting,a?P.default.isDetail:""),onClick:function(){window.open(C.joinUrl,"_blank")}},(0,y.t)("\u8fdb\u5165\u4f1a\u8bae")))),S.default.createElement("div",{className:(0,Q.default)(P.default.issueProperty,a&&P.default.isDetail)},S.default.createElement("div",{className:(0,Q.default)(P.default.label,a&&P.default.isDetail)},(0,y.t)("\u72b6\u6001")),S.default.createElement(w.default,{className:(0,Q.default)(P.default.step,P.default.customBar,a&&P.default.isDetail),projectID:s.id,project:s,issueCode:v.code,value:v.issueStatus,onSelect:this.onStatusChange,disabled:!R,isDetail:a,hoverControlArrow:!0,labelSize:"default"})),S.default.createElement("div",{className:(0,Q.default)(P.default.issueProperty,a&&P.default.isDetail)},S.default.createElement("div",{className:(0,Q.default)(P.default.label,a&&P.default.isDetail,this.isAssignAttrRequired(r,A.BASE_FIELD_TYPE.ASSIGNEE)&&P.default.required)},(0,y.t)("\u5904\u7406\u4eba")),S.default.createElement("div",{className:(0,Q.default)(P.default.customBar,a&&P.default.isDetail)},S.default.createElement(ne.default,{disabled:!R,inProject:!0,projectID:s.id,value:g.assignee||null,onSelect:function(t){return e.changeAttributes({type:"assignee",value:t.id})},onClear:function(){return e.changeAttributes({type:"assignee"})},triggerExtraProps:{initialSelectedItem:E},dropdownStyle:P.default.dropdownStyle,triggerStyle:P.default.triggerStyle,panelCustomStyle:P.default.panelCustomStyle}))),S.default.createElement("div",{className:(0,Q.default)(P.default.issueProperty,a&&P.default.isDetail)},S.default.createElement("div",{className:(0,Q.default)(P.default.label,a&&P.default.isDetail,this.isAssignAttrRequired(r,A.BASE_FIELD_TYPE.PARTICIPANT)&&P.default.required)},(0,y.t)("\u53c2\u4e0e\u4eba")),S.default.createElement("div",{className:(0,Q.default)(P.default.customBar,a&&P.default.isDetail)},S.default.createElement(ne.default,{disabled:!R,value:g.participants.map((function(e){return e.id})),inProject:!0,isMultiple:!0,projectID:s.id,onSelect:function(t){var a=[];a=g.participants.find((function(e){return e.id===t.id}))?g.participants.filter((function(e){return t.id!==e.id})):(0,Ye.default)(g.participants,t),e.changeAttributes({type:"participants",value:a})},onClear:function(){return e.changeAttributes({type:"participants",value:[]})},triggerExtraProps:{initialSelectedItem:g.participants},dropdownStyle:P.default.dropdownStyle,triggerStyle:P.default.triggerStyle,panelCustomStyle:P.default.panelCustomStyle}))),S.default.createElement("div",{className:P.default.splitLine,style:{marginTop:"16px"}}),T&&S.default.createElement(G.default,{user:this.props.user,detailInfo:this.props.detailInfo,expanded:i,className:P.default.issueProperties,isCreate:!1,schemeFieldArchives:r,fieldIds:o,issueType:"REQUIREMENT",onChange:this.changeAttributes,customAttributes:g,assignee:E,watchers:b,isFromDetailPage:a||i,isDetailPage:a,permissionFunction:X.ProjectPermissionFunction.PROJECT_ISSUE,isPermissible:n,projectID:s.id,currentProject:s,bugTypes:l,requirementTypes:c,moduleSchemes:u,labels:d,addLabel:f,activities:this.state.activities,productName:D&&"production"===D.valueType?D.name:"",sourceTypes:m,onManHourUpdate:function(){e.fetchManHourRecords().then((function(){e.changeAttributes({type:""})}))},onForwardLogs:function(){(0,ee.scrollRelatedToTopMenu)("activity-log-tab",200,e.scrollRef.current),e.setState({activeLogTab:"work"})},portalProps:{toRight:this.getDropdownPortalToRight(),portalWrapStyle:{zIndex:1099},isScroll:this.state.isElemScroll,resetIsScroll:function(){e.setState({isElemScroll:!1})}},meetingCallback:function(t){e.setState({meeting:t}),e.getActivityList()}}),S.default.createElement("div",{className:(0,Q.default)(P.default.createTime,P.default.creatorInfo),title:"".concat(v.creator.name).concat((0,y.t)(" \u521b\u5efa\u4e8e ")).concat((0,F.default)((0,_.timeFormat)(v.createdAt,"YYYY-MM-DD HH:mm:ss")).fromNow())},v.creator.name," ",(0,y.t)("\u521b\u5efa\u4e8e")," ",(0,F.default)((0,_.timeFormat)(v.createdAt,"YYYY-MM-DD HH:mm:ss")).fromNow()),S.default.createElement(Be.default,{context:O}))}},{key:"onScroll",value:function(e){var t=this.state,a=t.isDesEditing,n=t.isDescriptionBtnFixed;if(a){var i,r,o=this.scrollRef.current.scrollTop,s=this.scrollRef.current.getBoundingClientRect().height,l=this.editorRef.current.getBoundingClientRect().height,c=(null===(i=this.commentStickyContainerRef)||void 0===i||null===(r=i.current)||void 0===r?void 0:r.offsetHeight)||0;n=l>=s+o-this.headerRef.current.offsetHeight-c}this.setState({scrollControl:Date.now(),isDescriptionBtnFixed:n}),clearTimeout(this.scrollRunId),e.stopPropagation(),this.scrollRunId=setTimeout(this.doScroll,50)}},{key:"componentDidMount",value:function(){var e=this.props,t=e.user,a=e.watermark,n=e.detailInfo,i=e.payed,r=e.isDetail,o=e.isSensitiveAdmin;this.initAttributesData(n),this.getBasicInfo(),n.pageId?this.state.isDescriptionEmpty&&this.dataLoad("description"):this.dataLoad("description"),this.scrollRef.current&&this.scrollRef.current.addEventListener("scroll",this.onScroll,!1);var s=(0,Ne.getAuidtPaymentState)();if(!(0,Ne.getWatermarkPaymentState)()||i){var l=(0,le.getText)(t);(0,le.watermarkService)(a,l,r)}if(!s||i){var c,u,d="REQUIREMENT"===(null===(c=n.parent)||void 0===c?void 0:c.type)||"MISSION"===(null===(u=n.parent)||void 0===u?void 0:u.type);d&&this.trackEvent(n.code),o&&d&&this.getSensitiveMessage(n.code)}document.addEventListener("keyup",this.handleFullScreenKey)}},{key:"handleInput",value:function(e){var t=(0,W.default)(this.state.detailInfoState,(function(t){t.name=e}));this.setState({detailInfoState:t},this.submitTitleChange)}},{key:"componentWillUnmount",value:function(){var e=this.props,t=e.payed,a=e.isDetail;(0,Ne.getWatermarkPaymentState)()&&!t||(0,le.removeWatermark)(a),document.removeEventListener("keyup",this.handleFullScreenKey)}},{key:"componentDidUpdate",value:function(e,t){var a=this.props,n=a.params,i=a.detailInfo,r=a.issueCode,o=e.params,s=e.detailInfo;t.controlCaculatePos,this.state.controlCaculatePos;(0,H.default)(o,n)||n.subtaskCode&&o.subtaskCode!==n.subtaskCode&&this.props.getSubtaskScheme(),(0,H.default)(i,s)||this.updateDetailInfo(r,i)}},{key:"updateDetailInfo",value:function(e,t){var a=this,n=(0,Ne.getAuidtPaymentState)();this.setState(Ze({detailInfoState:t,attachmentsState:(0,d.default)(t.files)},this.isDeleteInFilePreview?{isFilePreviewVisible:!1}:null),(function(){a.isDeleteInFilePreview=!1,a.initAttributesData(t),!a.props.isSensitiveAdmin||n&&!a.props.payed||a.getSensitiveMessage(t.code)}))}},{key:"combineThirdLinks",value:function(e,t){if(!t)return e;var a=t.map((function(e){var t="MODAO"===e.thirdType,a="CODESIGN"===e.thirdType,n="";return t&&(n=e.title||(0,y.t)("\u58a8\u5200\u9644\u4ef6")),a&&(n=e.title),Ze(Ze({},e),{},{isModao:t,isCodesign:a,fileId:e.id,name:n,preview:t&&e.link})})),n=[].concat((0,d.default)(e),(0,d.default)(a));return n.sort((function(e,t){return(e.createdAt||e.created_at)-(t.createdAt||t.created_at)})),n}},{key:"initAttributesData",value:function(e){var t,a,n,i;this.setState({attributes:{assignee:e.assignee&&e.assignee.id||void 0,priority:void 0!==e.priority?e.priority:void 0,defectType:e.defectType&&e.defectType.id||void 0,projectModule:e.projectModule&&e.projectModule.id||void 0,requirementType:e.requirementType&&e.requirementType.id||void 0,startDate:e.startDate||void 0,dueDate:e.dueDate||void 0,labels:e.labels&&!!e.labels.length&&e.labels.map((function(e){return e.id}))||[],watchers:e.watchers&&!!e.watchers.length&&e.watchers.map((function(e){return e.id}))||[],workingHours:e.workingHours,fields:e.issueSchemeFields||{},progress:e.progress,defectKindIds:e.defectKinds&&e.defectKinds.length&&e.defectKinds.map((function(e){return e.id+""}))||[],defectPhaseId:e.defectPhase&&e.defectPhase.id+""||void 0,estimatedWorkHour:(null===e||void 0===e?void 0:e.estimatedWorkHour)||void 0,defectSourceId:(null===e||void 0===e||null===(t=e.defectSource)||void 0===t?void 0:t.id)||void 0,wuKongReloadId:e.wuKongReloadId,serialNum:e.serialNum,rblkhxgProperty:null===(a=e.rblkhxgProperty)||void 0===a?void 0:a.id,rblsjxgProperty:null===(n=e.rblsjxgProperty)||void 0===n?void 0:n.id,systemsId:null===(i=e.systemDTO)||void 0===i?void 0:i.systemId,participants:e.participants||[]},assignee:e.assignee,watchers:e.watchers||[],defectSource:e.defectSource})}},{key:"changeAttributes",value:function(e){var t,a=e.isCustom,n=e.type,i=e.value,r=e.issueFieldId,o=e.specCallback,s=this.state.attributes,l=this.props.subtaskSchemeFieldArchives;if(!this.validateDefect()){var c;if(a){var u=s.fields,d=i;!i&&(0,J.default)(u[r])?d=[]:!i&&((0,q.default)(u[r])||(0,Z.default)(u[r])||(0,z.default)(u[r]))&&(d=null),l[r].issueField.componentType!==De.PROPERTY_TYPE_CONSTANTS.SELECT_MEMBER_SINGLE&&l[r].issueField.componentType!==De.PROPERTY_TYPE_CONSTANTS.SELECT_ITERATION_SINGLE||(d=i?i.id:null),l[r].issueField.componentType!==De.PROPERTY_TYPE_CONSTANTS.SELECT_MEMBER_MULTI&&l[r].issueField.componentType!==De.PROPERTY_TYPE_CONSTANTS.SELECT_ITERATION_MULTI||(d=i?i.map((function(e){return e.id})):[]),c={customFieldValueMap:[{id:r,content:d}]}}else switch(n){case"requirementType":case"priority":case"assignee":c=Ze({},"requirementType"===n?{requirementTypeId:i||0}:(0,b.default)({},n,i||0));break;case"participants":c=(0,b.default)({},n,i?i.map((function(e){return e.id})):[]);break;case"labels":case"watchers":var f=s.labels,p=s.watchers,m="labels"===n?"labelIds":"watchers",h="labels"===n?"delLabelIds":"delWatchers",v="labels"===n?f:p,g=Array.from(new Set(v.concat(i)));if(i)if(g.length===v.length){var E=v.findIndex((function(e){return!i.includes(e)}));c=(0,b.default)({},h,[v[E]])}else c=(0,b.default)({},m,[i[i.length-1]]),"watchers"===n&&(i=g);else c=(0,b.default)({},h,v);break;case"workingHours":c={workingHours:(null===(t=i)||void 0===t?void 0:t.workingHours)||0,estimatedWorkHour:i||void 0};break;case"projectModule":c={projectModuleId:i||0};break;case"progress":c={progress:i||0};break;case"rblkhxgProperty":c={rblkhxg:i||0};break;case"rblsjxgProperty":c={rblsjxg:i||0};break;case"systemsId":c={systemsId:i||0};break;case"defectKindIds":c={defectKindIds:i||[],defectPhaseId:customValue};break;case"defectPhaseId":c={defectPhaseId:i||0,defectKindIds:[]};break;default:c=(0,b.default)({},n,i)}this.setState({attributes:Ze(Ze({},s),a?{fields:Ze(Ze({},s.fields),{},(0,b.default)({},r,i))}:(0,b.default)({},n,i))}),this.updateSubtask(c).then((function(){o&&o()}))}}},{key:"getBasicInfo",value:function(){var e=this,t=this.getFunctionFlags(),a=t.codeManagementOpen,n=t.issueReviewOpen;this.setState({issueReviewOpen:n}),Promise.all([this.props.getRequirementTypes(),this.props.getBugTypes(),this.props.getSourceTypes(),this.props.getModuleSchemes(),this.props.getSubtaskScheme()].concat((0,d.default)(a?[this.getCodeRepoSetting()]:[]),(0,d.default)(n?[this.fetchIssueReviewList()]:[]),[this.getActivityList()])).then((function(){e.setState({isInited:!0})})),a||this.dataLoad("codeRepo"),this.getResourceReference().then((function(){e.dataLoad("reference")})),this.fetchManHourRecords()}},{key:"callback",value:function(e,t){var a=this.props.updateCallback;a&&a(e,t)}},{key:"onNameChange",value:function(e){var t=(0,W.default)(this.state.detailInfoState,(function(t){t.name=e.target.value}));this.setState({detailInfoState:t})}},{key:"submitTitleChange",value:function(){var e=this,t=this.state.detailInfoState,a=this.props.detailInfo;t.name&&t.name.length<=128?t.name!==a.name&&this.updateSubtask({name:t.name.trim()},(function(){e.titleInputRef&&e.titleInputRef.current&&e.titleInputRef.current.blur(),e.setState({noHoverIcon:!0},(function(){setTimeout((function(){e.setState({noHoverIcon:!1})}),0)})),e.setState({detailInfoState:Ze(Ze({},t),{},{name:t.name.trim()})})})):(0,U.warning)((0,y.t)("\u8bf7\u8f93\u5165\u4e0d\u8d85\u8fc7128\u4f4d\u7684\u5b50\u5de5\u4f5c\u9879\u540d\u79f0"))}},{key:"onStatusChange",value:function(e){return this.updateSubtask(e)}},{key:"onVisibleChange",value:function(){this.setState({tooltipTitle:(0,y.t)("\u590d\u5236\u94fe\u63a5")})}},{key:"onCopyClick",value:function(){this.setState({tooltipTitle:(0,y.t)("\u5df2\u590d\u5236")})}},{key:"updateDescription",value:function(e){var t=this,a=this.props,n=a.currentProject,i=a.issueCode;return(0,B.modifyIssueDescription)(n.id,i,Ze({},e)).then((function(e){return(0,Ge.clearLocalStorage)(t.props),t.getResourceReference(),e}))}},{key:"onParentUpdate",value:function(e){var t,a,n=this.props,i=n.projectPath,r=n.location,o=r.pathname,s=r.query,l=n.router,c=this.state.detailInfoState;(this.updateSubtask({},null,e.code),/detail\/subtasks/.test(o))&&l.push({pathname:"".concat(i,"/").concat(Qe[null===(t=c.parent)||void 0===t?void 0:t.type],"/issues/").concat(null===(a=c.parent)||void 0===a?void 0:a.code,"/detail"),query:s})}},{key:"handleEditCommentCallback",value:function(e){var t=this;this.getActivityList((function(){setTimeout((function(){(0,ee.scrollRelatedToTopMenu)("comment-".concat(e),0,t.scrollRef.current)}))})),this.getResourceReference()}},{key:"postComment",value:function(e,t,a,n,i){var r=this,o=this.scrollRef;return(0,M.addComment)({projectID:e,subtaskCode:t,content:a,parentID:n}).then((function(e){i&&i(),r.getActivityList((function(){setTimeout((function(){(0,ee.scrollRelatedToTopMenu)("comment-".concat(e.data.id),0,o.current)}))})),r.getResourceReference()}))}},{key:"deleteComment",value:function(e,t,a,n){var i=this;(0,M.deleteComment)(e,t,a).then((function(){n&&n(),i.getResourceReference(),i.getActivityList()}))}},{key:"onRemoveReference",value:function(){(0,U.success)((0,y.t)("\u53d6\u6d88\u5173\u8054\u6210\u529f")),this.getResourceReference(),this.getActivityList()}},{key:"fileUploadSpec",value:function(e){var t=this.state.attachmentsState;this.setState({attachmentsState:[].concat((0,d.default)(t),(0,d.default)(e))})}},{key:"handleDeleteAttachment",value:function(e,t){t?this.handleDeleteModao(e):this.updateSubtask({delFileIds:[e]})}},{key:"handleDeleteModao",value:function(e){var t=this,a=this.props,n=a.currentProject.id,i=a.issueCode;(0,ce.deleteModao)(n,i,e).then((function(){(0,U.success)((0,y.t)("\u5220\u9664\u6210\u529f")),t.setState({attachmentsState:t.state.attachmentsState.filter((function(t){return t.fileId!==e}))}),t.getActivityList()}))}},{key:"onFileDropSuccessSpec",value:function(e){var t=this;if(e.isCanceled)this.setState({attachmentsState:(0,W.default)(this.state.attachmentsState,(function(t){var a=t.findIndex((function(t){return t.timestamp===e.timestamp}));t.splice(a,1)}))});else if(e.isModao||e.isCodesign){(0,U.success)((0,y.t)("\u66f4\u65b0\u6210\u529f"));var a=this.props,n=a.currentProject.id,i=a.issueCode;(0,M.fetchSubtaskDetail)(n,i,{withDescriptionMarkup:!0}).then((function(e){var a=e.data;t.setState({attachmentsState:t.combineThirdLinks(a.files,a.thirdLinks)},(function(){t.scrollToAttechment()}))})),this.getActivityList()}else this.updateSubtask({fileIds:[e.fileId]},(function(){t.scrollToAttechment()}))}},{key:"onFileDropFailSpec",value:function(e){var t=e.timestamp;this.setState({attachmentsState:(0,W.default)(this.state.attachmentsState,(function(e){var a=e.findIndex((function(e){return e.timestamp===t}));e.splice(a,1)}))})}},{key:"onFileDropDeleteSpec",value:function(e){var t=e.fileId,a=e.isModao,n=e.isCodesign;this.handleDeleteAttachment(t,a||n)}},{key:"onFileDropCancelSpec",value:function(e){var t=e.timestamp;this.setState({attachmentsState:(0,W.default)(this.state.attachmentsState,(function(e){var a=e.findIndex((function(e){return e.timestamp===t}));e[a].isCanceled=!0}))})}},{key:"filePreviewHideSpec",value:function(e){this.setState({isFilePreviewVisible:e})}},{key:"previewItem",value:function(e){this.setState({previewFileID:e,isFilePreviewVisible:!0})}},{key:"handleDelInPreviewFileSpec",value:function(){var e=this,t=this.state.deleteFileId;this.isDeleteInFilePreview=!0,this.updateSubtask({delFileIds:[t]},(function(){e.setState({showDeleteConfirmModal:!1,deleteFileId:void 0})}))}},{key:"handleDeleteAttachmentConfirm",value:function(e,t){this.setState({showDeleteConfirmModal:!0,deleteFileId:t})}},{key:"toggleRecord",value:function(){var e=this.state.isHistoryRecordVisible;this.setState({isHistoryRecordVisible:!e})}},{key:"viewRecord",value:function(e){var t=e.currentId;this.setState({isHistoryRecordVisible:!0,currentLogId:t})}}]),a}(S.Component),c.propTypes=Ze(Ze({detailInfo:T.default.object,affairList:T.default.array,projectPath:T.default.string,params:T.default.object,expanded:T.default.bool,isDetail:T.default.bool,onCodeChange:T.default.func,currentProject:T.default.object,labels:T.default.array,user:T.default.object,closeSlideslip:T.default.func,subtaskSchemeFieldArchives:T.default.object,subtaskUpdateFieldIDs:T.default.array,getSubtaskScheme:T.default.func,updateCallback:T.default.func,refreshCallback:T.default.func,enterpriseGlobalKey:T.default.string,watermark:T.default.string,payed:T.default.bool,location:T.default.object,issueCode:T.default.oneOfType([T.default.number,T.default.string]),iterationCode:T.default.oneOfType([T.default.number,T.default.string]),autoshowComment:T.default.object,autoToggleComment:T.default.func,domID:T.default.string,flashAnchor:T.default.func,scrollRef:T.default.any},X.WithProjectPermissionProps),{},{router:T.default.object,callFrom:T.default.string,branchsInfo:T.default.array}),c.defaultProps={expanded:!0,affairList:[],isDetail:!1},l=u))||l)||l)||l)||l)||l)||l)||l)||l)||l);t.default=$e},"YV+u":function(e,t,a){"use strict";var n=a("cDcd"),i=a.n(n),r=a("MXfu"),o=a.n(r),s=a("yZ+p"),l=a.n(s),c=a("xgZS"),u=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o};t.a=function(e){var t=e.value,a=e.maxLength,r=void 0===a?7:a,s=e.defaultLabel,d=void 0===s?"\u672a\u9884\u4f30":s,f=e.unit,p=void 0===f?"\u5c0f\u65f6":f,m=e.dangerTip,h=void 0===m?"\u9884\u4f30\u5de5\u65f6\u5fc5\u987b\u5c0f\u4e8e 10000, \u6700\u591a\u4fdd\u75592\u4f4d\u5c0f\u6570":m,v=e.onModify,g=e.className,E=e.disabled,b=e.setValid,y=u(Object(n.useState)(t),2),S=y[0],I=y[1],T=u(Object(n.useState)(!1),2),C=T[0],P=T[1],w=u(Object(n.useState)(!0),2),D=w[0],O=w[1],R=Object(n.useRef)(null),j=Object(n.useRef)(null),k=function(e){e.stopPropagation();/^([1-9]\d{0,3}(\.\d{0,2})?|0\.\d{0,2}|0)$/.test(S)?(v({content:Number(S)}),O(D),P(!1),R&&R.current&&R.current.blur(),b&&b(!0)):S?(O(D),Object(c.danger)(h),b&&b(!1)):(v({content:null}),O(!0),P(!1),R&&R.current&&R.current.blur(),b&&b(!0))};return Object(n.useEffect)((function(){var e=function(e){13===e.keyCode&&e.ctrlKey&&C&&k(e)};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}),[C,S,D,t]),Object(n.useEffect)((function(){I(t)}),[t]),i.a.createElement("div",{className:"".concat(o.a.root," ").concat(g," ").concat(!D&&o.a.isError," ").concat(C&&o.a.isEditing," ").concat(E&&o.a.disabled),title:E?"":"ctrl + enter \u786e\u8ba4",ref:j},!E&&i.a.createElement(l.a,{suffix:C&&i.a.createElement("span",null,p),defaultValue:t,value:C?S:!!t&&"".concat(t," ").concat(p)||"",onChange:function(e){return I(e.target.value.replace(/[^\d.]/g,""))},maxLength:r,className:"".concat(o.a.inputWrapper),placeholder:d,ref:R,readonly:!0,onFocus:function(){E||(P(!0),O(!0))},onBlur:k}),E&&i.a.createElement("div",{className:o.a.disabled},S&&i.a.createElement("span",{className:o.a.value},"".concat(S," ").concat(p)),!S&&i.a.createElement("span",{className:o.a.placeholder},d)))}},YWLj:function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjBweCIgaGVpZ2h0PSIyMHB4IiB2aWV3Qm94PSIwIDAgMjAgMjAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDUyLjUgKDY3NDY5KSAtIGh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaCAtLT4KICAgIDx0aXRsZT5maWxlLXR5cGUvb3RoZXJzPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9Iue8uumZty/or6bmg4UiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSLpmYTku7YiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC01MTYuMDAwMDAwLCAtNjYwLjAwMDAwMCkiPgogICAgICAgICAgICA8ZyBpZD0iZmlsZS10eXBlL290aGVycyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNTE2LjAwMDAwMCwgNjYwLjAwMDAwMCkiPgogICAgICAgICAgICAgICAgPHBhdGggZD0iTTIsMy40NjM4OTU4NGUtMTMgTDE4LDMuNDYzODk1ODRlLTEzIEMxOS4xMDQ1Njk1LDMuNDYxODY2NzhlLTEzIDIwLDAuODk1NDMwNSAyMCwyIEwyMCwxOCBDMjAsMTkuMTA0NTY5NSAxOS4xMDQ1Njk1LDIwIDE4LDIwIEwyLDIwIEMwLjg5NTQzMDUsMjAgLTEuNjQxMDg2MDllLTE1LDE5LjEwNDU2OTUgLTEuNzc2MzU2ODRlLTE1LDE4IEwtMS43NzYzNTY4NGUtMTUsMiBDLTEuOTExNjI3NTllLTE1LDAuODk1NDMwNSAwLjg5NTQzMDUsMy40NTcwNDMxMWUtMTMgMiwzLjQ1NTAxNDA1ZS0xMyBaIiBpZD0iUmVjdGFuZ2xlLTM3IiBmaWxsPSIjQTFBQ0JGIj48L3BhdGg+CiAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTAsMTUgQzkuNCwxNSA5LDE0LjYgOSwxNCBDOSwxMy40IDkuNCwxMyAxMCwxMyBDMTAuNiwxMyAxMSwxMy40IDExLDE0IEMxMSwxNC42IDEwLjYsMTUgMTAsMTUgWiIgaWQ9IlBhdGgiIGZpbGw9IiNGRkZGRkYiIG9wYWNpdHk9IjAuOTAwMDAwMDM2Ij48L3BhdGg+CiAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTEuNiwxMC40IEMxMS4xLDEwLjcgMTEuMSwxMC44IDExLjEsMTEgTDExLjEsMTIgTDkuMSwxMiBMOS4xLDExIEM5LjEsOS43IDkuOSw5LjEgMTAuNSw4LjcgQzExLDguNCAxMS4xLDguMyAxMS4xLDggQzExLjEsNy40IDEwLjcsNyAxMC4xLDcgQzkuNyw3IDkuNCw3LjIgOS4yLDcuNSBMOC43LDguNCBMNyw3LjQgTDcuNSw2LjUgQzgsNS42IDksNSAxMC4xLDUgQzExLjgsNSAxMy4xLDYuMyAxMy4xLDggQzEzLjEsOS40IDEyLjIsMTAgMTEuNiwxMC40IFoiIGlkPSJQYXRoIiBmaWxsPSIjRkZGRkZGIiBvcGFjaXR5PSIwLjkwMDAwMDAzNiI+PC9wYXRoPgogICAgICAgICAgICA8L2c+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4="},"Ybq+":function(e,t,a){e.exports={"united-wrapper":"united-wrapper-3qrIe6JUhP",unitedWrapper:"united-wrapper-3qrIe6JUhP",center:"center-14ZaQqsEXg",header:"header-2i2qlHWwh-","warning-section":"warning-section-2s3itX9eUW",warningSection:"warning-section-2s3itX9eUW",warning:"warning-ufReba4kuF",text:"text--25colgjNz",gap:"gap-1pYvpTOmsx",link:"link-2jQPzJbP96",zoom:"zoom-2sTSVZJls9",img:"img-3sZmqPQjLz",body:"body-20cDKeZMPl",seperator:"seperator-2b-GyoYpAM",disabled:"disabled-307tLIOG8v",footer:"footer-2J5TuFr3l_",left:"left-39PZd0nRmZ",right:"right-2hGCrCO-BI","create-btn":"create-btn-3WGFeoeCoj",createBtn:"create-btn-3WGFeoeCoj",icon:"icon-30h6-rcztg","cancel-btn":"cancel-btn-1EUarNu69U",cancelBtn:"cancel-btn-1EUarNu69U","ml-8":"ml-8-eA8XOCB9ob",ml8:"ml-8-eA8XOCB9ob","united-wrapper-large":"united-wrapper-large-1hjk1eZNGM",unitedWrapperLarge:"united-wrapper-large-1hjk1eZNGM",input:"input-37Ni_D15m4"}},Yfq4:function(e,t,a){"use strict";a.r(t);var n=a("mVeg"),i=a("cDcd"),r=a.n(i),o=a("GDO5"),s=a.n(o),l=a("dvJj"),c=a.n(l),u=a("K2gz"),d=a.n(u),f=a("246l"),p=a.n(f),m=a("yZ+p"),h=a.n(m),v=a("5kKY"),g=a("KUqB"),E=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},b=function(e){var t=e.onCancel,a=e.onFastCreate,o=e.scrollTargetId,s=e.controlFocus,l=e.onFullCreate,u=e.onTitleChange,f=e.clearTitle,m=e.getInstance,b=E(Object(i.useState)(""),2),y=b[0],S=b[1],I=Object(i.useRef)(""),T=Object(i.useCallback)((function(e){var t=e.target.value;S(t),I.current=t,u(t)}),[]),C=E(Object(i.useState)(!1),2),P=C[0],w=C[1],D=Object(i.useCallback)((function(e){w(e)}),[]),O=Object(i.useRef)(null),R=Object(i.useCallback)((function(){S(""),I.current="",u(""),O.current&&O.current.focus()}),[]);Object(i.useEffect)((function(){m(O)}),[]);Object(i.useEffect)((function(){O.current&&O.current.focus()}),[s]),Object(i.useEffect)((function(){R()}),[f]);var j=Object(i.useCallback)((function(e){13===e.keyCode?e.shiftKey?(O.current&&O.current.blur(),l()):a(I.current,R):27===e.keyCode&&t()}),[]);return Object(i.useEffect)((function(){return O.current&&O.current.input&&(O.current.input.onkeydown=j),function(){O.current&&O.current.input&&(O.current.input.onkeydown=null)}}),[]),r.a.createElement("div",{className:c.a.wrapper,id:o},r.a.createElement(h.a,{ref:O,prefix:r.a.createElement(g.default,{type:"work_item"}),suffix:r.a.createElement("div",{className:c.a.inputAfter},y&&r.a.createElement("div",{className:c.a.inputClear,onClick:R}),r.a.createElement(v.Trigger,{visible:P,onVisibleChange:D,popup:r.a.createElement("div",{className:c.a.popup},r.a.createElement("div",{className:c.a.popupItem,onClick:function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),l()}},r.a.createElement("div",{className:c.a.popupItemText},Object(n.t)("\u5b8c\u6574\u521b\u5efa")),r.a.createElement("div",{className:c.a.popupItemShift}),r.a.createElement("div",{className:c.a.popupItemEnter})))},r.a.createElement("div",{className:c.a.inputCreate},r.a.createElement("div",{className:c.a.inputCreateText,onClick:function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),a(y,R)}},Object(n.t)("\u521b\u5efa")),r.a.createElement("div",{className:c.a.inputCreateArrow}))),r.a.createElement("div",{onClick:t,className:d()(c.a.inputCancel,p.a.newButton,p.a.default,p.a.h24)},Object(n.t)("\u53d6\u6d88"))),placeholder:Object(n.t)("\u8f93\u5165\u6807\u9898\u5feb\u901f\u521b\u5efa\u5de5\u4f5c\u9879"),value:y,onChange:T}))},y=a("OajT"),S=a.n(y),I=a("ehTL"),T=function(){return(T=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},C=a("xgZS"),P=a("l8Oe"),w=a("DDKl"),D=a.n(w),O=a("lAyh"),R=a("L9lg"),j=a.n(R),k=a("ZTlW"),N=a("BXnm"),A=a("+QRC"),L=a.n(A),F=a("HwxY"),_=a("6Mal"),M=a("L8Eh"),x=a("iTKN"),B=a("/HD1"),U=a("dtw8"),W=function(){return(W=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Y=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},H=function(e,t,a){if(a||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},V=Object(U.withRouter)((function(e){var t=e.data,a=e.currentCode,o=e.isDetail,s=e.style,l=e.className,c=e.fetchList,u=e.onChange,f=e.allowUpdate,p=e.allowDelete,m=e.onDelete,h=e.draggingIndex,E=e.isLastChild,b=e.project,y=e.onUpdateParent,S=e.onRemoveRelation,I=e.router,T=e.location,P=e.parentCode,w=e.disabledBottomSpace,D=function(e){return Object(B.updateWorkItem)(b.name,t.code,e).then((function(e){return Object(C.success)(Object(n.t)("\u66f4\u65b0\u6210\u529f")),c(),u(t.code,e.data),e}))},O=function(){return"/p/".concat(b.name,"/program/plan/work-items/").concat(t.code,"/detail")},R=function(){return document.querySelector('div[data-frontend-module-container="coding-project-management-frontend"]')},A=H(H(H([{id:"detail",name:Object(n.t)("\u65b0\u7a97\u53e3\u6253\u5f00"),link:{path:O()}},{id:"copy",name:Object(n.t)("\u590d\u5236\u94fe\u63a5")}],Y(p||f?[{id:"divider",name:"",type:"divider"}]:[]),!1),Y(f?[{id:"parent",name:Object(n.t)("\u66f4\u6539\u7236\u5de5\u4f5c\u9879")},{id:"remove",name:Object(n.t)("\u89e3\u9664\u5173\u8054")}]:[]),!1),Y(p?[{id:"delete",name:Object(n.t)("\u5220\u9664"),type:"delete"}]:[]),!1),U=Object(i.useCallback)((function(e){switch(e.id){case"parent":y(t.code);break;case"copy":L()("".concat(window.location.origin).concat(O())),Object(C.success)(Object(n.t)("\u6210\u529f\u590d\u5236\u5230\u526a\u5207\u677f"));break;case"remove":Object(B.updateParentWorkItem)(b.name,t.code,0).then((function(){Object(C.success)(Object(n.t)("\u89e3\u9664\u5173\u8054\u6210\u529f")),c(),S(t.code)}));break;case"delete":m(t)}}),[]),V=t.issueStatus&&t.issueStatus.type&&"COMPLETED"===t.issueStatus.type,G=Y(Object(i.useState)(!1),2),K=G[0],z=G[1],q=function(){z(!0)},Z=function(){z(!1)},J=function(){I.push(O())},X=function(){o?I.push({pathname:"/p/".concat(b.name,"/program/plan/work-items/").concat(P,"/detail/subissues/").concat(t.code),query:W({},T.query)}):J()};return r.a.createElement(F.default.Consumer,null,(function(e){var n;return r.a.createElement("div",{className:d()(j.a.item,K&&-1===h&&j.a.itemHovering,a===t.code&&j.a.itemHovering,l,E&&j.a.lastChild),style:s,onMouseEnter:q,onMouseLeave:Z},r.a.createElement(g.default,{type:t.issueTypeDetail.iconType}),r.a.createElement("div",{className:j.a.itemCode,onClick:J},"#",t.code),r.a.createElement("div",{className:j.a.itemName,onClick:X,title:t.name},t.name),t.dueDate&&r.a.createElement("div",{className:j.a.itemDate},r.a.createElement(k.a,{date:t.dueDate,isCompleted:V})),r.a.createElement("div",{className:j.a.itemPriority},r.a.createElement(_.default,{componentType:x.ComponentType.ICON,value:t.priority,disabled:!f,onSelect:function(e){var t=e.id;return D({priority:t})},isPortal:!0,portalProps:{portalContainer:R(),toRight:!0,scrollControl:e.scrollControl},disabledBottomSpace:w})),r.a.createElement("div",{className:j.a.itemStatus},r.a.createElement(N.StatusSelect,{value:t.issueStatus,projectID:b.id,project:b,issueCode:t.code,disabled:!f,onSelect:function(e){return D(e)},portalContainer:R,portalAlign:{top:21,toRight:!0},disabledBottomSpace:w})),r.a.createElement("div",{className:j.a.itemAssignee},r.a.createElement(M.default,{componentType:x.ComponentType.ICON,disabled:!f,inProject:!0,projectID:b.id,value:null===(n=t.assignee)||void 0===n?void 0:n.id,onSelect:function(e){D({assignee:e.id})},onClear:function(){D({assignee:0})},triggerExtraProps:{initialSelectedItem:t.assignee},isPortal:!0,portalProps:{portalWrapStyle:{zIndex:1051},portalContainer:R(),toRight:!0,scrollControl:e.scrollControl},disabledBottomSpace:w})),r.a.createElement("div",null,r.a.createElement(v.ItemDropdown,{options:A,onSelect:U,popupStyle:{width:160},portalContainer:R,portalAlign:{top:24,left:-96}})))}))})),G=function(e){var t=e.data,a=e.currentCode,n=e.isDetail,o=e.list,l=e.fetchList,c=e.allowUpdate,u=e.allowDelete,f=e.onHover,p=e.onBegin,m=e.onDelete,h=e.onEnd,v=e.draggingIndex,g=e.draggingCode,E=e.isLastChild,b=e.style,y=e.project,S=e.onUpdateParent,I=e.onRemoveRelation,T=e.onChange,C=e.parentCode,P=e.disabledBottomSpace,w=Object(i.useRef)(null),D=function(e,a){if(w.current){var n=e.data.item.code;if(n!==t.code){var i=w.current.getBoundingClientRect(),r=(i.bottom-i.top)/2,s=a.getClientOffset();if(s){var l=s.y-i.top,c=o.findIndex((function(e){return e.code===n})),u=o.findIndex((function(e){return e.code===t.code}));c<u&&l<r||c>u&&l>r||f(n,t.code)}}}};return r.a.createElement(O.a,{type:"$sub-work-item",data:{item:t},canDrag:c,onBegin:function(){p(t.code)},onEnd:h},(function(e,i){return r.a.createElement(O.c,{type:"$sub-work-item",canDrop:c,onHover:D},(function(e,o){return i(w),o(w),r.a.createElement("div",{ref:w,className:d()(s.a.item,t.code===g&&s.a.itemIsOver),style:b||{}},r.a.createElement(V,{allowUpdate:c,allowDelete:u,fetchList:l,data:t,currentCode:a,isDetail:n,onDelete:m,draggingIndex:v,isLastChild:E,project:y,onUpdateParent:S,onRemoveRelation:I,onChange:T,parentCode:C,disabledBottomSpace:P}))}))}))},K=a("DTVk"),z=a("+dhI"),q=a("mecZ"),Z=a("mFAe"),J=Object(i.memo)((function(e){var t=e.data,a=e.style,n=e.className,o=t.issueStatus&&t.issueStatus.type&&"COMPLETED"===t.issueStatus.type;return Object(i.useMemo)((function(){return r.a.createElement("div",{className:d()(j.a.item,n),style:a},t.type===K.IssueType.requirement&&!!t.hasChild&&r.a.createElement("div",{className:j.a.itemArrow}),r.a.createElement(g.default,{type:t.issueTypeDetail.iconType}),r.a.createElement("div",{className:j.a.itemCode},"#",t.code),r.a.createElement("div",{className:j.a.itemName},t.name),t.dueDate&&r.a.createElement("div",{className:j.a.itemDate},r.a.createElement(k.a,{date:t.dueDate,isCompleted:o})),r.a.createElement("div",{className:j.a.itemPriority},r.a.createElement(z.default,{priority:t.priority})),r.a.createElement("div",{className:j.a.itemStatus},r.a.createElement(Z.default,{status:t.issueStatus})),r.a.createElement("div",{className:j.a.itemAssignee},r.a.createElement(q.a,{assignee:t.assignee})),r.a.createElement("div",null,r.a.createElement(v.ItemDropdown,{options:[],onSelect:function(){}})))}),[])})),X=a("Qkhu"),Q=a.n(X),$=a("DKcV"),ee=a("iR1w"),te=a("q47l"),ae=a("PW7d"),ne=a.n(ae),ie=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},re=function(e){var t,a=e.onCancel,o=e.type,s=e.project,l=e.parentCode,c=e.fetchList,u=e.onRelated,f=ie(Object(i.useState)(""),2),m=f[0],v=f[1],E=ie(Object(i.useState)([]),2),b=E[0],y=E[1],S=function(e){Object(B.getAvailableChildWorkItems)(s.name,l,{keyword:e,type:o}).then((function(e){y(e.data)}))},I=Object(i.useCallback)((function(e){var a=e.target.value;v(a),window.clearTimeout(t),t=window.setTimeout((function(){S(a)}),800)}),[]),T=Object(i.useCallback)((function(e){27===e.keyCode&&a()}),[]),C=Object(i.useRef)(),P=Object(i.useCallback)((function(){var e;v(""),S(""),null===(e=null===C||void 0===C?void 0:C.current)||void 0===e||e.focus()}),[]);Object(i.useEffect)((function(){S(m)}),[]);return r.a.createElement("div",{className:ne.a.wrapper},r.a.createElement(h.a,{ref:C,autoFocus:!0,prefix:r.a.createElement("div",{className:ne.a.inputBefore}),suffix:r.a.createElement("div",{className:ne.a.inputAfter},m&&r.a.createElement("div",{className:ne.a.inputClear,onClick:P}),r.a.createElement("div",{onClick:a,className:d()(ne.a.inputCancel,p.a.newButton,p.a.default,p.a.h24)},Object(n.t)("\u53d6\u6d88"))),placeholder:Object(n.t)("\u8f93\u5165\u4e8b\u9879\u5e94\u7528 ID \u6216\u6807\u9898"),value:m,onChange:I,onKeyDown:T}),r.a.createElement("div",{className:ne.a.panel,onScroll:function(e){e.stopPropagation()}},r.a.createElement("div",{className:ne.a.panelContainer},b.map((function(e){return r.a.createElement("div",{key:e.code,className:ne.a.item,onClick:function(){return t=e.code,void Object(B.relateAvailableChildWorkItems)(s.name,t,l).then((function(){P(),c(),u&&u(l,t)}));var t}},r.a.createElement(g.default,{type:e.issueTypeDetail.iconType}),r.a.createElement("div",{className:ne.a.itemCode},"#",e.code),r.a.createElement("div",{className:ne.a.itemName},e.name))}))),!b.length&&r.a.createElement("div",{className:ne.a.itemEmpty},Object(n.t)("\u65e0\u641c\u7d22\u7ed3\u679c"))))},oe=a("nuIr"),se=a("LvDl"),le=a("82Y3"),ce=a("DgMC"),ue=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},de=function(e,t,a){if(a||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))};t.default=S()((function(e){var t=e.sectionExpanded,a=e.SectionToggletrigger,o=e.parentCode,l=e.currentCode,c=e.isDetail,u=e.callback,d=e.list,f=e.createVisible,p=e.onCreateVisibleChange,m=e.controlFocus,h=e.scrollTargetId,v=e.onFullCreate,g=e.onListChange,E=e.onTitleChange,y=e.isPermissible,S=e.clearTitle,w=e.getInstance,R=e.getCreateInputInstance,j=e.canSplit,k=e.project,N=e.issueTypeDetail,A=e.onRemoveRelation,L=e.onChange,F=e.onChangeParent,_=e.onRemove,M=e.onCreate,x=e.onSort,U=e.onRelated,W=e.isFullScreen,Y=W?oe.FULL_SCREEN.disabledBottomSpace:0,H=Object(i.useRef)(null);Object(i.useEffect)((function(){w&&w(H)}),[]);var V=Object(i.useRef)(null),K=ue(Object(i.useState)(!1),2),z=K[0],q=K[1],Z=Object(i.useCallback)((function(e){V.current=e.current,R&&R(e)}),[]),X=Object(i.useCallback)((function(){p(!0),q(!1),V.current&&V.current.focus()}),[]),ae=Object(i.useCallback)((function(){q(!0)}),[]);Object(i.useEffect)((function(){q(!1)}),[m]);var ne=Object(i.useCallback)(Object(se.debounce)((function(e,t){var a,i,r;e?(i=k.id,r={parentCode:o,name:e,issueTypeId:N.id,issueDescriptionType:null!==(a=null===N||void 0===N?void 0:N.issueDescriptionType)&&void 0!==a?a:Object(le.getPreferEditorType)()},void 0===r&&(r={}),Object(I.postJSON)("/api/project/".concat(i,"/issues/smart"),T(T({},r),{issueType:"WORK_ITEM"}))).then((function(e){var a=e.data;t&&t(),u(),M(a)}),(function(e){var t=e.code;Object(ce.configPlanNotToastMsg)(t)||8011!==t&&v()})):Object(C.warning)("".concat(Object(n.t)("\u8bf7\u8f93\u5165\u5de5\u4f5c\u9879\u6807\u9898")))}),300),[]),ie=Object(i.useRef)(null),fe=function(e,t){var a=ye.current,n=a.findIndex((function(t){return t.code===e})),i=a.findIndex((function(e){return e.code===t})),r=a.splice(n,1)[0];a.splice(i,0,r),g(de([],ue(a),!1)),Ee(e)},pe=ue(Object(i.useState)(-1),2),me=pe[0],he=pe[1],ve=ue(Object(i.useState)(-1),2),ge=ve[0],Ee=ve[1],be=function(e){var t=d.findIndex((function(t){return t.code===e}));he(t),Ee(e)},ye=Object(i.useRef)(d);Object(i.useEffect)((function(){ye.current=d}),[d]);var Se=function(e){var t=ye.current,a=e.data.item.code,i=t.findIndex((function(e){return e.code===a}));if(me!==i){var r=t[i+1];Object(B.sortWorkItem)(k.name,o,{beforeCode:r?r.code:null,subItemCode:a}).then((function(){Object(C.success)(Object(n.t)("\u6392\u5e8f\u6210\u529f")),he(-1),Ee(-1),u(),x(a,r?r.code:null)}))}},Ie=Object(i.useCallback)((function(e){var t=e.data;return r.a.createElement("div",{className:s.a.draggingItem,style:{width:ie.current.getBoundingClientRect().width}},r.a.createElement(J,{data:t.item,style:{background:"#ffffff"}}))}),[]),Te=ue(Object(i.useState)({}),2),Ce=Te[0],Pe=Te[1],we=ue(Object(i.useState)(!1),2),De=we[0],Oe=we[1],Re=Object(i.useCallback)((function(e){Oe(!0),Pe(e)}),[]),je=Object(i.useCallback)((function(){p(!1),E("")}),[]),ke=y([{function:$.ProjectPermissionFunction.PROJECT_ISSUE,action:$.ProjectPermissionAction.UPDATE}]),Ne=y([{function:$.ProjectPermissionFunction.PROJECT_ISSUE,action:$.ProjectPermissionAction.DELETE}]),Ae=ue(Object(i.useState)(!1),2),Le=Ae[0],Fe=Ae[1],_e=Object(i.useCallback)((function(e){Fe(e)}),[]),Me=ue(Object(i.useState)(-1),2),xe=Me[0],Be=Me[1],Ue=Object(i.useCallback)((function(e){Fe(!0),Be(e)}),[]),We=Object(i.useCallback)((function(e){var t=e.index,a=e.style,n=e.data,i=n.list,s=n.isFullScreen,l=n.disabledBottomSpace,d=i[t];return r.a.createElement(G,{key:d.code,currentCode:n.currentCode,isDetail:c,allowUpdate:ke,allowDelete:Ne,fetchList:u,data:d,onDelete:Re,onHover:fe,onBegin:be,onEnd:Se,list:i,draggingIndex:n.draggingIndex,draggingCode:n.draggingCode,isLastChild:t===i.length-1,style:a,project:k,onUpdateParent:Ue,onRemoveRelation:A,onChange:L,parentCode:o,isFullScreen:s,disabledBottomSpace:l})}),[]);return r.a.createElement(P.DndProvider,{backend:D.a},r.a.createElement("div",{className:s.a.wrapper,ref:ie},r.a.createElement(O.b,{type:"$sub-work-item",isSort:!0},Ie),r.a.createElement("div",{className:s.a.header},r.a.createElement(a,null),r.a.createElement("div",{className:s.a.text},Object(n.t)("\u5b50\u5de5\u4f5c\u9879")),ke&&j&&r.a.createElement("div",{className:s.a.divider}),ke&&j&&r.a.createElement("div",{className:s.a.add,onClick:X})),d.length>0&&t&&r.a.createElement("div",{className:s.a.list},r.a.createElement(ee.FixedSizeList,{itemCount:d.length,itemSize:36,height:Math.min(345,36*d.length),width:ie.current?ie.current.getBoundingClientRect().width:0,itemData:{list:d,draggingIndex:me,draggingCode:ge,currentCode:l,isFullScreen:W,disabledBottomSpace:Y}},We)),f&&!z&&r.a.createElement(b,{scrollTargetId:h,controlFocus:m,onCancel:je,onFastCreate:ne,onFullCreate:v,onTitleChange:E,clearTitle:S,getInstance:Z}),f&&!z&&r.a.createElement("div",{className:s.a.find,onClick:ae},Object(n.t)("\u5173\u8054\u5df2\u6709\u5de5\u4f5c\u9879")),z&&r.a.createElement(re,{type:"WORK_ITEM",onCancel:function(){q(!1),je()},project:k,parentCode:o,fetchList:u,onRelated:U}),Le&&r.a.createElement(te.default,{onVisibleChange:_e,issueCode:xe,fetchList:u,project:k,parentCodeChange:function(e){return F(xe,e)}}),De&&r.a.createElement(Q.a,{text:Object(n.t)("\u5220\u9664\u5de5\u4f5c\u9879"),type:Ce?Ce.type:"",issueTypeDetail:Ce.issueTypeDetail,show:De,onConfirm:function(){Object(B.deleteWorkItem)(k.name,Ce.code).then((function(){Object(C.success)(Object(n.t)("\u5220\u9664\u6210\u529f")),Oe(!1),u(),_(Ce.code)}))},onClose:function(){return Oe(!1)},hasType:!Ce.children.length,customTip:Ce.children.length?Object(n.t)("".concat(Ce.issueTypeDetail.name,"\u4e0b\u542b\u6709\u5b50\u5de5\u4f5c\u9879\uff0c").concat(Ce.issueTypeDetail.name,"\u5220\u9664\u540e\u5b50\u5de5\u4f5c\u9879\u5c06\u4e00\u5e76\u5220\u9664\uff0c\u786e\u8ba4\u5220\u9664\u5417\uff1f")):""})))}))},Ylr9:function(e,t,a){e.exports={root:"root-27_SwsSNWt",wrapper:"wrapper-_7qTWkkV_j"}},YzRi:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetchConvertedTarget=t.cancelAssociateTestCase=t.associateTestCase=t.fetchTestCase=t.associatedTestCase=t.sortSubtask=t.fetchSubtasksList=t.checkInitialization=t.fetchRelationTests=t.fetchDefectActivityList=t.fetchIssueActitvites=t.deleteComment=t.addComment=t.deleteIssue=t.copyIssue=t.updateIssueStatus=t.modifyIssue=t.modifyIssueDescription=t.fetchIssueDescription=t.fetchIssueDetail=t.batchUpdateIssues=t.createIssue=void 0;var n=a("Z4vw");t.createIssue=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return(0,n.postJSON)("/external/collaboration/api/project/".concat(e,"/issues/defects"),t,a,i)};t.batchUpdateIssues=function(e,t){return(0,n.postJSON)("/api/project/".concat(e,"/issues/defects/batch/update"),t)};t.fetchIssueDetail=function(e,t,a){return(0,n.get)("/api/project/".concat(e,"/issues/defects/").concat(t,"?").concat((0,n.buildParams)(a)))};t.fetchIssueDescription=function(e,t){return(0,n.get)("/api/project/".concat(e,"/issues/defects/").concat(t,"/description"))};t.modifyIssueDescription=function(e,t,a){return(0,n.patchJSON)("/api/project/".concat(e,"/issues/").concat(t,"/description"),a)};t.modifyIssue=function(e,t,a){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return(0,n.patchJSON)("/external/collaboration/api/project/".concat(e,"/issues/defects/").concat(t,"/fields"),a,i)};t.updateIssueStatus=function(e,t,a){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return(0,n.putJSON)("/external/collaboration/api/project/".concat(e,"/issues/defects/").concat(t,"/kanban/status"),a,i)};t.copyIssue=function(e,t,a){return(0,n.post)("/api/project/".concat(e,"/issues/defects/").concat(t,"/copy"),{name:a})};t.deleteIssue=function(e,t){return(0,n.del)("/external/collaboration/api/project/".concat(e,"/issues/defects/").concat(t))};t.addComment=function(e){var t=e.projectID,a=e.issueCode,i=e.content,r=e.parentID;return(0,n.post)("/external/collaboration/api/project/".concat(t,"/issues/defects/").concat(a,"/comments"),{content:i,parentId:r})};t.deleteComment=function(e,t,a){return(0,n.del)("/api/project/".concat(e,"/issues/defects/").concat(t,"/comments/").concat(a))};t.fetchIssueActitvites=function(e,t){return(0,n.get)("/external/collaboration/api/project/".concat(e,"/issues/defects/").concat(t,"/activities/new"))};t.fetchDefectActivityList=function(e,t,a){return(0,n.get)("/api/project/".concat(e,"/issues/defects/activities?").concat((0,n.buildParamsWithBrackets)(t)),a)};t.fetchRelationTests=function(e,t){return(0,n.get)("/api/project/".concat(e,"/issues/testings/relations/defects/").concat(t))};t.checkInitialization=function(e){return(0,n.get)("/api/project/".concat(e,"/issues/defects/is-inited"),!0)};t.fetchSubtasksList=function(e,t){return(0,n.get)("/api/project/".concat(e,"/issues/defects/").concat(t,"/sub-tasks"))};t.sortSubtask=function(e,t,a){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return(0,n.postJSON)("/api/project/".concat(e,"/issues/defects/").concat(t,"/sub-tasks/sort"),a,i)};t.associatedTestCase=function(e,t){return(0,n.get)("/api/project/".concat(e,"/issues/defects/").concat(t,"/test-cases?").concat((0,n.buildParams)({code:t})))};t.fetchTestCase=function(e,t,a){return(0,n.get)("/external/collaboration/api/project/".concat(e,"/issues/defects/").concat(t,"/available-test-cases?").concat((0,n.buildParams)(a)))};t.associateTestCase=function(e,t,a){return(0,n.postJSON)("/external/collaboration/api/project/".concat(e,"/issues/defects/").concat(t,"/test-cases"),a)};t.cancelAssociateTestCase=function(e,t,a){return(0,n.del)("/external/collaboration/api/project/".concat(e,"/issues/defects/").concat(t,"/test-cases/").concat(a))};t.fetchConvertedTarget=function(e,t){return(0,n.get)("/external/dm/api/issue/".concat(e,"/listConvertedHistoryByTarget?projectId=").concat(t))}},ZTlW:function(e,t,a){"use strict";var n=a("cDcd"),i=a.n(n),r=a("LS+K"),o=a.n(r),s=a("K2gz"),l=a.n(s),c=a("f0Wu"),u=a.n(c),d=a("atQ4"),f=Object(n.memo)((function(e){var t=e.isCompleted,a=function(e,t){var a=u()(e),n=u()().add(2,"day"),i=u()().add(-1,"day"),r="gray";return t||(u()(a.format("YYYY-MM-DD")).isBetween(i.format("YYYY-MM-DD"),n.format("YYYY-MM-DD"),"day")?r="orange":a.isBefore(u()(),"day")&&(r="red")),{color:r,text:Object(d.generateLabelText)(e)+"\u622a\u6b62",formatDate:"".concat(u()(e).format("YYYY\u5e74M\u6708D\u65e5")).concat("\u622a\u6b62")}}(e.date,t);return i.a.createElement("div",{className:l()(o.a.tag,o.a[a.color]),title:a.formatDate},a.text)}));t.a=f},ZcJI:function(e,t,a){"use strict";var n=a("mVeg"),i=a("cDcd"),r=a.n(i),o=a("NIJN"),s=a.n(o),l=a("7tbW"),c=a.n(l),u=a("Y+p1"),d=a.n(u),f=a("sEfC"),p=a.n(f),m=a("TPfW"),h=a.n(m),v=a("K2gz"),g=a.n(v),E=a("/y0v"),b=a("0YfX"),y=a("QEh4"),S=a("IUQT"),I=(a("7FZc"),function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o}),T=function(e){var t=e.item,a=e.selected,n=e.onSelect,o=a.filter((function(e){return e.code===t.code})).length>0,s=I(Object(i.useState)(a.includes(t)),2),l=s[0],c=s[1];return Object(i.useEffect)((function(){c(o)})),r.a.createElement("div",{className:h.a.menuItem,onClick:function(){c(!l),n()}},r.a.createElement("span",{className:h.a.preIcon}),r.a.createElement("span",{className:h.a.itemName,title:t.name},t.name),l&&r.a.createElement("span",{className:h.a.checked}))},C=a("Fl7e"),P=function(){return(P=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},w=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},D=[Object(n.t)("\u672a\u6307\u5b9a"),Object(n.t)("\u672a\u6307"),Object(n.t)("\u6307\u5b9a"),Object(n.t)("\u672a"),Object(n.t)("\u6307"),Object(n.t)("\u5b9a"),Object(n.t)("\u89c4\u5212"),Object(n.t)("\u672a\u89c4\u5212"),Object(n.t)("\u672a\u89c4"),Object(n.t)("\u8fed\u4ee3"),Object(n.t)("\u8fdb\u8fed\u4ee3")],O={REQUIREMENT:Object(n.t)("\u89e3\u9664\u5173\u8054"),PARENT_REQUIREMENT:Object(n.t)("\u89e3\u9664\u5173\u8054")};t.a=function(e){var t=e.children,a=e.whichIs,o=e.multiple,l=e.list,u=e.value,f=e.show,m=e.fat,v=e.iteration,I=e.onSelect,R=e.onClear,j=e.onReachBottom,k=e.onSearch,N=e.skipClass,A=e.singleReturn,L=e.useUndefined,F=e.onUndefined,_=e.undefinedConst,M=e.onClearProp,x=e.disabled,B=e.isDetail,U=e.rootContainerId,W=w(Object(i.useState)(Boolean(f)),2),Y=W[0],H=W[1],V=w(Object(i.useState)(u),2),G=V[0],K=V[1],z=Object(i.useRef)(null),q=Object(i.useRef)(null),Z=Object(i.useRef)(null),J=w(Object(i.useState)(!1),2),X=J[0],Q=J[1],$=w(Object(i.useState)(0),2),ee=$[0],te=$[1],ae=w(Object(i.useState)(""),2),ne=ae[0],ie=ae[1],re=w(Object(i.useState)(!1),2),oe=re[0],se=re[1],le=w(Object(i.useState)(!1),2),ce=le[0],ue=le[1];Object(i.useEffect)((function(){(null===u||void 0===u?void 0:u.length)&&(null===u||void 0===u?void 0:u.length)>G.length&&K(null===u||void 0===u?void 0:u.filter((function(e){return void 0!==e})))}),[u]),Object(i.useEffect)((function(){var e=function(){if(q&&q.current){var e=q.current.scrollHeight,t=q.current.scrollTop,a=q.current.clientHeight;se(t>0),e-a===t&&j&&j(!0)}};return q&&q.current&&q.current.addEventListener("scroll",e,!0),function(){q&&q.current&&q.current.removeEventListener("scroll",e,!0)}}));var de=p()((function(e){k&&k(e)}),200),fe=function(){K([]),R([])},pe=N?"":Y&&!N?g()(h.a.triggerWrapper,h.a.active):h.a.triggerWrapper,me=g()(h.a.dropdown,m&&h.a.fat,B&&h.a.isDetail,v&&h.a.iteration),he=r.a.createElement("div",{className:me,style:X?{top:"-".concat(ee+80,"px")}:{}},r.a.createElement("div",{className:g()([m&&h.a.fat,h.a.menuWrapper,v&&h.a.iteration])},r.a.createElement("div",{className:h.a.searchInput},r.a.createElement("span",{className:h.a.searchIcon}),r.a.createElement("input",{ref:Z,className:h.a.input,placeholder:Object(n.t)("\u641c\u7d22"),value:ne,onChange:function(e){var t=e.target.value;ie(t),de(t)}}),ne.length>0&&r.a.createElement("span",{className:h.a.close,onClick:function(){ie(""),de("")}})),function(){var e=(null===G||void 0===G?void 0:G.length)||0;return(_?e+1:e||0)>0}()&&r.a.createElement("div",{className:oe?g()(h.a.selections,h.a.scrolling):h.a.selections},o?function(){var e=(null===G||void 0===G?void 0:G.length)||0,t=_?e+1:e||0;return r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:g()(h.a.text,t?"":h.a.textLight)},Object(n.t)("\u5df2\u9009")," ",t," ",Object(n.t)("\u9879")),r.a.createElement("span",{className:h.a.divider}),t>0&&r.a.createElement("span",{className:h.a.clear,onClick:function(){return fe()}},Object(n.t)("\u6e05\u9664\u5df2\u9009")))}():function(){var e=(null===G||void 0===G?void 0:G.length)||0,t=_?e+1:e||0;return r.a.createElement(r.a.Fragment,null,t>0&&r.a.createElement("span",{className:h.a.clearSingle,onClick:function(){return fe()}},O[a]||Object(n.t)("\u6e05\u9664\u5df2\u9009\u62e9\u9879")))}()),r.a.createElement("div",{className:h.a.list,ref:q},(0===ne.length||D.includes(ne))&&L&&function(){switch(a){case"MEMBER":return r.a.createElement(E.a,{undefinedConst:Boolean(_),setUndefined:function(){F&&F()}});case"ITERATION":return r.a.createElement(y.UndefineIterationItem,{iteration:v,undefinedConst:Boolean(_),setUndefined:function(){F&&F()}});default:return r.a.createElement(r.a.Fragment,null)}}(),0!==l.length||D.includes(ne)?r.a.createElement(r.a.Fragment,null,l.map((function(e,t){var n={index:t,item:e,selected:G,onSelect:function(){!function(e){var t=null===G||void 0===G?void 0:G.filter((function(t){return d()(e,t)})),a=[];a=o?(null===t||void 0===t?void 0:t.length)>0?null===G||void 0===G?void 0:G.filter((function(t){return!d()(e,t)})):c()(s()(G,e)):c()(s()([],e)),K(a),A?(I([e]),o||H(!1)):I(a)}(e)}};return"PROJECT"===a?r.a.createElement(b.a,P({key:t},n)):"ITERATION"===a?r.a.createElement(y.default,P({key:t},n,{iteration:v})):"REQUIREMENT"===a?r.a.createElement(S.a,P({key:t},n)):"PARENT_REQUIREMENT"===a?r.a.createElement(T,P({key:t},n)):r.a.createElement(E.b,P({key:t},n))}))):r.a.createElement("div",{className:h.a.noItem},Object(n.t)("\u65e0\u76f8\u5173\u6761\u76ee"))))),ve=Object(C.a)({Children:he,rootContainerId:U,dropRef:z,rootClass:"".concat(h.a.dropdownWrapper," drop-pop-container")}),ge=ve.getPanel,Ee=ve.panelRef;return Object(i.useEffect)((function(){var e;function t(e){var t=e.path||e.composedPath();t.includes(z.current)||t.includes(Ee.current)||(H(!1),ie(""),k&&k(""))}if(Y){if(z.current)(null===(e=z.current)||void 0===e?void 0:e.getBoundingClientRect()).top+300>window.innerHeight?Q(!0):Q(!1);if(q.current){var a=q.current.getBoundingClientRect().height;te(a)}Z.current&&Z.current.focus(),document.addEventListener("click",t)}return function(){document.removeEventListener("click",t)}}),[Y]),r.a.createElement("div",{className:"newfilter-dropdown ".concat(g()(h.a.dropdownWrapper,x&&h.a.disabled)),ref:z,onMouseOver:function(){return ue(!0)},onMouseLeave:function(){return ue(!1)}},r.a.createElement("div",{className:"newfilter-trigger ".concat(pe),onClick:function(){x||H(!Y)}},Object(i.cloneElement)(t,{selected:G,value:u,undefinedConst:_,disabled:x,open:Y}),(Y||ce)&&M&&r.a.createElement("div",{className:g()(h.a.clearButton,h.a.alignTop),onClick:M})),Y&&ge())}},a0Z9:function(e,t,a){e.exports=a.p+"fe0964baa9b1dcd0ed3f0a00998415c3.svg"},"aVY/":function(e,t,a){e.exports={root:"root-23zHxL6oA4"}},ah5l:function(e,t,a){e.exports={root:"root-2r6sYmsdE_","status-box":"status-box-1nldpHwTDI",statusBox:"status-box-1nldpHwTDI",icon:"icon-IK8PZydXD2",disabled:"disabled-jDU2m6Nul1","cart-down":"cart-down-16YZW_HjsS",cartDown:"cart-down-16YZW_HjsS",expanded:"expanded-3OMhu7Ola7",dropdown:"dropdown-29g_lBrehk",trigger:"trigger-1hpYCeiX8_"}},"avg+":function(e,t,a){e.exports=a.p+"966231933d7422bf4c8e2c04ea16a06b.svg"},bRS7:function(e,t,a){"use strict";a.r(t);var n=a("mVeg"),i=a("cDcd"),r=a.n(i),o=a("V/h/"),s=a("K2gz"),l=a.n(s),c=a("yZ+p"),u=a.n(c),d=a("NphA"),f=a.n(d),p=a("246l"),m=a.n(p),h=a("hlQ/"),v=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(t,a)};return function(t,a){if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),g=u.a.TextArea,E=function(e){function t(t){var a=e.call(this,t)||this;return a.state={expanded:t.expanded||!1,innerValue:t.value,showDel:!1},a.onChange=a.onChange.bind(a),a.onSubmit=a.onSubmit.bind(a),a.onReset=a.onReset.bind(a),a.toggleExpand=a.toggleExpand.bind(a),a.whetherToggle=a.whetherToggle.bind(a),a.clearValue=a.clearValue.bind(a),a}return v(t,e),t.prototype.dropdown=function(){var e=this,t=this.props,a=t.name,i=t.multiple,o=t.value,s=this.state.innerValue;return r.a.createElement("div",{className:f.a.inputBackWrapper,ref:function(t){return e.modalRef=t}},r.a.createElement("div",{className:f.a.titleWrapper},r.a.createElement("span",null,a),r.a.createElement("div",{className:l()(f.a.clearDivider,(s||o)&&f.a.show)},r.a.createElement("div",{className:f.a.clear,onClick:this.clearValue},Object(n.t)("\u6e05\u9664")))),i?r.a.createElement(g,{autosize:{minRows:3,maxRows:4},onChange:this.onChange,value:s,resizeable:!1,ref:function(t){return e.textareaRef=t},onPressEnter:this.onSubmit}):r.a.createElement(u.a,{onChange:this.onChange,value:s,autoFocus:!0,onPressEnter:this.onSubmit}),r.a.createElement("div",{className:f.a.buttonGroup},r.a.createElement("div",{className:l()(f.a.button,m.a.newButton,m.a.primary,m.a.h28),onClick:this.onSubmit},Object(n.t)("\u786e\u5b9a")),r.a.createElement("div",{className:l()(f.a.button,m.a.newButton,m.a.default,m.a.h28),onClick:this.onReset},Object(n.t)("\u53d6\u6d88"))))},t.prototype.trigger=function(){var e,t=this,a=this.props,i=a.value,o=a.className,s=a.label,c=this.state,u=c.expanded,d=c.showDel;return r.a.createElement("div",{className:f.a.triggerWrapper,onMouseEnter:function(){return t.setState({showDel:!0})},onMouseOver:function(){return t.setState({showDel:!0})}},r.a.createElement("div",{className:"newfilter-trigger ".concat(l()(f.a.selectTrigger,f.a.trigger,f.a.triggerBackground,(d||u)&&f.a.isExpanded,o)),onClick:this.toggleExpand},s&&r.a.createElement("span",{className:l()(f.a.itemLabel,f.a.itemLabelEllipsis)},s),r.a.createElement("span",{className:l()(f.a.itemText,f.a.itemTextEllipsis,(e={},e[f.a.notSelected]=!i,e))},r.a.createElement("span",null,i||Object(n.t)("\u8bf7\u8f93\u5165"))),r.a.createElement("span",{className:"".concat(f.a.selectArrowWrapper," ").concat(u&&f.a.isExpanded)},r.a.createElement("div",{className:h.cartDown}))),u&&this.dropdown())},t.prototype.render=function(){var e=this,t=this.props.onClearProp,a=this.state,n=a.showDel,i=a.expanded;return r.a.createElement("div",{className:f.a.root,onMouseLeave:function(){return e.setState({showDel:!1})}},this.trigger(),(n||i)&&t&&r.a.createElement("a",{className:l()(f.a.clearButton,f.a.alignTop),onClick:t}))},t.prototype.componentDidMount=function(){this.addAutoFocus()},t.prototype.addAutoFocus=function(){var e=this;this.state.expanded&&setTimeout((function(){if(e.textareaRef){e.textareaRef.focus();var t=e.textareaRef.textAreaRef;t&&t.value&&t.value.length&&t.setSelectionRange(t.value.length,t.value.length+1)}}))},t.prototype.toggleExpand=function(){var e=this.state.expanded;e?document.removeEventListener("click",this.whetherToggle,!1):document.addEventListener("click",this.whetherToggle,!1),this.setState({expanded:!e,showDel:!1},this.addAutoFocus)},t.prototype.whetherToggle=function(e){this.modalRef&&e.target&&e.target instanceof Element&&!this.modalRef.contains(e.target)&&this.toggleExpand()},t.prototype.onChange=function(e){this.setState({innerValue:e.target.value})},t.prototype.onSubmit=function(){var e=this.state.innerValue;(0,this.props.onChange)({content:e||null}),this.toggleExpand()},t.prototype.onReset=function(){var e=this.props.value;this.setState({innerValue:e}),this.toggleExpand()},t.prototype.clearValue=function(){var e=this.props.onChange;this.setState({innerValue:""},(function(){e({content:null})}))},t.defaultProps={name:Object(n.t)("\u5355\u884c\u6587\u672c")},t}(i.Component),b=a("HDqR"),y=a("tchc"),S=a("L8Eh"),I=a("ixak"),T=a("B7Ya"),C=a("iTKN"),P=a("7bn+"),w=a("necX"),D=a.n(w),O=a("2CQ4"),R=a("w2Sj"),j=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(t,a)};return function(t,a){if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),k=function(){return(k=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},N=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},A=function(e,t,a){if(a||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},L=function(e){function t(t){var a=e.call(this,t)||this;return a.onTreeSelectChange=function(e){var t=a.props,n=t.onChange,i=t.issueField,r=t.value;n(Object(o.default)(r,(function(t){t[i.id]={value:e,fixed:!1}})))},a.onClear=a.onClear.bind(a),a.multipleSelect=a.multipleSelect.bind(a),a.onDateChange=a.onDateChange.bind(a),a.onTextChange=a.onTextChange.bind(a),a.onRangeChange=a.onRangeChange.bind(a),a}return j(t,e),t.prototype.porpertyComponent=function(e){var t,a,i,o,s,c,u,d,f,p,m=this,h=this.props,v=h.value,g=h.issueField,w=h.onClearProp,j=h.expanded,L=h.isInProject,F=h.projectID,_=h.isPortal,M=h.portalProps,x=h.rootContainerId,B=h.isSpread,U=h.handleChangeCustomSchemeContent,W=h.modeType,Y={items:A([C.UNSPECIFIC_ITEM],N(e.map((function(e){return k(k({},e),{text:e.title})}))),!1),value:A(A([],N((null===(t=v[g.id])||void 0===t?void 0:t.constValue)||[]),!1),N((null===(a=v[g.id])||void 0===a?void 0:a.value)||[]),!1),label:g.name,handleChangeCustomSchemeContent:U,fieldKey:v[g.id].key,customFieldId:v[g.id].customFieldId};switch(g.componentType){case P.PROPERTY_TYPE_CONSTANTS.SELECT_SINGLE:case P.PROPERTY_TYPE_CONSTANTS.SELECT_MULTI:return r.a.createElement(T.default,{isPortal:_,portalProps:M,value:A(A([],N((null===(i=v[g.id])||void 0===i?void 0:i.constValue)||[]),!1),N((null===(o=v[g.id])||void 0===o?void 0:o.value)||[]),!1),items:A([C.UNSPECIFIC_ITEM],N(e.map((function(e){return k(k({},e),{text:e.title})}))),!1),onSelect:function(e){m.multipleSelect({value:e.id===C.UNSPECIFIC?C.UNSPECIFIC:e.id})},isMultiple:!0,show:j,onClear:function(){return m.onClear([])},triggerExtraProps:{label:g.name,removable:!!w,onRemove:w},pingPuObj:B&&Y,dropdownStyle:l()(B&&D.a.flatTrigger),itemInfo:v[g.id]});case P.PROPERTY_TYPE_CONSTANTS.TEXT_SINGLE_LINE:return r.a.createElement(E,{label:g.name,name:g.name,placeholder:Object(n.t)("\u8bf7\u8f93\u5165"),value:(null===(s=v[g.id])||void 0===s?void 0:s.value)||"",onChange:this.onTextChange,onClear:function(){return m.onClear("")},onClearProp:w,expanded:j});case P.PROPERTY_TYPE_CONSTANTS.TEXT_MULTI_LINE:return r.a.createElement(E,{label:g.name,name:g.name,multiple:!0,placeholder:Object(n.t)("\u8bf7\u8f93\u5165"),value:(null===(c=v[g.id])||void 0===c?void 0:c.value)||"",onChange:this.onTextChange,onClear:function(){return m.onClear("")},onClearProp:w,expanded:j});case P.PROPERTY_TYPE_CONSTANTS.SELECT_MEMBER_SINGLE:case P.PROPERTY_TYPE_CONSTANTS.SELECT_MEMBER_MULTI:return r.a.createElement(S.default,{dropdownStyle:l()(B&&D.a.flatTrigger),rootContainerId:x,componentType:B?C.ComponentType.FLAT_TYPE:C.ComponentType.FILTER,pingPuObj:B&&k(k({},Y),{items:v[g.id]?A(A([],N(v[g.id].constValue&&v[g.id].constValue.length?[C.UNSPECIFIC_ITEM]:[]),!1),N(v[g.id].value.map((function(e){return v[g.id].userMap[e]}))),!1):[]}),isMultiple:!0,useUnspecificItem:!0,show:j,inProject:L,projectID:F,value:A(A([],N((null===(u=v[g.id])||void 0===u?void 0:u.constValue)||[]),!1),N((null===(d=v[g.id])||void 0===d?void 0:d.value)||[]),!1),onSelect:function(e){m.multipleSelect(k({value:e.id===C.UNSPECIFIC?C.UNSPECIFIC:e.id},e.id!==C.UNSPECIFIC?{userItem:e}:{}))},onClear:function(){return m.onClear([])},triggerExtraProps:{label:g.name,removable:!!w,onRemove:w,initialSelectedItem:v[g.id]?A(A([],N(v[g.id].constValue&&v[g.id].constValue.length?[C.UNSPECIFIC_ITEM]:[]),!1),N(v[g.id].value.map((function(e){return v[g.id].userMap[e]}))),!1):void 0},allUsers:!0,itemInfo:v[g.id]});case P.PROPERTY_TYPE_CONSTANTS.SELECT_ITERATION_SINGLE:case P.PROPERTY_TYPE_CONSTANTS.SELECT_ITERATION_MULTI:return r.a.createElement(I.default,{isPortal:_,portalProps:M,componentType:C.ComponentType.FILTER,isMultiple:!0,useUnspecificItem:!0,show:j,inProject:L,projectID:F,value:A(A([],N((null===(f=v[g.id])||void 0===f?void 0:f.constValue)||[]),!1),N((null===(p=v[g.id])||void 0===p?void 0:p.value)||[]),!1),onSelect:function(e){m.multipleSelect(k({value:e.id===C.UNSPECIFIC?C.UNSPECIFIC:e.id},e.id!==C.UNSPECIFIC?{iterationItem:e}:{}))},onClear:function(){return m.onClear([])},triggerExtraProps:{label:g.name,removable:!!w,onRemove:w,initialSelectedItem:v[g.id]?A(A([],N(v[g.id].constValue&&v[g.id].constValue.length?[C.UNSPECIFIC_ITEM]:[]),!1),N(v[g.id].value.map((function(e){return v[g.id].iterationMap[e]}))),!1):void 0}});case P.PROPERTY_TYPE_CONSTANTS.TEXT_DATE:return r.a.createElement(b.default,{isPortal:_,portalProps:M,label:g.name,from:v[g.id]?v[g.id].value.startDate:"",to:v[g.id]?v[g.id].value.endDate:"",onChange:this.onDateChange,onClearProp:w,expanded:j});case P.PROPERTY_TYPE_CONSTANTS.TEXT_DATETIME:return r.a.createElement(b.default,{isTimePicker:!0,isPortal:_,portalProps:M,label:g.name,from:v[g.id]?v[g.id].value.startDate:"",to:v[g.id]?v[g.id].value.endDate:"",onChange:this.onDateChange,onClearProp:w,expanded:j});case P.PROPERTY_TYPE_CONSTANTS.TEXT_INTEGER:case P.PROPERTY_TYPE_CONSTANTS.TEXT_DECIMAL:return r.a.createElement(y.default,{onChange:this.onRangeChange,label:g.name+(g.unit?" (".concat(g.unit,")"):""),unit:g.unit,from:v[g.id]?v[g.id].value.start:"",to:v[g.id]?v[g.id].value.end:"",isInteger:g.componentType===P.PROPERTY_TYPE_CONSTANTS.TEXT_INTEGER,maxValue:999999999,minValue:0,onClearProp:w,expanded:j});case P.PROPERTY_TYPE_CONSTANTS.SELECT_TREE_SINGLE:return r.a.createElement(O.a,{label:g.name,options:g.options||[],value:v[g.id]?v[g.id].value:"",onChange:this.onTreeSelectChange,onClearProp:w,showClose:W!==R.a.select&&W!==R.a.filter,isPortal:!0,portalProps:{toRight:!0,portalWrapStyle:{zIndex:W===R.a.select?2500:1041}},modeType:W});case P.PROPERTY_TYPE_CONSTANTS.SELECT_TREE_MULTI:return r.a.createElement(O.a,{label:g.name,options:g.options||[],value:v[g.id]?v[g.id].value:"",onChange:this.onTreeSelectChange,onClearProp:w,multiple:!0,showClose:W!==R.a.select&&W!==R.a.filter,isPortal:!0,portalProps:{toRight:!0,portalWrapStyle:{zIndex:W===R.a.select?2500:1041}},modeType:W});default:window.console.warn("error unkown component type")}return""},t.prototype.render=function(){var e=this.props.issueField,t=e.options?e.options.map((function(e){return k(k({},e),{value:e.value,id:e.value,text:e.title})})):[];return r.a.createElement("div",{className:"newfilter-custom",style:{display:"flex"}},this.porpertyComponent(t))},t.prototype.onClear=function(e){var t=this.props,a=t.onChange,n=t.issueField,i=t.value;a(Object(o.default)(i,(function(t){t[n.id].value=e,Array.isArray(e)&&(t[n.id].constValue=e,t[n.id].validInfo=[])})))},t.prototype.multipleSelect=function(e,t){void 0===t&&(t=!1);var a=this.props,n=a.onChange,i=a.issueField,r=a.value;n(Object(o.default)(r,(function(a){if(a[i.id]||(a[i.id]=k({value:[],constValue:[],fixed:!1},t?{validInfo:[]}:{})),C.CONST_ITEMS.some((function(t){return t.value===e.value}))){var n=(a[i.id]&&a[i.id].constValue||[]).findIndex((function(t){return t===e.value}));n>-1?a[i.id].constValue.splice(n,1):(a[i.id].constValue||(a[i.id].constValue=[]),a[i.id].constValue.push(e.value))}else{var r=a[i.id]?a[i.id].value:[];(Array.isArray(e.value)?e.value:[e.value]).map((function(n){var o=r.findIndex((function(e){return e===n}));o>-1?(a[i.id].value.splice(o,1),t&&a[i.id].validInfo.splice(o,1)):(a[i.id].value||(a[i.id].value=[]),a[i.id].validInfo||(a[i.id].validInfo=[]),a[i.id].userMap||(a[i.id].userMap={}),e.userItem&&(a[i.id].userMap[e.value]=e.userItem),a[i.id].iterationMap||(a[i.id].iterationMap={}),e.iterationItem&&(a[i.id].iterationMap[e.value]=e.iterationItem),a[i.id].value.push(n),t&&a[i.id].validInfo.push({id:n,avatar:e.avatar,name:e.name}))}))}})))},t.prototype.onDateChange=function(e,t){var a=this.props,n=a.onChange,i=a.issueField,r=a.value;n(Object(o.default)(r,(function(a){a[i.id]={value:{startDate:e||"",endDate:t||""},fixed:!1}})))},t.prototype.onTextChange=function(e){var t=e.content,a=this.props,n=a.onChange,i=a.issueField,r=a.value;n(Object(o.default)(r,(function(e){e[i.id]={value:t,fixed:!1}})))},t.prototype.onRangeChange=function(e,t){var a=this.props,n=a.onChange,i=a.issueField,r=a.value;n(Object(o.default)(r,(function(a){a[i.id]={value:{start:e||null,end:t||null},fixed:!1}})))},t.defaultProps={isInProject:!0},t}(i.Component);t.default=L},"bx+P":function(e,t,a){e.exports={"progress-wrapper":"progress-wrapper-C3Bx40bbFt",progressWrapper:"progress-wrapper-C3Bx40bbFt","total-progress":"total-progress-1Wh77_RUO-",totalProgress:"total-progress-1Wh77_RUO-","bar-group":"bar-group-3tY1g19J-x",barGroup:"bar-group-3tY1g19J-x",bar:"bar-39lNIbVPhi",untested:"untested-2IP2p2dHa7",waiting:"waiting-1qnxxBURot",failed:"failed-3RHKO0EuCL",passed:"passed-3gB76hzhbt",completed:"completed-2_huKBGhC0",retest:"retest-1-o1lacGr4",testing:"testing-xDon2-pMRD",blocked:"blocked-1Sw101oPJ4",panel:"panel-2Eyu1Uapkw",statistic:"statistic-PM7ZE7h2WX",progress:"progress-kG9umuZq0E","progress-cell":"progress-cell-1_hlRUI8He",progressCell:"progress-cell-1_hlRUI8He",square:"square-b1ErMAGLDF",total:"total-24gAaTOEvB"}},cHM4:function(e,t,a){e.exports=a.p+"e41cf1e1bdab18711fc77291a42a5d04.svg"},cUHt:function(e,t,a){"use strict";a.r(t),a.d(t,"getSlotContext",(function(){return n}));var n=function(e,t){return{issue:{id:e.id,name:e.name,issueType:e.type,resourceCode:e.code},projectId:t}}},culb:function(e,t,a){"use strict";a.r(t),a.d(t,"IssueFilterProps",(function(){return gt})),a.d(t,"IssueCommonProps",(function(){return St}));var n=a("/HJl"),i=a.n(n),r=a("cDcd"),o=a.n(r),s=a("17x9"),l=a.n(s),c=a("dtw8"),u=a("5JFE"),d=a("TGxl"),f=a("TLfn"),p=a("te0o"),m=a("G4bb"),h=function(e,t,a,n){return new(a||(a=Promise))((function(i,r){function o(e){try{l(n.next(e))}catch(t){r(t)}}function s(e){try{l(n.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,s)}l((n=n.apply(e,t||[])).next())}))},v=function(e,t){var a,n,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(l){return function(s){if(a)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(a=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(l){s=[6,l],n=0}finally{a=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},g=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},E=function(e){var t=e.issueType,a=e.projectName,n=g(Object(r.useState)(!1),2),i=n[0],o=n[1];return Object(d.c)((function(){return h(void 0,void 0,void 0,(function(){return v(this,(function(e){return h(void 0,void 0,void 0,(function(){var e,n,i,r;return v(this,(function(s){switch(s.label){case 0:return Object(m.e)(t)?[4,Object(p.v)()]:[3,2];case 1:return e=s.sent().data.filterFixed,"1"==="".concat(e)&&o(!0),[2];case 2:return n=f.IssueTypeFixedCodes[t],[4,Object(p.D)(a,{codes:n})];case 3:return i=s.sent().data,(r=i.find((function(e){return e.code===n})))&&"1"===r.value&&o(!0),[2]}}))})),[2]}))}))})),{leftFixed:i,onFixedToggle:function(){return h(void 0,void 0,void 0,(function(){var e;return v(this,(function(n){switch(n.label){case 0:return Object(m.e)(t)?[4,Object(p.E)(i?"0":"1")]:[3,2];case 1:return n.sent(),o(!i),[2];case 2:return e=f.IssueTypeFixedCodes[t],[4,Object(p.J)(a,e,i?"0":"1")];case 3:return n.sent(),o(!i),[2]}}))}))}}},b=a("DJc2"),y=a.n(b),S=a("mVeg"),I=a("Mdvu"),T=a("eydm"),C=a("DlAp"),P=a("Clsu"),w=a("LvDl"),D=a("xgZS"),O=a("rkME"),R=function(){return(R=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},j=function(e,t,a,n){return new(a||(a=Promise))((function(i,r){function o(e){try{l(n.next(e))}catch(t){r(t)}}function s(e){try{l(n.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,s)}l((n=n.apply(e,t||[])).next())}))},k=function(e,t){var a,n,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(l){return function(s){if(a)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(a=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(l){s=[6,l],n=0}finally{a=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},N=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},A=function(e,t,a){if(a||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},L=Object(c.withRouter)((function(e){var t=Object(r.useContext)(C.b),a=t.state,n=a.hasFilterChanged,i=a.currentFilterScheme,s=a.filterSchemes,l=a.type,c=a.currentProject,d=a.issueType,f=a.activeFilterContent,m=a.projectIdList,h=t.dispatch,v=N(Object(r.useState)(!1),2),g=v[0],E=v[1],b=N(Object(r.useState)(!1),2),L=b[0],F=b[1];if(Object(r.useEffect)((function(){Object(O.isPermissible)("project",c.id,"collaboration:shareFilterConfiguration").then((function(e){F(e)}))}),[]),!n)return o.a.createElement(o.a.Fragment,null);var _=s[i.value],M=_.creator,x=_.content,B=_.sharedTeam,U=M===e.user.id;return o.a.createElement("div",{className:y.a.filterChanedMain},o.a.createElement(u.Tooltip,{title:Object(S.t)("\u5c06\u5f53\u524d\u7b5b\u9009\u5668\u53d8\u66f4\u4fdd\u5b58\u4e3a\u65b0\u7b5b\u9009\u5668")},o.a.createElement(u.Button,{size:"small",className:y.a.btn,onClick:function(){return E(!0)}},Object(S.t)("\u4fdd\u5b58\u4e3a\u65b0\u7b5b\u9009\u5668"))),"custom"===i.type&&(U||L)?o.a.createElement(u.Tooltip,{title:Object(S.t)("\u4fdd\u5b58\u53d8\u66f4\u5230\u5f53\u524d\u7b5b\u9009\u5668")},o.a.createElement(u.Button,{size:"small",className:y.a.btn,onClick:function(){return j(void 0,void 0,void 0,(function(){var t,a,n,r;return k(this,(function(o){switch(o.label){case 0:return t=Object(T.b)(f),"team"===l&&B&&(null===(r=null===t||void 0===t?void 0:t.conditions)||void 0===r?void 0:r.length)&&(a=[],t.conditions.map((function(e){var t;"PROJECT"===e.key&&e.value&&e.value.length&&(null===(t=null===e||void 0===e?void 0:e.value)||void 0===t||t.map((function(e){m.includes(e)&&a.push(e)})))})),0===a.length)?(Object(D.danger)(Object(S.t)("\u8bf7\u9009\u62e9\u7814\u53d1\u7a7a\u95f4")),[2]):[4,Object(p.H)(l,c.id,d,i.value,t,{code:e.router.params.code})];case 1:return o.sent(),u.message.success(Object(S.t)("\u4fdd\u5b58\u6210\u529f")),I.default.emit(I.EventBusType.FilterLayout,I.FilterLayoutEventKeys.filterReloadScheme,!0),n=Object(w.cloneDeep)(f),i.isSpread&&(n.conditions=n.conditions.map((function(e){return e.isSpread=1,e}))),h({type:C.a.init,value:{activeFilterContent:n}}),[2]}}))}))}},Object(S.t)("\u4fdd\u5b58\u53d8\u66f4"))):null,o.a.createElement(u.Tooltip,{title:Object(S.t)("\u6e05\u9664\u5f53\u524d\u7b5b\u9009\u5668\u7684\u53d8\u66f4")},o.a.createElement(u.Button,{size:"small",className:y.a.btn,onClick:function(){h({type:C.a.setActiveFilterContent,value:function(e){e.conditions=A([],N(x.conditions),!1),e.sort=R({},x.sort)}})}},Object(S.t)("\u6e05\u9664\u53d8\u66f4"))),g?o.a.createElement(P.a,{visable:g,modeType:"new",onClose:function(){return E(!1)}}):null)})),F=a("XXMN"),_=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},M=function(e,t){var a=_(Object(r.useState)(!1),2),n=a[0],i=a[1];return Object(r.useEffect)((function(){if(e.current){var a=function(a){if(n){if(!document.contains(a.target))return;if(t&&t.current&&t.current.contains(a.target))return;if(e.current.contains(a.target))return;i(!1)}};return n&&document.addEventListener("click",a),function(){document.removeEventListener("click",a)}}}),[e,n]),{visible:n,setVisible:i}},x=a("BqJP"),B=a("pMd9"),U=a.n(B),W=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},Y=function(e){var t=e.leftFixed,a=e.onFixedToggle,n=Object(r.useContext)(C.b).state.currentFilterScheme,i=Object(d.d)(),s=Object(r.useRef)(null),l=M(i,s),c=l.visible,f=l.setVisible,p=W(Object(r.useState)(!1),2),m=p[0],h=p[1],v=W(Object(r.useState)(""),2),g=v[0],E=v[1],b=function(){return i.current},I=o.a.createElement("div",{className:y.a.schemeDropdowmContent},o.a.createElement("div",{className:y.a.schemeContent},o.a.createElement("div",{className:"".concat(y.a.item," ").concat(y.a.pb4)},o.a.createElement(u.Input,{placeholder:Object(S.t)("\u641c\u7d22\u7b5b\u9009\u5668\u540d\u79f0"),allowClear:!0,onChange:function(e){return E(e.target.value)},prefix:o.a.createElement(F.Search,{style:{color:"#BAC1CC"}})})),o.a.createElement("div",{className:y.a.schemeMain},o.a.createElement(x.a,{searchValue:g,getPopupContainer:b,setVisible:f})),o.a.createElement("div",{className:y.a.line}),!1,o.a.createElement("div",{className:"".concat(U.a.menuItem," ").concat(y.a.add),onClick:a},o.a.createElement("span",{className:y.a.rowCenter},o.a.createElement("span",{className:y.a.fixedIcon}),Object(S.t)("\u56fa\u5b9a\u5230\u5de6\u4fa7")))));return o.a.createElement(o.a.Fragment,null,t?o.a.createElement("span",{className:y.a.schemeDropdowmTitle},n.text):o.a.createElement(u.Popover,{placement:"bottomLeft",content:I,trigger:"click",visible:c,getPopupContainer:b,destroyTooltipOnHide:!0,overlayClassName:"popoverContent"},o.a.createElement("span",{ref:s,className:y.a.schemeDropdowmTitle,onClick:function(){return f(!0)}},n.text,o.a.createElement(F.TriangleDown,null))),m?o.a.createElement(P.a,{getContainer:function(){return i.current},visable:m,onClose:function(){return h(!1)}}):null)},H=a("tG+G"),V=a.n(H),G=function(){return(G=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},K=function(e){return r.createElement("svg",G({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"none",viewBox:"0 0 16 17"},e),r.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M1.5 4.188a1 1 0 0 1 1-1h11a1 1 0 1 1 0 2h-11a1 1 0 0 1-1-1Zm2 4a1 1 0 0 1 1-1h7a1 1 0 1 1 0 2h-7a1 1 0 0 1-1-1Zm3 3a1 1 0 1 0 0 2h3a1 1 0 1 0 0-2h-3Z",clipRule:"evenodd"}))},z=function(){return(z=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},q=function(e){return r.createElement("svg",z({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"none",viewBox:"0 0 16 17"},e),r.createElement("path",{fill:"currentColor",d:"M3.925 11.453.591 8.12a.64.64 0 0 1 .036-.94 6.029 6.029 0 0 1 5.587-1.208l3.487-2.726a3.51 3.51 0 0 1 1.013-2.87.64.64 0 0 1 .906 0l4.095 4.093a.64.64 0 0 1 0 .907 3.507 3.507 0 0 1-2.871 1.013L10.216 9.75c.7 2.005.28 4.284-1.111 5.906a.641.641 0 0 1-.94.036L4.832 12.36 1.19 16a.64.64 0 0 1-.906-.906l3.64-3.64Z"}))},Z=function(){return(Z=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},J=function(e){return r.createElement("svg",Z({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"none",viewBox:"0 0 16 17"},e),r.createElement("path",{fill:"currentColor",d:"M8.546 14.26a4.773 4.773 0 0 0 .352-4.368.64.64 0 0 1 .085-.645l3.085-3.946a.642.642 0 0 1 .647-.23 2.254 2.254 0 0 0 1.575-.214L11.233 1.8a2.25 2.25 0 0 0-.213 1.575.64.64 0 0 1-.23.647L6.738 7.19a.64.64 0 0 1-.61.099 4.75 4.75 0 0 0-4.103.45l3.26 3.26V11l3.261 3.26Zm-8.26.833 3.64-3.64L.594 8.118a.64.64 0 0 1 .035-.94 6.03 6.03 0 0 1 5.587-1.207l3.487-2.726a3.512 3.512 0 0 1 1.013-2.87.64.64 0 0 1 .906 0l4.093 4.093a.64.64 0 0 1 0 .906 3.509 3.509 0 0 1-2.87 1.014L10.216 9.75c.7 2.005.28 4.284-1.11 5.907a.643.643 0 0 1-.463.222H8.62a.638.638 0 0 1-.453-.187l-3.334-3.334L1.192 16a.64.64 0 1 1-.906-.906Z"}))},X=function(){return(X=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Q=function(e){return r.createElement("svg",X({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"none",viewBox:"0 0 16 17"},e),r.createElement("path",{fill:"#176DE6",d:"M12.612 3.2a.875.875 0 1 0-1.75 0v7H9.147a.438.438 0 0 0-.341.711l2.248 2.81a.875.875 0 0 0 1.366 0l2.248-2.81a.438.438 0 0 0-.341-.71h-1.715v-7Z"}),r.createElement("path",{fill:"#666F80",fillRule:"evenodd",d:"M1.236 4.075c0-.483.392-.875.875-.875h5.25a.875.875 0 0 1 0 1.75h-5.25a.875.875 0 0 1-.875-.875Zm0 3.5c0-.483.392-.875.875-.875h5.25a.875.875 0 0 1 0 1.75h-5.25a.875.875 0 0 1-.875-.875Zm.875 2.625a.875.875 0 1 0 0 1.75h3.5a.875.875 0 1 0 0-1.75h-3.5Z",clipRule:"evenodd"}))},$=function(){return($=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},ee=function(e){return r.createElement("svg",$({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"none",viewBox:"0 0 16 17"},e),r.createElement("path",{fill:"#176DE6",d:"M12.612 13.175a.875.875 0 1 1-1.75 0v-7H9.147a.437.437 0 0 1-.341-.711l2.248-2.81a.875.875 0 0 1 1.366 0l2.248 2.81c.23.286.026.71-.341.71h-1.715v7Z"}),r.createElement("path",{fill:"#666F80",fillRule:"evenodd",d:"M1.236 12.3c0 .483.392.875.875.875h5.25a.875.875 0 0 0 0-1.75h-5.25a.875.875 0 0 0-.875.875Zm0-3.5c0 .483.392.875.875.875h5.25a.875.875 0 0 0 0-1.75h-5.25a.875.875 0 0 0-.875.875Zm.875-2.625a.875.875 0 1 1 0-1.75h3.5a.875.875 0 1 1 0 1.75h-3.5Z",clipRule:"evenodd"}))},te=a("mTYr"),ae=a("nuIr"),ne=a("7bn+"),ie=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},re=[ae.BASE_FIELD_TYPE.BASE_ISSUE_TYPE],oe=[ne.PROPERTY_TYPE_CONSTANTS.TEXT_SINGLE_LINE,ne.PROPERTY_TYPE_CONSTANTS.TEXT_MULTI_LINE],se=[ae.BASE_FIELD_TYPE.WORKING_HOURS,ae.BASE_FIELD_TYPE.PROGRESS,ae.BASE_FIELD_TYPE.START_DATE,ae.BASE_FIELD_TYPE.DUE_DATE,ae.BASE_FIELD_TYPE.RELEASE_DATE,ae.BASE_FIELD_TYPE.UPDATED_AT,ae.BASE_FIELD_TYPE.CREATED_AT],le=[ne.PROPERTY_TYPE_CONSTANTS.TEXT_INTEGER,ne.PROPERTY_TYPE_CONSTANTS.TEXT_DECIMAL,ne.PROPERTY_TYPE_CONSTANTS.TEXT_DATE,ne.PROPERTY_TYPE_CONSTANTS.TEXT_DATETIME],ce=function(e){var t=Object(r.useContext)(C.b),a=t.state.filterList,n=t.dispatch,i=e.selectedAttrs,s=e.value,l=e.index,c=e.className,u=e.getPopupContainer,d=ie(Object(r.useState)(),2),f=d[0],p=d[1],h=Object(r.useMemo)((function(){return a.map((function(e){return{value:e.value,label:e.label,disabled:i.includes(e.value)||i.includes(e.issueFieldId)}})).sort((function(e,t){return!e.disabled&&t.disabled?-1:e.disabled&&!t.disabled?1:0}))}),[a,i]);return Object(r.useEffect)((function(){var e=h.find((function(e){return Object(m.a)(s.toString(),e.value.toString())}));e&&p(e.value)}),[s]),o.a.createElement(te.default,{className:c,options:h,value:f,style:{width:170},allowClear:!1,onChange:function(e){var t=a.find((function(t){return t.value===e}));n({type:C.a.setActiveFilterContent,value:function(a){var n,i=a.conditions[l],r={key:t.key,fixed:i.fixed,value:[]};re.includes(e)?r.value="":se.includes(e)&&(r.value={}),"CUSTOM"===t.key&&(r.customFieldId=-1!=="".concat(t.issueFieldId).indexOf("combined-")?null:t.issueFieldId,(null===(n=t.combinedFieldIds)||void 0===n?void 0:n.length)>1&&(r.combinedFieldIds=t.combinedFieldIds),oe.includes(t.componentType)?r.value="":le.includes(t.componentType)&&(r.value={})),a.conditions[l]=r}})},getPopupContainer:u})},ue=a("w2Sj"),de=a("iTKN"),fe=function(e,t){return e.findIndex((function(e){var a;return"CUSTOM"===e.key?e.customFieldId?e.customFieldId===t:"combined-".concat(null===(a=e.combinedFieldIds)||void 0===a?void 0:a.join(":"))===t:e.key===t}))},pe=function(e,t,a,n,i){void 0===n&&(n=!1),void 0===i&&(i=!1),e({type:C.a.setActiveFilterContent,value:function(e){var n=e.conditions,r=n[fe(n,t)];if(de.CONST_ITEMS.some((function(e){return e.value===a.value}))){var o=(r&&r.constValue||[]).findIndex((function(e){return e===a.value}));o>-1?r.constValue.splice(o,1):(r.constValue||(r.constValue=[]),r.constValue.push(a.value))}else{var s=r?r.value:[];(Array.isArray(a.value)?a.value:[a.value]).map((function(e){var t=s.findIndex((function(t){return t===e}));t>-1?(r.value.splice(t,1),r.userMap&&delete r.userMap[a.value],r.selectedItems&&delete r.selectedItems[a.value],i&&r.validInfo.splice(t,1)):(r.value||(r.value=[]),r.validInfo||(r.validInfo=[]),r.userMap||(r.userMap={}),r.selectedItems||(r.selectedItems={}),r.userMap[a.value]=a,r.selectedItems[a.value]=a,r.value.push(e),i&&r.validInfo.push({id:e,avatar:a.avatar,name:a.name,display_name:a.display_name,icon:a.icon}))}))}}})},me=function(){return(me=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},he=function(e){var t=e.value,a=e.type,n=e.issueType,i=e.modeType,s=e.itemInfo,l=e.getPopupContainer,c=e.projectId,u=e.rootContainerId,d=Object(r.useContext)(C.b),p=d.state,h=p.filterList,v=p.payed,g=d.dispatch,E={value:t,onSelect:function(e){a===f.FilterIssueTypes.PROJECT?pe(g,a,e,!1,!0):pe(g,a,e)},onInvertSelect:function(e){!function(e,t,a){e({type:C.a.setActiveFilterContent,value:function(e){var n=fe(e.conditions,t);e.conditions[n]=Object.assign(e.conditions[n],{value:a,constValue:[],userMap:{},selectedItems:{}})}})}(g,a,e)},onClear:function(){!function(e,t){e({type:C.a.setActiveFilterContent,value:function(e){var a=fe(e.conditions,t);e.conditions[a]=Object.assign(e.conditions[a],{value:[],constValue:[],userMap:{},selectedItems:{}})}})}(g,a)},onRemove:function(){!function(e,t){e({type:C.a.setActiveFilterContent,value:function(e){var a=fe(e.conditions,t);e.conditions.splice(a,1)}})}(g,a)},onChange:function(e){g({type:C.a.setActiveFilterContent,value:function(t){var n=fe(t.conditions,a);t.conditions[n].value=e}})},onCustomChange:function(e){var t=JSON.parse(JSON.stringify(e));g({type:C.a.setActiveFilterContent,value:function(e){var n=fe(e.conditions,a);delete t.fixed,e.conditions[n]=me(me({},e.conditions[n]),t)}})}},b=h.find((function(e){return Object(m.a)(a.toString(),e.value.toString())}));return b||"KEYWORD"===a.toString()||console.error("\u7b5b\u9009\u5668\u5b57\u6bb5\u3010".concat(a,"\u3011\u5339\u914d\u5931\u8d25,\u5f53\u524d\u7b5b\u9009\u5668\u65b9\u6848\u5c5e\u6027\uff0c\u5728\u6240\u6709\u7b5b\u9009\u9879\u4e2d\u627e\u4e0d\u5230"),h,a),o.a.createElement(ue.b,me({},E,{rootContainerId:u,attrType:a,issueType:n,modeType:i,itemInfo:s,getPopupContainer:l,fieldInfo:b,projectID:c,isPro:v,isSpread:s.isSpread}))},ve=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},ge=function(e,t,a){if(a||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},Ee=["KEYWORD"],be=function(e){var t=e.issueType,a=e.currentProject,n=Object(r.useContext)(C.b),i=n.state,s=i.activeFilterContent,l=i.conditionNumber,c=n.dispatch,f=Object(d.d)(),p=Object(r.useRef)(null),h=M(f,p),v=h.visible,g=h.setVisible,E=Object(r.useMemo)((function(){var e=[];return s.conditions.length&&(e=s.conditions.reduce((function(e,t){return t&&t.key&&e.push(Object(m.c)(t)),e}),[])),e}),[s]),b=function(){return f.current},y=function(e,t){e.key&&c({type:C.a.setActiveFilterContent,value:function(e){e.conditions[t].fixed=!e.conditions[t].fixed}})},I=o.a.createElement("div",{className:"".concat(V.a.filterAttrsContent," filter-attrs-content")},o.a.createElement("div",{className:V.a.title},o.a.createElement("span",null,Object(S.t)("\u7b5b\u9009")),o.a.createElement(F.Close,{onClick:function(){return g(!1)}})),o.a.createElement("div",{id:"filterItemsMain",className:V.a.filterItemsMain},s.conditions.map((function(e,n){var i;if(Ee.includes(e.key))return o.a.createElement(o.a.Fragment,null);var r=Object(m.c)(e);return o.a.createElement("div",{className:V.a.conditionItem,key:r||e.id},o.a.createElement(ce,{className:V.a.item,selectedAttrs:E,getPopupContainer:b,index:n,value:r}),o.a.createElement("div",{className:"".concat(V.a.coditionhandle," ").concat(e.fixed||!r?"":V.a.coditionInput)},e.fixed||!r?o.a.createElement(u.Input,{disabled:!0,placeholder:e.fixed?Object(S.t)("\u8bf7\u5728\u64cd\u4f5c\u533a\u4fee\u6539\u7b5b\u9009\u503c"):""}):o.a.createElement(he,{type:r,rootContainerId:null===(i=f.current)||void 0===i?void 0:i.id,value:e.constValue&&e.constValue.length?ge(ge([],ve(e.constValue),!1),ve(e.value),!1):e.value,getPopupContainer:b,issueType:t,modeType:ue.a.select,itemInfo:e,projectId:a.id})),o.a.createElement("div",{className:V.a.coditionMenu,title:Object(S.t)(e.fixed?"\u53d6\u6d88\u56fa\u5b9a\u7b5b\u9009\u6761\u4ef6\u5230\u64cd\u4f5c\u533a":"\u56fa\u5b9a\u7b5b\u9009\u6761\u4ef6\u5230\u64cd\u4f5c\u533a")},e.fixed?o.a.createElement(q,{color:e.key?"#257EFA":"#bac1cc",onClick:function(){return y(e,n)}}):o.a.createElement(J,{style:{color:e.key?"#666F80":"#bac1cc"},onClick:function(){return y(e,n)}}),o.a.createElement("span",{title:Object(S.t)("\u5220\u9664\u5f53\u524d\u7b5b\u9009\u6761\u4ef6")},o.a.createElement(F.CloseCircle,{onClick:function(){return function(e){c({type:C.a.setActiveFilterContent,value:function(t){t.conditions.splice(e,1)}})}(n)},style:{color:"#8D97A6"}}))))}))),o.a.createElement("div",{className:V.a.attrsFooter},o.a.createElement(u.Button,{type:"primary",icon:o.a.createElement(F.Add,null),onClick:function(){return function(){c({type:C.a.addActiveFilter});var e=document.getElementById("filterItemsMain");setTimeout((function(){e.scrollTo({top:e.scrollHeight+32,behavior:"smooth"}),e.scrollIntoView({behavior:"smooth",block:"end"})}),100)}()}},Object(S.t)("\u6dfb\u52a0\u7b5b\u9009\u6761\u4ef6"))));return o.a.createElement(o.a.Fragment,null,o.a.createElement(u.Popover,{placement:"bottomLeft",content:I,trigger:"click",visible:v,getPopupContainer:b},o.a.createElement(u.Button,{ref:p,size:"small",className:V.a.attrsBtn,onClick:function(){return g(!v)}},o.a.createElement(K,{color:"#176DE6"}),o.a.createElement("span",{className:V.a.pl5},Object(S.t)("\u7b5b\u9009")),l>0?o.a.createElement("span",null,"\xb7 ",l,Object(S.t)("\u4e2a\u6761\u4ef6")):null)))},ye=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},Se=function(e,t,a){if(a||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},Ie=function(e){var t=Object(r.useContext)(C.b).state,a=t.activeFilterContent,n=t.issueType,i=t.filterList,s=e.currentProject,l=a.conditions.filter((function(e){return e.fixed}));return i&&0!==i.length?o.a.createElement(o.a.Fragment,null,l.map((function(e){var t=Object(m.c)(e);return o.a.createElement("span",{className:"filterFixedItem",key:t||e.id},o.a.createElement(he,{type:t,value:e.constValue&&e.constValue.length?Se(Se([],ye(e.constValue),!1),ye(e.value),!1):e.value,issueType:n,modeType:ue.a.filter,itemInfo:e,projectId:s.id}))}))):o.a.createElement(o.a.Fragment,null)},Te=function(){return(Te=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Ce=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},Pe=function(e){var t=e.onChange,a=e.options,n=e.debounce,i=void 0!==n&&n,s=e.value,l=Ce(Object(r.useState)(""),2),c=l[0],f=l[1],p=Object(d.a)((function(e){t&&t(e)}),{wait:(null===a||void 0===a?void 0:a.wait)||500,trailing:(null===a||void 0===a?void 0:a.trailing)||!0,leading:(null===a||void 0===a?void 0:a.leading)||!1}).run;return Object(r.useEffect)((function(){s!==c&&f(s)}),[s]),o.a.createElement(u.Input,Te({},e,{value:c,onChange:function(e){f(e.target.value),i?p(e.target.value):t&&t(c)}}))},we=a("9i3m"),De=a.n(we),Oe=function(e){var t=e.placeholder,a=void 0===t?Object(S.t)("\u8bf7\u9009\u62e9"):t,n=e.onChange,i=e.value,r=e.getContainer,s=e.width,l=e.options;return o.a.createElement(te.default,{className:"auto-dropdown",placeholder:a,value:i,showSearch:!1,allowClear:!1,style:{width:s},options:l,dropdownClassName:"auto-dropdown",optionRender:function(e){return o.a.createElement("div",{className:De.a.flexBetween},o.a.createElement("span",null,e.label),o.a.createElement("span",null,e.desc))},onChange:n,getPopupContainer:r})},Re=a("YstK"),je=a("X4JO"),ke=a.n(je),Ne=function(e){var t=e.children,a=e.value,n=e.onRadioChange;return o.a.createElement("label",{className:ke.a.radioButtonWrapper,onClick:function(){n({target:{value:a}})}},o.a.createElement("span",{className:ke.a.radioButton},o.a.createElement("input",{type:"radio",className:ke.a.radioButtonInput,value:a}),o.a.createElement("span",{className:ke.a.radioButtonInner})),t)},Ae=function(e){var t=e.children,a=e.value,n=o.a.createRef();return Object(r.useEffect)((function(){if(n.current){var e=o.a.Children.toArray(t).findIndex((function(e){return e.props.value===a}));if(-1!==e){var i=73*e+2;console.log(i),n.current.style.left="".concat(i,"px"),n.current.style.width="73px"}}}),[a,n.current]),o.a.createElement("div",{className:ke.a.radioGroup},t,o.a.createElement("div",{className:ke.a.radioGroupSlider,ref:n}))},Le=a("fmVk"),Fe=a("Y+p1"),_e=a.n(Fe),Me=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},xe=function(e,t,a){if(a||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},Be={CODE:{value:"CODE",label:Object(S.t)("\u6309ID"),componentType:Re.PROPERTY_TYPE_CONSTANTS_ENUM.TEXT_DECIMAL},PRIORITY:{value:"PRIORITY",label:Object(S.t)("\u6309\u4f18\u5148\u7ea7"),componentType:Re.PROPERTY_TYPE_CONSTANTS_ENUM.SELECT_SINGLE},CREATED_AT:{value:"CREATED_AT",label:Object(S.t)("\u6309\u521b\u5efa\u65f6\u95f4"),componentType:Re.PROPERTY_TYPE_CONSTANTS_ENUM.TEXT_DATETIME},DUE_DATE:{value:"DUE_DATE",label:Object(S.t)("\u6309\u622a\u6b62\u65e5\u671f"),componentType:Re.PROPERTY_TYPE_CONSTANTS_ENUM.TEXT_DATETIME},UPDATED_AT:{value:"UPDATED_AT",label:Object(S.t)("\u6309\u66f4\u65b0\u65f6\u95f4"),componentType:Re.PROPERTY_TYPE_CONSTANTS_ENUM.TEXT_DATETIME},ASSIGNEE:{value:"ASSIGNEE",label:Object(S.t)("\u6309\u5904\u7406\u4eba"),componentType:Re.PROPERTY_TYPE_CONSTANTS_ENUM.SELECT_MEMBER_SINGLE},NAME:{value:"NAME",label:Object(S.t)("\u6309\u6807\u9898")},SYSTEM:{value:"SYSTEM",label:Object(S.t)("\u6309\u6240\u5c5e\u7cfb\u7edf")},GROUP_TEAM:{value:"GROUP_TEAM",label:Object(S.t)("\u6309\u8d1f\u8d23\u5c0f\u961f")}},Ue=function(e){var t=Object(r.useContext)(C.b),a=t.state.activeFilterContent,n=t.dispatch,i=e.issueType,s=Object(d.d)(),l=Object(r.useRef)(null),c=function(e){Object(T.c)(n,"sort.value",e.target.value)},p=function(e){Object(T.c)(n,"sort.key",e)},m=M(s,l),h=m.visible,v=m.setVisible,g=function(){return s.current},E=Object(r.useMemo)((function(){var e,t,n,r,o,s,l,c=["CODE","PRIORITY","CREATED_AT","DUE_DATE","UPDATED_AT","ASSIGNEE","NAME"];if(i===f.PAGE_TYPE.ITERATION_ISSUE){c.push("SYSTEM");var u=null===(t=null===(e=null===a||void 0===a?void 0:a.conditions)||void 0===e?void 0:e.filter((function(e){return"ISSUE_TYPE_ID"===e.key})))||void 0===t?void 0:t[0],d=null===(r=null===(n=function(){var e;return null===(e=Le.store.getState().APP.currentProjectCooperateSettings)||void 0===e?void 0:e.ISSUE_TYPES}())||void 0===n?void 0:n.filter((function(e){return"\u7528\u6237\u6545\u4e8b"===e.name||e.issueType===f.PAGE_TYPE.DEFECT})))||void 0===r?void 0:r.map((function(e){return e.id}));1===(null===(o=null===u||void 0===u?void 0:u.value)||void 0===o?void 0:o.length)&&(null===d||void 0===d?void 0:d.includes(null===(s=null===u||void 0===u?void 0:u.value)||void 0===s?void 0:s[0]))||2===(null===(l=null===u||void 0===u?void 0:u.value)||void 0===l?void 0:l.length)&&_e()(d,null===u||void 0===u?void 0:u.value)?c.push("GROUP_TEAM"):"GROUP_TEAM"===a.sort.key&&p("PRIORITY")}else if(i===f.PAGE_TYPE.REQUIREMENT||i===f.PAGE_TYPE.DEFECT)c.push("SYSTEM","GROUP_TEAM");else if(i===f.PAGE_TYPE.ASSIGNMENT||i===f.PAGE_TYPE.ALL||i===f.PAGE_TYPE.TEAM_VIEW)c.push("SYSTEM");else if(i===f.PAGE_TYPE.PRD_REQUIREMENT){var m=c.findIndex((function(e){return"ASSIGNEE"===e}));c.splice(m,1)}return c.reduce((function(e,t){return xe(xe([],Me(e),!1),[Be[t]],!1)}),[])}),[i,a]),b=o.a.createElement("div",{className:De.a.filterSort},o.a.createElement(Oe,{value:a.sort.key,options:E,width:"170px",getContainer:g,onChange:p}),h?o.a.createElement(Ae,{value:a.sort.value},o.a.createElement(Ne,{value:"ASC",onRadioChange:c},o.a.createElement("span",{className:De.a.flexBetween},o.a.createElement(ee,null),Object(S.t)("\u5347\u5e8f"))),o.a.createElement(Ne,{value:"DESC",onRadioChange:c},o.a.createElement("span",{className:De.a.flexBetween},o.a.createElement(Q,null),Object(S.t)("\u964d\u5e8f")))):null),y=E.find((function(e){return e.value===a.sort.key}));return o.a.createElement(u.Popover,{visible:h,getPopupContainer:g,trigger:"click",placement:"bottomLeft",content:b,overlayClassName:"popoverContent"},o.a.createElement(u.Button,{size:"small",ref:l,className:De.a.sortBtn,onClick:function(){return v(!h)}},o.a.createElement("span",{className:De.a.flexBetween},"ASC"===a.sort.value?o.a.createElement(ee,null):o.a.createElement(Q,null),o.a.createElement("span",{className:De.a.pl5},Object(S.t)("\u6392\u5e8f")),y?o.a.createElement("span",null,"\xb7",y.label):null)))},We=a("Myje"),Ye=function(){return(Ye=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},He=function(e){var t=Object(r.useContext)(C.b),a=t.state,n=a.activeFilterContent,i=a.layoutConfig,s=t.dispatch,l=e.SlotFilterRight,c=i.hasSort,u=n.conditions.find((function(e){return"KEYWORD"===e.key})),d=Object(We.a)(e);return o.a.createElement("div",{className:y.a.filterSorts},o.a.createElement("div",{className:y.a.filterItem},o.a.createElement(Pe,{value:null===u||void 0===u?void 0:u.value,placeholder:Object(S.t)("\u6807\u9898\u6216\u63cf\u8ff0"),onChange:function(e){Object(T.c)(s,"KEYWORD",e)},debounce:!0,style:{height:"28px"},allowClear:!0,prefix:o.a.createElement(F.Search,{style:{color:"#bbc1cb"}})})),c?o.a.createElement("div",{className:y.a.filterItem},o.a.createElement(Ue,Ye({},e))):null,l?o.a.createElement(l,Ye({},d)):null)},Ve=function(){return(Ve=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Ge=function(e){return o.a.createElement("div",{className:y.a.filterContent},o.a.createElement("div",{className:y.a.filterAttrs},o.a.createElement(be,Ve({},e)),o.a.createElement(Ie,Ve({},e))),o.a.createElement(He,Ve({},e)))},Ke=a("V0lW"),ze=function(){return(ze=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},qe=function(e){var t=e.leftFixed,a=e.onFixedToggle,n=e.user,i=e.SlotSchemeRight,s=e.FilterListAfter,l=Object(We.a)(e),c=Object(r.useContext)(C.b),u=c.state,d=u.type,f=u.issueType,p=c.dispatch;return Object(r.useEffect)((function(){"team"===d&&Object(Ke.fetchProjects)({page:1,pageSize:1e3}).then((function(e){var t,a,n,i=null!==(n=null===(a=null===(t=e.data)||void 0===t?void 0:t.list)||void 0===a?void 0:a.map((function(e){return e.id})))&&void 0!==n?n:[];p({type:C.a.setProjectIdList,value:i})}))}),[f]),o.a.createElement("div",{className:y.a.filterHeader},o.a.createElement("div",{className:y.a.headerScheme},o.a.createElement("div",{className:y.a.headerLeft},o.a.createElement(Y,{leftFixed:t,onFixedToggle:a,user:n}),o.a.createElement(L,{user:n}),s&&o.a.createElement(s,ze({},l))),o.a.createElement("div",{className:y.a.headerRight},i?o.a.createElement(i,ze({},l)):null)),o.a.createElement(Ge,ze({},e)))},Ze=a("5CaM"),Je=function(){return(Je=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Xe=function(e){var t=e.TargetDom,a=e.leftFixed,n=Object(r.useContext)(C.b).state,i=n.customLoading,s=n.activeFilterContent,l=n.tableView,c=n.fieldsArchives,u=n.currentFilterScheme,d=n.customParams;if(-1!==Object.keys(i).findIndex((function(e){return!i[e]})))return o.a.createElement(o.a.Fragment,null);var f={leftFixed:a,tableView:l,fieldsArchives:c,activeFilterContent:Object(T.b)(s),currentFilterScheme:u,customParams:d};return o.a.createElement(t,Je({},e,f))},Qe=a("vPNc"),$e=a("jgPD"),et=a("MYKk"),tt=a("w3Wo"),at=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},nt=function(e){var t=at(Object(r.useState)(!0),2),a=t[0],n=t[1],i=-1!==Object.keys(e).findIndex((function(t){return!e[t]}));if(a)return i||n(!1),a},it=a("DgMC"),rt=function(){return(rt=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},ot=function(e,t,a,n){return new(a||(a=Promise))((function(i,r){function o(e){try{l(n.next(e))}catch(t){r(t)}}function s(e){try{l(n.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,s)}l((n=n.apply(e,t||[])).next())}))},st=function(e,t){var a,n,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(l){return function(s){if(a)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(a=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(l){s=[6,l],n=0}finally{a=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},lt=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},ct=function(e,t,a){if(a||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},ut=function(e){var t=e.location.query,a=e.currentProject,n=e.issueType,i=e.payed,o=e.router,s=e.config,l=Object(r.useContext)(C.b),c=l.dispatch,u=l.state.currentFilterScheme,m=null,h=!0;function v(e){m&&window.clearTimeout(m),m=window.setTimeout((function(){Object(p.i)(a.id,n,e,{code:o.params.code}).then((function(e){m=null,e.data&&h&&(delete t.filterId,o.replace({pathname:window.location.pathname,query:rt(rt({},t),{filter:e.data.hash})}))}))}),500)}var g=Object(d.b)((function(e){return ot(void 0,void 0,void 0,(function(){var r,l,d,m,h;return st(this,(function(v){return l=(r=e||{}).isInit,d=void 0!==l&&l,r.hashFilter,m=r.schemeId,h=t.filterId||m,Object(p.p)(a.id,n,!0,{code:o.params.code}).then((function(e){var t=e.data;if(t){var r=[];if(n===f.PAGE_TYPE.TEAM_VIEW){var o=t.otherFilters,l=t.pinnedFilters;r=ct(ct([],lt(o),!1),lt(l),!1)}else{var p=t.systemFilters,m=t.customFilters;r=ct(ct([],lt(p),!1),lt(m),!1)}var v=(r=function(e,t){return e!==f.PAGE_TYPE.RISK&&e!==f.PAGE_TYPE.WORK_ITEM&&e!==f.PAGE_TYPE.DEFECT||t.forEach((function(e){var t;if(null===(t=e.content)||void 0===t?void 0:t.conditions){var a=e.content.conditions.findIndex((function(e){return"ISSUE_TYPE_ID"===e.key}));-1!==a&&e.content.conditions.splice(a,1)}})),t}(n,r).map((function(e){return e.isSpread&&(e.content.conditions=e.content.conditions.map((function(e){return e.isSpread=1,e}))),e}))).map((function(e){return Object(it.organizeFilterItem)(e)})),g=ct(ct([],lt(v.filter((function(e){return e.pin}))),!1),lt(v.filter((function(e){return!e.pin}))),!1),E=rt({},Object(w.keyBy)(r,"id")),b={layoutConfig:s},y=g.find((function(e){return e.isDefault}));if(d){s.load&&(b.customLoading=s.load);var S=y;Object.assign(b,{payed:i,currentProject:a,issueType:n,defaultFilter:y,currentFilterScheme:S,activeFilterContent:E[y.value].content})}if(h){var I=E[h];if(!I)return void console.error("\u8bbe\u7f6e\u9ed8\u8ba4\u89c6\u56fe\u6570\u636e\u6709\u8bef\uff0c\u8bf7\u6392\u67e5\u89c6\u56fe\u63a5\u53e3\u6216\u8005\u8981\u663e\u793a\u7684\u89c6\u56feID\u3010".concat(h,"\u3011\uff0c\u6240\u6709\u89c6\u56fe\u6570\u636e\u4e3a"),g);b.currentFilterScheme=function(e){return{isDefault:e.isDefault,sharedTeam:e.sharedTeam,text:e.name,type:e.isSystem?"system":"custom",value:e.id,pin:e.pin,isSpread:e.isSpread}}(I),b.activeFilterContent=I.content}u.value&&!E[u.value]&&(b.currentFilterScheme=y,b.activeFilterContent=E[y.value].content),Object.assign(b,{filterSchemes:E,schemesList:g}),c({type:C.a.init,value:b})}}),(function(e){22023!==e.code&&Object(D.danger)(Object(S.t)("\u83b7\u53d6\u7b5b\u9009\u5668\u5931\u8d25"))})),[2]}))}))}));Object(r.useEffect)((function(){return ot(void 0,void 0,void 0,(function(){return st(this,(function(e){return g({isInit:!0}),[2]}))})),I.default.on(I.EventBusType.FilterLayout,I.FilterLayoutEventKeys.filterReloadScheme,g),I.default.on(I.EventBusType.FilterLayout,I.FilterLayoutEventKeys.filterSetHashContent,v),function(){h=!1,I.default.destroy(I.EventBusType.FilterLayout,I.FilterLayoutEventKeys.filterReloadScheme),I.default.destroy(I.EventBusType.FilterLayout,I.FilterLayoutEventKeys.filterSetHashContent)}}),[])},dt=a("ZC3d"),ft=function(){return(ft=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},pt=function(e,t,a,n){return new(a||(a=Promise))((function(i,r){function o(e){try{l(n.next(e))}catch(t){r(t)}}function s(e){try{l(n.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,s)}l((n=n.apply(e,t||[])).next())}))},mt=function(e,t){var a,n,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(l){return function(s){if(a)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(a=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(l){s=[6,l],n=0}finally{a=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},ht=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},vt=function(e,t,a){if(a||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},gt={getHashFilterContent:l.a.func,setFilterContentHash:l.a.func,hashFilterContent:l.a.object};function Et(e){return{projectPath:e.APP.projectPath,currentProject:e.APP.currentProject,currentProjectCooperateSettings:e.APP.currentProjectCooperateSettings,payed:e.APP.enterprise.payed}}var bt=u.Layout.Header,yt=u.Layout.Content,St={leftFixed:l.a.bool,tableView:l.a.object,fieldsArchives:l.a.object,activeFilterContent:l.a.object,currentFilterScheme:l.a.object};t.default=function(e){return function(t){var a=this,n=function(n){var i=n.currentProject,s=n.currentProjectCooperateSettings,l=n.isPermissible,c=n.router,d=n.location,h=n.payed,v=Object(r.useContext)(C.b),g=v.dispatch,b=v.state.loading,S=i.name,I=e.issueType,T=e.topHeader,P=void 0===T||T,w=e.hasLeftSider,D=void 0===w||w,O=e.hasSort,R=void 0===O||O,j=e.load,k=e.SlotSchemeRight,N=e.SlotFilterRight,A=e.FilterListAfter,L=E({issueType:I,projectName:S}),F=L.leftFixed,_=L.onFixedToggle;Object(r.useEffect)((function(){return m.f.setPermission(l),function(){m.f.clear()}}),[]);var M=nt(b);ut({location:d,currentProject:i,issueType:I,router:c,payed:h,config:{issueType:I,topHeader:P,hasLeftSider:D,hasSort:R,load:j}});var x=function(){return pt(a,void 0,void 0,(function(){return mt(this,(function(e){switch(e.label){case 0:return Object($e.default)(ft(ft({projectName:i.name,projectId:i.id,issueType:I},!Object(m.e)(I)&&{templateId:s.template.id}),{callback:function(){g({type:C.a.setLoading,value:{storeActionLoad:!0}})}})),Object(m.e)(I)?(et.b.init((function(){g({type:C.a.setLoading,value:{teamActionLoad:!0}})})),g({type:C.a.setType,value:"team"})):g({type:C.a.setLoading,value:{teamActionLoad:!0}}),[4,pt(a,void 0,void 0,(function(){var e,t,a,n;return mt(this,(function(r){switch(r.label){case 0:return e={},Object(m.e)(I)?[4,Object(p.u)()]:[3,2];case 1:return e=r.sent(),[3,4];case 2:return[4,Object(tt.fetchIssueFields)(i.name)];case 3:e=r.sent(),r.label=4;case 4:return t=e.code,a=e.data,0===t?(n=a.reduce((function(e,t){return e[t.id]={issueField:t},e}),{}),g({type:C.a.setFieldsArchives,value:n}),g({type:C.a.setLoading,value:{fieldLoad:!0}}),[2,n]):[2]}}))}))];case 1:return function(e){pt(a,void 0,void 0,(function(){var t,a,n,r,o;return mt(this,(function(s){switch(s.label){case 0:return t={},Object(m.e)(I)?[4,Object(p.z)()]:[3,2];case 1:return t=s.sent(),[3,4];case 2:return[4,Object(p.C)(i.id,I)];case 3:t=s.sent(),s.label=4;case 4:return a=t.data,n=[],I===f.PAGE_TYPE.PRD_REQUIREMENT?(r=vt(vt(vt([],ht(ae.REQUIRE_MANAGEMENT_TYPES),!1),ht(ae.OTHER_HIDE_ATTRIBUTES),!1),["CUSTOM","ITERATION"],!1),n=a.filter((function(e){return!r.includes(e.key)})).map((function(t){return Object(m.b)(t,e)}))):I===f.PAGE_TYPE.TEAM_VIEW?(o=vt(vt(vt([],ht(ae.REQUIRE_MANAGEMENT_TYPES),!1),ht(ae.USE_LESS_ATTRIBUTES),!1),[dt.FIELD_TYPE.MILESTONE],!1),n=a.filter((function(e){return!o.includes(e.key)})).map((function(t){return Object(m.b)(t,e)}))):n=a.map((function(t){return Object(m.b)(t,e)})),g({type:C.a.setFilterList,value:n}),[2]}}))}))}(e.sent()),[2]}}))}))};Object(r.useEffect)((function(){x()}),[]);var B={SlotSchemeRight:k,SlotFilterRight:N,FilterListAfter:A};return M?o.a.createElement(u.Layout,{className:y.a.filterLayout,style:{height:"100%"}},P?o.a.createElement(bt,{style:{padding:"0px",height:"48px"}},o.a.createElement(Qe.b,ft({},n,{issueType:I}))):null):o.a.createElement(o.a.Fragment,null,o.a.createElement(u.Layout,{className:y.a.filterLayout,style:{height:"100%"}},P?o.a.createElement(bt,{style:{padding:"0px",height:"48px"}},o.a.createElement(Qe.b,ft({},n,{issueType:I}))):null,o.a.createElement(u.Layout,null,F&&D?o.a.createElement(Ze.a,{leftFixed:F,onFixedToggle:_}):null,o.a.createElement(yt,null,o.a.createElement(u.Layout,{style:{height:"100%"}},o.a.createElement(bt,{style:{padding:"0px",backgroundColor:"#fff",height:"auto",zIndex:10,boxShadow:"0px 0px 1px rgba(0, 0, 0, 0.2), 0px 1px 1px rgba(9, 30, 66, 0.08)"}},o.a.createElement(qe,ft({},n,{leftFixed:F,issueType:I,config:{issueType:I,topHeader:P,hasLeftSider:D,hasSort:R,load:j}},B,{onFixedToggle:_}))),o.a.createElement(yt,null,o.a.createElement(Xe,ft({},n,{leftFixed:F,TargetDom:t}))))))))};return i()(Et)(Object(c.withRouter)((function(e){return o.a.createElement(C.c,null,o.a.createElement(n,ft({},e)))})))}}},"d/wg":function(e,t,a){e.exports={header:"header-3KSxJjV94F","header-title":"header-title-3cUGSfs5Ak",headerTitle:"header-title-3cUGSfs5Ak","header-divider":"header-divider-dnxVdeSdv6",headerDivider:"header-divider-dnxVdeSdv6","header-add":"header-add-3QUObfOhfT",headerAdd:"header-add-3QUObfOhfT",disabled:"disabled-1B_Q7eDT6R",list:"list-1y8GK8447D",relate:"relate-1YzSUo29Bl","relate-icon":"relate-icon-3GxDR8Evqm",relateIcon:"relate-icon-3GxDR8Evqm","header-right":"header-right-n9lDVLo6Ze",headerRight:"header-right-n9lDVLo6Ze",progress:"progress-3ytjx8JMH5","progress-bar":"progress-bar-1eQfvWcH3r",progressBar:"progress-bar-1eQfvWcH3r","progress-bar-inner":"progress-bar-inner-32IAExR02Q",progressBarInner:"progress-bar-inner-32IAExR02Q","progress-text":"progress-text-3_vVZqKRcI",progressText:"progress-text-3_vVZqKRcI"}},d3LG:function(e,t,a){e.exports={dragging:"dragging-1Q86eWKMzZ"}},dBa0:function(e,t,a){"use strict";var n,i;a.r(t),a.d(t,"SLOTS",(function(){return n})),a.d(t,"SLOTS_DISPLAY",(function(){return i})),function(e){e.COLLABORATION_TAB_ONE="collaboration-tab-one",e.COLLABORATION_TAB_DROPDOWN_MENU_ONE="collaboration-tab-dropdown-menu-one",e.COLLABORATION_DETAIL_DROPDOWN_MENU_ONE="collaboration-detail-dropdown-menu-one",e.COLLABORATION_DETAIL_BUTTON_ONE="collaboration-detail-button-one",e.COLLABORATION_DETAIL_ATTRIBUTE_BUTTON_ONE="collaboration-detail-attribute-button-one",e.COLLABORATION_ITERATIONS_DETAIL_BUTTON_ONE="collaboration-iterations-detail-tab-one"}(n||(n={})),function(e){e.INLINE="INLINE",e.MODAL="MODAL",e.DRAWER="DRAWER"}(i||(i={}))},dEY8:function(e,t,a){e.exports={select:"select-1jB8XyyJrq","select-arrow-wrapper":"select-arrow-wrapper-3j0tEOvdgA",selectArrowWrapper:"select-arrow-wrapper-3j0tEOvdgA","menu-top":"menu-top-1smqz896Bk",menuTop:"menu-top-1smqz896Bk","select-with-label":"select-with-label-2H4uC0J7lT",selectWithLabel:"select-with-label-2H4uC0J7lT","select-trigger":"select-trigger-2bn3fTybhf",selectTrigger:"select-trigger-2bn3fTybhf","has-border":"has-border-305kzWgHv8",hasBorder:"has-border-305kzWgHv8","is-block":"is-block-1S-M_2QK5A",isBlock:"is-block-1S-M_2QK5A","item-text":"item-text-fANXipKwIV",itemText:"item-text-fANXipKwIV","not-selected":"not-selected-o8bqFzJHCk",notSelected:"not-selected-o8bqFzJHCk","select-trigger-disabled":"select-trigger-disabled-1ijkk9dnG7",selectTriggerDisabled:"select-trigger-disabled-1ijkk9dnG7","is-expanded":"is-expanded-gH8yEfz3H5",isExpanded:"is-expanded-gH8yEfz3H5","inline-dropdown":"inline-dropdown-2M1OeaRQeS",inlineDropdown:"inline-dropdown-2M1OeaRQeS","item-label":"item-label-3dSeTp1Z6q",itemLabel:"item-label-3dSeTp1Z6q","item-text-ellipsis":"item-text-ellipsis-mvD66cYCzv",itemTextEllipsis:"item-text-ellipsis-mvD66cYCzv","clear-button":"clear-button-2skLShWjY0",clearButton:"clear-button-2skLShWjY0","to-top":"to-top-1ubvTVMN2Y",toTop:"to-top-1ubvTVMN2Y","to-right":"to-right-1qN6vu7SQB",toRight:"to-right-1qN6vu7SQB","trigger-background":"trigger-background-R5z3O07dLE",triggerBackground:"trigger-background-R5z3O07dLE","clear-divider":"clear-divider-2DEHR2Jd_T",clearDivider:"clear-divider-2DEHR2Jd_T",show:"show-1IGW3-QZTr",clear:"clear-2E8QZ1v9jQ","calendar-date":"calendar-date-2puqLW620_",calendarDate:"calendar-date-2puqLW620_",today:"today-1tkwiifuiX",yesterday:"yesterday-FlTQQvypjT","not-specified":"not-specified-53EJ1CQmgu",notSpecified:"not-specified-53EJ1CQmgu","custom-select":"custom-select-2RvLED5KdG",customSelect:"custom-select-2RvLED5KdG","is-disabled":"is-disabled-BzhyejsVyj",isDisabled:"is-disabled-BzhyejsVyj",trigger:"trigger-pgdEQSYYJD","custom-select-not-portal":"custom-select-not-portal-3DJAK24WUJ",customSelectNotPortal:"custom-select-not-portal-3DJAK24WUJ","custom-select-portal":"custom-select-portal-3spewqGUpQ",customSelectPortal:"custom-select-portal-3spewqGUpQ","custom-select-in-top":"custom-select-in-top-_vEcIpZdpk",customSelectInTop:"custom-select-in-top-_vEcIpZdpk","custom-select-to-top":"custom-select-to-top-3lMqoWORdh",customSelectToTop:"custom-select-to-top-3lMqoWORdh","arrow-position-right":"arrow-position-right-3fdPS3FcRL",arrowPositionRight:"arrow-position-right-3fdPS3FcRL","cart-down":"cart-down-21XyNczMB2",cartDown:"cart-down-21XyNczMB2",triggerInput:"triggerInput-2VymjP1nqF",textEllipsis:"textEllipsis-10biL36Sat",label:"label-1aGYcnZYTR",downIcon:"downIcon-1SgrRdFqxg",placeholder:"placeholder-RT_KnngKKc","align-top":"align-top-3t5k1_Kxlj",alignTop:"align-top-3t5k1_Kxlj",minSize:"minSize-25VBskhWT6",dropdownClass:"dropdownClass-1ov1gRUyrQ","full-tree-select-dropdown":"full-tree-select-dropdown-2v461zfxfE",fullTreeSelectDropdown:"full-tree-select-dropdown-2v461zfxfE"}},dHGx:function(e,t,a){"use strict";a.r(t),a.d(t,"getCustomColumns",(function(){return r})),a.d(t,"resetCustomColumns",(function(){return o})),a.d(t,"updateCustomColumns",(function(){return s})),a.d(t,"batchUpdateCustomColumns",(function(){return l})),a.d(t,"getPrdCustomColumns",(function(){return c})),a.d(t,"resetPrdCustomColumns",(function(){return u})),a.d(t,"updatePrdCustomColumns",(function(){return d})),a.d(t,"batchUpdatePrdCustomColumns",(function(){return f})),a.d(t,"BUSINESS_TYPE",(function(){return n}));var n,i=a("Z4vw"),r=function(e){return Object(i.get)("/external/collaboration/agile/api/custom-columns?".concat(Object(i.buildParams)(e)))},o=function(e){return Object(i.get)("/external/collaboration/agile/api/custom-columns/reset?".concat(Object(i.buildParams)(e)))},s=function(e,t){return Object(i.patchJSON)("/external/collaboration/agile/api/custom-columns?".concat(Object(i.buildParams)(e)),t)},l=function(e,t){return Object(i.putJSON)("/external/collaboration/agile/api/custom-columns/data?".concat(Object(i.buildParams)(e)),t)},c=function(e){return Object(i.get)("/external/dm/api/issues/custom-columns/REQUIREMENT?".concat(Object(i.buildParams)(e)))},u=function(e){return Object(i.get)("/external/dm/api/issues/custom-columns/REQUIREMENT/reset?".concat(Object(i.buildParams)(e)))},d=function(e,t){return Object(i.patchJSON)("/external/dm/api/issues/custom-columns/REQUIREMENT?".concat(Object(i.buildParams)(e)),t)},f=function(e,t){return Object(i.putJSON)("/external/dm/api/issues/custom-columns/REQUIREMENT/data?".concat(Object(i.buildParams)(e)),t)};!function(e){e.TEAM_VIEW="TEAM_VIEW",e.WORKBENCH="WORKBENCH",e.ITERATION="ITERATION",e.ALL="ALL",e.REQUIREMENT="REQUIREMENT",e.DEFECT="DEFECT",e.EPIC="EPIC",e.SUB_TASK="SUB_TASK",e.MISSION="MISSION",e.RISK="RISK",e.RELEASE="RELEASE",e.RELEASE_ISSUE="RELEASE_ISSUE"}(n||(n={}))},dLZG:function(e,t,a){"use strict";a.r(t),a.d(t,"fetchModuleConfig",(function(){return i}));var n=a("Z4vw"),i=function(){return Object(n.get)("/collaboration/api/standard/config")}},dvJj:function(e,t,a){e.exports={wrapper:"wrapper-32TP_fW8CZ","input-before":"input-before-1Ilxlta0sR",inputBefore:"input-before-1Ilxlta0sR","icon-task":"icon-task-1AUTDt8Rj9",iconTask:"icon-task-1AUTDt8Rj9","icon-requirement":"icon-requirement-3zIXwSygn6",iconRequirement:"icon-requirement-3zIXwSygn6","input-after":"input-after-3MHEK2K-si",inputAfter:"input-after-3MHEK2K-si","input-clear":"input-clear-1qj9AXVBsa",inputClear:"input-clear-1qj9AXVBsa","input-create":"input-create-1t0qezuEvX",inputCreate:"input-create-1t0qezuEvX","input-create-text":"input-create-text-1JSy-jTrlB",inputCreateText:"input-create-text-1JSy-jTrlB","input-create-arrow":"input-create-arrow-2rh05IG4N3",inputCreateArrow:"input-create-arrow-2rh05IG4N3",popup:"popup-1UIaBvhITF","popup-item":"popup-item-2RCqompAVQ",popupItem:"popup-item-2RCqompAVQ","popup-item-text":"popup-item-text-3qI5camnew",popupItemText:"popup-item-text-3qI5camnew","popup-item-shift":"popup-item-shift-1QXf6K65Rw",popupItemShift:"popup-item-shift-1QXf6K65Rw","popup-item-enter":"popup-item-enter-PwTK5-_Nmb",popupItemEnter:"popup-item-enter-PwTK5-_Nmb","input-cancel":"input-cancel-3ImhHDe-Ht",inputCancel:"input-cancel-3ImhHDe-Ht"}},e6EU:function(e,t,a){e.exports={"dropdown-wrapper":"dropdown-wrapper-2mZ6lO6W6B",dropdownWrapper:"dropdown-wrapper-2mZ6lO6W6B",dropdown:"dropdown-2eX8sTFb7X",showIn:"showIn-MicTEVNG_v","menu-wrapper":"menu-wrapper-1OFGIqny9b",menuWrapper:"menu-wrapper-1OFGIqny9b","menu-item-wrapper":"menu-item-wrapper-1DXd7wssVG",menuItemWrapper:"menu-item-wrapper-1DXd7wssVG",focus:"focus-34olMdzAtL","menu-item":"menu-item-19Jx2oXVTk",menuItem:"menu-item-19Jx2oXVTk","menu-item-icon":"menu-item-icon-TUCOvj3AnQ",menuItemIcon:"menu-item-icon-TUCOvj3AnQ","menu-item-name":"menu-item-name-2YfpMMBGCS",menuItemName:"menu-item-name-2YfpMMBGCS",unspecific:"unspecific-1lqIXL2DRR","menu-item-checked":"menu-item-checked-2xMlgAfeGG",menuItemChecked:"menu-item-checked-2xMlgAfeGG","menu-item-status":"menu-item-status-2BEz32lo6n",menuItemStatus:"menu-item-status-2BEz32lo6n","search-input":"search-input-1VVX2INE_R",searchInput:"search-input-1VVX2INE_R","search-icon":"search-icon-t-fAgYvdIL",searchIcon:"search-icon-t-fAgYvdIL",input:"input-38HrmVFbhw",close:"close-3HkGzZTEgB",selections:"selections-31dOe9YzBQ",scrolling:"scrolling-LcBky87Ztu",text:"text-3j5UgIts5h","text-light":"text-light-1ThsMDpsxZ",textLight:"text-light-1ThsMDpsxZ","clear-single":"clear-single-3jJwtUB88Z",clearSingle:"clear-single-3jJwtUB88Z",clear:"clear-1sMIgAtDCw",list:"list-22lPqK-CSq","no-item":"no-item-1lzPFIII2v",noItem:"no-item-1lzPFIII2v","trigger-wrapper":"trigger-wrapper-2U8OCjumvo",triggerWrapper:"trigger-wrapper-2U8OCjumvo",trigger:"trigger-2COvyAt0nL",title:"title-3s9mLg0w21",name:"name-2qdhZRluNS","caret-down":"caret-down-n6eGu7r_Pp",caretDown:"caret-down-n6eGu7r_Pp",active:"active-2dTflaDCxn","hide-trigger-bg":"hide-trigger-bg-2QUPFkymh1",hideTriggerBg:"hide-trigger-bg-2QUPFkymh1",disabled:"disabled-15tkpeKgPe","hide-trigger-padding":"hide-trigger-padding-2Iwk02_rxR",hideTriggerPadding:"hide-trigger-padding-2Iwk02_rxR","config-error":"config-error-1eq0zUtRkt",configError:"config-error-1eq0zUtRkt","align-top":"align-top-2aZl2T5EWY",alignTop:"align-top-2aZl2T5EWY","clear-button":"clear-button-3azVO-R7Zw",clearButton:"clear-button-3azVO-R7Zw"}},e7hk:function(e,t,a){e.exports={"slide-wrapper":"slide-wrapper-1sll_u6CTT",slideWrapper:"slide-wrapper-1sll_u6CTT","full-screen":"full-screen-1bZAW11_Vp",fullScreen:"full-screen-1bZAW11_Vp","full-screen-mask":"full-screen-mask-2ypVIsKjHi",fullScreenMask:"full-screen-mask-2ypVIsKjHi","no-view-permission-container":"no-view-permission-container-2e6CqLD6Gs",noViewPermissionContainer:"no-view-permission-container-2e6CqLD6Gs",pic:"pic-kZ4o7O77P2",title:"title-1Sf-eliMHY",tip:"tip-1W-jzJiLuf"}},ePqy:function(e,t,a){e.exports={"page-tab":"page-tab-MfRo1dJzED",pageTab:"page-tab-MfRo1dJzED",tab:"tab-1Tlo9nZf9g",selected:"selected-3lxbLiBGRn","is-active":"is-active-3vhA72PckD",isActive:"is-active-3vhA72PckD",disabled:"disabled-2ytWts_5Pk"}},eXGp:function(e,t,a){e.exports={root:"root-3L_gU8Bff2",link:"link-1I3ITxYlQf",avatar:"avatar-UleFCk5kdc","is-program":"is-program-2y7auQY55d",isProgram:"is-program-2y7auQY55d"}},eydm:function(e,t,a){"use strict";a.d(t,"c",(function(){return o})),a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return c}));var n=a("LvDl"),i=a("Mdvu"),r=a("DlAp"),o=function(e,t,a){e({type:r.a.setActiveFilterContent,value:function(e){if("sort.value"!==t)if("sort.key"!==t){var n=e.conditions.findIndex((function(e){return e.key===t}));-1===n?e.conditions.push({key:t,value:a,fixed:!1}):e.conditions[n].value=a}else e.sort.key=a;else e.sort.value=a}})},s=function(e){var t=Object(n.cloneDeep)(e);return t.conditions=t.conditions.filter((function(e){return e.key})),t},l=Object(n.debounce)((function(){i.default.emit(i.EventBusType.Filter,i.EventBusKeys.filterReloadTable)}),400,{trailing:!0}),c=function(e,t,a){var r=s(e.activeFilterContent),o=!Object(n.isEqual)(t,r);(o||!o&&e.hasFilterChanged||a)&&(i.default.emit(i.EventBusType.FilterLayout,i.FilterLayoutEventKeys.filterSetHashContent,r),l()),e.hasFilterChanged=a?e.hasFilterChanged:o,e.conditionNumber=r.conditions.filter((function(e){return"KEYWORD"!==e.key})).length}},f0yp:function(e,t,a){e.exports={wrapper:"wrapper-rWJrck_fNP",title:"title--BDwEB4iSK","custom-result":"custom-result-1l1cb847-_",customResult:"custom-result-1l1cb847-_","custom-detail":"custom-detail-1_rL5dq6ZA",customDetail:"custom-detail-1_rL5dq6ZA","belong-iteration":"belong-iteration-Fufrc0XzMz",belongIteration:"belong-iteration-Fufrc0XzMz","custom-search-icon":"custom-search-icon-2SJg0cwZn5",customSearchIcon:"custom-search-icon-2SJg0cwZn5",root:"root-2ufcNaV6MD","custom-input":"custom-input-2YVTgrVWZN",customInput:"custom-input-2YVTgrVWZN","result-wrapper":"result-wrapper-2-vRgEbXqs",resultWrapper:"result-wrapper-2-vRgEbXqs","result-empty":"result-empty-3aWhfmZsF9",resultEmpty:"result-empty-3aWhfmZsF9",icon:"icon-DMFZ3qNzLR","cancel-btn":"cancel-btn-2rdWUVgVYR",cancelBtn:"cancel-btn-2rdWUVgVYR","result-items":"result-items-10D91RdVk0",resultItems:"result-items-10D91RdVk0",item:"item-2_hGf-LhCv","is-disabled":"is-disabled-2_vra1mPCv",isDisabled:"is-disabled-2_vra1mPCv",desc:"desc-1XbnFKreTb","item-code":"item-code-hqRj0avsca",itemCode:"item-code-hqRj0avsca","item-detail":"item-detail-1uHhZN79xB",itemDetail:"item-detail-1uHhZN79xB","item-detail-title":"item-detail-title-2z5Dp3fu2l",itemDetailTitle:"item-detail-title-2z5Dp3fu2l","result-filter-bar":"result-filter-bar-i-BogaTqe9",resultFilterBar:"result-filter-bar-i-BogaTqe9",detail:"detail-1jP_TqZS63"}},f6d8:function(e,t,a){e.exports={"input-greater":"input-greater-1eVc-FjEfl",inputGreater:"input-greater-1eVc-FjEfl","input-greater-error":"input-greater-error-3UKRwIgFzS",inputGreaterError:"input-greater-error-3UKRwIgFzS","input-greater-error-msg":"input-greater-error-msg-3g3t5F8Ic8",inputGreaterErrorMsg:"input-greater-error-msg-3g3t5F8Ic8"}},fJkI:function(e,t,a){e.exports={select:"select-2UOx787Lyi","select-arrow-wrapper":"select-arrow-wrapper-2RNvjfpAxA",selectArrowWrapper:"select-arrow-wrapper-2RNvjfpAxA","menu-top":"menu-top-22S6jCl07z",menuTop:"menu-top-22S6jCl07z","select-with-label":"select-with-label-3J1lnNdSXc",selectWithLabel:"select-with-label-3J1lnNdSXc","select-trigger":"select-trigger-p3OnAjBmdO",selectTrigger:"select-trigger-p3OnAjBmdO","has-border":"has-border-3K1DDHXNN9",hasBorder:"has-border-3K1DDHXNN9","is-block":"is-block-AVorkapvrL",isBlock:"is-block-AVorkapvrL","item-text":"item-text-2s0c27Tkri",itemText:"item-text-2s0c27Tkri","not-selected":"not-selected-38Tca2LiDP",notSelected:"not-selected-38Tca2LiDP","is-expanded":"is-expanded-YIyItAPDm2",isExpanded:"is-expanded-YIyItAPDm2","inline-dropdown":"inline-dropdown-3O1kKcs4uJ",inlineDropdown:"inline-dropdown-3O1kKcs4uJ","item-label":"item-label-3-TbFSBc40",itemLabel:"item-label-3-TbFSBc40","item-text-ellipsis":"item-text-ellipsis-3pHYD6Z_Lm",itemTextEllipsis:"item-text-ellipsis-3pHYD6Z_Lm","clear-button":"clear-button-1KY8KzGtaM",clearButton:"clear-button-1KY8KzGtaM","to-top":"to-top-3kN-oBaM7U",toTop:"to-top-3kN-oBaM7U","to-right":"to-right-3cA6aYOf6a",toRight:"to-right-3cA6aYOf6a","trigger-background":"trigger-background-q2bDIK98Ss",triggerBackground:"trigger-background-q2bDIK98Ss","clear-divider":"clear-divider-3-omq7MnM0",clearDivider:"clear-divider-3-omq7MnM0",show:"show-2H9gZo8bTX",clear:"clear-1epaHNqhZJ","date-range-picker":"date-range-picker-3LvhxkHWSa",dateRangePicker:"date-range-picker-3LvhxkHWSa",devide:"devide-3NY1FYLCDR","item-date":"item-date-1aAXWTz6Rk",itemDate:"item-date-1aAXWTz6Rk","custom-date-dropdown":"custom-date-dropdown-1dtZ5xgWS8",customDateDropdown:"custom-date-dropdown-1dtZ5xgWS8","custom-dropdown":"custom-dropdown-16z74wxJUI",customDropdown:"custom-dropdown-16z74wxJUI",button:"button-2HWagMEZhd","align-top":"align-top-3BZ3udluq9",alignTop:"align-top-3BZ3udluq9","item-date-label":"item-date-label-hRWBeN-8cv",itemDateLabel:"item-date-label-hRWBeN-8cv","date-value":"date-value-WEx9OwOmCN",dateValue:"date-value-WEx9OwOmCN","cart-down":"cart-down-3Xi32yePsj",cartDown:"cart-down-3Xi32yePsj","date-value-placeholder":"date-value-placeholder-3rLzxzb9gr",dateValuePlaceholder:"date-value-placeholder-3rLzxzb9gr","from-date":"from-date-3MLdTubLPi",fromDate:"from-date-3MLdTubLPi","to-date":"to-date-1rcB5ZikyJ",toDate:"to-date-1rcB5ZikyJ"}},fJrm:function(e,t,a){"use strict";a("I5cv"),a("RW0V"),a("ioFf"),a("mYba"),a("jm62"),a("EK0E"),a("XfO3"),a("Btvt"),a("yt8O"),a("rGqo");var n=a("TqRt"),i=a("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("bWfx"),a("0l/t"),a("f3/d");var r,o,s,l=n(a("lSNA")),c=n(a("lwsE")),u=n(a("W8MJ")),d=n(a("PJYZ")),f=n(a("7W2i")),p=n(a("a1gu")),m=n(a("Nsbk")),h=a("mVeg"),v=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!==typeof e)return{default:e};var a=P(t);if(a&&a.has(e))return a.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=r?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}n.default=e,a&&a.set(e,n);return n}(a("cDcd")),g=n(a("K2gz")),E=n(a("17x9")),b=a("nuIr"),y=a("DKcV"),S=a("w3Wo"),I=n(a("KUqB")),T=a("rkME"),C=n(a("08Wx"));function P(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(P=function(e){return e?a:t})(e)}function w(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function D(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?w(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):w(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function O(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,m.default)(e);if(t){var i=(0,m.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,p.default)(this,a)}}var R=(0,y.WithProjectPermission)((s=o=function(e){(0,f.default)(a,e);var t=O(a);function a(e){var n;return(0,c.default)(this,a),(n=t.call(this,e)).state={expanded:!1,epicAvailable:!1,requirementAvailable:!1,assignmentAvailable:!1,defectAvailable:!1,united:!1,allowCreate:!1},n.hideToggle=n.hideToggle.bind((0,d.default)(n)),n.showToggle=n.showToggle.bind((0,d.default)(n)),n.onToggle=n.onToggle.bind((0,d.default)(n)),n}return(0,u.default)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.handleClick,n=t.currentProjectCooperateSettings,i=this.state,r=i.expanded,o=i.epicAvailable,s=i.requirementAvailable,l=i.assignmentAvailable,c=i.defectAvailable,u=i.allowCreate,d=n.EPIC===b.MODULE_SWITCH.OPENED,f=n.REQUIREMENT===b.MODULE_SWITCH.OPENED,p=n.MISSION===b.MODULE_SWITCH.OPENED,m=n.DEFECT===b.MODULE_SWITCH.OPENED,E=!u||(!o||!d)&&(!s||!f)&&(!l||!p)&&(!c||!m);return v.default.createElement("div",{className:C.default.creationWrapper},v.default.createElement("div",{style:{display:b.KA_DEFECT_EDIT_ENTRY_DISABLE?"none":"flex"},className:(0,g.default)(C.default.creationTrigger,E&&C.default.disabled),onClick:function(){return e.onToggle(E)}},v.default.createElement("span",null,(0,h.t)("\u521b\u5efa\u4e8b\u9879"))),r&&v.default.createElement("div",{className:C.default.dropdownMenu},n.ISSUE_TYPES.filter((function(e){return"SUB_TASK"!==e.issueType})).map((function(e){return v.default.createElement("div",{className:C.default.item,onClick:function(){return a(e)},key:e.id,title:e.name},v.default.createElement(I.default,{type:e.iconType,className:C.default.itemIcon}),v.default.createElement("div",{className:C.default.itemName},e.name))}))))}},{key:"componentDidMount",value:function(){var e,t,a=this;this.getStatusFromIssueState(),(0,T.isPermissible)("project",null===(e=this.props)||void 0===e||null===(t=e.currentProject)||void 0===t?void 0:t.id,"collaboration:createProjectIssue").then((function(e){a.setState({allowCreate:e})}))}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.hideToggle,!1)}},{key:"onToggle",value:function(e){e||(this.state.expanded?this.hideToggle():this.showToggle())}},{key:"hideToggle",value:function(){document.removeEventListener("click",this.hideToggle,!1),this.setState({expanded:!1})}},{key:"showToggle",value:function(){this.setState({expanded:!0}),document.addEventListener("click",this.hideToggle,!1)}},{key:"getStatusFromIssueState",value:function(){var e=this,t=this.props.currentProject;return(0,S.fetchIssueInitStatus)(t.id).then((function(t){var a=t.data;e.setState({epicAvailable:a.EPIC,requirementAvailable:a.REQUIREMENT,assignmentAvailable:a.MISSION,defectAvailable:a.DEFECT})}))}}]),a}(v.Component),o.propTypes=D(D({currentProject:E.default.object,handleClick:E.default.func},y.WithProjectPermissionProps),{},{currentProjectCooperateSettings:E.default.object}),r=s))||r;t.default=R},fLoT:function(e,t,a){"use strict";var n=a("cDcd"),i=a.n(n),r=a("mVeg"),o=a("+STs"),s=a.n(o),l=a("K2gz"),c=a.n(l);t.a=function(e){var t=e.selected,a=e.open,n=void 0!==t?t:[];return 0===n.length?i.a.createElement("div",{className:a?c()(s.a.projectTrigger,s.a.active,s.a.disabled):c()(s.a.projectTrigger,s.a.disabled)},i.a.createElement("span",{className:s.a.text},Object(r.t)("\u8bf7\u9009\u62e9\u7814\u53d1\u7a7a\u95f4")),i.a.createElement("span",{className:s.a.caret})):i.a.createElement("div",{className:a?c()(s.a.projectTrigger,s.a.active):s.a.projectTrigger},i.a.createElement("img",{className:s.a.icon,src:n[0].icon}),i.a.createElement("span",{className:s.a.text},n[0].display_name),i.a.createElement("span",{className:s.a.caret}))}},fRA5:function(e,t,a){"use strict";a.r(t);var n=a("mVeg"),i=a("cDcd"),r=a.n(i),o=a("zasr"),s=a.n(o),l=a("EyEP"),c=a.n(l),u=a("QP9f"),d=a.n(u),f=a("K2gz"),p=a.n(f),m=a("246l"),h=a.n(m),v=a("yZ+p"),g=a.n(v),E=a("X7Wg"),b=a.n(E),y=a("5kKY"),S=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},I=[{text:Object(n.t)("\u524d\u7f6e\u4e8b\u9879"),value:"BLOCK_BY"},{text:Object(n.t)("\u540e\u7f6e\u4e8b\u9879"),value:"BLOCK"}],T=function(e){var t=e.value,a=e.onSelect,o=S(Object(i.useState)(!1),2),s=o[0],l=o[1],c=I.find((function(e){return e.value===t})),u=Object(i.useCallback)((function(e){l(e)}),[]);return r.a.createElement(y.Trigger,{visible:s,onVisibleChange:u,popup:r.a.createElement("div",{className:b.a.popup},r.a.createElement("div",{className:b.a.popupTitle},Object(n.t)("\u5173\u8054\u4e3a")),I.map((function(e,n){return r.a.createElement("div",{className:p()(b.a.popupItem,e.value===t&&b.a.popupItemActive),key:n,onClick:function(){return a(e.value)}},e.text)})))},r.a.createElement("div",{className:p()(b.a.dropdown,s&&b.a.dropdownOpen)},r.a.createElement("div",{className:b.a.text},c.text,r.a.createElement("div",{className:b.a.arrow}),r.a.createElement("div",{className:b.a.divider}))))},C=a("w3Wo"),P=a("KUqB"),w=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},D=Object(i.memo)((function(e){var t,a=e.onCancel,o=e.scrollTargetId,s=e.controlFocus,l=e.projectID,c=e.issueCode,u=e.fetchList,f=w(Object(i.useState)("BLOCK_BY"),2),m=f[0],v=f[1],E=w(Object(i.useState)(""),2),b=E[0],y=E[1],S=w(Object(i.useState)([]),2),I=S[0],D=S[1],O=function(e,t){Object(C.fetchSearchBlockRelation)(l,c,{blockType:e,keyword:t}).then((function(e){D(e.data.list)}))},R=Object(i.useRef)(m),j=Object(i.useCallback)((function(e){var a=e.target.value;y(a),window.clearTimeout(t),t=window.setTimeout((function(){O(R.current,a)}),800)}),[]),k=Object(i.useRef)(null),N=function(){y(""),O(m,""),k.current&&k.current.focus()};Object(i.useEffect)((function(){O(m,b)}),[]),Object(i.useEffect)((function(){k.current&&k.current.focus()}),[s]);var A=Object(i.useCallback)((function(e){27===e.keyCode&&a()}),[]);return r.a.createElement("div",{className:d.a.wrapper,id:o},r.a.createElement(g.a,{ref:k,autoFocus:!0,prefix:r.a.createElement("div",{className:d.a.inputBefore},r.a.createElement(T,{value:m,onSelect:function(e){v(e),y(""),R.current=e,O(e,"")}})),suffix:r.a.createElement("div",{className:d.a.inputAfter},b&&r.a.createElement("div",{className:d.a.inputClear,onClick:N}),r.a.createElement("div",{onClick:a,className:p()(d.a.inputCancel,h.a.newButton,h.a.default,h.a.h24)},Object(n.t)("\u53d6\u6d88"))),placeholder:Object(n.t)("\u8f93\u5165\u4e8b\u9879 ID \u6216\u6807\u9898\u5feb\u901f\u5173\u8054"),value:b,onChange:j,onKeyDown:A}),r.a.createElement("div",{className:d.a.panel,onScroll:function(e){e.stopPropagation()}},r.a.createElement("div",{className:d.a.panelContainer},I.map((function(e){return r.a.createElement("div",{key:e.code,className:d.a.item,onClick:function(){return t=e.code,void Object(C.createBlockRelation)(l,c,m,t).then((function(){O(m,b),u(),N()}));var t}},r.a.createElement(P.default,{type:e.issueTypeDetail.iconType}),r.a.createElement("div",{className:d.a.itemCode},"#",e.code),r.a.createElement("div",{className:d.a.itemName},e.name))}))),!I.length&&r.a.createElement("div",{className:d.a.itemEmpty},Object(n.t)("\u65e0\u641c\u7d22\u7ed3\u679c"))))})),O=a("OajT"),R=a.n(O),j=a("OHfB"),k=a("iR1w"),N=a("nuIr");t.default=R()((function(e){var t=e.sectionExpanded,a=e.SectionToggletrigger,o=e.blockBeforeList,l=e.blockAfterList,u=e.createVisible,d=e.onCreateVisibleChange,f=e.scrollTargetId,p=e.controlFocus,m=e.projectID,h=e.issueCode,v=e.callback,g=e.projectPath,E=e.currentProject,b=e.allowUpdate,y=e.isDetail,S=e.isFullScreen,I=function(e){return Math.min(345,36*e)},T=S?N.FULL_SCREEN.disabledBottomSpace:0,C=Object(i.useCallback)((function(e){var t=e.index,a=e.style,n=e.data,i=n.list[t];return r.a.createElement(j.a,{data:i,key:i.code,projectID:m,projectPath:g,currentProject:E,fetchList:v,allowUpdate:b,issueCode:h,blockType:n.type,style:a,isDetail:y,isFullScreen:n.isFullScreen,disabledBottomSpace:n.disabledBottomSpace})}),[]);return r.a.createElement("div",{className:s.a.wrapper},r.a.createElement("div",{className:c.a.header},r.a.createElement(a,null),r.a.createElement("div",{className:c.a.text},Object(n.t)("\u963b\u585e\u5173\u7cfb")),b&&r.a.createElement("div",{className:c.a.divider}),b&&r.a.createElement("div",{className:c.a.add,onClick:function(){return d(!0)}})),r.a.createElement("div",{className:s.a.body},!!o.length&&t&&r.a.createElement("div",{className:s.a.prev},r.a.createElement("div",{className:s.a.title},Object(n.t)("\u524d\u7f6e\u4e8b\u9879")),r.a.createElement("div",{className:s.a.list},r.a.createElement(k.FixedSizeList,{itemCount:o.length,itemSize:36,width:"100%",height:I(o.length),itemData:{list:o,type:"BLOCK_BY",isFullScreen:S,disabledBottomSpace:T}},C))),!!l.length&&t&&r.a.createElement("div",{className:s.a.next},r.a.createElement("div",{className:s.a.title},Object(n.t)("\u540e\u7f6e\u4e8b\u9879")),r.a.createElement("div",{className:s.a.list},r.a.createElement(k.FixedSizeList,{itemCount:l.length,itemSize:36,width:"100%",height:I(l.length),itemData:{list:l,type:"BLOCK",isFullScreen:S,disabledBottomSpace:T}},C)))),u&&r.a.createElement(D,{scrollTargetId:f,issueCode:h,projectID:m,controlFocus:p,onCancel:function(){return d(!1)},fetchList:v}))}))},fwPQ:function(e,t,a){e.exports={wrapper:"wrapper-2pJCwuO2sm"}},g1RP:function(e,t,a){e.exports=a.p+"92f254604b74d47528fc1b9fd5efef33.svg"},g2Cx:function(e,t,a){"use strict";a("I5cv"),a("EK0E"),a("XfO3"),a("yt8O"),a("rGqo"),a("mYba");var n=a("TqRt"),i=a("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("f3/d"),a("CX2u"),a("Btvt"),a("VRzm");var r,o,s,l=n(a("lwsE")),c=n(a("W8MJ")),u=n(a("PJYZ")),d=n(a("7W2i")),f=n(a("a1gu")),p=n(a("Nsbk")),m=a("mVeg"),h=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!==typeof e)return{default:e};var a=w(t);if(a&&a.has(e))return a.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=r?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}n.default=e,a&&a.set(e,n);return n}(a("cDcd")),v=n(a("17x9")),g=a("h74D"),E=n(a("sftu")),b=n(a("yZ+p")),y=n(a("zmh9")),S=n(a("E+oP")),I=n(a("Zsd2")),T=a("xgZS"),C=a("YzRi"),P=n(a("PiG+"));function w(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(w=function(e){return e?a:t})(e)}function D(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,p.default)(e);if(t){var i=(0,p.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,f.default)(this,a)}}var O=(0,g.connect)((function(e){return{currentProject:e.APP.currentProject}}),null)((s=o=function(e){(0,d.default)(a,e);var t=D(a);function a(e){var n;return(0,l.default)(this,a),(n=t.call(this,e)).state={name:e.detailInfo&&e.detailInfo.name,isLoading:!1},n.nameChange=n.nameChange.bind((0,u.default)(n)),n.onSubmit=n.onSubmit.bind((0,u.default)(n)),n}return(0,c.default)(a,[{key:"render",value:function(){var e=this.props,t=e.show,a=e.closeHandle,n=this.state,i=n.name,r=n.isLoading;return h.default.createElement(E.default,{closeButton:!0,outsideClickCloseable:!1,show:t,onHide:a,className:P.default.wrapper},h.default.createElement("div",{className:P.default.header},(0,m.t)("\u590d\u5236\u7f3a\u9677")),h.default.createElement("div",{className:P.default.inputLabel},(0,m.t)("\u6807\u9898")," ",h.default.createElement("span",null,"*")),h.default.createElement(b.default,{size:"medium",value:i,onChange:this.nameChange}),h.default.createElement("div",{className:P.default.buttonGroup},h.default.createElement(y.default,{onClick:this.onSubmit},(0,m.t)("\u590d\u5236")),h.default.createElement(y.default,{loading:r,empty:!0,onClick:function(){return a()}},(0,m.t)("\u53d6\u6d88"))))}},{key:"nameChange",value:function(e){this.setState({name:e.target.value})}},{key:"onSubmit",value:function(){var e=this,t=this.props,a=t.detailInfo,n=t.currentProject,i=t.closeHandle,r=t.callback,o=this.state.name;(0,S.default)((0,I.default)(o))?(0,T.danger)((0,m.t)("\u7f3a\u9677\u6807\u9898\u4e0d\u80fd\u4e3a\u7a7a")):(this.setState({isLoading:!0}),(0,C.copyIssue)(n.id,a.code,o).then((function(){(0,T.success)((0,m.t)("\u7f3a\u9677\u590d\u5236\u6210\u529f")),i(),r&&r()})).finally((function(){e.setState({isLoading:!1})})))}}]),a}(h.Component),o.propTypes={show:v.default.bool,closeHandle:v.default.func,detailInfo:v.default.object,currentProject:v.default.object,callback:v.default.func},r=s))||r;t.default=O},"g84+":function(e,t,a){e.exports={"file-preview-wrapper":"file-preview-wrapper-1gQ3mgmiY_",filePreviewWrapper:"file-preview-wrapper-1gQ3mgmiY_","previous-button":"previous-button-3DudRnMQY6",previousButton:"previous-button-3DudRnMQY6","next-button":"next-button-1W3CdALPaE",nextButton:"next-button-1W3CdALPaE","invisible-file":"invisible-file-31KW3ETMfN",invisibleFile:"invisible-file-31KW3ETMfN","fetch-loading":"fetch-loading-DqdaZX0xJo",fetchLoading:"fetch-loading-DqdaZX0xJo","fetch-error":"fetch-error-2nGR7xgaSz",fetchError:"fetch-error-2nGR7xgaSz","file-loading":"file-loading-3prHWHPjjJ",fileLoading:"file-loading-3prHWHPjjJ","file-error":"file-error-375EEzD9G-",fileError:"file-error-375EEzD9G-","file-success":"file-success-32aOh9Fxpe",fileSuccess:"file-success-32aOh9Fxpe","preview-container":"preview-container-2Ep5FP0wEv",previewContainer:"preview-container-2Ep5FP0wEv","file-preview":"file-preview-2WrNBiF10b",filePreview:"file-preview-2WrNBiF10b","preview-download":"preview-download-3XfjsJ42rh",previewDownload:"preview-download-3XfjsJ42rh","file-preview-office":"file-preview-office-3tLqH2xWZ4",filePreviewOffice:"file-preview-office-3tLqH2xWZ4","full-screen-image":"full-screen-image-XqwWYZns-B",fullScreenImage:"full-screen-image-XqwWYZns-B","file-preview-image":"file-preview-image-wClwWHzh8r",filePreviewImage:"file-preview-image-wClwWHzh8r","image-not-found":"image-not-found-2RTqckQo7d",imageNotFound:"image-not-found-2RTqckQo7d","image-loading":"image-loading-1bunNsIGui",imageLoading:"image-loading-1bunNsIGui","image-error":"image-error-1T4knz4WY2",imageError:"image-error-1T4knz4WY2","loading-icon":"loading-icon-2hkL4BVohE",loadingIcon:"loading-icon-2hkL4BVohE","file-preview-pdf":"file-preview-pdf-1sf614qQri",filePreviewPdf:"file-preview-pdf-1sf614qQri","file-preview-markdown":"file-preview-markdown-c4IFpK0qJu",filePreviewMarkdown:"file-preview-markdown-c4IFpK0qJu","file-preview-text":"file-preview-text-tUBs4nLK_f",filePreviewText:"file-preview-text-tUBs4nLK_f","file-inner-navigator":"file-inner-navigator-2SmaPzOvH5",fileInnerNavigator:"file-inner-navigator-2SmaPzOvH5","zoom-rage":"zoom-rage-10Wmas15eH",zoomRage:"zoom-rage-10Wmas15eH",show:"show-3BeVw_qJft",hide:"hide-1TFJXypxSq",squire:"squire-1KJG7qXfxb",letting:"letting-ReetG7h7T-",enlarge:"enlarge-2baFvSlj6G","arrow-up":"arrow-up-ZgVWo6JlAw",arrowUp:"arrow-up-ZgVWo6JlAw","arrow-down":"arrow-down-1d9Zt07MhP",arrowDown:"arrow-down-1d9Zt07MhP",minimize:"minimize-2-KUgYbquF",maximize:"maximize-29PZjk9Deq",rate:"rate-10TOESOqo5","navigator-nums":"navigator-nums-dXhT7fbeMv",navigatorNums:"navigator-nums-dXhT7fbeMv",zooming:"zooming-3gRoHE60Dm",item:"item-1aFFFVUYnn","horizontal-split":"horizontal-split-1FQk0OjRBR",horizontalSplit:"horizontal-split-1FQk0OjRBR","zooming-hide":"zooming-hide-3EthJibiWr",zoomingHide:"zooming-hide-3EthJibiWr","navigate-input":"navigate-input-2pLQs1qov_",navigateInput:"navigate-input-2pLQs1qov_",split:"split-auwgOZtLa6"}},gHyg:function(e,t,a){e.exports={root:"root-3u0n5dJaui","custom-input":"custom-input-1rp61F8VFF",customInput:"custom-input-1rp61F8VFF","result-wrapper":"result-wrapper-3TXJEQhYMP",resultWrapper:"result-wrapper-3TXJEQhYMP","result-empty":"result-empty-1ScQhur3Pz",resultEmpty:"result-empty-1ScQhur3Pz",icon:"icon-2doHnEipmN","cancel-btn":"cancel-btn-3k3Rp3b9iQ",cancelBtn:"cancel-btn-3k3Rp3b9iQ","result-items":"result-items-1DH2vUiDfG",resultItems:"result-items-1DH2vUiDfG",item:"item-2M1qQgvriL","is-disabled":"is-disabled-3NZ3ulOlHp",isDisabled:"is-disabled-3NZ3ulOlHp",desc:"desc-3ejfVfXn5z","item-code":"item-code-2fEBn1FQ9Q",itemCode:"item-code-2fEBn1FQ9Q","item-detail":"item-detail-3IKoVagJlp",itemDetail:"item-detail-3IKoVagJlp","item-detail-title":"item-detail-title-1_7wH_aMIv",itemDetailTitle:"item-detail-title-1_7wH_aMIv","result-filter-bar":"result-filter-bar-FJZ6tgFUOJ",resultFilterBar:"result-filter-bar-FJZ6tgFUOJ",detail:"detail-1azJJV6vEi","input-wrapper":"input-wrapper-2wsuLd-LPX",inputWrapper:"input-wrapper-2wsuLd-LPX",wrapper:"wrapper-2ruK8OY1Fi",title:"title-2av_xB4Zih","requirement-icon":"requirement-icon-1-_QfWnYUK",requirementIcon:"requirement-icon-1-_QfWnYUK","issue-icon":"issue-icon-3__zVQBjxv",issueIcon:"issue-icon-3__zVQBjxv","assignment-icon":"assignment-icon-QD7651l3jk",assignmentIcon:"assignment-icon-QD7651l3jk","custom-detail":"custom-detail-34m4SCVSbd",customDetail:"custom-detail-34m4SCVSbd","belong-iteration":"belong-iteration-11dUBYe4MZ",belongIteration:"belong-iteration-11dUBYe4MZ","belong-epic":"belong-epic-1NJYwvWB2h",belongEpic:"belong-epic-1NJYwvWB2h","custom-search-icon":"custom-search-icon-1B-pju7X4-",customSearchIcon:"custom-search-icon-1B-pju7X4-"}},gqWk:function(e,t,a){e.exports={root:"root-bRzAWlC0I7","expanded-style":"expanded-style-2rdIPIi21r",expandedStyle:"expanded-style-2rdIPIi21r",trigger:"trigger-3d4LfA-qOG",dropdown:"dropdown-2ERd2m1g8F","delete-style":"delete-style-3P7cYGF-8E",deleteStyle:"delete-style-3P7cYGF-8E","help-icon":"help-icon-lyfyjjunPB",helpIcon:"help-icon-lyfyjjunPB","divide-line":"divide-line-24dV1SPZBk",divideLine:"divide-line-24dV1SPZBk","full-screen-help-icon":"full-screen-help-icon-1lqGgN3Kz6",fullScreenHelpIcon:"full-screen-help-icon-1lqGgN3Kz6","add-sensitive":"add-sensitive-1jUBoemFwI",addSensitive:"add-sensitive-1jUBoemFwI",item:"item-SgSPgmgS_a","min-width-hide":"min-width-hide-1RMSQ3SXx0",minWidthHide:"min-width-hide-1RMSQ3SXx0"}},hJbg:function(e,t,a){"use strict";var n=a("mVeg"),i=a("cDcd"),r=a.n(i),o=a("sEfC"),s=a.n(o),l=a("faye"),c=a("ka/S"),u=a.n(c),d=a("K2gz"),f=a.n(d),p=a("yZ+p"),m=a.n(p),h=a("5kKY"),v=a("qEFv"),g=a("DTVk"),E=a("w3Wo"),b=a("u5of"),y=a.n(b),S=a("8lvN"),I=a.n(S),T=a("Q95R"),C=a.n(T),P=a("xgZS"),w=a("82Y3"),D=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(t,a)};return function(t,a){if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),O=function(e){function t(t){var a=e.call(this,t)||this;return a.handleSelectCategory=function(e){a.setState({issueTypeDetail:e})},a.handleTitleChange=function(e){a.setState({title:e.target.value})},a.handleVisible=function(e){a.setState({visible:e})},a.handleOpenCreate=function(){a.setState({createVisible:!0})},a.handleCloseCreate=function(){a.setState({createVisible:!1})},a.handleClose=function(){var e=a.props.onCancel;e&&e()},a.handleCreateFast=s()((function(){var e=a.props,t=e.iteration,i=e.parent,r=e.onCreate,o=e.projectID,s=a.state,l=s.title,c=s.issueTypeDetail;l?Object(E.fastCreateIssue)(o,{iterationCode:t?t.code:void 0,parentCode:i?i.code:void 0,name:l,issueType:c.issueType,issueTypeId:c.id,issueDescriptionType:Object(w.getPreferEditorType)()}).then((function(e){var t=e.data;Object(P.success)(Object(n.t)("\u521b\u5efa\u6210\u529f")),a.setState({title:""}),r&&r(t)}),(function(e){8011!==e.code&&a.handleOpenCreate()})):Object(P.warning)(Object(n.t)("\u8bf7\u8f93\u5165{{type}}\u6807\u9898",{type:c.name}))}),300),a.handleUpdate=function(e){var t=a.props.onFullCreate;a.setState({title:""}),t&&t(e)},a.handleKeydown=s()((function(e){if(!a.state.createVisible&&(27===e.keyCode&&a.handleClose(),13===e.keyCode)){var t=a.props.iteration;e.shiftKey?(t&&t.status&&"COMPLETED"===t.status&&Object(P.danger)(Object(n.t)("\u8fed\u4ee3\u5df2\u5b8c\u6210\uff0c\u4e0d\u5141\u8bb8\u52a0\u5165")),a.handleOpenCreate()):a.handleCreateFast()}}),300),a.state={title:"",visible:!1,createVisible:!1,issueTypeDetail:t.issueTypeOptions[0]},a}return D(t,e),t.prototype.componentDidMount=function(){window.addEventListener("keydown",this.handleKeydown)},t.prototype.componentWillUnmount=function(){window.removeEventListener("keydown",this.handleKeydown)},t.prototype.render=function(){var e=this,t=this.props,a=t.projectName,i=t.iteration,o=t.currentIteration,s=t.parent,c=t.style,d=t.issueTypeOptions,p=this.state,E=p.issueTypeDetail,b=p.title,S=p.visible,T=p.createVisible;return Object(l.createPortal)(r.a.createElement("div",{className:u.a.wrapper},r.a.createElement("div",{className:u.a.create,style:c},r.a.createElement(m.a,{autoFocus:!0,prefix:r.a.createElement("div",{className:u.a.prefix},r.a.createElement("div",{className:u.a.subItem}),r.a.createElement(v.CategorySelect,{value:E,onSelect:this.handleSelectCategory,getContainer:function(){return document.body},options:d}),r.a.createElement("div",{className:u.a.divider})),placeholder:"".concat(E.name).concat(Object(n.t)("\u6807\u9898")),value:b,onChange:this.handleTitleChange}),r.a.createElement("div",{className:u.a.operate},r.a.createElement("div",{className:u.a.operateLeft},r.a.createElement(h.Trigger,{visible:S,onVisibleChange:this.handleVisible,popup:r.a.createElement("div",{className:u.a.popup},r.a.createElement("div",{className:u.a.popupItem,onClick:function(){i&&i.status&&"COMPLETED"===i.status&&Object(P.danger)(Object(n.t)("\u8fed\u4ee3\u5df2\u5b8c\u6210\uff0c\u4e0d\u5141\u8bb8\u52a0\u5165")),e.handleOpenCreate()}},r.a.createElement("div",{className:u.a.popupText},Object(n.t)("\u5b8c\u6574\u521b\u5efa")),r.a.createElement("div",{className:f()(u.a.operateIcon,u.a.operateIconShift)}),r.a.createElement("div",{className:f()(u.a.operateIcon,u.a.operateIconEnter)})))},r.a.createElement("div",{className:f()(u.a.trigger,S&&u.a.triggerActive)},r.a.createElement("div",{className:u.a.triggerButton,onClick:function(t){t.stopPropagation(),e.handleCreateFast()}},Object(n.t)("\u5feb\u901f\u521b\u5efa")),r.a.createElement("div",{className:u.a.triggerIcon}))),r.a.createElement("div",{className:u.a.operateCancel,onClick:this.handleClose},Object(n.t)("\u53d6\u6d88"))),r.a.createElement("div",{className:u.a.operateItem},r.a.createElement("div",{className:f()(u.a.operateIcon,u.a.operateIconEnter)}),r.a.createElement("div",{className:u.a.operateTip},Object(n.t)("\u5feb\u901f\u521b\u5efa"))),r.a.createElement("div",{className:u.a.operateItem},r.a.createElement("div",{className:f()(u.a.operateIcon,u.a.operateIconShift)}),r.a.createElement("div",{className:f()(u.a.operateIcon,u.a.operateIconEnter)}),r.a.createElement("div",{className:u.a.operateTip},Object(n.t)("\u5b8c\u6574\u521b\u5efa"))),r.a.createElement("div",{className:u.a.operateItem},r.a.createElement("div",{className:f()(u.a.operateIcon,u.a.operateIconEsc)}),r.a.createElement("div",{className:u.a.operateTip},Object(n.t)("\u53d6\u6d88")))),T&&E.issueType===g.IssueType.requirement&&r.a.createElement(y.a,{targetData:{projectName:a},name:b,show:T&&E.issueType===g.IssueType.requirement,callbackWithData:this.handleUpdate,closeHandle:this.handleCloseCreate,iteration:o,parentCode:s?s.code:void 0,issueTypeDetail:E}),T&&E.issueType===g.IssueType.assignment&&r.a.createElement(I.a,{targetData:{projectName:a},name:b,show:T&&E.issueType===g.IssueType.assignment,callbackWithData:this.handleUpdate,closeHandle:this.handleCloseCreate,iteration:o,parent:s,issueTypeDetail:E}),T&&E.issueType===g.IssueType.bug&&r.a.createElement(C.a,{targetData:{projectName:a},name:b,show:T&&E.issueType===g.IssueType.bug,callbackWithData:this.handleUpdate,closeHandle:this.handleCloseCreate,iteration:o,iterationCode:i&&i.code,issueTypeDetail:E}))),document.querySelector('div[data-frontend-module-container="coding-project-management-frontend"]')||document.body)},t}(r.a.Component);t.a=O},"he8+":function(e,t,a){"use strict";a.r(t);var n=a("mVeg"),i=a("cDcd"),r=a.n(i),o=a("7bn+"),s=a("BKNj"),l=a("L8Eh"),c=a("ixak"),u=a("OBZ8"),d=a("MiOB"),f=a("V/h/"),p=a("K2gz"),m=a.n(p),h=a("aVY/"),v=a.n(h),g=a("w3Wo"),E=a("2CQ4"),b=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(t,a)};return function(t,a){if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),y=function(){return(y=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},S=function(e){function t(t){var a=e.call(this,t)||this;return a.getAllDepartments=function(e,t){if(void 0===e&&(e=""),t){if(0===t.code){var n=t.data.map((function(e){return y(y({},e),{id:e.departmentId,text:e.orgName})}));a.setState({departments:n})}}else Object(g.getAllDept)(e).then((function(e){var t=e.data.map((function(e){return y(y({},e),{id:e.departmentId,text:e.orgName})}));a.setState({departments:t})}))},a.state={departments:[]},a.onClear=a.onClear.bind(a),a.multipleSelect=a.multipleSelect.bind(a),a.multipleMemberSelect=a.multipleMemberSelect.bind(a),a.multipleIterationSelect=a.multipleIterationSelect.bind(a),a}return b(t,e),t.prototype.porpertyComponent=function(){var e=this,t=this.props,a=t.componentType,i=t.value,f=t.options,p=t.onChange,m=t.unit,h=t.className,g=t.initialSelectedMembers,b=t.initialSelectedIterations,S=t.disabled,I=t.isDetail,T=t.portalProps,C=t.isCreate,P=t.projectID,w=t.dateTimeClass,D=t.onExpandChange,O=t.required,R=this.state.departments,j=f?f.map((function(e){return y(y({},e),{value:e.value,id:e.value,text:e.title})})):[];switch(a){case o.PROPERTY_TYPE_CONSTANTS.SELECT_SINGLE:return r.a.createElement(s.default,{value:i,items:j,disabled:S,placeholder:Object(n.t)("\u8bf7\u9009\u62e9"),searchPlaceholder:Object(n.t)("\u8bf7\u8f93\u5165\u5173\u952e\u5b57"),onSelect:function(e){return p(e.id)},onClear:this.onClear,onExpandChange:D});case o.PROPERTY_TYPE_CONSTANTS.SELECT_MULTI:return r.a.createElement(s.default,{value:Array.isArray(i)?i:[],items:j,isMultiple:!0,disabled:S,placeholder:Object(n.t)("\u8bf7\u9009\u62e9"),searchPlaceholder:Object(n.t)("\u8bf7\u8f93\u5165\u5173\u952e\u5b57"),onSelect:this.multipleSelect,onClear:this.onClear});case o.PROPERTY_TYPE_CONSTANTS.TEXT_SINGLE_LINE:return r.a.createElement(u.default,{disabled:S,placeholder:Object(n.t)("\u672a\u586b\u5199"),onChange:function(e){var t=e.content;return p(t)},value:i});case o.PROPERTY_TYPE_CONSTANTS.TEXT_MULTI_LINE:return r.a.createElement(u.default,{disabled:S,multiple:!0,placeholder:Object(n.t)("\u672a\u586b\u5199"),onChange:function(e){var t=e.content;return p(t)},value:i,isCreate:C});case o.PROPERTY_TYPE_CONSTANTS.SELECT_MEMBER_SINGLE:var k=i&&!isNaN(i)?i:i.id?i.id:null;return r.a.createElement(l.default,{disabled:S,value:k,inProject:!0,projectID:P,onSelect:function(e){return p(e)},onClear:this.onClear,triggerExtraProps:{initialSelectedItem:g}});case o.PROPERTY_TYPE_CONSTANTS.SELECT_MEMBER_MULTI:return r.a.createElement(l.default,{disabled:S,isMultiple:!0,inProject:!0,projectID:P,value:Array.isArray(i)?i.map((function(e){return e.id})):[],onSelect:this.multipleMemberSelect,onClear:this.onClear,triggerExtraProps:{initialSelectedItem:g}});case o.PROPERTY_TYPE_CONSTANTS.SELECT_ITERATION_SINGLE:k=i&&!isNaN(i)?i:i.id?i.id:null;return r.a.createElement(c.default,{disabled:S,projectID:P,value:k,onSelect:function(e){return p(e)},onClear:this.onClear,triggerExtraProps:{initialSelectedItem:b}});case o.PROPERTY_TYPE_CONSTANTS.SELECT_ITERATION_MULTI:return r.a.createElement(c.default,{disabled:S,isMultiple:!0,projectID:P,value:Array.isArray(i)?i.map((function(e){return e.id})):[],onSelect:this.multipleIterationSelect,onClear:this.onClear,triggerExtraProps:{initialSelectedItem:b}});case o.PROPERTY_TYPE_CONSTANTS.TEXT_DATE:return r.a.createElement(d.default,{isDisabled:S,className:"".concat(v.a.inlineDatePicker," ").concat(h),value:i,onChange:function(e){p(e.isValid()?e.format("YYYY-MM-DD"):"")},isDetail:I,isPortal:!0,portalProps:T});case o.PROPERTY_TYPE_CONSTANTS.TEXT_DATETIME:return r.a.createElement("div",{className:w,onScroll:function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()}},r.a.createElement(d.default,{isDisabled:S,className:"".concat(v.a.inlineDatePicker," ").concat(h),isTimePicker:!0,value:i,onChange:function(e){p(e.isValid()?e.format("YYYY-MM-DD HH:mm:ss"):"")},isDetail:I,isPortal:!0,portalProps:T}));case o.PROPERTY_TYPE_CONSTANTS.TEXT_INTEGER:return r.a.createElement(u.default,{disabled:S,isNumber:!0,onChange:function(e){var t=e.content;t?p(t):p()},value:i,unit:m,dangerTip:Object(n.t)("\u8bf7\u8f93\u5165\u6574\u6570"),maxLength:9});case o.PROPERTY_TYPE_CONSTANTS.TEXT_DECIMAL:return r.a.createElement(u.default,{disabled:S,isNumber:!0,isDecimals:!0,onChange:function(e){var t=e.content;t?p(parseFloat(t)):p()},value:i,unit:m,dangerTip:Object(n.t)("\u8bf7\u8f93\u5165\u5c0f\u6570"),maxLength:9});case o.PROPERTY_TYPE_CONSTANTS.SELECT_DEPARTMENT_SINGLE:return r.a.createElement(s.default,{value:i&&+i,items:R,disabled:S,placeholder:Object(n.t)("\u8bf7\u9009\u62e9"),searchPlaceholder:Object(n.t)("\u8bf7\u8f93\u5165\u5173\u952e\u5b57"),onSearch:function(t){return e.getAllDepartments(t)},onSelect:function(e){return p(e.id)},onClear:this.onClear});case o.PROPERTY_TYPE_CONSTANTS.SELECT_TREE_SINGLE:return r.a.createElement(E.a,{options:f,value:i,onChange:p,isPortal:!0,required:O,portalProps:T});case o.PROPERTY_TYPE_CONSTANTS.SELECT_TREE_MULTI:return r.a.createElement(E.a,{options:f,value:i,onChange:p,multiple:!0,isPortal:!0,required:O,portalProps:T});default:window.console.warn("error unkown component type")}return""},t.prototype.render=function(){var e=this.props.outterClassName;return r.a.createElement("div",{className:m()([e,v.a.root])},this.porpertyComponent())},t.prototype.onClear=function(){var e=this.props.onChange;e&&e()},t.prototype.multipleSelect=function(e){var t=this.props,a=t.value,n=t.onChange,i={};if(a){var r=a.findIndex((function(t){return t===e.id}));i=Object(f.default)(a,(function(t){r>-1?t.splice(r,1):t.push(e.id)}))}else i=[e.id];n(i)},t.prototype.multipleMemberSelect=function(e){var t=this.props,a=t.value,n=t.onChange,i={};if(a){var r=a.findIndex((function(t){return t.id===e.id}));i=Object(f.default)(a,(function(t){r>-1?t.splice(r,1):t.push(e)}))}else i=[e.id];n(i)},t.prototype.multipleIterationSelect=function(e){var t=this.props,a=t.value,n=t.onChange,i={};if(a){var r=a.findIndex((function(t){return t.id===e.id}));i=Object(f.default)(a,(function(t){r>-1?t.splice(r,1):t.push(e)}))}else i=[e.id];n(i)},t}(i.Component);t.default=S},hjSp:function(e,t,a){e.exports=a.p+"7f06d34241796d0682a03f2f04a6b972.svg"},"hlQ/":function(e,t,a){e.exports={select:"select-243bhu6JYn","select-arrow-wrapper":"select-arrow-wrapper-1-RnYBrmik",selectArrowWrapper:"select-arrow-wrapper-1-RnYBrmik","menu-top":"menu-top-3_Zh1GKrJz",menuTop:"menu-top-3_Zh1GKrJz","select-with-label":"select-with-label-1FW4yzbtlq",selectWithLabel:"select-with-label-1FW4yzbtlq","select-trigger":"select-trigger-1--U7ECUlf",selectTrigger:"select-trigger-1--U7ECUlf","has-border":"has-border-20lkv8P5WU",hasBorder:"has-border-20lkv8P5WU","is-block":"is-block-1MOPD-O7_A",isBlock:"is-block-1MOPD-O7_A","item-text":"item-text-1uYVGVzdji",itemText:"item-text-1uYVGVzdji","not-selected":"not-selected-1bDP4j7m5o",notSelected:"not-selected-1bDP4j7m5o","is-expanded":"is-expanded-LrA_u1UftX",isExpanded:"is-expanded-LrA_u1UftX","inline-dropdown":"inline-dropdown-2AUT42rsxx",inlineDropdown:"inline-dropdown-2AUT42rsxx","item-label":"item-label-3KVgpP6eCA",itemLabel:"item-label-3KVgpP6eCA","item-text-ellipsis":"item-text-ellipsis-15pd5G3SZN",itemTextEllipsis:"item-text-ellipsis-15pd5G3SZN","clear-button":"clear-button-2uiBHQYA4A",clearButton:"clear-button-2uiBHQYA4A","to-top":"to-top-3AONi6az7c",toTop:"to-top-3AONi6az7c","to-right":"to-right-3mVJaHgWh5",toRight:"to-right-3mVJaHgWh5","trigger-background":"trigger-background-1iaTLZvbm4",triggerBackground:"trigger-background-1iaTLZvbm4","clear-divider":"clear-divider-3GWVw_qgjB",clearDivider:"clear-divider-3GWVw_qgjB",show:"show-1F2wiRX84p",clear:"clear-2HOCKVhoPR","unspecific-user":"unspecific-user-2zaXbpRoG7",unspecificUser:"unspecific-user-2zaXbpRoG7","align-top":"align-top-36yDYU4E7W",alignTop:"align-top-36yDYU4E7W","cart-down":"cart-down-MdHo-Jfshx",cartDown:"cart-down-MdHo-Jfshx",color:"color-2STlw4sHYM"}},htee:function(e,t,a){"use strict";a.r(t);var n=a("cDcd"),i=a.n(n),r=a("es6E"),o=a("LgIu"),s=a("O9Lt"),l=a.n(s),c=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(t,a)};return function(t,a){if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),u=function(){return(u=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},d=function(e,t,a,n){var i,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,a,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(r<3?i(o):r>3?i(t,a,o):i(t,a))||o);return r>3&&o&&Object.defineProperty(t,a,o),o};t.default=function(e){return function(t){function a(e){var a=t.call(this,e)||this;return a.getProjectPermissions=function(){var e=a.props,t=e.projectID,n=e.currentProject;Object(o.g)(t).then((function(e){var t=e.data;a.projectsStore.updateProjectPermissionList(n.name,t.permissions)}))},a.hasPermiss=function(e,t){if(void 0===a.permisscache[e]){var n=e.split("-");a.permisscache[e]=t.some((function(e){return n[0]===e.function&&n[1]===e.action}))}return a.permisscache[e]},a.isPermissible=function(e,t){void 0===t&&(t={});var n=a.getProjectPermissionData(),i=e.map((function(e){return e.function+"-"+e.action}));if(!n)return!1;var r=t.strict;return void 0!==r&&r?i.every((function(e){return a.hasPermiss(e,n)})):i.some((function(e){return a.hasPermiss(e,n)}))},a.getProjectPermissionData=function(){var e=a.props.currentProject.name;return a.projectCache[e]||(a.projectCache[e]=r.StoreMobxApi.toJS(a.projectsStore.projectPermissionData[e])),a.projectCache[e]},a.projectsStore=Object(r.getStore)(r.StoreName.PROJECTS),a.permisscache={},a.projectCache={},a}return c(a,t),a.prototype.render=function(){var t=this.props.currentProject,a=this.getProjectPermissionData();return t&&a?i.a.createElement(e,u({},this.props,{isPermissible:this.isPermissible})):i.a.createElement(l.a,{show:!0})},a.prototype.componentDidMount=function(){this.getProjectPermissionData()||this.getProjectPermissions()},a=d([r.StoreMobxReactApi.observer],a)}(i.a.Component)}},hyWy:function(e,t,a){e.exports={select:"select-1bz0r5bi5o","select-arrow-wrapper":"select-arrow-wrapper-3U12P11Q4b",selectArrowWrapper:"select-arrow-wrapper-3U12P11Q4b","menu-top":"menu-top-2QPYd9kafJ",menuTop:"menu-top-2QPYd9kafJ","select-with-label":"select-with-label-29IJMrb0d6",selectWithLabel:"select-with-label-29IJMrb0d6","select-trigger":"select-trigger-3UYsfkddjR",selectTrigger:"select-trigger-3UYsfkddjR","has-border":"has-border-3IvaSxbep3",hasBorder:"has-border-3IvaSxbep3","is-block":"is-block-5vX8UKjnpP",isBlock:"is-block-5vX8UKjnpP","item-text":"item-text-1v-E8Ts0jZ",itemText:"item-text-1v-E8Ts0jZ","not-selected":"not-selected-1tmIkq7EE_",notSelected:"not-selected-1tmIkq7EE_","select-trigger-disabled":"select-trigger-disabled-2EqbMup0-y",selectTriggerDisabled:"select-trigger-disabled-2EqbMup0-y","is-expanded":"is-expanded-1uBxTdxELR",isExpanded:"is-expanded-1uBxTdxELR","inline-dropdown":"inline-dropdown-3moFxhJjcD",inlineDropdown:"inline-dropdown-3moFxhJjcD","item-label":"item-label-UjvEvcHqaE",itemLabel:"item-label-UjvEvcHqaE","item-text-ellipsis":"item-text-ellipsis-1-GSrYuBo2",itemTextEllipsis:"item-text-ellipsis-1-GSrYuBo2","clear-button":"clear-button-2T_er0vd0u",clearButton:"clear-button-2T_er0vd0u","to-top":"to-top-2Zz08pfri0",toTop:"to-top-2Zz08pfri0","to-right":"to-right-1vIkk-Ki_3",toRight:"to-right-1vIkk-Ki_3","trigger-background":"trigger-background-2sbLWkYVXl",triggerBackground:"trigger-background-2sbLWkYVXl","clear-divider":"clear-divider-IxZq6IL_hF",clearDivider:"clear-divider-IxZq6IL_hF",show:"show-1uqKXd-oNH",clear:"clear-NL7X3OoduC","calendar-date":"calendar-date-LGR2mqT9Nd",calendarDate:"calendar-date-LGR2mqT9Nd",today:"today-1XCxPACkyp",yesterday:"yesterday-2B8eK1qDwt","not-specified":"not-specified-21zNcKRraI",notSpecified:"not-specified-21zNcKRraI","custom-select":"custom-select-VtkUsish-N",customSelect:"custom-select-VtkUsish-N","is-disabled":"is-disabled-3mvCakwmQl",isDisabled:"is-disabled-3mvCakwmQl",trigger:"trigger-3AbxtyfwDE","custom-select-not-portal":"custom-select-not-portal-1hJBLBCLTt",customSelectNotPortal:"custom-select-not-portal-1hJBLBCLTt","custom-select-portal":"custom-select-portal-2a1qOSgoIe",customSelectPortal:"custom-select-portal-2a1qOSgoIe","custom-select-in-top":"custom-select-in-top-1ey2mhect8",customSelectInTop:"custom-select-in-top-1ey2mhect8","arrow-position-right":"arrow-position-right-28C0UNZiSW",arrowPositionRight:"arrow-position-right-28C0UNZiSW","cart-down":"cart-down-3t0KTElFZO",cartDown:"cart-down-3t0KTElFZO"}},iOVS:function(e,t,a){"use strict";a("I5cv");var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("f3/d"),a("bWfx"),a("I78e");var i=n(a("lwsE")),r=n(a("W8MJ")),o=n(a("7W2i")),s=n(a("a1gu")),l=n(a("Nsbk")),c=a("mVeg"),u=n(a("cDcd")),d=n(a("17x9")),f=n(a("smSU")),p=n(a("K2gz")),m=a("7FZc"),h=a("dtw8"),v=n(a("P5Jw")),g=n(a("KUqB"));function E(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,l.default)(e);if(t){var i=(0,l.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,s.default)(this,a)}}var b={REQUIREMENT:"requirements",MISSION:"assignments"},y=function(e){(0,o.default)(a,e);var t=E(a);function a(e){var n;return(0,i.default)(this,a),(n=t.call(this,e)).getName=function(e){var t,a=n.props.projectPath;return u.default.createElement(m.TooltipTrigger,{title:e.name},u.default.createElement(h.Link,{to:"".concat(a,"/").concat(b[e.type],"/issues/").concat(e.code,"/detail"),className:(0,p.default)(f.default.code,f.default.number)},u.default.createElement(g.default,{type:null===e||void 0===e||null===(t=e.issueTypeDetail)||void 0===t?void 0:t.iconType}),u.default.createElement("span",null,"#",e.code)))},n.getLastName=function(e){var t,a=n.props.projectPath,i=n.state.tooltipTitle;return u.default.createElement(u.default.Fragment,null,u.default.createElement("span",{className:(0,p.default)(f.default.code,f.default.lastId,f.default.lastNumber)},u.default.createElement(h.Link,{to:"".concat(a,"/").concat(b[e.type],"/issues/").concat(e.code,"/detail"),className:(0,p.default)(f.default.code,f.default.number)},u.default.createElement(g.default,{type:null===e||void 0===e||null===(t=e.issueTypeDetail)||void 0===t?void 0:t.iconType}),u.default.createElement("span",null,"#",e.code)),u.default.createElement(m.TooltipTrigger,{title:i,onVisibleChange:n.onVisibleChange},u.default.createElement(v.default,{text:"".concat(window.location.origin).concat(a,"/").concat(b[e.type],"/issues/").concat(e.code,"/detail")},u.default.createElement("div",{className:f.default.copyIcon,onClick:n.onCopyClick})))),u.default.createElement("span",{className:(0,p.default)(f.default.code,f.default.lastId,f.default.lastNumber),style:{marginLeft:20,fontWeight:600}},"|",u.default.createElement("span",{style:{color:"red",margin:"0 5px"}},"GID"),u.default.createElement("span",null,"#",e.id),u.default.createElement(m.TooltipTrigger,{title:i,onVisibleChange:n.copyGID},u.default.createElement(v.default,{text:e.id},u.default.createElement("div",{className:f.default.copyIcon,onClick:n.onCopyClick})))))},n.copyGID=function(){n.setState({tooltipTitle:(0,c.t)("\u590d\u5236")})},n.onVisibleChange=function(){n.setState({tooltipTitle:(0,c.t)("\u590d\u5236\u94fe\u63a5")})},n.onCopyClick=function(){n.setState({tooltipTitle:(0,c.t)("\u5df2\u590d\u5236")})},n.state={tooltipTitle:(0,c.t)("\u590d\u5236\u94fe\u63a5")},n}return(0,r.default)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.nameList,n=t.showMoreCrumb,i=t.toggleDropdown,r=t.projectPath;return a.length<=3?u.default.createElement("div",{className:f.default.issuesCrumbs},a.map((function(t,n){return u.default.createElement(u.default.Fragment,{key:n},n!==a.length-1?e.getName(t):e.getLastName(t),n!==a.length-1&&u.default.createElement("span",{className:f.default.codeIdDivideLine},"/"))}))):u.default.createElement("div",{className:f.default.issuesCrumbs},this.getName(a[0]),u.default.createElement("span",{className:f.default.codeIdDivideLine},"/"),u.default.createElement("span",{className:(0,p.default)(f.default.moreButton,n?f.default.active:""),onClick:i},n&&u.default.createElement("ul",{className:f.default.detailMenu},a.slice(1,a.length-2).map((function(e,t){var a;return u.default.createElement("li",{key:t,onClick:function(){return window.location.href="".concat(window.location.origin).concat(r,"/").concat(b[e.type],"/issues/").concat(e.code,"/detail")},className:f.default.showItem},u.default.createElement("span",{title:e.name,className:f.default.toolDoc},u.default.createElement(g.default,{type:null===(a=e.issueTypeDetail)||void 0===a?void 0:a.iconType}),u.default.createElement("span",{className:f.default.over},u.default.createElement("span",{className:f.default.listCode},"#",e.code)," ",e.name)))})))),u.default.createElement("span",{className:f.default.codeIdDivideLine},"/"),this.getName(a[a.length-2]),u.default.createElement("span",{className:f.default.codeIdDivideLine},"/"),this.getLastName(a[a.length-1]))}}]),a}(u.default.Component);t.default=y,y.propTypes={issueType:d.default.string,nameList:d.default.array,showMoreCrumb:d.default.bool,toggleDropdown:d.default.func,getWikiLink:d.default.func,projectPath:d.default.string}},iQyA:function(e,t,a){e.exports=a.p+"2a54ed0da646dc312ea1192694e83b52.svg"},ixw1:function(e,t,a){e.exports={switch:"switch-vmpEST4qXT","switch-checked":"switch-checked-23XZXVJObO",switchChecked:"switch-checked-23XZXVJObO","switch-un-checked":"switch-un-checked-10tpX5Rm_G",switchUnChecked:"switch-un-checked-10tpX5Rm_G","active-disabled":"active-disabled-1XmlyhDRNR",activeDisabled:"active-disabled-1XmlyhDRNR",disabled:"disabled-ebmLjMWHqH",on:"on-2RFpcbWUVo",checked:"checked-3NRDSy_mIu","un-checked":"un-checked-3mMYcBj5D7",unChecked:"un-checked-3mMYcBj5D7",loading:"loading-18dEJ0GZCr",spin:"spin-ZWfexHY-WG"}},"iz+V":function(e,t,a){e.exports={"export-modal":"export-modal-AVkhW5_Zcs",exportModal:"export-modal-AVkhW5_Zcs","export-body":"export-body-GglH042XO4",exportBody:"export-body-GglH042XO4","export-footer":"export-footer-Kchfb0d5mu",exportFooter:"export-footer-Kchfb0d5mu","export-select":"export-select-3Qmi0l-LWR",exportSelect:"export-select-3Qmi0l-LWR","export-select-title":"export-select-title-2m3pc2CP7-",exportSelectTitle:"export-select-title-2m3pc2CP7-"}},j3Pi:function(e,t,a){e.exports=a.p+"c6c0dc1df136d610e8d05f3254f5bb65.svg"},jOzQ:function(e,t,a){"use strict";a("I5cv");var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("f3/d"),a("bWfx"),a("I78e");var i=n(a("lwsE")),r=n(a("W8MJ")),o=n(a("7W2i")),s=n(a("a1gu")),l=n(a("Nsbk")),c=a("mVeg"),u=n(a("cDcd")),d=n(a("17x9")),f=n(a("KJCM")),p=n(a("K2gz")),m=a("7FZc"),h=a("dtw8"),v=n(a("P5Jw")),g=n(a("KUqB"));function E(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,l.default)(e);if(t){var i=(0,l.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,s.default)(this,a)}}var b=function(e){(0,o.default)(a,e);var t=E(a);function a(e){var n;return(0,i.default)(this,a),(n=t.call(this,e)).getName=function(e){var t,a=n.props.projectPath;return u.default.createElement(m.TooltipTrigger,{title:e.name},u.default.createElement(h.Link,{to:"".concat(a,"/program/plan/work-items/").concat(e.code,"/detail"),className:(0,p.default)(f.default.code,f.default.number)},u.default.createElement(g.default,{type:null===e||void 0===e||null===(t=e.issueTypeDetail)||void 0===t?void 0:t.iconType}),u.default.createElement("span",null,"#",e.code)))},n.getLastName=function(e){var t,a=n.props.projectPath,i=n.state.tooltipTitle;return u.default.createElement(u.default.Fragment,null,u.default.createElement("span",{className:(0,p.default)(f.default.code,f.default.lastId,f.default.lastNumber)},u.default.createElement(h.Link,{to:"".concat(a,"/program/plan/work-items/").concat(e.code,"/detail"),className:(0,p.default)(f.default.code,f.default.number)},u.default.createElement(g.default,{type:null===e||void 0===e||null===(t=e.issueTypeDetail)||void 0===t?void 0:t.iconType}),u.default.createElement("span",null,"#",e.code)),u.default.createElement(m.TooltipTrigger,{title:i,onVisibleChange:n.onVisibleChange},u.default.createElement(v.default,{text:"".concat(window.location.origin).concat(a,"/program/plan/work-items/").concat(e.code,"/detail")},u.default.createElement("div",{className:f.default.copyIcon,onClick:n.onCopyClick})))),u.default.createElement("div",{className:(0,p.default)(f.default.code,f.default.lastId,f.default.lastNumber),style:{marginLeft:20,fontWeight:600}},"|",u.default.createElement("span",{style:{color:"red",margin:"0 5px"}},"GID"),"#",e.id,u.default.createElement(m.TooltipTrigger,{title:i,onVisibleChange:n.copyGID},u.default.createElement(v.default,{text:e.id},u.default.createElement("div",{className:f.default.copyIcon,onClick:n.onCopyClick})))))},n.copyGID=function(){n.setState({tooltipTitle:(0,c.t)("\u590d\u5236")})},n.onVisibleChange=function(){n.setState({tooltipTitle:(0,c.t)("\u590d\u5236\u94fe\u63a5")})},n.onCopyClick=function(){n.setState({tooltipTitle:(0,c.t)("\u5df2\u590d\u5236")})},n.state={tooltipTitle:(0,c.t)("\u590d\u5236\u94fe\u63a5")},n}return(0,r.default)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.nameList,n=t.showMoreCrumb,i=t.toggleDropdown,r=t.projectPath;return a.length<=3?u.default.createElement("div",{className:f.default.issuesCrumbs},a.map((function(t,n){return u.default.createElement(u.default.Fragment,{key:n},n!==a.length-1?e.getName(t):e.getLastName(t),n!==a.length-1&&u.default.createElement("span",{className:f.default.codeIdDivideLine},"/"))}))):u.default.createElement("div",{className:f.default.issuesCrumbs},this.getName(a[0]),u.default.createElement("span",{className:f.default.codeIdDivideLine},"/"),u.default.createElement("span",{className:(0,p.default)(f.default.moreButton,n?f.default.active:""),onClick:i},n&&u.default.createElement("ul",{className:f.default.detailMenu},a.slice(1,a.length-2).map((function(e,t){var a;return u.default.createElement("li",{key:t,onClick:function(){return window.location.href="".concat(window.location.origin).concat(r,"/program/plan/work-items/").concat(e.code,"/detail")},className:f.default.showItem},u.default.createElement("span",{title:e.name,className:f.default.toolDoc},u.default.createElement(g.default,{type:null===(a=e.issueTypeDetail)||void 0===a?void 0:a.iconType}),u.default.createElement("span",{className:f.default.over},u.default.createElement("span",{className:f.default.listCode},"#",e.code)," ",e.name)))})))),u.default.createElement("span",{className:f.default.codeIdDivideLine},"/"),this.getName(a[a.length-2]),u.default.createElement("span",{className:f.default.codeIdDivideLine},"/"),this.getLastName(a[a.length-1]))}}]),a}(u.default.Component);t.default=b,b.propTypes={issueType:d.default.string,nameList:d.default.array,showMoreCrumb:d.default.bool,toggleDropdown:d.default.func,getWikiLink:d.default.func,projectPath:d.default.string}},jP76:function(e,t,a){e.exports=a.p+"110b4206cf105626123e524a9d9aac5c.svg"},jQ3A:function(e,t,a){e.exports={"default-style":"default-style-2zsOHc_qYp",defaultStyle:"default-style-2zsOHc_qYp",disabled:"disabled-Fb3XOhXTmz","checked-style":"checked-style-3xiTcpjFDG",checkedStyle:"checked-style-3xiTcpjFDG","indeterminate-style":"indeterminate-style-2gJBm3EdOv",indeterminateStyle:"indeterminate-style-2gJBm3EdOv","hover-disable":"hover-disable-1hl4wVc-hW",hoverDisable:"hover-disable-1hl4wVc-hW"}},jaMa:function(e,t,a){"use strict";a.r(t),a.d(t,"formatDropdownItem",(function(){return m}));var n=a("cDcd"),i=a.n(n),r=a("qPyV"),o=a.n(r),s=a("V0lW"),l=a("BKNj"),c=a("HlXz"),u=a("xgZS"),d=function(){return(d=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},f=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(a[n[i]]=e[n[i]])}return a},p=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},m=function(e){return e.map((function(e){return d(d({},e),{id:e.id,value:e.id,text:e.name,name:e.name})}))};t.default=function(e){var t,a=e.isMultiple,r=e.show,h=e.projectID,v=e.triggerExtraProps,g=e.itemExtraProps,E=(e.Trigger,e.systemId),b=f(e,["isMultiple","show","projectID","triggerExtraProps","itemExtraProps","Trigger","systemId"]),y=p(Object(n.useState)(!1),2),S=y[0],I=y[1],T=p(Object(n.useState)(!1),2),C=T[0],P=T[1],w=p(Object(n.useState)([]),2),D=w[0],O=w[1],R=p(Object(n.useState)(1),2),j=R[0],k=R[1],N=p(Object(n.useState)(!0),2),A=N[0],L=N[1],F=p(Object(n.useState)(""),2),_=F[0],M=F[1],x=p(Object(n.useState)([]),2),B=x[0],U=x[1],W=p(Object(n.useState)(1),2),Y=W[0],H=W[1],V=p(Object(n.useState)(!0),2),G=V[0],K=V[1],z=p(Object(n.useState)(!1),2),q=z[0],Z=z[1],J=Object(n.useRef)(0),X=function(){A&&!C&&E&&(P(!0),Object(s.getSoftwareUnitList)(h,E,"",j).then((function(e){var t=e.data,a=t.list,n=t.totalPage,i=[];i=v&&v.initialSelectedItem&&Array.isArray(v.initialSelectedItem)?m(null===v||void 0===v?void 0:v.initialSelectedItem):[];var r=m(a);return O(o()(D.concat(r).concat(i),"id")),I(!0),j<n?k(j+1):L(!1)})).finally((function(){P(!1)})))},Q=function(e,t){if(void 0===t&&(t=!1),(t||G)&&E){var a=Date.now();J.current=a,P(!0),Object(s.getSoftwareUnitList)(h,E,e,Y).then((function(e){var n=e.data,i=n.list,r=n.totalPage,s=m(i),l=t?1:Y,c=t?[]:B;if(a===J.current){if(U(o()(c.concat(s),"id")),Y>=r)return K(!1);H(l+1),K(!0)}})).finally((function(){P(!1)}))}},$=function(){return _?Q(_):X()};return Object(n.useEffect)((function(){if(_)return Q(_,!0);U([]),H(1),K(!0)}),[_]),Object(n.useEffect)((function(){h&&E&&(O([]),I(!1),P(!1),O([]),k(1),L(!0),M(""),U([]),H(1),K(!0))}),[h]),Object(n.useEffect)((function(){Z(r)}),[]),Object(n.useEffect)((function(){$()}),[C,q,_]),i.a.createElement(l.default,d({},b,{isMultiple:a,placeholder:"\u8bf7\u9009\u62e9",items:_?B:D,dataInited:S,dataFetching:C,onReachBottom:function(e){e&&$()},isLocalSearch:!1,onSearch:function(e){M(e)},disableArrowUp:!0,showPanel:r,triggerExtraProps:{initialSelectedItem:(null===(t=null===v||void 0===v?void 0:v.initialSelectedItem)||void 0===t?void 0:t.length)>0?m(null===v||void 0===v?void 0:v.initialSelectedItem):[]},itemExtraProps:g,Trigger:c.a,disabledBottomSpace:b.disabledBottomSpace,onExpandChange:function(e){e?E?X():Object(u.warning)("\u8bf7\u5148\u9009\u62e9\u6240\u5c5e\u7cfb\u7edf"):(O([]),I(!1),P(!1),O([]),k(1),L(!0),M(""),U([]),H(1),K(!0))}}))}},jubm:function(e,t,a){e.exports={"table-wrapper":"table-wrapper-S7mVuCS4BB",tableWrapper:"table-wrapper-S7mVuCS4BB","workbench-table-wrapper":"workbench-table-wrapper--JEBDAyFXi",workbenchTableWrapper:"workbench-table-wrapper--JEBDAyFXi","header-cell":"header-cell-lgcwX1_9qL",headerCell:"header-cell-lgcwX1_9qL",cell:"cell-1a4TGVBqLN","sticky-box-shadow":"sticky-box-shadow-rq-MASCEia",stickyBoxShadow:"sticky-box-shadow-rq-MASCEia","sticky-box-background":"sticky-box-background-3VuOtrIXYJ",stickyBoxBackground:"sticky-box-background-3VuOtrIXYJ","resize-column":"resize-column-3Xu4ZJL8tm",resizeColumn:"resize-column-3Xu4ZJL8tm",loading:"loading-1iak65q889","issue-type-name":"issue-type-name-3ErXGNuUHS",issueTypeName:"issue-type-name-3ErXGNuUHS","no-padding":"no-padding-2OaoUIfjso",noPadding:"no-padding-2OaoUIfjso","anomaly-mark":"anomaly-mark-1Q9yNQNPh_",anomalyMark:"anomaly-mark-1Q9yNQNPh_","empty-search-container":"empty-search-container-IzcDI6PuBJ",emptySearchContainer:"empty-search-container-IzcDI6PuBJ","empty-title":"empty-title-2DgN1xMtiv",emptyTitle:"empty-title-2DgN1xMtiv","empty-tip":"empty-tip-37w3Ggt5Ut",emptyTip:"empty-tip-37w3Ggt5Ut","empty-table-container":"empty-table-container-2XslNyOPCC",emptyTableContainer:"empty-table-container-2XslNyOPCC"}},"k/a0":function(e,t,a){e.exports={"plan-date-trigger":"plan-date-trigger-2o2OI7GuiX",planDateTrigger:"plan-date-trigger-2o2OI7GuiX","item-date":"item-date-1Z2HT92XYs",itemDate:"item-date-1Z2HT92XYs",root:"root-2BryzMV_4N","is-over":"is-over-3cjdAokpnC",isOver:"is-over-3cjdAokpnC","is-today":"is-today-29YC8p5U5f",isToday:"is-today-29YC8p5U5f",isNearExpiration:"isNearExpiration-l_dVt5CEba",disabled:"disabled-2e6z159Lwi","cart-down":"cart-down-3YzWPyf6YR",cartDown:"cart-down-3YzWPyf6YR",expanded:"expanded-3eToEea2uP",content:"content-3HeoOP3a5Q","is-over-icon":"is-over-icon-2izMGZKjwI",isOverIcon:"is-over-icon-2izMGZKjwI"}},k65d:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.backlogSwitch=t.deleteAssignment=t.deleteBug=t.deleteRequirement=t.fetchCount=t.addBacklogIssues=t.sortBacklogIssues=t.fetchBacklogIssues=t.fetchEpics=void 0;var n=a("Z4vw");t.fetchEpics=function(e,t){return(0,n.get)("/api/project/".concat(e,"/issues/epics/backlog?").concat((0,n.buildParams)(t)))};t.fetchBacklogIssues=function(e,t,a){return(0,n.postJSON)("/external/collaboration/api/cms/issues/project/".concat(e,"/backlog-yfkj?").concat((0,n.buildParams)(t)),a)};t.sortBacklogIssues=function(e,t){return(0,n.postJSON)("/external/collaboration/api/project/".concat(e,"/issues/backlogs/across"),t)};t.addBacklogIssues=function(e,t){return(0,n.postJSON)("/api/project/".concat(e,"/issues/backlogs"),t)};t.fetchCount=function(e,t,a){return(0,n.postJSON)("/external/collaboration/api/project/".concat(e,"/iterations/backlog?").concat((0,n.buildParams)(t)),a)};t.deleteRequirement=function(e,t){return(0,n.del)("/external/collaboration/api/project/".concat(e,"/issues/requirements/").concat(t))};t.deleteBug=function(e,t){return(0,n.del)("/external/collaboration/api/project/".concat(e,"/issues/defects/").concat(t))};t.deleteAssignment=function(e,t){return(0,n.del)("/external/collaboration/api/project/".concat(e,"/issues/missions/").concat(t))};t.backlogSwitch=function(e,t){return(0,n.patchJSON)("/api/project/".concat(e,"/agile/module"),t)}},kGa7:function(e,t,a){e.exports={wrapper:"wrapper-37NHIb8qCv","input-before":"input-before-25sTPXe6kW",inputBefore:"input-before-25sTPXe6kW","dropdown-wrapper":"dropdown-wrapper-20y0R0iWfC",dropdownWrapper:"dropdown-wrapper-20y0R0iWfC","input-after":"input-after-uC4tGWGx6c",inputAfter:"input-after-uC4tGWGx6c","input-clear":"input-clear-1bKe9nG_L_",inputClear:"input-clear-1bKe9nG_L_","input-cancel":"input-cancel-yWT_2tDWLf",inputCancel:"input-cancel-yWT_2tDWLf",panel:"panel-1vgXgVjS_q","panel-container":"panel-container-bmJm3wcOfO",panelContainer:"panel-container-bmJm3wcOfO",item:"item-2Qmuojy2hW","item-empty":"item-empty-35D5LUqlyt",itemEmpty:"item-empty-35D5LUqlyt","item-icon":"item-icon-3VJdExz9yu",itemIcon:"item-icon-3VJdExz9yu","item-code":"item-code-UUXgUPQnP1",itemCode:"item-code-UUXgUPQnP1","item-name":"item-name-lkoOz2w6O5",itemName:"item-name-lkoOz2w6O5"}},"ka/S":function(e,t,a){e.exports={wrapper:"wrapper-1er7Hghbi7",create:"create-175h5Bhcej",prefix:"prefix-1BSBZ_Djxd","sub-item":"sub-item-2Kc0s4ew_h",subItem:"sub-item-2Kc0s4ew_h",divider:"divider-1D7_uoW0pO",operate:"operate-izxPm7i6qH","operate-left":"operate-left-m6NnOKe9Ya",operateLeft:"operate-left-m6NnOKe9Ya","operate-cancel":"operate-cancel-zE0dlijQz8",operateCancel:"operate-cancel-zE0dlijQz8",trigger:"trigger-1B4vFdJxfC","trigger-button":"trigger-button-4a7lSMQdD_",triggerButton:"trigger-button-4a7lSMQdD_","trigger-active":"trigger-active-2qRKRkGYxQ",triggerActive:"trigger-active-2qRKRkGYxQ","trigger-icon":"trigger-icon-12lwMsVJ4T",triggerIcon:"trigger-icon-12lwMsVJ4T",popup:"popup-VQDGi0h8pU","popup-item":"popup-item-2CZ7tInkDM",popupItem:"popup-item-2CZ7tInkDM","popup-text":"popup-text-1-a1cxV8jI",popupText:"popup-text-1-a1cxV8jI","operate-item":"operate-item-jHpoxADXlJ",operateItem:"operate-item-jHpoxADXlJ","operate-icon":"operate-icon-2d56rVs6hX",operateIcon:"operate-icon-2d56rVs6hX","operate-icon-enter":"operate-icon-enter-12vl-F9kqf",operateIconEnter:"operate-icon-enter-12vl-F9kqf","operate-icon-shift":"operate-icon-shift-rIoOj5NVAM",operateIconShift:"operate-icon-shift-rIoOj5NVAM","operate-icon-esc":"operate-icon-esc-3C55WsiNaj",operateIconEsc:"operate-icon-esc-3C55WsiNaj","operate-tip":"operate-tip-2_dMrmkuL7",operateTip:"operate-tip-2_dMrmkuL7"}},kwSY:function(e,t,a){"use strict";a("I5cv"),a("EK0E"),a("XfO3"),a("Btvt"),a("yt8O"),a("rGqo"),a("mYba");var n=a("TqRt"),i=a("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(a("lwsE")),o=n(a("W8MJ")),s=n(a("7W2i")),l=n(a("a1gu")),c=n(a("Nsbk")),u=a("mVeg"),d=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!==typeof e)return{default:e};var a=T(t);if(a&&a.has(e))return a.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=r?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}n.default=e,a&&a.set(e,n);return n}(a("cDcd")),f=n(a("17x9")),p=n(a("gqWk")),m=a("7FZc"),h=n(a("Qkhu")),v=n(a("K2gz")),g=n(a("P5Jw")),E=a("xgZS"),b=n(a("T8xO")),y=a("JTQj"),S=a("uelK"),I=a("dBa0");function T(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(T=function(e){return e?a:t})(e)}function C(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,l.default)(this,a)}}var P=function(e){(0,s.default)(a,e);var t=C(a);function a(){var e;(0,r.default)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).state={expanded:!1,showModal:!1},e.openConfirmModal=function(){e.setState({showModal:!0})},e.handleChangeParent=function(){var t=e.props.onChangeParent;"function"===typeof t&&t()},e.toggleExpand=function(t){var a=e.state.expanded,n=e.props.onClickTrigger;t.stopPropagation(),n&&n(),a?e.closePanel():e.openPanel()},e.openPanel=function(){e.setState({expanded:!0}),document.addEventListener("click",e.closePanel)},e.closePanel=function(){e.setState({expanded:!1}),document.removeEventListener("click",e.closePanel)},e}return(0,o.default)(a,[{key:"componentDidMount",value:function(){this.getSlotInfo()}},{key:"getSlotInfo",value:function(){var e=this;(0,S.getSlotConfiguration)({slot:I.SLOTS.COLLABORATION_DETAIL_DROPDOWN_MENU_ONE,type:"CURRENT"}).then((function(t){var a=t.data;e.setState({slotConfiguration:a||{}})}))}},{key:"componentDidUpdate",value:function(e){this.props.controlHideMore&&e.controlHideMore!==this.props.controlHideMore&&this.closePanel()}},{key:"render",value:function(){var e,t=this,a=this.state,n=a.expanded,i=a.showModal,r=a.slotConfiguration,o=this.props,s=o.allowUpdate,l=o.allowDelete,c=o.onDelete,f=o.isSensitiveAdmin,E=o.isSensitive,S=o.operateSensitive,T=o.showSensitive,C=o.premiumVersion,P=o.viewDescriptionVersion,w=o.copyLink,D=o.copyTitle,O=o.onIsFullWidthChange,R=o.isFullWidth,j=o.isShowFullWidthOption,k=o.slotCallback;return d.default.createElement("div",{className:"".concat(p.default.root," ").concat(n?p.default.expandedStyle:"")},d.default.createElement(m.TooltipTrigger,{title:(0,u.t)("\u66f4\u591a")},d.default.createElement("div",{className:p.default.trigger,onClick:this.toggleExpand})),d.default.createElement(h.default,{show:i,text:(0,u.t)("\u786e\u5b9a\u8981\u5220\u9664\u5417\uff1f"),type:"SUB_TASK",onConfirm:c,onClose:function(){t.setState({showModal:!1})}}),n&&d.default.createElement("ul",{className:p.default.dropdown},d.default.createElement(g.default,{text:w},d.default.createElement("li",{className:p.default.item,onClick:this.onCopy},(0,u.t)("\u590d\u5236\u94fe\u63a5"))),d.default.createElement("li",{className:p.default.divideLine}),d.default.createElement(g.default,{text:"".concat(D,"\r\n").concat(w)},d.default.createElement("li",{className:p.default.item,onClick:this.onCopy},(0,u.t)("\u590d\u5236\u6807\u9898\u548c\u94fe\u63a5"))),s&&d.default.createElement("li",{className:p.default.divideLine}),s&&d.default.createElement("li",{className:(0,v.default)(p.default.isVertical,p.default.item),onClick:this.handleChangeParent},(0,u.t)("\u66f4\u6539\u7236\u4e8b\u9879")),d.default.createElement("li",{className:p.default.divideLine}),d.default.createElement("li",{className:p.default.item,onClick:P},(0,u.t)("\u5386\u53f2\u7248\u672c")),j&&d.default.createElement(d.default.Fragment,null,d.default.createElement("li",{className:(0,v.default)(p.default.divideLine,p.default.minWidthHide)}),d.default.createElement("li",{className:(0,v.default)(p.default.item,p.default.minWidthHide),onClick:function(e){e.stopPropagation()},ref:this.fullScreenRef},(0,u.t)("\u5168\u5bbd\u663e\u793a"),d.default.createElement(m.TooltipTrigger,{title:(0,u.t)("\u63cf\u8ff0\u533a\u57df\u4e0d\u9650\u5236\u6700\u5927\u5bbd\u5ea6\u663e\u793a")},d.default.createElement("span",{className:(0,v.default)(p.default.helpIcon,p.default.fullScreenHelpIcon)})),d.default.createElement(b.default,{checked:R,onChange:function(e){O&&O(e),t.closePanel()}}))),C&&T&&f&&d.default.createElement("li",{className:p.default.divideLine}),C&&T&&f&&E&&d.default.createElement("li",{className:p.default.item,onClick:S},(0,u.t)("\u53d6\u6d88\u6807\u8bb0\u654f\u611f\u5185\u5bb9")),C&&T&&f&&!E&&d.default.createElement("li",{className:(0,v.default)(p.default.item,p.default.addSensitive),onClick:S},(0,u.t)("\u6807\u8bb0\u4e3a\u654f\u611f\u5185\u5bb9"),d.default.createElement(m.TooltipTrigger,{placement:"top",title:(0,u.t)("\u67e5\u770b\u5e2e\u52a9\u6587\u6863")},d.default.createElement("div",{onClick:function(e){e.stopPropagation(),window.open((0,y.getHelp)("/docs/pro/access-audit.html"),"_blank")},className:p.default.helpIcon}))),(null===r||void 0===r||null===(e=r.slot)||void 0===e?void 0:e.identity)&&d.default.createElement(d.default.Fragment,null,d.default.createElement("li",{className:p.default.divideLine}),d.default.createElement("li",{className:p.default.item,onClick:function(){k(I.SLOTS.COLLABORATION_DETAIL_DROPDOWN_MENU_ONE)}},null===r||void 0===r?void 0:r.triggerText)),s&&d.default.createElement("li",{className:p.default.divideLine}),l&&d.default.createElement("li",{className:p.default.deleteStyle,onClick:this.openConfirmModal},(0,u.t)("\u5220\u9664"))))}},{key:"onCopy",value:function(e){e.stopPropagation(),(0,E.success)((0,u.t)("\u5df2\u590d\u5236"))}}]),a}(d.Component);P.propTypes={onChangeParent:f.default.func,onDelete:f.default.func,allowDelete:f.default.bool,allowUpdate:f.default.bool,onIsFullWidthChange:f.default.func,isFullWidth:f.default.bool,isShowFullWidthOption:f.default.bool,isSensitiveAdmin:f.default.bool,isSensitive:f.default.bool,operateSensitive:f.default.func,showSensitive:f.default.bool,premiumVersion:f.default.bool,viewDescriptionVersion:f.default.func,copyLink:f.default.string,copyTitle:f.default.string,onClickTrigger:f.default.func,controlHideMore:f.default.number,slotCallback:f.default.func};var w=P;t.default=w},lAyh:function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),a.d(t,"c",(function(){return u})),a.d(t,"d",(function(){return p})),a.d(t,"b",(function(){return v}));var n=a("cDcd"),i=a.n(n),r=a("l8Oe"),o=a("DDKl"),s=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},l=Object(n.memo)((function(e){var t=e.type,a=e.data,i=e.canDrag,l=e.children,c=e.onBegin,u=e.onEnd,d=s(Object(r.useDrag)({item:{type:t,data:a},collect:function(e){return{isDragging:e.isDragging()}},begin:function(e){c&&c(e)},end:function(e,t){u&&u(e,t)},canDrag:function(){return i}}),3),f=d[0],p=d[1],m=d[2];return Object(n.useEffect)((function(){m(Object(o.getEmptyImage)(),{captureDraggingState:!0})}),[]),l(f,p)})),c=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},u=Object(n.memo)((function(e){var t=e.type,a=e.children,n=e.onHover,i=e.onDrop,o=e.canDrop,s=c(Object(r.useDrop)({accept:t,hover:function(e,t){n&&n(e,t)},drop:function(e,t){t.didDrop()||i&&i(e,t)},collect:function(e){return{isOver:e.isOver({shallow:!0})}},canDrop:function(){return o}}),2);return a(s[0],s[1])})),d=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},f=(Object(n.memo)((function(e){var t=e.type,a=e.data,s=e.children,l=e.nativePreview,c=e.disabled,u=e.className,f=e.style,p=e.onBegin,m=e.onEnd,h=d(Object(r.useDrag)({item:{type:t,data:a},collect:function(e){return{isDragging:e.isDragging()}},begin:function(e){p&&p(e)},end:function(e,t){m&&m(e,t)},canDrag:function(){return"function"===typeof c?!c():!c}}),3),v=h[0],g=h[1],E=h[2];return Object(n.useEffect)((function(){l||E(Object(o.getEmptyImage)(),{captureDraggingState:!0})}),[]),i.a.createElement("div",{ref:g,className:u&&u(v.isDragging),style:f&&f(v.isDragging)},s)})),function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o}),p=Object(n.memo)((function(e){var t=e.type,a=e.children,o=e.disabled,s=e.className,l=e.style,c=e.onHover,u=e.onDrop,d=Object(n.useRef)(null),p=f(Object(r.useDrop)({accept:t,hover:function(e,t){c&&c(e,t,d)},drop:function(e,t){t.didDrop()||u&&u(e,t)},collect:function(e){return{isOver:e.isOver({shallow:!0})}},canDrop:function(){return"function"===typeof o?!o():!o}}),2),m=p[0],h=p[1];return i.a.createElement("div",{ref:h(d),className:s&&s(m.isOver),style:l&&l(m.isOver)},a)})),m={position:"fixed",pointerEvents:"none",zIndex:100,left:0,top:0,width:"100%",height:"100%"};function h(e,t,a,n,i){if(void 0===a&&(a=0),void 0===n&&(n=0),void 0===i&&(i=!1),!e||!t)return{display:"none"};var r=t.x,o=t.y,s="translate(".concat(r-a,"px, ").concat(i?e.y-n:o-n,"px)");return{transform:s,WebkitTransform:s}}var v=Object(n.memo)((function(e){var t=e.type,a=e.children,n=e.isSort,o=e.offsetX,s=e.offsetY,l=e.horizontal,c=Object(r.useDragLayer)((function(e){return{item:e.getItem(),itemType:e.getItemType(),initialOffset:e.getInitialSourceClientOffset(),currentOffset:n?e.getSourceClientOffset():e.getClientOffset(),isDragging:e.isDragging()}})),u=c.itemType,d=c.isDragging,f=c.item,p=c.initialOffset,v=c.currentOffset;return d?i.a.createElement("div",{style:m},i.a.createElement("div",{style:h(p,v,o,s,l)},u===t?a(f):null)):null}))},lEUG:function(e,t,a){e.exports=a.p+"ad9c9de6b4f48fb4a49d9acbab0b4fae.svg"},"mO/f":function(e,t,a){"use strict";a.r(t),a.d(t,"ProgramProjectListCtx",(function(){return c}));var n=a("cDcd"),i=a.n(n),r=a("DbF1"),o=a("qPyV"),s=a.n(o),l=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},c=i.a.createContext({});t.default=function(e){var t=e.children,a=e.programID,o=l(Object(n.useState)([]),2),u=o[0],d=o[1],f=l(Object(n.useState)([]),2),p=f[0],m=f[1];return Object(n.useEffect)((function(){Object(r.d)(a).then((function(e){var t=e.data,a=t.filter((function(e){return!e.archived})).map((function(e){return{id:e.id,value:e.id,display_name:e.display_name,name:e.name,icon:e.icon,description:e.description,pinyin:e.name_pinyin}}));d(s()(u.concat(a),"id")),m(s()(p.concat(a),"id"))}))}),[]),i.a.createElement(c.Provider,{value:{results:p,onSearch:function(e){var t=u.filter((function(t){return t.name.toLocaleLowerCase().includes(e.toLocaleLowerCase())}));m(t)}}},t)}},mO28:function(e,t,a){e.exports={select:"select-62XCIAfb7x","select-arrow-wrapper":"select-arrow-wrapper-1Vc5WXm8Ck",selectArrowWrapper:"select-arrow-wrapper-1Vc5WXm8Ck","menu-top":"menu-top-39F9u2VIzP",menuTop:"menu-top-39F9u2VIzP","select-with-label":"select-with-label-11nfqvtaEw",selectWithLabel:"select-with-label-11nfqvtaEw","select-trigger":"select-trigger-1fPT6apPyZ",selectTrigger:"select-trigger-1fPT6apPyZ","has-border":"has-border-33z7CReu-B",hasBorder:"has-border-33z7CReu-B","is-block":"is-block-3H5bFOZZrG",isBlock:"is-block-3H5bFOZZrG","item-text":"item-text-1JUh5Xz3SJ",itemText:"item-text-1JUh5Xz3SJ","not-selected":"not-selected-3o8TFN4lKM",notSelected:"not-selected-3o8TFN4lKM","is-expanded":"is-expanded-1p13BEq3vl",isExpanded:"is-expanded-1p13BEq3vl","inline-dropdown":"inline-dropdown-3Rtvqsrdy2",inlineDropdown:"inline-dropdown-3Rtvqsrdy2","item-label":"item-label-6lTfrllFP1",itemLabel:"item-label-6lTfrllFP1","item-text-ellipsis":"item-text-ellipsis-2I-BpMkW_U",itemTextEllipsis:"item-text-ellipsis-2I-BpMkW_U","clear-button":"clear-button-2O7m8h1Lxu",clearButton:"clear-button-2O7m8h1Lxu","to-top":"to-top-kRkKQuL4_C",toTop:"to-top-kRkKQuL4_C","to-right":"to-right-2uV0py0shP",toRight:"to-right-2uV0py0shP","trigger-background":"trigger-background-2lN1wLUllj",triggerBackground:"trigger-background-2lN1wLUllj","clear-divider":"clear-divider-3A395Em6qO",clearDivider:"clear-divider-3A395Em6qO",show:"show-2F7vDf0bgI",clear:"clear-sg2ez9Q7iu","is-inline":"is-inline-j9LD8oo-8Y",isInline:"is-inline-j9LD8oo-8Y",name:"name-1KaKv-sGvx",arrow:"arrow-3sODzF4fF8","status-wrapper":"status-wrapper-1dlb48tWYB",statusWrapper:"status-wrapper-1dlb48tWYB","step-status":"step-status-1W2TbjjdEK",stepStatus:"step-status-1W2TbjjdEK","empty-step":"empty-step-rPg9Fauzsp",emptyStep:"empty-step-rPg9Fauzsp","loading-panel":"loading-panel-15HvJGDGQR",loadingPanel:"loading-panel-15HvJGDGQR","loading-item":"loading-item-3IEHLv6P3M",loadingItem:"loading-item-3IEHLv6P3M","empty-icon":"empty-icon-1uGjEHgqek",emptyIcon:"empty-icon-1uGjEHgqek","cart-down":"cart-down-3W9vjgPWWM",cartDown:"cart-down-3W9vjgPWWM","dark-hover":"dark-hover-1qZFcSkN1J",darkHover:"dark-hover-1qZFcSkN1J","dark-style":"dark-style-3tymAZmOSL",darkStyle:"dark-style-3tymAZmOSL","select-trigger-status":"select-trigger-status-_ReecQ8u-T",selectTriggerStatus:"select-trigger-status-_ReecQ8u-T","select-trigger-disabled":"select-trigger-disabled-tia5Td8j7G",selectTriggerDisabled:"select-trigger-disabled-tia5Td8j7G","custom-select-trigger":"custom-select-trigger-1IVNyU-Pmv",customSelectTrigger:"custom-select-trigger-1IVNyU-Pmv","select-trigger-disable":"select-trigger-disable-2XSuD5V7q6",selectTriggerDisable:"select-trigger-disable-2XSuD5V7q6",expanded:"expanded-1HkdpOIcwc","control-arrow":"control-arrow-2OA-OeYNuy",controlArrow:"control-arrow-2OA-OeYNuy"}},mSbZ:function(e,t,a){"use strict";a.r(t);var n=a("cDcd"),i=a.n(n),r=a("mwIZ"),o=a.n(r),s=a("O9Lt"),l=a.n(s),c=a("es6E"),u=a("LgIu"),d=a("mVeg"),f=a("ehTL"),p=function(e){return e?Object(f.post)("/api/platform/project/".concat(e,"/join")).then((function(e){return 0===(null===e||void 0===e?void 0:e.code)})).catch((function(){return!1})):Promise.resolve(!1)},m=a("zoVt"),h=a.n(m),v=a("2jHd"),g=a.n(v),E=function(e,t,a,n){return new(a||(a=Promise))((function(i,r){function o(e){try{l(n.next(e))}catch(t){r(t)}}function s(e){try{l(n.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,s)}l((n=n.apply(e,t||[])).next())}))},b=function(e,t){var a,n,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(l){return function(s){if(a)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(a=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(l){s=[6,l],n=0}finally{a=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},y=Object(n.memo)((function(e){var t=e.projectName;return i.a.createElement("div",{className:h.a.wrapper},i.a.createElement("div",{className:h.a.content},i.a.createElement("img",{src:g.a,alt:"unauthorized"}),i.a.createElement("div",{className:h.a.title},Object(d.t)("\u7531\u4e8e\u60a8\u4e0d\u662f\u8be5\u7814\u53d1\u7a7a\u95f4\u6210\u5458\uff0c\u6682\u65f6\u65e0\u6cd5\u8bbf\u95ee"),i.a.createElement("br",null),i.a.createElement("p",null,Object(d.t)("\u70b9\u51fb")," ",i.a.createElement("a",{onClick:function(){return E(void 0,void 0,void 0,(function(){return b(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,p(t)];case 1:return e.sent()&&window.location.reload(),[3,3];case 2:return e.sent(),[3,3];case 3:return[2]}}))}))}},Object(d.t)("\u7acb\u5373\u52a0\u5165"))," ",Object(d.t)("\u540e\u5373\u53ef\u8bbf\u95ee")))))})),S=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(t,a)};return function(t,a){if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),I=function(){return(I=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},T=function(e,t,a,n){var i,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,a,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(r<3?i(o):r>3?i(t,a,o):i(t,a))||o);return r>3&&o&&Object.defineProperty(t,a,o),o};t.default=function(e){return function(t){function a(e){var a=t.call(this,e)||this;return a.state={permissionDenied:!1},a.getCurrentProject=function(){var e=a.getProjectName(a.props.targetData);Object(u.h)(e).then((function(t){var n=+o()(t,"data.pmType",0),i=I(I({},t.data),{isProgram:1===n});a.projectsStore.updateProject(e,i)})).catch((function(e){var t=e.code;1400===Number(t)&&a.setState({permissionDenied:!0})}))},a.getEnterpriseKey=function(){return location.hostname.split(".")[0]},a.getProjectName=function(e){var t=location.pathname.match(/\/p\/([^/]+)/);return t?t[1]:null===e||void 0===e?void 0:e.projectName},a.getCurrentProjectData=function(){var e=a.getProjectName(a.props.targetData);return e?c.StoreMobxApi.toJS(a.projectsStore.projectData[e]):null},a.projectsStore=Object(c.getStore)(c.StoreName.PROJECTS),a}return S(a,t),a.prototype.render=function(){var t,a,n,r,o,s,c,u,d;if(this.props.fromDM){f=null===(n=null===(a=this.props)||void 0===a?void 0:a.dmData)||void 0===n?void 0:n.targetProject,p=null===(s=null===(o=null===(r=this.props)||void 0===r?void 0:r.dmData)||void 0===o?void 0:o.targetProject)||void 0===s?void 0:s.id,h=null===(d=null===(u=null===(c=this.props)||void 0===c?void 0:c.dmData)||void 0===u?void 0:u.targetProject)||void 0===d?void 0:d.name,m=this.state.permissionDenied;return p?i.a.createElement(e,I({},this.props,{projectID:p,projectPath:f.project_path,currentProject:f})):m?i.a.createElement(y,{projectName:h}):i.a.createElement(l.a,{show:!0})}var f=this.getCurrentProjectData(),p=(null===(t=this.props.targetData)||void 0===t?void 0:t.projectID)||(null===f||void 0===f?void 0:f.id),m=this.state.permissionDenied,h=this.getProjectName(this.props.targetData);return p?i.a.createElement(e,I({},this.props,{projectID:p,projectPath:f.project_path,currentProject:f})):m?i.a.createElement(y,{projectName:h}):i.a.createElement(l.a,{show:!0})},a.prototype.componentDidMount=function(){this.getCurrentProjectData()||this.getCurrentProject()},a=T([c.StoreMobxReactApi.observer],a)}(i.a.Component)}},mecZ:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a("cDcd"),i=a.n(n),r=a("3ZF0"),o=a.n(r),s=a("K2gz"),l=a.n(s),c=Object(n.memo)((function(e){var t=e.assignee,a=e.className,n=e.style;return t?i.a.createElement("img",{className:l()(o.a.avatar,a),src:t.avatar,style:n}):i.a.createElement("div",{className:l()(o.a.avatar,o.a.defaultAvatar,a),style:n})}))},mpRw:function(e,t,a){e.exports={root:"root-2CG86wexKh","input-wrapper":"input-wrapper-27zsL_4MOS",inputWrapper:"input-wrapper-27zsL_4MOS","is-creation":"is-creation-1XxwLwOdTW",isCreation:"is-creation-1XxwLwOdTW","is-editing":"is-editing-2TJZOY0oSk",isEditing:"is-editing-2TJZOY0oSk","is-error":"is-error-1Zxc8kFmNR",isError:"is-error-1Zxc8kFmNR","operation-wrapper":"operation-wrapper-G0a2zjBFF6",operationWrapper:"operation-wrapper-G0a2zjBFF6",disabled:"disabled-6289FsGZrU","disabled-placeholder":"disabled-placeholder-15V4Nb9rCa",disabledPlaceholder:"disabled-placeholder-15V4Nb9rCa"}},n09Y:function(e,t,a){"use strict";a("I5cv");var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("L9s1"),a("Z2Ku"),a("pIFo");var i=n(a("lSNA")),r=n(a("lwsE")),o=n(a("W8MJ")),s=n(a("PJYZ")),l=n(a("7W2i")),c=n(a("a1gu")),u=n(a("Nsbk")),d=a("mVeg"),f=n(a("cDcd")),p=n(a("17x9")),m=n(a("K2gz")),h=n(a("/Ev0")),v=n(a("0gM1")),g=n(a("yZ+p")),E=n(a("zmh9")),b=n(a("O9Lt"));function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,u.default)(e);if(t){var i=(0,u.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,c.default)(this,a)}}var S=function(e){(0,l.default)(a,e);var t=y(a);function a(e){var n;return(0,r.default)(this,a),(n=t.call(this,e)).state={curPerPage:e.pageSize,goPage:void 0,isExpanded:!1},n.togglePanel=n.togglePanel.bind((0,s.default)(n)),n.showPanel=n.showPanel.bind((0,s.default)(n)),n.hidePanel=n.hidePanel.bind((0,s.default)(n)),n.changePage=n.changePage.bind((0,s.default)(n)),n.goPage=n.goPage.bind((0,s.default)(n)),n}return(0,o.default)(a,[{key:"render",value:function(){var e=this.props,t=e.currentPage,a=e.totalPage,n=this.state.isExpanded;return f.default.createElement("div",{className:v.default.pageWrapper},f.default.createElement("div",{className:v.default.pageTrigger,onClick:this.togglePanel},f.default.createElement("span",{className:v.default.nums},t,"/",a),(0,d.t)("\u9875"),f.default.createElement("div",{className:(0,m.default)(v.default.cartDown,(0,i.default)({},v.default.isExpanded,n))})),n&&this.renderPanel())}},{key:"renderPanel",value:function(){var e=this.props,t=e.changePageCallback,a=e.isLoading,n=this.state.curPerPage;return f.default.createElement("div",{className:v.default.pagePanel},f.default.createElement("div",{className:v.default.header},(0,d.t)("\u6bcf\u9875\u663e\u793a"),f.default.createElement(h.default,{className:v.default.pageSizeWrapper,currentPageSize:n,callback:function(e){return t({pageSize:e})},isLoading:a})),this.renderBody(),this.renderFooter())}},{key:"renderBody",value:function(){var e=this.props,t=e.totalPage,a=e.currentPage,n=e.changePageCallback;if(e.isLoading)return f.default.createElement(b.default,{show:!0,className:v.default.loadingWrapper});for(var r=[],o=function(e){r.push(f.default.createElement("div",{className:(0,m.default)(v.default.page,(0,i.default)({},v.default.isActive,a===e)),key:"page".concat(e),onClick:function(){return n({page:e})}},e))},s=1;s<=t;s++)o(s);return f.default.createElement("div",{className:v.default.body},r)}},{key:"renderFooter",value:function(){var e=this.state.goPage;return f.default.createElement("div",{className:v.default.footer},f.default.createElement("span",null,(0,d.t)("\u524d\u5f80\u9875")),f.default.createElement("div",{className:v.default.inputPage},f.default.createElement(g.default,{autoFocus:!0,value:e,onChange:this.changePage,onPressEnter:this.goPage})),f.default.createElement(E.default,{className:v.default.btnGo,disabled:!e,onClick:this.goPage},f.default.createElement("div",{className:v.default.icon})))}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.hidePanel,!1)}},{key:"togglePanel",value:function(){var e=this.state.isExpanded;document.removeEventListener("click",this.hidePanel,!1),e?this.hidePanel():this.showPanel()}},{key:"showPanel",value:function(){this.setState({isExpanded:!0}),document.addEventListener("click",this.hidePanel,!1)}},{key:"hidePanel",value:function(e){e&&e.target&&(e.target.className.includes("tab")&&e.target.parentNode.className.includes("page-tab")||"INPUT"===e.target.tagName)||this.setState({isExpanded:!1,goPage:void 0})}},{key:"changePage",value:function(e){var t=e.target.value.replace(/[^\d]/g,"");this.setState({goPage:t})}},{key:"goPage",value:function(){var e=this.props,t=e.changePageCallback,a=e.totalPage,n=this.state.goPage;if(n){var i=parseInt(n,10);i>a&&(i=a),t({page:i}),this.togglePanel()}}}],[{key:"getDerivedStateFromProps",value:function(e){return{curPerPage:e.pageSize}}}]),a}(f.default.Component);S.propTypes={totalPage:p.default.number,currentPage:p.default.number,pageSize:p.default.number,changePageCallback:p.default.func,isLoading:p.default.bool};var I=S;t.default=I},n6b2:function(e,t,a){"use strict";a.r(t),a.d(t,"withCompressInterfaceContainer",(function(){return u})),a.d(t,"updateCompressInterfaceContainer",(function(){return d}));var n=a("cDcd"),i=a.n(n),r=a("Z4vw"),o=a("Mh+3"),s=function(){return(s=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},l=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},c=i.a.createContext({data:{},data3:{},data4:{},getAgileApi:function(){}}),u=function(e){return function(t){return i.a.createElement(c.Consumer,null,(function(a){return i.a.createElement(e,s({},s({zipRes:s({},a.data||{}),zipRes3:s({},a.data3||{}),zipRes4:s({},a.data4||{}),getAgileApi:a.getAgileApi},t)))}))}},d=function(e){return function(t){var a=l(Object(n.useState)({}),2),u=a[0],d=a[1],f=l(Object(n.useState)({}),2),p=f[0],m=f[1],h=l(Object(n.useState)({}),2),v=h[0],g=h[1],E=function(e,a){var n=t.targetData,i=e||n,s=i.projectId,l=i.code,c=i.projectName,u={global:{projectId:s},z2YBFz:{issueCode:l,withDescriptionMarkup:!0},Nz2Efa:{},u6RZNf:{issueCode:l},y2Y73u:{projectName:c},JzuUji:{projectName:c},j6jyqi:{projectName:c},FJzYNb:{code:l},Aj2i6b:{issueCode:l},YnIfQv:{status:["WAIT_PROCESS","PROCESSING"]},YV7Zre:{code:l},"7FzyUv":{issueCode:l},qa2qm2:{code:l},QZvYBn:{issueCode:l},ji6nQn:{issueCode:l,blockType:"ALL"},Evqai2:{issueCode:l,type:a},ZviUZb:{},EJv67r:{projectName:c},ueAfM3:{projectName:c},BRBr2q:{},F3IRnq:{},zm6r22:{deptName:""}};return new Promise((function(t,a){(function(e,t){return void 0===t&&(t=!0),Object(r.postJSON)("/external/collaboration/agile/api/compress/zip",e,t)})(u).then((function(a){var n;d(a),Object.keys(a.data).forEach((function(e){o.noAlertApi.includes(e)||Object(o.alertError)(a.data[e])})),Promise.all([b(null===(n=a.data[o.default.getDetailInfo])||void 0===n?void 0:n.data,e),y(e)]).then((function(e){var n={zipRes:a,zipRes3:e[0],zipRes4:e[1]};t(n)}))})).catch((function(e){d(e),a()}))}))},b=function(e,a){var n=t.targetData;return function(e,t){return void 0===t&&(t=!0),Object(r.postJSON)("/external/collaboration/api/platform/project/compress/zip",e,t)}({global:{projectId:(a||n).projectId},YzYvAz:{}}).then((function(e){return m(e),Object.keys(e.data).forEach((function(t){o.noAlertApi.includes(t)||Object(o.alertError)(e.data[t])})),e})).catch((function(e){m(e)}))},y=function(e){var a=t.targetData,n=(e||a).projectId;return function(e,t){return void 0===t&&(t=!0),Object(r.postJSON)("/external/collaboration/api/user/project/compress/zip",e,t)}({global:{projectId:n},VvYfYn:{projectId:n,systemsName:""}}).then((function(e){return g(e),Object.keys(e.data).forEach((function(t){o.noAlertApi.includes(t)||Object(o.alertError)(e.data[t])})),e})).catch((function(e){g(e)}))};return i.a.createElement(c.Provider,{value:{data:u,data3:p,data4:v,getAgileApi:E}},i.a.createElement(e,s({},s(s({},t),{getAgileApi:E}))))}};t.default=c},"nH/Q":function(e,t,a){e.exports={"label-item-icon":"label-item-icon-2M2ZImjjk7",labelItemIcon:"label-item-icon-2M2ZImjjk7",default:"default-30lbtSTpO4","custom-label-name":"custom-label-name-1eqv51JH8Z",customLabelName:"custom-label-name-1eqv51JH8Z"}},nQHV:function(e,t,a){e.exports=a.p+"2f03f262fd03f29b1b19eb70c06582fe.svg"},nbZB:function(e,t,a){e.exports={item:"item-WclyyWrmXe","last-child":"last-child-1Ki9WxGP_v",lastChild:"last-child-1Ki9WxGP_v","item-level1":"item-level1-1kIC5ctkrU",itemLevel1:"item-level1-1kIC5ctkrU","item-arrow":"item-arrow-2lQcC6g-Gr",itemArrow:"item-arrow-2lQcC6g-Gr","item-level2":"item-level2-3mUsI1QTiZ",itemLevel2:"item-level2-3mUsI1QTiZ","item-level3":"item-level3-2JUPcVfX3z",itemLevel3:"item-level3-2JUPcVfX3z","item-level4":"item-level4-3_rwxWfW0Y",itemLevel4:"item-level4-3_rwxWfW0Y","item-level5":"item-level5-3pLKWrdecG",itemLevel5:"item-level5-3pLKWrdecG","item-level6":"item-level6-31FaYKvNPH",itemLevel6:"item-level6-31FaYKvNPH","item-arrow-right":"item-arrow-right-1f9pqmX0yz",itemArrowRight:"item-arrow-right-1f9pqmX0yz","item-arrow-hide":"item-arrow-hide-VTM-rqiArq",itemArrowHide:"item-arrow-hide-VTM-rqiArq","item-hovering":"item-hovering-nwPPxZdStP",itemHovering:"item-hovering-nwPPxZdStP","item-multi-dragging":"item-multi-dragging-2d25xcxAxT",itemMultiDragging:"item-multi-dragging-2d25xcxAxT","item-icon":"item-icon-4yWb1C9Cnx",itemIcon:"item-icon-4yWb1C9Cnx","item-code":"item-code-29y1HwVSoQ",itemCode:"item-code-29y1HwVSoQ","item-name":"item-name-1iS84gNJg_",itemName:"item-name-1iS84gNJg_","item-date":"item-date-202uVHu351",itemDate:"item-date-202uVHu351","item-priority":"item-priority-1b6OoqpgBI",itemPriority:"item-priority-1b6OoqpgBI","item-status":"item-status-1N7R_w_pe_",itemStatus:"item-status-1N7R_w_pe_","item-assignee":"item-assignee-fDpSdC095Y",itemAssignee:"item-assignee-fDpSdC095Y","to-right":"to-right-1BzfXCxuMg",toRight:"to-right-1BzfXCxuMg"}},nv37:function(e,t,a){e.exports=a.p+"8d7deea3af73825daf8cbdc9e77b6d83.svg"},"oT/l":function(e,t,a){"use strict";var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("17x9")),r=n(a("cDcd")),o=n(a("K2gz")),s=a("7FZc"),l=n(a("Ism1")),c=function(e){var t=e.className,a=e.tooltip,n=e.children,i=e.placement;return r.default.createElement("div",{className:(0,o.default)(l.default.title,t)},n,r.default.createElement(s.TooltipTrigger,{placement:i||"right",className:l.default.tooltip,title:r.default.createElement("div",{className:l.default.content},a)},r.default.createElement("span",{className:l.default.icon})))};c.propTypes={className:i.default.string,tooltip:i.default.any,children:i.default.any,placement:i.default.string};var u=c;t.default=u},oXNU:function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjRweCIgaGVpZ2h0PSIyNHB4IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+ZmlsZS1pY29ucy8yNHB4L251bWJlcnM8L3RpdGxlPgogICAgPGRlZnM+CiAgICAgICAgPHBhdGggZD0iTTUuMjUsMiBMMTUsMiBMMTUsMiBMMjEsOCBMMjEsMTkuNzUgQzIxLDIwLjk5MjY0MDcgMTkuOTkyNjQwNywyMiAxOC43NSwyMiBMNS4yNSwyMiBDNC4wMDczNTkzMSwyMiAzLDIwLjk5MjY0MDcgMywxOS43NSBMMyw0LjI1IEMzLDMuMDA3MzU5MzEgNC4wMDczNTkzMSwyIDUuMjUsMiBaIiBpZD0icGF0aC0xIj48L3BhdGg+CiAgICAgICAgPGZpbHRlciB4PSItOC4zJSIgeT0iLTcuNSUiIHdpZHRoPSIxMTYuNyUiIGhlaWdodD0iMTE1LjAlIiBmaWx0ZXJVbml0cz0ib2JqZWN0Qm91bmRpbmdCb3giIGlkPSJmaWx0ZXItMiI+CiAgICAgICAgICAgIDxmZU9mZnNldCBkeD0iMCIgZHk9IjAiIGluPSJTb3VyY2VBbHBoYSIgcmVzdWx0PSJzaGFkb3dPZmZzZXRPdXRlcjEiPjwvZmVPZmZzZXQ+CiAgICAgICAgICAgIDxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjAuNSIgaW49InNoYWRvd09mZnNldE91dGVyMSIgcmVzdWx0PSJzaGFkb3dCbHVyT3V0ZXIxIj48L2ZlR2F1c3NpYW5CbHVyPgogICAgICAgICAgICA8ZmVDb2xvck1hdHJpeCB2YWx1ZXM9IjAgMCAwIDAgMCAgIDAgMCAwIDAgMCAgIDAgMCAwIDAgMCAgMCAwIDAgMC4wNSAwIiB0eXBlPSJtYXRyaXgiIGluPSJzaGFkb3dCbHVyT3V0ZXIxIj48L2ZlQ29sb3JNYXRyaXg+CiAgICAgICAgPC9maWx0ZXI+CiAgICA8L2RlZnM+CiAgICA8ZyBpZD0iUGFnZS0xIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8ZyBpZD0iSWNvbnMvRmlsZS8yNHB4L051bWJlcnMiPgogICAgICAgICAgICA8ZyBpZD0iUmVjdGFuZ2xlLUNvcHkiPgogICAgICAgICAgICAgICAgPHVzZSBmaWxsPSJibGFjayIgZmlsbC1vcGFjaXR5PSIxIiBmaWx0ZXI9InVybCgjZmlsdGVyLTIpIiB4bGluazpocmVmPSIjcGF0aC0xIj48L3VzZT4KICAgICAgICAgICAgICAgIDx1c2UgZmlsbD0iIzAyQTY1MSIgZmlsbC1ydWxlPSJldmVub2RkIiB4bGluazpocmVmPSIjcGF0aC0xIj48L3VzZT4KICAgICAgICAgICAgPC9nPgogICAgICAgICAgICA8cGF0aCBkPSJNMTYuMTI1LDE4IEMxNi4zMzIxMDY4LDE4IDE2LjUsMTguMTY3ODkzMiAxNi41LDE4LjM3NSBDMTYuNSwxOC41ODIxMDY4IDE2LjMzMjEwNjgsMTguNzUgMTYuMTI1LDE4Ljc1IEw3LjEyNSwxOC43NSBDNi45MTc4OTMyMiwxOC43NSA2Ljc1LDE4LjU4MjEwNjggNi43NSwxOC4zNzUgQzYuNzUsMTguMTY3ODkzMiA2LjkxNzg5MzIyLDE4IDcuMTI1LDE4IEwxNi4xMjUsMTggWiBNOSwxNS43NSBMOSwxNy4yNSBMNy41LDE3LjI1IEw3LjUsMTUuNzUgTDksMTUuNzUgWiBNMTEuMjUsMTQuMjUgTDExLjI1LDE3LjI1IEw5Ljc1LDE3LjI1IEw5Ljc1LDE0LjI1IEwxMS4yNSwxNC4yNSBaIE0xMy41LDExLjI1IEwxMy41LDE3LjI1IEwxMiwxNy4yNSBMMTIsMTEuMjUgTDEzLjUsMTEuMjUgWiBNMTUuNzUsMTIuNzUgTDE1Ljc1LDE3LjI1IEwxNC4yNSwxNy4yNSBMMTQuMjUsMTIuNzUgTDE1Ljc1LDEyLjc1IFoiIGlkPSJDb21iaW5lZC1TaGFwZSIgZmlsbD0iI0YyRjRGNiIgb3BhY2l0eT0iMC45MDAwMDAwMzYiPjwvcGF0aD4KICAgICAgICAgICAgPHBhdGggZD0iTTE1LDIgTDIxLDggTDE3LjI1LDggQzE2LjAwNzM1OTMsOCAxNSw2Ljk5MjY0MDY5IDE1LDUuNzUgTDE1LDIgTDE1LDIgWiIgaWQ9IlJlY3RhbmdsZS1Db3B5LTMiIGZpbGw9IiNGRkZGRkYiIG9wYWNpdHk9IjAuNDAwMDAwMDA2Ij48L3BhdGg+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4="},pKat:function(e,t,a){e.exports={item:"item-14OhiXWPN4","item-icon":"item-icon-10VAszt4GV",itemIcon:"item-icon-10VAszt4GV","item-code":"item-code-zhCfXpPly3",itemCode:"item-code-zhCfXpPly3","item-name":"item-name-1cphjxT0Bn",itemName:"item-name-1cphjxT0Bn","item-delay":"item-delay-2gvx-NX7f7",itemDelay:"item-delay-2gvx-NX7f7","item-date":"item-date-XkDaqUz0z2",itemDate:"item-date-XkDaqUz0z2","item-status":"item-status-3nkmTC48kF",itemStatus:"item-status-3nkmTC48kF","item-assignee":"item-assignee-1fwPUUz0Jt",itemAssignee:"item-assignee-1fwPUUz0Jt","to-right":"to-right-vblGWkXPgS",toRight:"to-right-vblGWkXPgS"}},pMd9:function(e,t,a){e.exports={menuItem:"menuItem-3LG61YDXEy",menu:"menu-16U_tFdLKv",schemeName:"schemeName-3RPuDhbnrW",schemeNametext:"schemeNametext-3eByNK_I0p",moreMenu:"moreMenu-1HLPkVaiS0",star:"star-39j0lg_imv",iconStar:"iconStar-1OMXvtjwBd",siderItem:"siderItem-c2c3QOw2wE",schemeActive:"schemeActive-28S_MEMjrN",flexBetween:"flexBetween-dEvh8jZdMN",teamIcon:"teamIcon-18Cn7dKx8n","iteration-filter":"iteration-filter-2r3KUjVy5R",iterationFilter:"iteration-filter-2r3KUjVy5R",moreIcon:"moreIcon-2qoc8Pn3QY","check-icon":"check-icon-1tfvBBB530",checkIcon:"check-icon-1tfvBBB530"}},pgVe:function(e,t,a){"use strict";a("I5cv"),a("RW0V"),a("ioFf"),a("mYba"),a("jm62"),a("EK0E"),a("XfO3"),a("Btvt"),a("yt8O"),a("rGqo");var n=a("TqRt"),i=a("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("dRSK"),a("INYr"),a("xfY5"),a("f3/d"),a("bWfx"),a("0l/t");var r,o,s,l=n(a("RIqP")),c=n(a("ZDp4")),u=n(a("lSNA")),d=n(a("lwsE")),f=n(a("W8MJ")),p=n(a("PJYZ")),m=n(a("7W2i")),h=n(a("a1gu")),v=n(a("Nsbk")),g=a("mVeg"),E=Z(a("cDcd")),b=a("iR1w"),y=n(a("X9In")),S=n(a("17x9")),I=n(a("K2gz")),T=a("nuIr"),C=a("uKPp"),P=a("dtw8"),w=n(a("+QRC")),D=a("xgZS"),O=a("DKcV"),R=Z(a("OajT")),j=n(a("NUcW")),k=a("x+BT"),N=a("BXnm"),A=a("w3Wo"),L=a("k65d"),F=a("DgMC"),_=a("5kKY"),M=n(a("Qkhu")),x=n(a("TT2u")),B=a("EvOC"),U=a("c7k8"),W=n(a("BkRI")),Y=n(a("HwxY")),H=n(a("6Mal")),V=n(a("L8Eh")),G=a("iTKN"),K=n(a("KUqB")),z=a("nuIr");function q(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(q=function(e){return e?a:t})(e)}function Z(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!==typeof e)return{default:e};var a=q(t);if(a&&a.has(e))return a.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=r?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}return n.default=e,a&&a.set(e,n),n}function J(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function X(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?J(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):J(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Q(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,v.default)(e);if(t){var i=(0,v.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,h.default)(this,a)}}var $=(0,R.default)(r=(0,x.default)((s=o=function(e){(0,m.default)(a,e);var t=Q(a);function a(e){var n;return(0,d.default)(this,a),(n=t.call(this,e)).renderDragPreview=function(e){var t=n.state.draggingCode;if(!t)return null;var a=n.state.copyAffairs;return E.default.createElement(B.DragPreview,{type:"$$-epic-issue-$$"},(function(i){return E.default.createElement("div",{className:y.default.draggingItem,style:X({width:e},i)},n.renderItem(a.find((function(e){return e.code===t}))))}))},n.renderDragDropItem=function(e){var t=e.index,a=e.style,i=n.props.isPermissible,r=n.state.copyAffairs,o=r[t],s=i([{function:O.ProjectPermissionFunction.PROJECT_ISSUE,action:O.ProjectPermissionAction.UPDATE}]);return E.default.createElement(B.Drag,{key:o.code,type:"$$-epic-issue-$$",data:{code:o.code},canDrag:s,enablePreview:!0,onBegin:n.handleDragBegin,onEnd:n.handleDragEnd},(function(e,i){return(0,c.default)(e),E.default.createElement(B.Drop,{type:"$$-epic-issue-$$",data:{code:o.code},canDrop:s,list:r,onHover:n.handleDragHover,restrict:!0,keyName:"code"},(function(e,r){e.isOver;return E.default.createElement("div",{ref:i,key:o.code,style:X({cursor:s?"move":"default"},a)},E.default.createElement("div",{ref:r,className:(0,I.default)(o.code===n.state.draggingCode&&y.default.itemIsDragging)},n.renderItem(o,t)))}))}))},n.handleDragBegin=function(e){var t=e.data,a=n.state.copyAffairs.findIndex((function(e){return e.code===t.code}));n.setState({draggingCode:t.code,startIndex:a})},n.handleDragEnd=function(e){var t=e.data;n.setState({draggingCode:void 0});var a=n.props,i=a.projectID,r=a.callback,o=a.epicCode,s=n.state,l=s.copyAffairs,c=s.startIndex,u=l.findIndex((function(e){return e.code===t.code}));if(c!==u){var d=l[u],f=l[u+1],p={issueCode:d.code,beforeCode:f?f.code:void 0};(0,k.sortIssue)(i,o,p).then((function(){(0,D.success)((0,g.t)("\u6392\u5e8f\u6210\u529f")),r()}),(function(e){var t=e.msg;(0,D.danger)(getErrorMessage(t))}))}},n.handleDragHover=function(e,t){n.scheduleUpdate({sourceData:e,targetData:t})},n.scheduleUpdate=function(e){n.pendingUpdateObj=e,n.requestedFrame||(n.requestedFrame=requestAnimationFrame(n.handleDrawFrame))},n.handleDrawFrame=function(){var e=n.pendingUpdateObj,t=e.sourceData,a=e.targetData,i=t.data.code,r=a.data.code,o=n.state.copyAffairs,s=o.findIndex((function(e){return e.code===i})),l=o.findIndex((function(e){return e.code===r})),c=o.splice(s,1)[0];o.splice(l,0,c),n.setState({copyAffairs:o}),n.pendingUpdateObj=void 0,n.requestedFrame=void 0},n.renderItem=function(e,t){var a,i=n.props,r=i.isPermissible,o=i.params,s=i.isDetail,c=i.currentProject,u=n.state,d=(u.transfers,u.draggingCode),f=u.copyAffairs,p=r([{function:O.ProjectPermissionFunction.PROJECT_ISSUE,action:O.ProjectPermissionAction.UPDATE}]),m=r([{function:O.ProjectPermissionFunction.PROJECT_ISSUE,action:O.ProjectPermissionAction.DELETE}]),h=("".concat(e.projectId,"-").concat(e.code),e&&e.issueStatus&&e.issueStatus.type&&"COMPLETED"===e.issueStatus.type);a=n.props.isFullScreen?Number(n.props.currentCode)===e.code:Number(o.issueCode||o.subIssueCode)===e.code;var v=n.props.isFullScreen?z.FULL_SCREEN.disabledBottomSpace:0;return E.default.createElement(Y.default.Consumer,null,(function(i){var r;return E.default.createElement("div",{className:(0,I.default)(y.default.items,a&&y.default.active,d&&y.default.itemIsMoving,f.length-1===t?y.default.lastItem:"")},E.default.createElement("div",{className:y.default.itemLeft},n.renderIcon(e.issueTypeDetail),n.renderLink(e.type,e.code,e.name)),E.default.createElement("div",{className:y.default.itemRight},e.dueDate&&E.default.createElement("div",{className:(0,I.default)(y.default.tag,y.default.dueDate,y.default[(0,F.parseDueDate)(e.dueDate,h).color]),title:(0,F.parseDueDate)(e.dueDate,h).formatDate},(0,F.parseDueDate)(e.dueDate,h).text),E.default.createElement("div",{className:y.default.itemPriority},E.default.createElement(H.default,{componentType:G.ComponentType.ICON,value:e.priority,disabled:!p,onSelect:function(t){return n.changeAttributes(e.type,e.code,{priority:t.id})},isPortal:!0,portalProps:{portalContainer:s?document.querySelector('#wm-detail div[class^="spec-main"]'):document.querySelector('#wm-spec div[class^="spec-main"]'),toRight:!0,scrollControl:i.scrollControl},disabledBottomSpace:v})),E.default.createElement("div",{className:y.default.itemStatus},E.default.createElement(N.StatusSelect,{value:e.issueStatus,projectID:n.props.projectID,project:c,issueCode:e.code,disabled:!p,onSelect:function(t){return n.changeAttributes(e.type,e.code,t)},portalContainer:function(){return s?document.querySelector('#wm-detail div[class^="spec-main"]'):document.querySelector('#wm-spec div[class^="spec-main"]')},portalAlign:{top:21,toRight:!0},disabledBottomSpace:v})),E.default.createElement("div",{className:y.default.itemAssignee},E.default.createElement(V.default,{componentType:G.ComponentType.ICON,disabled:!p,inProject:!0,projectID:n.props.projectID,value:null===(r=e.assignee)||void 0===r?void 0:r.id,onSelect:function(t){n.changeAttributes(e.type,e.code,{assignee:t.id})},onClear:function(){n.changeAttributes(e.type,e.code,{assignee:0})},triggerExtraProps:{initialSelectedItem:e.assignee},isPortal:!0,portalProps:{portalWrapStyle:{zIndex:1055},portalContainer:s?document.querySelector('#wm-detail div[class^="spec-main"]'):document.querySelector('#wm-spec div[class^="spec-main"]'),toRight:!0,scrollControl:i.scrollControl},disabledBottomSpace:v})),E.default.createElement(_.ItemDropdown,{popupStyle:{width:160},portalContainer:function(){return s?document.querySelector('#wm-detail div[class^="spec-main"]'):document.querySelector('#wm-spec div[class^="spec-main"]')},portalAlign:{top:24,left:-96},options:[{name:(0,g.t)("\u65b0\u7a97\u53e3\u6253\u5f00"),id:C.ITEMS_ACTION.OPEN_IN_NEW_WINDOW},{name:(0,g.t)("\u590d\u5236\u94fe\u63a5"),id:C.ITEMS_ACTION.COPY_PATH}].concat((0,l.default)(p||m?[{id:"divider",name:"",type:"divider"}]:[]),(0,l.default)(p?[{name:(0,g.t)("\u89e3\u9664\u5173\u8054"),id:C.ITEMS_ACTION.UNLINK}]:[]),(0,l.default)(m?[{name:(0,g.t)("\u5220\u9664"),id:C.ITEMS_ACTION.DELETE,type:"delete"}]:[])),onSelect:function(t){return n.onSelect(t,e)}})))}))},n.getListHeight=function(){return Math.min(345,36*n.state.copyAffairs.length)},n.getUrlByType=function(e){var t=n.props.projectPath;switch(e.type){case T.ISSUE_TYPE.REQUIREMENT:return"".concat(t,"/requirements/issues/").concat(e.code,"/detail");case T.ISSUE_TYPE.ASSIGNMENT:return"".concat(t,"/assignments/issues/").concat(e.code,"/detail");case T.ISSUE_TYPE.DEFECT:return"".concat(t,"/bug-tracking/issues/").concat(e.code,"/detail");default:return""}},n.deleteIssue=function(){var e=n.state.deleteItem,t=n.props,a=t.callback,i=t.projectID,r=function(){};switch(e.type){case T.ISSUE_TYPE.REQUIREMENT:r=L.deleteRequirement;break;case T.ISSUE_TYPE.ASSIGNMENT:r=L.deleteAssignment;break;case T.ISSUE_TYPE.DEFECT:r=L.deleteBug}r(i,e.code).then((function(){(0,D.success)((0,g.t)("\u5220\u9664\u6210\u529f")),n.closeConfirm(),a()}))},n.closeConfirm=function(){n.setState({showDeleteModal:!1,deleteItem:void 0})},n.onSelect=function(e,t){var a=n.props,i=a.callback,r=a.projectID,o=a.epicCode,s=a.browserRouter,l=n.getUrlByType(t);switch(e.id){case C.ITEMS_ACTION.UNLINK:(0,k.deleteIssueFromEpic)(r,o,t.code).then((function(){(0,D.success)((0,g.t)("\u53d6\u6d88\u5173\u8054\u6210\u529f")),i()}));break;case C.ITEMS_ACTION.COPY_PATH:(0,w.default)("".concat(window.location.origin).concat(l)),(0,D.success)((0,g.t)("\u6210\u529f\u590d\u5236\u5230\u526a\u5207\u677f"));break;case C.ITEMS_ACTION.OPEN_IN_NEW_WINDOW:window.open(l);break;case C.ITEMS_ACTION.DETAIL:s.push(l);break;case C.ITEMS_ACTION.DELETE:n.setState({showDeleteModal:!0,deleteItem:t});break;default:window.console.danger((0,g.t)("\u672a\u77e5\u9879\u76ee"))}},n.getIssueStatusTransfers=function(e){var t=e.projectId,a=e.code,i=n.state.transfers;return(0,A.fetchIssueStatusTransfers)(t,a).then((function(e){var r=e.data,o="".concat(t,"-").concat(a);n.setState({transfers:X(X({},i),{},(0,u.default)({},o,r))})}))},n.changeAttributes=function(e,t,a){var i=n.props,r=i.projectID,o=i.callback;return(0,A.modifyIssue)(e,r,t,a).then((function(e){return(0,D.success)((0,g.t)("\u66f4\u65b0\u6210\u529f")),o(),e}))},n.state={transfers:{},draggingCode:void 0,copyAffairs:(0,W.default)(e.affairs||[]),showDeleteModal:!1,deleteItem:void 0},n.createSimpleAffairs=n.createSimpleAffairs.bind((0,p.default)(n)),n.createFullAffairs=n.createFullAffairs.bind((0,p.default)(n)),n.associateAffairs=n.associateAffairs.bind((0,p.default)(n)),n}return(0,f.default)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.sectionExpanded,n=t.isCreateAffairsVisible,i=t.isPermissible,r=this.state,o=r.copyAffairs,s=r.deleteItem,l=r.showDeleteModal,c=i([{function:O.ProjectPermissionFunction.PROJECT_ISSUE,action:O.ProjectPermissionAction.UPDATE}]);return E.default.createElement(B.DndProvider,{backend:B.Backend},E.default.createElement("div",{className:y.default.subitemWrapper},c&&E.default.createElement(U.AutoSizer,null,(function(t){var a=t.width;return e.renderDragPreview(a)})),this.renderHeader(),a&&(o.length?this.renderList():n?null:E.default.createElement("p",{className:y.default.emptyTip},(0,g.t)("\u5c1a\u672a\u5173\u8054\u4e8b\u9879\uff0c\u53ef\u70b9\u51fb\u4e0a\u65b9\u6309\u94ae\u521b\u5efa\u5e76\u5173\u8054\u4e00\u4e2a\u4e8b\u9879"))),E.default.createElement(M.default,{text:(0,g.t)("\u5220\u9664\u4e8b\u9879"),type:s?s.type:"",show:l,onConfirm:this.deleteIssue,onClose:this.closeConfirm,issueTypeDetail:s?s.issueTypeDetail:void 0})))}},{key:"renderIcon",value:function(e){return E.default.createElement(K.default,{type:e.iconType})}},{key:"renderLink",value:function(e,t,a){var n=this.props,i=n.projectPath,r=n.params,o=(n.isDetail,n.epicCode);n.isFullScreen;return E.default.createElement(P.Link,{to:"".concat(i,"/epics/issues/").concat(r.epicCode||r.issueCode||o,"/detail/subissues/").concat(t),className:y.default.itemDetail,style:{flexGrow:0}},this.renderLinkInner(t,a))}},{key:"renderLinkInner",value:function(e,t){return E.default.createElement(E.default.Fragment,null,E.default.createElement("div",{className:y.default.itemCode},"#",e),E.default.createElement("div",{className:y.default.itemSpec},E.default.createElement("div",{className:y.default.itemTitle,title:t},t)))}},{key:"componentWillUnmount",value:function(){void 0!==this.requestedFrame&&cancelAnimationFrame(this.requestedFrame)}},{key:"renderList",value:function(){var e=this,t=this.state.copyAffairs;return E.default.createElement("div",{className:y.default.subitemDetail},t.length>10?E.default.createElement(b.FixedSizeList,{itemCount:t.length,itemSize:36,height:this.getListHeight(),itemData:{copyAffairs:t}},this.renderDragDropItem):t.map((function(t,a){return e.renderDragDropItem({index:a,style:{}})})))}},{key:"renderHeader",value:function(){var e=this,t=this.props,a=t.SectionToggletrigger,n=t.isPermissible,i=this.state.copyAffairs,r=i.filter((function(e){return"COMPLETED"===e.issueStatus.type}))||0,o=n([{function:O.ProjectPermissionFunction.PROJECT_ISSUE,action:O.ProjectPermissionAction.UPDATE}]);return E.default.createElement("div",{className:y.default.subitemHeader},E.default.createElement("div",{className:(0,I.default)(y.default.title,!o&&y.default.noBorder)},(0,g.t)("\u53f2\u8bd7\u4e0b\u7684\u4e8b\u9879"),E.default.createElement(a,null)),E.default.createElement("div",{className:y.default.operation},o&&E.default.createElement("div",{className:y.default.createButton,onClick:function(){return e.createSimpleAffairs("")}}),!!i.length&&E.default.createElement("div",{className:y.default.progress},E.default.createElement(j.default,{total:i.length,completed:r.length}))))}},{key:"createSimpleAffairs",value:function(e){this.props.handleSimpleCreate(e)}},{key:"createFullAffairs",value:function(e){this.props.handleFullCreate(e)}},{key:"associateAffairs",value:function(e){this.props.handleAssociate(e)}}],[{key:"getDerivedStateFromProps",value:function(e){return"affairs"in e?{copyAffairs:e.affairs}:null}}]),a}(E.Component),o.propTypes=X(X(X({params:S.default.object,isDetail:S.default.bool,affairs:S.default.array,projectPath:S.default.string,projectID:S.default.number,currentProject:S.default.object,epicCode:S.default.number,handleFullCreate:S.default.func,handleSimpleCreate:S.default.func,handleAssociate:S.default.func,callback:S.default.func},O.WithProjectPermissionProps),R.ToggleSectionWrapperProps),{},{isCreateAffairsVisible:S.default.bool,browserRouter:S.default.object,isFullScreen:S.default.bool}),r=s))||r)||r;t.default=$},"q+jK":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stageSize=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:360,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:60;if("undefined"!==typeof window){var a=window,n=a.innerHeight,i=void 0===n?0:n,r=a.innerWidth,o=void 0===r?0:r;return{width:o-e,height:i-t}}return{width:0,height:0}},t.stageFitSize=function(e,t,a,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:80,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:90,o=n-i,s=a-r;t>e&&(o=Math.min(t,n)-i);t<=e&&e>a&&(s=Math.min(e,a)-r);return{maxWidth:s,maxHeight:o}}},q18W:function(e,t,a){"use strict";a.r(t);var n=a("cDcd"),i=a.n(n),r=a("BKNj"),o=a("mVeg"),s=a("GOSa"),l=a.n(s),c=a("MiOB"),u=a("xgZS"),d=a("v6U7"),f=a("w3Wo"),p=a("f0Wu"),m=a.n(p),h=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o};t.default=function(e){var t=e.getVersion,a=e.labelStyle,s=e.boxStyle,p=e.projectId,v=e.planDateCustomID,g=e.onChange,E=e.planDateValue,b=e.versionValue,y=e.issueId,S=e.status,I=e.updateActivity,T=e.isSetDropdownPanelWidth,C=e.isFieldUpdate,P=void 0!==C&&C,w=e.updateVersions,D=void 0===w?function(e){}:w,O=e.getInnerVersionList,R=void 0===O?function(e){}:O,j=h(Object(n.useState)([]),2),k=j[0],N=j[1],A=h(Object(n.useState)(null===b||void 0===b?void 0:b.id),2),L=A[0],F=A[1],_=h(Object(n.useState)(""),2),M=_[0],x=_[1],B=h(Object(n.useState)(E),2),U=B[0],W=B[1],Y=Object(n.useCallback)((function(){Object(f.getIssueseDition)({projectId:p,keyword:M,page:1,pageSize:99999}).then((function(e){var t,a,n=null!==(a=null===(t=e.data.list)||void 0===t?void 0:t.map((function(e){return{text:e.name,id:e.editionId,planDate:253370736e6===e.plannedProductionTime?null:e.plannedProductionTime}})))&&void 0!==a?a:[];if(N(n),R(n),(null===b||void 0===b?void 0:b.id)&&!U){var i=n.find((function(e){return e.id===(null===b||void 0===b?void 0:b.id)}));i&&(W(i.planDate||void 0),H(i.planDate?m()(i.planDate).format("YYYY-MM-DD"):void 0))}}))}),[p,M]);Object(n.useEffect)((function(){Y()}),[Y]),Object(n.useEffect)((function(){t(L)}),[L]);var H=function(e){g({isCustom:!0,issueFieldId:v,value:e})},V=function(e,t){"isEdit"===S?P?D&&D(e):Object(f.editIssueseDition)({projectId:p,issueId:y,editionId:e}).then((function(){Object(u.success)("\u66f4\u65b0\u6210\u529f"),I&&I()})):H(t?m()(t).format("YYYY-MM-DD"):void 0)};return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:s},i.a.createElement("label",{className:null!==a&&void 0!==a?a:l.a.issueProperty},Object(o.t)("\u7248\u672c")),i.a.createElement(r.default,{value:L,disabled:(null===b||void 0===b?void 0:b.isSubmit)&&"3"!==(null===b||void 0===b?void 0:b.fileStatus)||"101"===(null===b||void 0===b?void 0:b.fileStatus),onSelect:function(e){F(e.id),W(e.planDate),V(e.id,e.planDate)},onClear:function(){x(""),F(void 0),W(void 0),V(-1)},onSearch:function(e){x(e)},dataInited:!0,isPortal:T,portalProps:T&&{toRight:!0,portalWrapStyle:{zIndex:1041}},placeholder:Object(o.t)("\u8bf7\u9009\u62e9\u7248\u672c"),searchPlaceholder:Object(o.t)("\u641c\u7d22\u7248\u672c"),items:k,Trigger:d.default,isSetDropdownPanelWidth:T,triggerExtraProps:{initialSelectedItem:{text:null===b||void 0===b?void 0:b.name,id:null===b||void 0===b?void 0:b.id,value:null===b||void 0===b?void 0:b.id}}})),i.a.createElement("div",{className:s},i.a.createElement("label",{className:null!==a&&void 0!==a?a:l.a.issueProperty},Object(o.t)("\u8ba1\u5212\u4e0a\u7ebf\u65e5\u671f")),i.a.createElement(c.default,{isDisabled:!!L,className:l.a.dateSelect,value:U,placeholder:Object(o.t)("\u672a\u6307\u5b9a"),onChange:function(e){e.isValid()?(W(e),H(e.format("YYYY-MM-DD"))):(W(void 0),H(void 0))},isDetail:!1,isCreate:!0,isPortal:!0,portalProps:{toRight:!0,portalWrapStyle:{zIndex:1041},isScroll:!1,resetIsScroll:function(){}}})))}},q47l:function(e,t,a){"use strict";a.r(t);var n=a("mVeg"),i=a("cDcd"),r=a.n(i),o=a("sftu"),s=a.n(o),l=a("yZ+p"),c=a.n(l),u=a("N0I2"),d=a.n(u),f=a("xgZS"),p=a("KUqB"),m=a("/HD1"),h=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o};t.default=function(e){var t,a=e.onVisibleChange,o=e.project,l=e.issueCode,u=e.fetchList,v=e.parentCodeChange,g=Object(i.useRef)(null),E=h(Object(i.useState)(""),2),b=E[0],y=E[1],S=h(Object(i.useState)([]),2),I=S[0],T=S[1],C=function(e){Object(m.fetchParentWorkItems)(o.name,l,{keyword:e}).then((function(e){T(e.data)}))},P=Object(i.useCallback)((function(e){var a=e.target.value;y(a),window.clearTimeout(t),t=window.setTimeout((function(){C(a)}),800)}),[]),w=Object(i.useCallback)((function(){y(""),C("")}),[]);return Object(i.useEffect)((function(){C("")}),[]),r.a.createElement(s.a,{closeButton:!0,outsideClickCloseable:!1,show:!0,onHide:function(){return a(!1)},className:d.a.wrapper,keyboard:!1},r.a.createElement("div",{className:d.a.title},Object(n.t)("\u66f4\u6539\u7236\u5de5\u4f5c\u9879")),r.a.createElement(c.a,{value:b,className:d.a.customInput,ref:g,onChange:P,prefix:r.a.createElement("div",{className:d.a.customSearchIcon}),suffix:r.a.createElement("div",{className:d.a.cancelBtn,onClick:w},Object(n.t)("\u53d6\u6d88")),size:"medium",placeholder:Object(n.t)("\u8f93\u5165\u7236\u5de5\u4f5c\u9879 ID \u6216\u6807\u9898")}),r.a.createElement("div",{className:d.a.customResult,onScroll:function(e){return e.stopPropagation()}},r.a.createElement("div",{className:d.a.resultWrapper},!!I.length&&r.a.createElement("div",{className:d.a.resultItems},I.map((function(e){return r.a.createElement("div",{className:d.a.item,key:e.code,onClick:function(){return t=e.code,void Object(m.updateParentWorkItem)(o.name,l,t).then((function(){Object(f.success)(Object(n.t)("\u66f4\u65b0\u6210\u529f")),a(!1),u(),v(t)}));var t}},r.a.createElement("div",{className:d.a.itemIcon},r.a.createElement(p.default,{type:e.issueTypeDetail.iconType})),r.a.createElement("div",{className:d.a.itemCode},"#",e.code),r.a.createElement("div",{className:"".concat(d.a.itemDetail," ").concat(d.a.customDetail)},r.a.createElement("div",{className:d.a.itemDetailTitle},e.name)))}))),!I.length&&r.a.createElement("div",{className:d.a.resultEmpty},r.a.createElement("div",{className:"".concat(d.a.icon," ").concat(d.a.customSearchIcon)}),Object(n.t)("\u6ca1\u6709\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c")))))}},q70N:function(e,t,a){"use strict";a.r(t);var n=a("cDcd"),i=a.n(n),r=a("VVDc"),o=a.n(r),s=a("EyEP"),l=a.n(s),c=a("OajT"),u=a.n(c),d=a("mVeg"),f=a("Xc7o"),p=a.n(f),m=a("K2gz"),h=a.n(m),v=a("dtw8"),g=a("KUqB"),E=a("5kKY"),b=a("HwxY"),y=a("mFAe"),S=a("Qkhu"),I=a.n(S),T=a("AwMv"),C=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},P=function(e,t,a){if(a||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},w=function(e){var t,a,r,o=e.data,s=e.style,l=e.fetchList,c=e.allowUpdate,u=e.className,f=e.issueCode,m=e.isScroll,S=e.resetIsScroll,w=e.typeInfo,D=e.projectID,O=C(Object(n.useState)(!1),2),R=O[0],j=O[1],k=P([],C(c?[{id:"remove",name:Object(d.t)("\u89e3\u9664\u5173\u8054")}]:[]),!1),N=function(){Object(T.cancelRelationRequirement)(f,o.code,D).then((function(){j(!1),l()}))},A=Object(n.useCallback)((function(e){switch(e.id){case"remove":j(!0)}}),[]),L="".concat(o.targetProjectName,"#").concat(o.code),F="/requiremanage?requirementCode=".concat(o.code),_={name:null===(t=o.meta)||void 0===t?void 0:t.statusName,id:null===(a=o.meta)||void 0===a?void 0:a.statusId,type:null===(r=o.meta)||void 0===r?void 0:r.statusType};return i.a.createElement(b.default.Consumer,null,(function(e){return i.a.createElement("div",{className:h()(p.a.item,u),style:s},i.a.createElement("div",{className:p.a.itemIcon},i.a.createElement(g.default,{type:w.icon})),i.a.createElement(i.a.Fragment,null,i.a.createElement(v.Link,{to:F,target:"_blank",className:p.a.itemCode,title:L},L),i.a.createElement(v.Link,{to:F,target:"_blank",className:p.a.itemName,title:o.title},o.title)),i.a.createElement("div",{className:p.a.itemPriority},i.a.createElement(y.default,{status:_})),!("PRD_REQUIREMENT"===w.type&&"\u5df2\u53d1\u5e03"===_.name)&&i.a.createElement("div",null,i.a.createElement(E.ItemDropdown,{options:k,onSelect:A,popupStyle:{width:160},isPortal:!0,candidate:o,portalProps:{portalContainer:document.querySelector('div[data-frontend-module-container="coding-project-management-frontend"]'),portalWrapStyle:{zIndex:1055},isScroll:m,resetIsScroll:S,toRight:!0,scrollControl:e.scrollControl}})),R&&i.a.createElement(I.a,{show:R,text:Object(d.t)("\u63d0\u793a"),hasType:!1,customTip:Object(d.t)("\u786e\u8ba4\u53d6\u6d88\u5173\u8054 {{title}} \u5417\uff1f",{title:o.title}),onConfirm:N,onClose:function(){return j(!1)}}))}))},D=a("iR1w"),O=a("NTFJ");t.default=u()((function(e){var t,a,r=e.sectionExpanded,s=e.SectionToggletrigger,c=e.list,u=e.projectID,d=e.issueCode,f=e.callback,p=e.currentProject,m=e.allowUpdate,h=e.type,v=((t={})[O.DM_ITEM_TYPE.PRD_REQUIREMENT]={icon:"prd",label:"\u4ea7\u54c1\u9700\u6c42",type:O.DM_ITEM_TYPE.PRD_REQUIREMENT},t[O.DM_ITEM_TYPE.ORD_REQUIREMENT]={icon:"operational",label:"\u8fd0\u8425\u9700\u6c42",type:O.DM_ITEM_TYPE.ORD_REQUIREMENT},t)[h],g=v.label,E=Object(n.useCallback)((function(e){var t=e.index,a=e.style,n=e.data.list[t];return i.a.createElement(w,{typeInfo:v,data:n,key:n.code,projectID:u,currentProject:p,fetchList:f,allowUpdate:m,issueCode:d,style:a})}),[]);return i.a.createElement("div",{className:o.a.wrapper},i.a.createElement("div",{className:l.a.header},i.a.createElement(s,null),i.a.createElement("div",{className:l.a.text},g)),i.a.createElement("div",{className:o.a.body},r&&i.a.createElement("div",{className:o.a.nextTitle},"\u88ab\u5173\u8054"),!!c.length&&r&&i.a.createElement("div",{className:o.a.list},i.a.createElement(D.FixedSizeList,{itemCount:c.length,itemSize:36,width:"100%",height:(a=c.length,Math.min(345,36*a)),itemData:{list:c,disabledBottomSpace:0}},E))))}))},qC95:function(e,t,a){e.exports=a.p+"132c5c9cb9515501605e0b4ab82bd033.svg"},qD4R:function(e,t,a){"use strict";a.r(t);var n=a("cDcd"),i=a.n(n),r=a("5JFE"),o=a("xnf3"),s=a.n(o),l=function(){return(l=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},c={1:"\u4f4e",2:"\u4e2d",3:"\u9ad8"},u={overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",wordBreak:"break-all"};t.default=function(e){var t,a,n=e.localUrl,o=e.issue,d=(null===(t=null===o||void 0===o?void 0:o.riskInfo)||void 0===t?void 0:t.riskGrade)||2;return n&&o.issueExtend&&1===o.issueExtend.isRisk?i.a.createElement(r.Tooltip,{title:(a=null===o||void 0===o?void 0:o.riskInfo,i.a.createElement(r.Row,null,i.a.createElement(r.Col,{span:24},"\u98ce\u9669\u539f\u56e0\u5206\u7c7b\uff1a",null===a||void 0===a?void 0:a.riskClass),i.a.createElement(r.Col,{span:24},"\u98ce\u9669\u539f\u56e0\uff1a",null===a||void 0===a?void 0:a.riskReason),i.a.createElement(r.Col,{span:24},"\u98ce\u9669\u7b49\u7ea7\uff1a",c[(null===a||void 0===a?void 0:a.riskGrade)||2]),i.a.createElement(r.Col,{span:24},i.a.createElement("span",{style:l({WebkitLineClamp:3,WebkitBoxOrient:"vertical"},u),title:null===a||void 0===a?void 0:a.riskRemark},"\u5907\u6ce8\uff1a",null===a||void 0===a?void 0:a.riskRemark))))},i.a.createElement("span",{className:s.a["riskContent".concat(d)]},i.a.createElement("span",{className:s.a["riskMonitoring".concat(d)]}),"\u98ce\u9669")):i.a.createElement(i.a.Fragment,null)}},qEFv:function(e,t,a){"use strict";a.r(t),a.d(t,"CategoryTag",(function(){return u})),a.d(t,"CategorySelect",(function(){return v})),a.d(t,"CategoryType",(function(){return n}));var n,i=a("cDcd"),r=a.n(i),o=a("/cKC"),s=a.n(o),l=a("K2gz"),c=a.n(l);!function(e){e.iterationBlack="ITERATION-BLACK",e.subIssue="SUB-ISSUE",e.iteration="ITERATION"}(n||(n={}));var u=Object(i.memo)((function(e){var t=e.type,a=e.className,n=e.style;return r.a.createElement("div",{className:c()(s.a.category,s.a["category-".concat(t.toLowerCase())],a),style:n})})),d=a("OWZr"),f=a.n(d),p=a("KUqB"),m=a("5kKY"),h=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},v=Object(i.memo)((function(e){var t=e.value,a=e.onSelect,n=e.getContainer,o=e.options,s=e.portalContainer,l=e.portalAlign,u=e.isPortal,d=e.portalProps,v=h(Object(i.useState)(!1),2),g=v[0],E=v[1],b=Object(i.useCallback)((function(e){E(e)}),[]);return r.a.createElement(m.Trigger,{visible:g,onVisibleChange:b,getContainer:n,portalContainer:s,portalAlign:l,isPortal:u,portalProps:d,popup:r.a.createElement("div",{className:f.a.popup},o.map((function(e){return r.a.createElement("div",{key:e.id,className:f.a.option,onClick:function(){return a(e)},title:e.name},r.a.createElement(p.default,{type:e.iconType}),r.a.createElement("div",{className:f.a.optionName},e.name))})))},r.a.createElement("div",{className:c()(f.a.trigger,g&&f.a.triggerActive)},r.a.createElement(p.default,{type:t.iconType}),r.a.createElement("div",{className:f.a.triggerIcon})))}))},qOiO:function(e,t,a){e.exports=a.p+"ee00c7bffed214afafc62d3cd33948d8.svg"},"qS/1":function(e,t,a){"use strict";a("RW0V"),a("ioFf"),a("0l/t"),a("mYba"),a("jm62");var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.SUBITEM_ACTIONS=t.BASE_STATUS_TYPE=t.BASE_ISSUE_TYPES=t.LOG_TYPE=t.FIELD_TYPE=t.ACTION=void 0;var i=n(a("lSNA")),r=a("nuIr");function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){(0,i.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}t.ACTION={UPDATE_ASSIGNMENT_SCHEME:"ASSIGNMENTS.GET.ASSIGNMENT_SCHEME",UPDATE_HIDDEN_FILE_DIRS:"ASSIGNMENTS.GET.HIDDEN_FILE_DIRS",UPDATE_ASSIGNMENT_STATUS:"ASSIGNMENTS.GET.ASSIGNMENT_STATUS",UPDATE_MORE_FILTER_FIELDS:"ASSIGNMENTS.GET.MORE_FILTER_FIELDS"};var l=s({},r.BASE_FIELD_TYPE);t.FIELD_TYPE=l;var c=s({},r.LOG_TYPE);t.LOG_TYPE=c;var u=s({},r.ISSUE_TYPE);t.BASE_ISSUE_TYPES=u;var d=s({},r.STATUS_TYPE);t.BASE_STATUS_TYPE=d;t.SUBITEM_ACTIONS={REMOVEASSOCIATE:"REMOVEASSOCIATE",DELETE:"DELETE"}},r3Yi:function(e,t,a){"use strict";a.r(t);var n=a("cDcd"),i=a.n(n),r=a("e6EU"),o=a.n(r),s=a("mFAe");t.default=function(e){var t=e.index,a=e.item,n=e.selected,r=e.onSelect,l=n&&n.length&&n.filter((function(e){return e===a.value})).length||!1;return i.a.createElement("div",{className:o.a.menuItem,onClick:r,key:t},i.a.createElement("div",{className:o.a.menuItemName},i.a.createElement(s.default,{status:{id:a.id,name:a.name||"",type:a.type},className:o.a.menuItemStatus})),l&&i.a.createElement("div",{className:o.a.menuItemChecked}))}},rHVM:function(e,t,a){e.exports=a.p+"773945a9e5dd80a71dfb4cc3ad01e1cd.svg"},rSJF:function(e,t,a){e.exports={"tool-content":"tool-content-18NnQ-4L8z",toolContent:"tool-content-18NnQ-4L8z","tool-wrapper":"tool-wrapper-Gpu1-86SeZ",toolWrapper:"tool-wrapper-Gpu1-86SeZ",tooltitle:"tooltitle-2DMOcM6_uD",warpper:"warpper-2NiGoAFc_g",footer:"footer-1DbzH821Uu"}},rmFV:function(e,t,a){"use strict";a.r(t);var n=a("mVeg"),i=a("cDcd"),r=a.n(i),o=a("d/wg"),s=a.n(o),l=a("OajT"),c=a.n(l),u=a("iR1w"),d=a("5WBM"),f=a.n(d),p=a("K2gz"),m=a.n(p),h=a("KUqB"),v=a("ZTlW"),g=a("BXnm"),E=a("5kKY"),b=a("w3Wo"),y=a("xgZS"),S=a("+QRC"),I=a.n(S),T=a("HwxY"),C=a("6Mal"),P=a("L8Eh"),w=a("iTKN"),D=a("7FZc"),O=a("/HD1"),R=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},j=function(e,t,a){if(a||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},k={REQUIREMENT:"requirements",DEFECT:"bug-tracking",MISSION:"assignments",EPIC:"epics"},N=function(e){var t=e.data,a=(e.isDetail,e.style),i=e.className,o=e.onDelete,s=e.isLastChild,l=e.onChange,c=e.project,u=e.currentIssue,d=e.disabledBottomSpace,p=e.allowUpdate,S=function(e){return Object(b.modifyIssue)(t.type,t.project.id,t.code,e).then((function(e){return Object(y.success)(Object(n.t)("\u66f4\u65b0\u6210\u529f")),l(),e}))},N=function(){return"/p/".concat(t.project.name,"/").concat(k[t.issueTypeDetail.issueType],"/issues/").concat(t.code,"/detail")},A=function(){return document.querySelector('div[data-frontend-module-container="coding-project-management-frontend"]')},L=j(j(j([{id:"detail",name:Object(n.t)("\u65b0\u7a97\u53e3\u6253\u5f00"),link:{path:N()}},{id:"copy",name:Object(n.t)("\u590d\u5236\u94fe\u63a5")}],R(t.allowDelete||p?[{id:"divider",name:"",type:"divider"}]:[]),!1),R(p?[{id:"remove",name:Object(n.t)("\u89e3\u9664\u5173\u8054")}]:[]),!1),R(t.allowDelete?[{id:"delete",name:Object(n.t)("\u5220\u9664"),type:"delete"}]:[]),!1),F=function(e){switch(e.id){case"copy":I()("".concat(window.location.origin).concat(N())),Object(y.success)(Object(n.t)("\u6210\u529f\u590d\u5236\u5230\u526a\u5207\u677f"));break;case"delete":o(t);break;case"remove":Object(O.workItemRemoveSplittedIssue)(c.name,u.code,t.id).then((function(){Object(y.success)(Object(n.t)("\u89e3\u9664\u5173\u8054\u6210\u529f")),l()}))}},_=t.issueStatus&&t.issueStatus.type&&"COMPLETED"===t.issueStatus.type,M=function(){window.open(N())};return r.a.createElement(T.default.Consumer,null,(function(e){var n;return r.a.createElement("div",{className:m()(f.a.item,i,s&&f.a.lastChild),style:a},r.a.createElement(D.TooltipTrigger,{title:t.project.displayName},r.a.createElement("img",{className:f.a.itemProject,src:t.project.icon})),r.a.createElement("div",{className:f.a.itemDivider},"/"),r.a.createElement(h.default,{type:t.issueTypeDetail.iconType}),r.a.createElement("div",{className:f.a.itemCode,onClick:M},"#",t.code),r.a.createElement("div",{className:f.a.itemName,onClick:M,title:t.name},t.name),t.dueDate&&r.a.createElement("div",{className:f.a.itemDate},r.a.createElement(v.a,{date:t.dueDate,isCompleted:_})),r.a.createElement("div",{className:f.a.itemPriority},r.a.createElement(C.default,{componentType:w.ComponentType.ICON,value:t.priority,disabled:!t.allowUpdate||t.project.archived,onSelect:function(e){var t=e.id;return S({priority:t})},isPortal:!0,portalProps:{portalContainer:A(),toRight:!0,scrollControl:e.scrollControl},disabledBottomSpace:d})),r.a.createElement("div",{className:f.a.itemStatus},r.a.createElement(g.StatusSelect,{value:t.issueStatus,projectID:t.project.id,project:t.project,issueCode:t.code,disabled:!t.allowUpdate||t.project.archived,onSelect:function(e){return S(e)},portalContainer:A,portalAlign:{top:21,toRight:!0},disabledBottomSpace:d})),r.a.createElement("div",{className:f.a.itemAssignee},r.a.createElement(P.default,{componentType:w.ComponentType.ICON,disabled:!t.allowUpdate||t.project.archived,inProject:!0,projectID:t.project.id,value:null===(n=t.assignee)||void 0===n?void 0:n.id,onSelect:function(e){S({assignee:e.id})},onClear:function(){S({assignee:0})},triggerExtraProps:{initialSelectedItem:t.assignee},isPortal:!0,portalProps:{portalWrapStyle:{zIndex:1051},portalContainer:A(),toRight:!0,scrollControl:e.scrollControl},disabledBottomSpace:d})),!t.project.archived&&r.a.createElement("div",null,r.a.createElement(E.ItemDropdown,{options:L,onSelect:F,popupStyle:{width:160},portalContainer:A,portalAlign:{top:24,left:-96}})))}))},A=a("yt2Q"),L=a("Qkhu"),F=a.n(L),_=a("nuIr"),M=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(t,a)};return function(t,a){if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),x={REQUIREMENT:"requirements",DEFECT:"defects",MISSION:"missions",EPIC:"epics"},B=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={wrapperWidth:0,deleteItem:null,confirmVisible:!1},t.handleWrapperWidth=function(){t.wrapperRef.current&&t.setState({wrapperWidth:t.wrapperRef.current.clientWidth})},t.wrapperRef=Object(i.createRef)(),t.getListHeight=function(){var e=t.props.list;return Math.min(345,36*e.length)},t.handleCreateIssue=function(e){var a=e.code,n=e.data,i=t.props,r=i.currentProject,o=i.currentIssue,s=i.onSplittingIssue;0===a&&Object(O.workItemSplittingIssues)(r.name,o.code,n.id).then((function(){s()}))},t.handleDelete=function(e){t.setState({deleteItem:e,confirmVisible:!0})},t.renderRow=function(e){var a=e.index,n=e.style,i=e.data,o=t.props,s=o.isDetail,l=o.onRefresh,c=o.currentProject,u=o.currentIssue,d=o.allowUpdate,f=i.list,p=f[a];return r.a.createElement("div",{style:n},r.a.createElement(N,{allowUpdate:d,data:p,isDetail:s,onDelete:t.handleDelete,onChange:l,isLastChild:a===f.length-1,project:c,currentIssue:u,disabledBottomSpace:i.disabledBottomSpace}))},t.handleConfirmDelete=function(){var e=t.props.onRefresh,a=t.state.deleteItem;Object(O.deleteIssue)(a.project.id,x[a.issueTypeDetail.issueType],a.code).then((function(){Object(y.success)(Object(n.t)("\u5220\u9664\u6210\u529f")),t.setState({confirmVisible:!1}),e()}))},t}return M(t,e),t.prototype.componentDidMount=function(){this.handleWrapperWidth()},t.prototype.render=function(){var e=this,t=this.props,a=t.SectionToggletrigger,i=t.list,o=t.sectionExpanded,l=t.user,c=t.enterpriseGlobalKey,d=t.onOpenAssociateIssuesModal,f=t.currentProject,p=t.scrollTargetId,m=t.splittedIssuesVisible,h=t.onSplittedIssuesVisible,v=t.allowUpdate,g=this.state,E=g.wrapperWidth,b=g.confirmVisible,y=g.deleteItem,S=i.filter((function(e){return e&&"COMPLETED"===e.issueStatusType})).length,I=this.props.isFullScreen?_.FULL_SCREEN.disabledBottomSpace:0;return r.a.createElement("div",{className:s.a.wrapper,ref:this.wrapperRef,id:p},r.a.createElement("div",{className:s.a.header},r.a.createElement(a,null),r.a.createElement("div",{className:s.a.headerTitle},Object(n.t)("\u5206\u89e3\u5230\u9879\u76ee")),r.a.createElement("div",{className:s.a.headerDivider}),r.a.createElement("div",{className:s.a.headerAdd,onClick:function(){return h(!0)}}),!!i.length&&r.a.createElement("div",{className:s.a.headerRight},r.a.createElement("div",{className:s.a.progress},r.a.createElement("div",{className:s.a.progressBar},r.a.createElement("div",{className:s.a.progressBarInner,style:{width:S/i.length*120}})),r.a.createElement("div",{className:s.a.progressText},S,"/",i.length),r.a.createElement("div",{className:s.a.progressText},Object(n.t)("\u5df2\u5b8c\u6210"))))),i.length>0&&o&&r.a.createElement("div",{className:s.a.list},r.a.createElement(u.FixedSizeList,{itemCount:i.length,itemSize:36,height:this.getListHeight(),width:E,itemData:{list:i,disabledBottomSpace:I,allowUpdate:v}},this.renderRow)),m&&r.a.createElement("div",{style:{marginTop:8}},r.a.createElement(A.default,{isModal:!1,user:l,enterpriseGlobalKey:c,show:m,onHide:function(){return h(!1)},onSubmit:this.handleCreateIssue,inProgram:!0,programID:f.id}),r.a.createElement("div",{onClick:function(){return d()},className:s.a.relate},r.a.createElement("div",{className:s.a.relateIcon}),Object(n.t)("\u5173\u8054\u5df2\u6709\u4e8b\u9879"))),b&&r.a.createElement(F.a,{text:Object(n.t)("\u5220\u9664\u5de5\u4f5c\u9879"),type:y?y.type:"",issueTypeDetail:y.issueTypeDetail,show:b,onConfirm:this.handleConfirmDelete,onClose:function(){return e.setState({confirmVisible:!1})}}))},t}(i.Component);t.default=c()(B)},rtSv:function(e,t,a){e.exports={body:"body-2oBy6jkho6",title:"title-dSJbMfnXWN",list:"list-46ZgvyM1kL"}},"sM/k":function(e,t,a){e.exports={"empty-page":"empty-page-3YifpqAnGC",emptyPage:"empty-page-3YifpqAnGC","empty-icon":"empty-icon-eS9eYrPxYF",emptyIcon:"empty-icon-eS9eYrPxYF","empty-title":"empty-title-GcKp_od6G2",emptyTitle:"empty-title-GcKp_od6G2","empty-description":"empty-description-CXSpKNmnBe",emptyDescription:"empty-description-CXSpKNmnBe"}},sT2k:function(e,t,a){"use strict";a("I5cv");var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("lwsE")),r=n(a("W8MJ")),o=n(a("7W2i")),s=n(a("a1gu")),l=n(a("Nsbk")),c=n(a("cDcd")),u=n(a("17x9")),d=n(a("yZ+p")),f=n(a("K2gz")),p=n(a("cZGM")),m=n(a("f6d8"));function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,l.default)(e);if(t){var i=(0,l.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,s.default)(this,a)}}var v=function(e){(0,o.default)(a,e);var t=h(a);function a(){return(0,i.default)(this,a),t.apply(this,arguments)}return(0,r.default)(a,[{key:"render",value:function(){var e=this.props,t=(0,p.default)(e,"errorMessage");return c.default.createElement("div",{className:(0,f.default)(e.className,m.default.inputGreater,e.errorMessage&&m.default.inputGreaterError)},c.default.createElement(d.default,t),e.errorMessage&&c.default.createElement("div",{className:m.default.inputGreaterErrorMsg},e.errorMessage))}}]),a}(c.default.Component);v.propTypes={errorMessage:u.default.string,type:u.default.string,id:u.default.oneOfType([u.default.string,u.default.number]),size:u.default.oneOf(["small","default","medium","large","big"]),maxLength:u.default.oneOfType([u.default.string,u.default.number]),disabled:u.default.bool,value:u.default.any,defaultValue:u.default.any,className:u.default.string,addonBefore:u.default.node,addonAfter:u.default.node,prefixCls:u.default.string,onPressEnter:u.default.func,onKeyDown:u.default.func,onKeyUp:u.default.func,onFocus:u.default.func,onBlur:u.default.func,prefix:u.default.node,suffix:u.default.node,loading:u.default.bool,getLoadingIcon:u.default.func};var g=v;t.default=g},"sgW/":function(e,t,a){e.exports={trigger:"trigger-2rBXs_kLsj",status:"status-2aioV0mgRs",visible:"visible-3wooLEJuWX","trigger-visible":"trigger-visible-2hTzCEJXWO",triggerVisible:"trigger-visible-2hTzCEJXWO","trigger-arrow":"trigger-arrow-1w30rm8FR9",triggerArrow:"trigger-arrow-1w30rm8FR9","trigger-disabled":"trigger-disabled-1OavVTf7lL",triggerDisabled:"trigger-disabled-1OavVTf7lL",popup:"popup-4Z-JrXOWZc",option:"option-3LOnJxGZgb","option-arrow":"option-arrow-3AJe3BD41D",optionArrow:"option-arrow-3AJe3BD41D","option-name":"option-name-17zAf243wB",optionName:"option-name-17zAf243wB","option-tag":"option-tag-2AE94uH7fF",optionTag:"option-tag-2AE94uH7fF"}},smSU:function(e,t,a){e.exports={"issues-crumbs":"issues-crumbs-16DLd1Hdl2",issuesCrumbs:"issues-crumbs-16DLd1Hdl2","more-button":"more-button-1i6BAlPJWj",moreButton:"more-button-1i6BAlPJWj",active:"active-2yBpB6jqj9","code-id-divide-line":"code-id-divide-line-qaEkVmiTkL",codeIdDivideLine:"code-id-divide-line-qaEkVmiTkL",code:"code-24bbUgZha0",number:"number-2asTj5ypPn","last-number":"last-number-3DSk8yfb-a",lastNumber:"last-number-3DSk8yfb-a","last-id":"last-id-2dVabDdFdH",lastId:"last-id-2dVabDdFdH","copy-icon":"copy-icon-2ER2CJqUNI",copyIcon:"copy-icon-2ER2CJqUNI","hidden-doc":"hidden-doc-3G7xircnra",hiddenDoc:"hidden-doc-3G7xircnra","show-doc":"show-doc-2ODb0ewx5r",showDoc:"show-doc-2ODb0ewx5r","tool-doc":"tool-doc-3I6wrU039i",toolDoc:"tool-doc-3I6wrU039i",over:"over-6p0pAfSgyl","list-code":"list-code-3I_xjw7Vj1",listCode:"list-code-3I_xjw7Vj1","show-item":"show-item-343yVJTNaL",showItem:"show-item-343yVJTNaL","show-hidden-doc":"show-hidden-doc-1ZEsrkJLJy",showHiddenDoc:"show-hidden-doc-1ZEsrkJLJy","detail-menu":"detail-menu-3CPo_DhHhA",detailMenu:"detail-menu-3CPo_DhHhA"}},"tG+G":function(e,t,a){e.exports={filterAttrsContent:"filterAttrsContent-3cPIKpEm8u",title:"title-1uyOUsYFXT",filterItemsMain:"filterItemsMain-D8O9Iewgbf",conditionItem:"conditionItem-3p38jRSQz6",item:"item-1zsyLVj_du",coditionhandle:"coditionhandle-3O1-qkKtG3",coditionInput:"coditionInput-3cPdtgYkFV",coditionMenu:"coditionMenu-wM8J51VkLb",attrsFooter:"attrsFooter-1mFS_VZtZI",attrsBtn:"attrsBtn-3wRuV8MWTw"}},tchc:function(e,t,a){"use strict";a.r(t);var n=a("mVeg"),i=a("cDcd"),r=a.n(i),o=a("K2gz"),s=a.n(o),l=a("yZ+p"),c=a.n(l),u=a("246l"),d=a.n(u),f=a("xgZS"),p=a("Pc5Q"),m=a.n(p),h=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(t,a)};return function(t,a){if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),v=function(e){function t(t){var a=e.call(this,t)||this,n=t.ride||1;return a.state={expanded:t.expanded||!1,start:t.from&&Number(t.from)/n,end:t.to&&Number(t.to)/n,ride:n,showDel:!1},a.onStartChange=a.onStartChange.bind(a),a.onEndChange=a.onEndChange.bind(a),a.onSubmit=a.onSubmit.bind(a),a.onReset=a.onReset.bind(a),a.toggleExpand=a.toggleExpand.bind(a),a.clearValue=a.clearValue.bind(a),a.onShow=a.onShow.bind(a),a.onHide=a.onHide.bind(a),a}return h(t,e),t.prototype.trigger=function(){var e=this,t=this.props,a=t.from,n=t.to,i=t.unit,o=t.className,l=t.label,c=this.state,u=c.expanded,d=c.showDel,f=c.ride;return r.a.createElement("div",{className:"".concat(m.a.triggerWrapper," trigger-w100"),onMouseEnter:function(){return e.setState({showDel:!0})},onMouseOver:function(){e.setState({showDel:!0})}},r.a.createElement("div",{className:"newfilter-trigger ".concat(s()(m.a.selectTrigger,m.a.trigger,m.a.triggerBackground,(d||u)&&m.a.isExpanded,o)),onClick:this.toggleExpand},l&&r.a.createElement("span",{className:s()(m.a.itemLabel,m.a.itemLabelEllipsis)},l),r.a.createElement("span",{className:s()(m.a.itemText,m.a.itemTextEllipsis)},r.a.createElement("span",null,this.triggerText(a,n,i,f))),r.a.createElement("span",{className:"".concat(m.a.selectArrowWrapper," ").concat((u||d)&&m.a.isExpanded)},r.a.createElement("div",{className:m.a.cartDown}))),u&&this.dropdown())},t.prototype.dropdown=function(){var e=this,t=this.props,a=t.label,i=t.unit,o=t.from,l=t.to,u=this.state,f=u.start,p=u.end;return r.a.createElement("div",{className:m.a.inputBackWrapper,ref:function(t){return e.modalRef=t}},r.a.createElement("div",{className:s()(m.a.titleWrapper,m.a.customTitleWrapper)},a,"\u8303\u56f4",r.a.createElement("div",{className:s()(m.a.clearDivider,(f||p||o||l)&&m.a.show)},r.a.createElement("div",{className:m.a.clear,onClick:this.clearValue},Object(n.t)("\u6e05\u9664")))),r.a.createElement("div",{className:m.a.rangeWrapper},r.a.createElement("div",{className:m.a.rangeInputContainer,title:f?f+"":""},r.a.createElement(c.a,{autoComplete:"off",id:"start",className:m.a.rangeInput,value:f,maxLength:15,onChange:this.onStartChange,autoFocus:!0,onPressEnter:this.onSubmit}),r.a.createElement("label",{htmlFor:"start"},i)),r.a.createElement("span",{className:m.a.inputDivider}),r.a.createElement("div",{className:m.a.rangeInputContainer,title:p?p+"":""},r.a.createElement(c.a,{autoComplete:"off",id:"end",className:m.a.rangeInput,value:p,onChange:this.onEndChange,maxLength:15,onPressEnter:this.onSubmit}),r.a.createElement("label",{htmlFor:"end"},i))),r.a.createElement("div",{className:m.a.buttonGroup},r.a.createElement("div",{className:s()(m.a.button,d.a.newButton,d.a.primary,d.a.h28),onClick:this.onSubmit},Object(n.t)("\u786e\u5b9a")),r.a.createElement("div",{className:s()(m.a.button,d.a.newButton,d.a.default,d.a.h28),onClick:this.onReset},Object(n.t)("\u53d6\u6d88"))))},t.prototype.render=function(){var e=this,t=this.props.onClearProp,a=this.state,n=a.showDel,i=a.expanded;return r.a.createElement("div",{className:"".concat(m.a.root," newfilter-dropdown"),onMouseLeave:function(){return e.setState({showDel:!1})}},this.trigger(),(n||i)&&t&&r.a.createElement("a",{className:s()(m.a.clearButton,m.a.alignTop),onClick:t}))},t.prototype.triggerText=function(e,t,a,i){return e?t?"".concat(Number(e)/i).concat(Object(n.t)("\u81f3")).concat(Number(t)/i).concat(a||""):"".concat(Object(n.t)("\u5927\u4e8e\u7b49\u4e8e")).concat(Number(e)/i).concat(a||""):t?"".concat(Object(n.t)("\u5c0f\u4e8e\u7b49\u4e8e")).concat(Number(t)/i).concat(a||""):Object(n.t)("\u5168\u90e8")},t.prototype.componentDidMount=function(){this.props.expanded&&document.addEventListener("click",this.onHide,!1)},t.prototype.toggleExpand=function(e){this.state.expanded?this.onHide(e):this.onShow()},t.prototype.onHide=function(e){this.modalRef&&e.target&&e.target instanceof Element&&this.modalRef.contains(e.target)||(this.setState({expanded:!1}),document.removeEventListener("click",this.onHide,!1))},t.prototype.onShow=function(){this.setState({expanded:!0}),document.addEventListener("click",this.onHide,!1)},t.prototype.onStartChange=function(e){var t=this.props,a=t.isInteger,n=t.maxValue,i=t.minValue,r=a?/^([1-9]\d*|0)?$/:/^(\d+\.?\d*)$/,o=e.target.value;if(r.test(e.target.value)){if(n&&o>n)return void this.setState({start:n});if(i&&o<i)return void this.setState({start:i});this.setState({start:e.target.value})}else""===e.target.value&&this.setState({start:e.target.value})},t.prototype.onEndChange=function(e){var t=this.props,a=t.isInteger,n=t.maxValue,i=t.minValue,r=a?/^([1-9]\d*|0)?$/:/^(\d+\.?\d*)$/,o=e.target.value;if(r.test(e.target.value)){if(n&&o>n)return void this.setState({end:n});if(i&&o<i)return void this.setState({end:i});this.setState({end:e.target.value})}else""===e.target.value&&this.setState({end:e.target.value})},t.prototype.onSubmit=function(){var e=this.state,t=e.start,a=e.end,i=e.ride,r=this.props.onChange;t&&a&&Number(t)>Number(a)?Object(f.warning)(Object(n.t)("\u5f00\u59cb\u503c\u4e0d\u80fd\u5927\u4e8e\u7ed3\u675f\u503c")):(r(isNaN(Number(t))?"":Number(t)*i,isNaN(Number(a))?"":Number(a)*i),this.setState({expanded:!1}))},t.prototype.onReset=function(){var e=this.props,t=e.from,a=e.to,n=this.state.ride;this.setState({start:t&&Number(t)/n,end:a&&Number(a)/n,expanded:!1})},t.prototype.clearValue=function(e){var t=this.props.onChange;e.nativeEvent.stopPropagation(),this.setState({start:null,end:null},(function(){t("","")}))},t.defaultProps={isInteger:!0},t}(i.Component);t.default=v},te0o:function(e,t,a){"use strict";a.d(t,"p",(function(){return r})),a.d(t,"K",(function(){return s})),a.d(t,"o",(function(){return l})),a.d(t,"i",(function(){return c})),a.d(t,"J",(function(){return u})),a.d(t,"D",(function(){return d})),a.d(t,"C",(function(){return f})),a.d(t,"q",(function(){return p})),a.d(t,"r",(function(){return m})),a.d(t,"f",(function(){return h})),a.d(t,"g",(function(){return v})),a.d(t,"m",(function(){return g})),a.d(t,"n",(function(){return E})),a.d(t,"F",(function(){return b})),a.d(t,"G",(function(){return y})),a.d(t,"s",(function(){return S})),a.d(t,"t",(function(){return I})),a.d(t,"a",(function(){return T})),a.d(t,"b",(function(){return C})),a.d(t,"c",(function(){return P})),a.d(t,"k",(function(){return w})),a.d(t,"l",(function(){return D})),a.d(t,"h",(function(){return O})),a.d(t,"H",(function(){return R})),a.d(t,"j",(function(){return j})),a.d(t,"A",(function(){return k})),a.d(t,"v",(function(){return N})),a.d(t,"E",(function(){return A})),a.d(t,"u",(function(){return L})),a.d(t,"z",(function(){return F})),a.d(t,"x",(function(){return _})),a.d(t,"y",(function(){return M})),a.d(t,"w",(function(){return x})),a.d(t,"I",(function(){return B})),a.d(t,"d",(function(){return U})),a.d(t,"e",(function(){return W})),a.d(t,"B",(function(){return Y}));var n=a("Z4vw"),i=a("TLfn"),r=function(e,t,a,r){return void 0===a&&(a=!1),t===i.PAGE_TYPE.TEAM_VIEW?Object(n.get)("/external/collaboration/agile/api/team-view/filters"):t===i.PAGE_TYPE.ITERATION_ISSUE&&r?o(e,r.code,a):t===i.PAGE_TYPE.PRD_REQUIREMENT?Object(n.get)("/external/collaboration/api/project/".concat(e,"/issues/PRD_REQUIREMENT/filters"),a):Object(n.get)("/external/collaboration/api/project/".concat(e,"/issues/").concat(t,"/filters"),a)},o=function(e,t,a){return void 0===a&&(a=!1),Object(n.get)("/external/collaboration/api/project/".concat(e,"/iterations/").concat(t,"/").concat(i.PAGE_TYPE.ITERATION_ISSUE,"/filters"),a)},s=function(e,t,a,r){return Object(n.postJSON)("/external/collaboration/api/project/".concat(e,"/iterations/").concat(t,"/").concat(i.PAGE_TYPE.ITERATION_ISSUE,"/filters/").concat(a,"/shared-iteration"),r)},l=function(e,t,a,r){return t===i.PAGE_TYPE.TEAM_VIEW?Object(n.get)("/external/collaboration/agile/api/team-view/filters/conditions?".concat(Object(n.buildParams)(a))):t===i.PAGE_TYPE.ITERATION_ISSUE&&r?function(e,t,a){return Object(n.get)("/external/collaboration/api/project/".concat(e,"/iterations/").concat(t,"/").concat(i.PAGE_TYPE.ITERATION_ISSUE,"/filters/conditions?").concat(Object(n.buildParams)(a)))}(e,r.code,a):Object(n.get)("/external/collaboration/api/project/".concat(e,"/issues/").concat(t,"/filters/conditions?").concat(Object(n.buildParams)(a)))},c=function(e,t,a,r){return t===i.PAGE_TYPE.TEAM_VIEW?Object(n.postJSON)("/agile/api/team-view/filters/conditions",a):t===i.PAGE_TYPE.ITERATION_ISSUE&&r?function(e,t,a){return Object(n.postJSON)("/external/collaboration/api/project/".concat(e,"/iterations/").concat(t,"/").concat(i.PAGE_TYPE.ITERATION_ISSUE,"/filters/conditions"),a)}(e,r.code,a):t===i.PAGE_TYPE.PRD_REQUIREMENT?Object(n.postJSON)("/api/project/".concat(e,"/issues/REQUIREMENT/filters/conditions"),a):Object(n.postJSON)("/api/project/".concat(e,"/issues/").concat(t,"/filters/conditions"),a)},u=function(e,t,a){return Object(n.post)("/collaboration/api/project/".concat(e,"/user-settings/").concat(t),{value:a})},d=function(e,t){return Object(n.get)("/collaboration/api/project/".concat(e,"/user-settings?").concat(Object(n.buildParams)(t)))},f=function(e,t){return Object(n.get)("/external/collaboration/api/project/".concat(e,"/issues/").concat(t,"/filters/more-fields"))},p=function(e,t,a,i){return"project"===e?Object(n.patch)("/external/collaboration/api/project/".concat(t,"/issues/").concat(a,"/filters/").concat(i,"/pin")):Object(n.patch)("/external/collaboration/agile/api/team-view/filters/".concat(i,"/pin"))},m=function(e,t,a,i){return"project"===e?Object(n.patch)("/external/collaboration/api/project/".concat(t,"/issues/").concat(a,"/filters/").concat(i,"/pin")):Object(n.patch)("/external/collaboration/agile/api/team-view/filters/".concat(i,"/pin"))},h=function(e,t,a,i){return"project"===e?Object(n.patch)("/external/collaboration/api/project/".concat(t,"/issues/").concat(a,"/filters/").concat(i,"/unpin")):Object(n.patch)("/external/collaboration/agile/api/team-view/filters/".concat(i,"/unpin"))},v=function(e,t,a,i){return"project"===e?Object(n.patch)("/external/collaboration/api/project/".concat(t,"/issues/").concat(a,"/filters/").concat(i,"/unpin\n")):Object(n.patch)("/external/collaboration/agile/api/team-view/filters/".concat(i,"/unpin"))},g=function(e,t,a,r,o,s){return"project"===e?a===i.PAGE_TYPE.ITERATION_ISSUE&&s?function(e,t,a,r){return Object(n.postJSON)("/external/collaboration/api/project/".concat(e,"/iterations/").concat(t,"/").concat(i.PAGE_TYPE.ITERATION_ISSUE,"/filters/").concat(a,"/name"),r)}(t,s.code,r,o):Object(n.postJSON)("/api/project/".concat(t,"/issues/").concat(a,"/filters/").concat(r,"/name"),o):Object(n.postJSON)("/external/collaboration/agile/api/team-view/filters/".concat(r,"/name"),o)},E=function(e,t,a,i,r,o){return"project"===e?Object(n.postJSON)("/external/collaboration/api/project/".concat(t,"/issues/").concat(a,"/filters/").concat(i,"/name"),r):Object(n.postJSON)("/external/collaboration/agile/api/team-view/filters/".concat(i,"/name"),r)},b=function(e,t,a,r,o){return"project"===e?a===i.PAGE_TYPE.ITERATION_ISSUE&&o?function(e,t,a){return Object(n.del)("/external/collaboration/api/project/".concat(e,"/iterations/").concat(t,"/").concat(i.PAGE_TYPE.ITERATION_ISSUE,"/filters/").concat(a))}(t,o.code,r):Object(n.delJSON)("/external/collaboration/api/project/".concat(t,"/issues/").concat(a,"/filters/").concat(r)):Object(n.delJSON)("/external/collaboration/agile/api/team-view/filters/".concat(r))},y=function(e,t,a,i,r){return"project"===e?Object(n.delJSON)("/external/collaboration/api/project/".concat(t,"/issues/").concat(a,"/filters/").concat(i)):Object(n.delJSON)("/external/collaboration/agile/api/team-view/filters/".concat(i))},S=function(e,t,a,r,o,s){return"project"===e?a===i.PAGE_TYPE.ITERATION_ISSUE&&o?function(e,t,a,r){return Object(n.postJSON)("/external/collaboration/api/project/".concat(e,"/iterations/").concat(t,"/").concat(i.PAGE_TYPE.ITERATION_ISSUE,"/filters/").concat(a,"/shared-team"),r)}(t,o.code,r):Object(n.postJSON)("/api/project/".concat(t,"/issues/").concat(a,"/filters/").concat(r,"/shared-team")):Object(n.postJSON)("/external/collaboration/agile/api/team-view/filter/shareTeam",{filterId:r,projectIds:s})},I=function(e,t,a,i,r,o){return"project"===e?Object(n.postJSON)("/external/collaboration/api/project/".concat(t,"/issues/").concat(a,"/filters/").concat(i,"/shared-team")):Object(n.postJSON)("/external/collaboration/agile/api/team-view/filter/shareTeam",{filterId:i,projectIds:o})},T=function(e){return Object(n.del)("/external/collaboration/agile/api/team-view/filter/".concat(e,"/cancelShareTeam"))},C=function(e,t,a){return Object(n.post)("/external/collaboration/api/project/".concat(e,"/iterations/").concat(t,"/ITERATION_ISSUE/filters/").concat(a,"/noShare"))},P=function(e,t,a){return Object(n.post)("/external/collaboration/api/project/".concat(e,"/issues/").concat(t,"/filters/").concat(a,"/noShare"))},w=function(e,t,a,r,o){return"project"===e?a===i.PAGE_TYPE.ITERATION_ISSUE&&o?function(e,t,a,r){return Object(n.patch)("/external/collaboration/api/project/".concat(e,"/iterations/").concat(t,"/").concat(i.PAGE_TYPE.ITERATION_ISSUE,"/filters/").concat(a,"/default"),r)}(t,o.code,r):Object(n.patchJSON)("/external/collaboration/api/project/".concat(t,"/issues/").concat(a,"/filters/").concat(r,"/default")):Object(n.patch)("/external/collaboration/agile/api/team-view/filters/".concat(r,"/default"))},D=function(e,t,a,i,r){return"project"===e?Object(n.patchJSON)("/external/collaboration/api/project/".concat(t,"/issues/").concat(a,"/filters/").concat(i,"/default")):Object(n.patch)("/external/collaboration/agile/api/team-view/filters/".concat(i,"/default"))},O=function(e,t,a,r,o){return"project"===e?a===i.PAGE_TYPE.ITERATION_ISSUE&&o?function(e,t,a){return Object(n.postJSON)("/external/collaboration/api/project/".concat(e,"/iterations/").concat(t,"/").concat(i.PAGE_TYPE.ITERATION_ISSUE,"/filters"),a)}(t,o.code,r):Object(n.postJSON)("/external/collaboration/api/project/".concat(t,"/issues/").concat(a,"/filters"),r):Object(n.postJSON)("/external/collaboration/agile/api/team-view/filters",r)},R=function(e,t,a,r,o,s){return"project"===e?a===i.PAGE_TYPE.ITERATION_ISSUE&&s?function(e,t,a,r){return Object(n.postJSON)("/external/collaboration/api/project/".concat(e,"/iterations/").concat(t,"/").concat(i.PAGE_TYPE.ITERATION_ISSUE,"/filters/").concat(a,"/content"),r)}(t,s.code,r,{content:o}):Object(n.postJSON)("/external/collaboration/api/project/".concat(t,"/issues/").concat(a,"/filters/").concat(r,"/content"),{content:o}):Object(n.postJSON)("/agile/api/team-view/filters/".concat(r,"/content"),{content:o})},j=function(e,t){return t===i.PAGE_TYPE.PRD_REQUIREMENT?Object(n.get)("/external/dm/api/issues/distinct-all-status"):Object(n.get)("/external/collaboration/api/project/".concat(e,"/issues/all-status?").concat(Object(n.buildParams)({issueType:t})))},k=function(){return Object(n.get)("/external/collaboration/agile/api/team-view/issue-statuses")},N=function(){return Object(n.get)("/agile/api/team-view/filters/user-settings")},A=function(e){return Object(n.put)("/agile/api/team-view/filters/user-settings?".concat(Object(n.buildParams)({filterFixed:e})))},L=function(){return Object(n.get)("/external/collaboration/agile/api/team-view/fields/list")},F=function(){return Object(n.get)("/external/collaboration/agile/api/team-view/more-fields")},_=function(){return Object(n.get)("/agile/api/team-view/issue-types?keyword=").then((function(e){return e.data=e.data.filter((function(e){return"\u53f2\u8bd7"!==e.name})),e}))},M=function(){return Object(n.get)("/agile/api/team-view/labels")},x=function(e){return void 0===e&&(e=!1),Object(n.get)("/collaboration/api/team-view/issues/defects/types",e)},B=function(e,t,a,r,o){return t===i.PAGE_TYPE.ITERATION_ISSUE&&o?function(e,t,a,r){return Object(n.postJSON)("/external/collaboration/api/project/".concat(e,"/iterations/").concat(t,"/").concat(i.PAGE_TYPE.ITERATION_ISSUE,"/filters/").concat(a,"/updateFilterSpread"),r)}(e,o.code,a,r):Object(n.postJSON)("/external/collaboration/api/project/".concat(e,"/issues/").concat(t,"/filters/").concat(a,"/updateFilterSpread?").concat(Object(n.buildParams)(r)))},U=function(e){return Object(n.get)("/external/dm/agile/api/team-view/requirement/export-fields?issueTypeIds=".concat(e))},W=function(e){return Object(n.postJSON)("/external/dm/api/issues/REQUIREMENT/export",e)},Y=function(e){return Object(n.get)("/external/dm/api/issues/export/".concat(e))}},uEQr:function(e,t,a){"use strict";var n,i,r,o,s;a.r(t),a.d(t,"MilestoneType",(function(){return n})),a.d(t,"TimeView",(function(){return i})),a.d(t,"Direct",(function(){return r})),a.d(t,"AttributeType",(function(){return o})),a.d(t,"UpdateItemActionType",(function(){return s})),function(e){e.todo="todo",e.delay="delay",e.delayDone="delayDone",e.done="done"}(n||(n={})),function(e){e.day="day",e.week="week",e.month="month"}(i||(i={})),function(e){e.above="above",e.below="below"}(r||(r={})),function(e){e.startDate="START_DATE",e.dueDate="DUE_DATE",e.status="STATUS",e.assignee="ASSIGNEE",e.progress="PROGRESS"}(o||(o={})),function(e){e.ATTR_CHANGE="ATTR_CHANGE",e.DELETE="DELETE",e.CREATE_SUB="CREATE_SUB",e.CHANGE_PARENT="CHANGE_PARENT",e.SORT="SORT"}(s||(s={}))},uKPp:function(e,t,a){"use strict";a("RW0V"),a("ioFf"),a("0l/t"),a("mYba"),a("jm62");var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.BASE_STATUS_TYPE=t.FIELD_TYPE=t.LOG_TYPE=t.ACTION=t.ITEMS_ACTION=void 0;var i=n(a("lSNA")),r=a("nuIr");function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){(0,i.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}t.ITEMS_ACTION={DELETE:"DELETE",UNLINK:"UNLINK",DETAIL:"DETAIL",OPEN_IN_NEW_WINDOW:"OPEN_IN_NEW_WINDOW",COPY_PATH:"COPY_PATH"};t.ACTION={GET_EPIC_STATUS:"AUTO.GET.STATUS",UPDATE_EPIC_SCHEME:"AUTO.GET.EPIC_SCHEME",UPDATE_HIDDEN_FILE_DIRS:"AUTO.GET.HIDDEN.FILE.DIRS",UPDATE_MORE_FILTER_FIELDS:"AUTO.GET.UPDATE_MORE_FILTER_FIELDS"};var l=s({},r.LOG_TYPE);t.LOG_TYPE=l;var c=s({},r.BASE_FIELD_TYPE);t.FIELD_TYPE=c;var u=s({},r.STATUS_TYPE);t.BASE_STATUS_TYPE=u},uTi8:function(e,t,a){"use strict";var n=a("cDcd"),i=a.n(n),r=a("mVeg"),o=a("RoFc"),s=a("O9Lt"),l=a.n(s),c=a("BKNj"),u=a("sWxF"),d=a("K2gz"),f=a.n(d),p=a("xwLU"),m=a.n(p),h=a("IuC+"),v=a.n(h),g=a("hevv"),E=a.n(g),b=function(){return(b=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},y=function(e,t,a,n){return new(a||(a=Promise))((function(i,r){function o(e){try{l(n.next(e))}catch(t){r(t)}}function s(e){try{l(n.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,s)}l((n=n.apply(e,t||[])).next())}))},S=function(e,t){var a,n,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(l){return function(s){if(a)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(a=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(l){s=[6,l],n=0}finally{a=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},I=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(a[n[i]]=e[n[i]])}return a},T=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},C=Object(n.forwardRef)((function(e,t){var a=e.dataFetching,n=e.items,o=e.value,s=e.isMultiple,c=e.changeFocusIndex,u=e.mouseFocusEnable,d=e.setMouseFocusEnable,f=e.onListScroll,p=e.onSelect,h=e.focusIndex;return i.a.createElement("div",{className:m.a.list,onScroll:f,ref:t,onMouseMove:function(){d(!0)},onMouseLeave:function(){d(!1),c(void 0)}},!a&&n.length<1&&i.a.createElement("div",{className:m.a.noSearchResult},Object(r.t)("\u65e0\u5339\u914d\u7684\u72b6\u6001")),n.map((function(e,t){return i.a.createElement("div",{key:e.id,onMouseEnter:function(){return u&&c(t)}},i.a.createElement(P,{item:e,value:o,isMultiple:s,onSelect:p,focused:h===t}))})),a&&i.a.createElement(l.a,{show:!0}))})),P=Object(n.memo)((function(e){var t,a=e.value,n=e.item,r=e.isMultiple,o=e.onSelect,s=e.focused,l=function(){return r?Array.isArray(n.id)?a.some((function(e){return n.id.some((function(t){return t===e}))})):a.some((function(e){return e===n.id})):n.id===a};return i.a.createElement("div",{className:f()(v.a.item,l()&&v.a.checked,s&&v.a.focus),title:n.text,onClick:function(){return o(n)}},i.a.createElement("span",{className:f()(E.a.icon,E.a[null===(t=null===n||void 0===n?void 0:n.type)||void 0===t?void 0:t.toLowerCase()])}),i.a.createElement("span",{className:v.a.content},n.text),l()&&i.a.createElement("span",{className:f()(v.a.checked)}))}));t.a=Object(n.memo)((function(e){var t=e.projectId,a=e.issueTypeIds,s=e.value,l=I(e,["projectId","issueTypeIds","value"]),d=T(Object(n.useState)([]),2),f=d[0],p=d[1],m=T(Object(n.useState)([]),2),h=m[0],v=m[1],g=T(Object(n.useState)(""),2),E=g[0],P=g[1],w=T(Object(n.useState)(!1),2),D=w[0],O=w[1],R=T(Object(n.useState)(!1),2),j=R[0],k=R[1],N=function(){return y(void 0,void 0,void 0,(function(){var e,n,i;return S(this,(function(r){switch(r.label){case 0:k(!0),r.label=1;case 1:return r.trys.push([1,3,4,5]),j?[2]:[4,Object(u.getAvailableStatus)(t,{issueTypeIds:a})];case 2:return e=r.sent(),n=e.code,i=e.data,0===n&&(p(null===(o=i)||void 0===o?void 0:o.map((function(e){var t,a,n;return b(b({},e),{id:null!==(t=null===e||void 0===e?void 0:e.id)&&void 0!==t?t:0,value:null!==(a=null===e||void 0===e?void 0:e.id)&&void 0!==a?a:0,text:null!==(n=null===e||void 0===e?void 0:e.name)&&void 0!==n?n:"0"})}))),O(!0)),[3,5];case 3:return r.sent(),[3,5];case 4:return k(!1),[7];case 5:return[2]}var o}))}))};Object(n.useEffect)((function(){t&&Array.isArray(a)&&a.length>0&&N()}),[a,t]),Object(n.useEffect)((function(){var e=f;E&&(e=null===f||void 0===f?void 0:f.filter((function(e){var t,a;return null===(a=null===(t=null===e||void 0===e?void 0:e.text)||void 0===t?void 0:t.toLowerCase())||void 0===a?void 0:a.includes(E.toUpperCase())}))),v(e)}),[f,E]);return i.a.createElement(c.default,b({dataInited:D,value:s,items:h,placeholder:Object(r.t)("\u8bf7\u9009\u62e9\u72b6\u6001"),dataFetching:j,CustomPanel:C,Trigger:o.a,onSearch:function(e){P(e)}},l))}))},uk0h:function(e,t,a){"use strict";a.r(t);var n=a("cDcd"),i=a.n(n),r=a("h74D"),o=a("es6E"),s=a("O9Lt"),l=a.n(s),c=a("w3Wo"),u=a("TNCg"),d=a("9+7+"),f=a("Mh+3"),p=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(t,a)};return function(t,a){if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),m=function(){return(m=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},h=function(e,t,a,n){var i,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,a,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(r<3?i(o):r>3?i(t,a,o):i(t,a))||o);return r>3&&o&&Object.defineProperty(t,a,o),o},v=function(e,t,a,n){return new(a||(a=Promise))((function(i,r){function o(e){try{l(n.next(e))}catch(t){r(t)}}function s(e){try{l(n.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,s)}l((n=n.apply(e,t||[])).next())}))},g=function(e,t){var a,n,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(l){return function(s){if(a)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(a=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(l){s=[6,l],n=0}finally{a=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},E=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},b=Object(r.connect)(null,{updateCollaborationSettings:u.updateCurrentProjectCooperateSettings});t.default=function(e){var t=function(t){function a(e){var a=t.call(this,e)||this;return a.getCooperateSettings=function(e){return v(a,void 0,void 0,(function(){var t,a,n,i,r,s,l,u,d;return g(this,(function(p){switch(p.label){case 0:if(t=this.props,a=t.updateCollaborationSettings,n=t.fromDM,i=t.dmErrorCallback,r=this.getProjectKey(this.props.targetData),e)return l=e[f.default.fetchCollaborationSettings],u=e[f.default.fetchIssueTypes],d=e[f.default.fetchGlobalProjectCollaborationSplitType],0===(null===l||void 0===l?void 0:l.code)&&0===(null===u||void 0===u?void 0:u.code)&&0===(null===d||void 0===d?void 0:d.code)&&(/^\/p\/[^/]+\//.test(location.pathname)&&a(m(m({},l.data),{ISSUE_TYPES:u.data,PROJECT_ISSUE_SPLIT_TYPE:d.data})),Object(o.getStore)(o.StoreName.ISSUES).updateCooperateSettings(r,m(m({},l.data),{ISSUE_TYPES:u.data,PROJECT_ISSUE_SPLIT_TYPE:d.data}))),[2];p.label=1;case 1:return p.trys.push([1,3,,4]),[4,Promise.all([Object(c.fetchCollaborationSettings)(r,!n),Object(c.fetchIssueTypes)(r,!0),Object(c.fetchGlobalProjectCollaborationSplitType)(r,!0)])];case 2:return s=E.apply(void 0,[p.sent(),3]),l=s[0].data,u=s[1].data,d=s[2].data,/^\/p\/[^/]+\//.test(location.pathname)&&a(m(m({},l),{ISSUE_TYPES:u,PROJECT_ISSUE_SPLIT_TYPE:d})),Object(o.getStore)(o.StoreName.ISSUES).updateCooperateSettings(r,m(m({},l),{ISSUE_TYPES:u,PROJECT_ISSUE_SPLIT_TYPE:d})),[3,4];case 3:return p.sent(),n&&i(),[3,4];case 4:return[2]}}))}))},a.getProjectKey=function(e){var t,n,i,r;if(null===(t=a.props)||void 0===t?void 0:t.fromDM)return null===(r=null===(i=null===(n=a.props)||void 0===n?void 0:n.dmData)||void 0===i?void 0:i.targetProject)||void 0===r?void 0:r.name;if(e&&e.useOwnProjectName&&e.projectName)return null===e||void 0===e?void 0:e.projectName;var o=location.pathname.match(/\/p\/([^/]+)/);return o?o[1]:null===e||void 0===e?void 0:e.projectName},a.getCurrentProjectCooperateSettings=function(){var e,t,n,i,r=(null===(e=a.props)||void 0===e?void 0:e.fromDM)?null===(i=null===(n=null===(t=a.props)||void 0===t?void 0:t.dmData)||void 0===n?void 0:n.targetProject)||void 0===i?void 0:i.name:a.getProjectKey(a.props.targetData);return o.StoreMobxApi.toJS(Object(o.getStore)(o.StoreName.ISSUES).cooperateSettings[r])},a}return p(a,t),a.prototype.render=function(){var t=this.getCurrentProjectCooperateSettings();return t&&(d.windowStorage.setItem("templateId",t.template.id),d.windowStorage.setItem("originTemplateId",t.template.originTemplateId)),t?i.a.createElement(e,m({},this.props,{currentProjectCooperateSettings:t})):i.a.createElement(l.a,{show:!0})},a.prototype.componentDidMount=function(){var e=this.props.zipRes,t=this.getCurrentProjectCooperateSettings();t&&Object.keys(t).length||this.getCooperateSettings(0===(null===e||void 0===e?void 0:e.code)&&e.data)},a=h([o.StoreMobxReactApi.observer],a)}(i.a.Component);return b(t)}},v6U7:function(e,t,a){"use strict";a.r(t);var n=a("mVeg"),i=a("cDcd"),r=a.n(i),o=a("A3jt"),s=a.n(o),l=a("7FZc"),c=a("K2gz"),u=a.n(c),d=a("vih4"),f=a.n(d),p=a("LvDl"),m=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},h=function(e,t,a){if(a||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))};t.default=Object(i.memo)((function(e){var t=e.value,a=e.items,i=e.active,o=e.disabled,c=e.initialSelectedItem,d=void 0===c?{}:c,v=e.isMultiple,g=e.placeholder,E=void 0===g?Object(n.t)("\u672a\u6307\u5b9a"):g,b=e.isSpread,y=void 0===b?0:b,S=e.toolTip,I=function(){return v?(null===t||void 0===t?void 0:t.length)>0:!!t},T=function(){var e,i=a;if(Array.isArray(d)?i=Object(p.uniqBy)(h(h([],m(a),!1),m(d),!1),"id"):"object"===typeof d&&d&&(i=Object(p.uniqBy)(h(h([],m(a),!1),[d],!1),"id")),v)e=null===t||void 0===t?void 0:t.map((function(e){var t;return null===(t=a.find((function(t){return t.id===e})))||void 0===t?void 0:t.text})).filter((function(e){return!!e}));else{var r=i.find((function(e){return e.id===t}));e=r?[r.text]:[]}return e.join(",")||E||Object(n.t)("\u672a\u6307\u5b9a")};return r.a.createElement(r.a.Fragment,null,S?r.a.createElement(l.TooltipTrigger,{title:S},r.a.createElement("div",{className:u()(f.a.trigger,i&&f.a.active,o&&f.a.disabled),title:T()},y?r.a.createElement(s.a,null):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:u()(f.a.content,!I()&&f.a.placeholder)},T()||E),r.a.createElement("span",{className:u()(f.a.caret)})))):r.a.createElement("div",{className:u()(f.a.trigger,i&&f.a.active,o&&f.a.disabled),title:T()},y?r.a.createElement(s.a,null):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:u()(f.a.content,!I()&&f.a.placeholder)},T()||E),r.a.createElement("span",{className:u()(f.a.caret)}))))}))},vPNc:function(e,t,a){"use strict";a.d(t,"a",(function(){return ne}));var n=a("nuIr"),i=a("cDcd"),r=a.n(i),o=a("TGxl"),s=a("s06w"),l=a.n(s),c=a("885C"),u=a("Gup7"),d=a.n(u),f=a("Mdvu"),p=a("a4iY"),m=a.n(p),h=a("QWzU"),v=a("DlAp"),g=a("YstK"),E=a("9Vkv"),b=a.n(E),y=a("fJrm"),S=a.n(y),I=a("5JFE"),T=a("mVeg"),C=a("XXMN"),P=a("aHEs"),w=a("rkME"),D=a("DKcV"),O=a("P0O0"),R=a("sftu"),j=a.n(R),k=a("iz+V"),N=a.n(k),A=a("EAU0"),L=a.n(A),F=a("EPIV"),_=a.n(F),M=a("1Epj"),x=a("te0o"),B=function(){return(B=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},U=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},W=function(e,t,a){if(a||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},Y=Object(i.forwardRef)((function(e,t){var a=e.setAll,n=e.issueList,o=U(Object(i.useState)(!1),2),s=o[0],l=o[1],c=U(Object(i.useState)([]),2),u=c[0],d=c[1],f=U(Object(i.useState)({}),2),p=f[0],m=f[1],h=U(Object(i.useState)({}),2),v=h[0],g=h[1],E=U(Object(i.useState)({}),2),b=E[0],y=E[1],S=Object(i.useRef)();Object(i.useEffect)((function(){l(!0);var e=n.filter((function(e){return["intention","prd_requirement","operational_requirement"].includes(e.type)})).map((function(e){return e.id})).join(",");Object(x.d)(e).then((function(e){l(!1),d(Object(M.dataFilter)(e.data)),y(Object(M.fieldList)(e.data))}))}),[n]),Object(i.useEffect)((function(){u.length&&(m(Object(M.GroupData)(u)),g(Object(M.allGroupCheck)(u)))}),[u]);var T=function(e){var t={};Object.keys(Object(M.allGroupCheck)(u)).forEach((function(a){t[a]=e})),g((function(e){return B(B({},e),t)}))},C=function(e){var t={};Object(M.typeFilter)(u).forEach((function(a){t["".concat(a,"checkList")]=e?Object(M.allChooes)(u,a):[]})),m((function(e){return B(B({},e),t)}))},P=function(e,t){var a="".concat(t,"checkList");m((function(t){var n;return B(B({},t),((n={})[a]=e,n))}))},w=function(){var e=[],t=[];Object.keys(p).forEach((function(a){"systemcheckList"!==a?e.push.apply(e,W([],U(p[a]),!1)):t.push.apply(t,W([],U(p[a]),!1))}));var a=[],n=[];t.forEach((function(e){b.systemfield.forEach((function(t){e===t.key&&n.push(t)}))})),e.forEach((function(e){b.customfield.forEach((function(t){e===t.issueFieldIds[0]&&a.push(t)}))}));var i=b.defaultCHoose?b.defaultCHoose:[];return W(W(W([],U(n),!1),U(a),!1),U(i),!1)};return Object(i.useImperativeHandle)(t,(function(){return{allParentNode:T,allSonNode:C,getEndCheck:w}})),r.a.createElement("div",{className:_.a.exportAttr},r.a.createElement(I.Spin,{spinning:s},r.a.createElement("div",{ref:S,className:_.a.exportContent},Object.keys(p).length>0&&u.map((function(e,t){return r.a.createElement("div",{key:t,className:_.a.contair},r.a.createElement("div",{className:_.a.leftContair},r.a.createElement("span",null,e[Object.keys(e)[0]]),r.a.createElement(I.Checkbox,{checked:v["".concat(Object.keys(e)[0],"Checked")],onChange:function(t){return function(e,t){e.target.checked||a();var n="".concat(t,"Checked");e.target.checked?P(Object(M.allChooes)(u,t),t):P([],t),g((function(t){var a;return B(B({},t),((a={})[n]=e.target.checked,a))}))}(t,Object.keys(e)[0])}},"\u5168\u9009")),r.a.createElement("div",{className:_.a.rightContair},r.a.createElement(I.Checkbox.Group,{options:e.groupAttribute,value:p["".concat(Object.keys(e)[0],"checkList")],onChange:function(t){return function(e,t){a(),P(e,t);var n="".concat(t,"Checked");e.length===Object(M.allChooes)(u,t).length?g((function(e){var t;return B(B({},e),((t={})[n]=!0,t))})):g((function(e){var t;return B(B({},e),((t={})[n]=!1,t))}))}(t,Object.keys(e)[0])}})))})))))})),H=a("xgZS"),V=a("zmh9"),G=a.n(V),K=a("h74D"),z=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},q=function(e,t,a){if(a||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))};var Z=Object(K.connect)((function(e){var t,a;return{issueList:null===(t=null===e||void 0===e?void 0:e.APP)||void 0===t?void 0:t.issueList,pager:null===(a=null===e||void 0===e?void 0:e.REQUIREMENTS)||void 0===a?void 0:a.requirementsProductPager}}))((function(e){var t=e.show,a=e.onShowResult,n=e.slotProps,o=e.onClose,s=e.issueList,l=e.pager,c=z(Object(i.useState)(!1),2),u=c[0],d=c[1],f=z(Object(i.useState)(1),2),p=f[0],m=f[1],h=z(Object(i.useState)(!1),2),v=h[0],g=h[1],E=Object(i.useRef)(null);return r.a.createElement(j.a,{show:t,onHide:o,className:N.a.exportModal,closeButton:!0},r.a.createElement(I.Spin,{spinning:v},r.a.createElement("div",{className:N.a.exportSelect},r.a.createElement("span",{className:N.a.exportSelectTitle},"\u9009\u62e9\u5bfc\u51fa\u5c5e\u6027"),r.a.createElement(L.a,{onChange:function(e){return function(e){var t=e.target.checked;d(t),E.current.allParentNode(t),E.current.allSonNode(t)}(e)},checked:u},"\u4e00\u952e\u5168\u9009")),r.a.createElement("div",{className:N.a.exportBody},r.a.createElement(Y,{ref:E,setAll:function(e){return d(e)},issueList:s})),r.a.createElement("div",{className:N.a.exportSelect},r.a.createElement("span",{className:N.a.exportSelectTitle},"\u9009\u62e9\u5bfc\u51fa\u7c7b\u578b"),r.a.createElement(I.Radio.Group,{value:p,onChange:function(e){var t;return m(null===(t=null===e||void 0===e?void 0:e.target)||void 0===t?void 0:t.value)}},r.a.createElement(I.Radio,{value:1},"\u5bfc\u51fa\u5f53\u524d\u9875\u4e8b\u9879"),r.a.createElement(I.Radio,{value:2},"\u5bfc\u51fa\u7b5b\u9009\u7684\u5168\u90e8\u4e8b\u9879"))),r.a.createElement("div",{className:N.a.exportFooter},r.a.createElement(G.a,{onClick:function(){var e,t,i,r=E.current.getEndCheck();if(r&&0!==r.length){var c=s.find((function(e){return"prd_requirement"===(null===e||void 0===e?void 0:e.type)})),u={fields:r,content:{conditions:q(q([],z((null===(e=null===n||void 0===n?void 0:n.activeFilterContent)||void 0===e?void 0:e.conditions)||[]),!1),[{key:"ISSUE_TYPE_ID",value:[null===c||void 0===c?void 0:c.id]},{key:"PROJECT_ID",value:[null===(t=null===n||void 0===n?void 0:n.currentProject)||void 0===t?void 0:t.id]}],!1),sort:null===(i=null===n||void 0===n?void 0:n.activeFilterContent)||void 0===i?void 0:i.sort,viewValue:"LIST"}};1===p&&(u.page=null===l||void 0===l?void 0:l.page,u.pageSize=null===l||void 0===l?void 0:l.pageSize),g(!0),Object(x.e)(u).then((function(e){0===(null===e||void 0===e?void 0:e.code)&&(a(e.data.id),o(),d(!1))})).finally((function(){return g(!1)}))}else Object(H.warning)("\u8bf7\u9009\u62e9\u9700\u8981\u5bfc\u51fa\u7684\u5b57\u6bb5")}},"\u5bfc\u51fa"),r.a.createElement(G.a,{onClick:o,empty:!0},"\u5173\u95ed"))))})),J=a("s/lc"),X=a.n(J),Q=a("Myje"),$=function(){return($=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},ee=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},te=function(e){var t=e.projectPath,a=e.currentProject,s=e.currentProjectCooperateSettings,u=e.user,p=e.issueType,E=e.isPermissible,y=Object(Q.a)(e),R=ee(Object(o.e)({identity:"",slotVisible:!1}),2),j=R[0],k=R[1],N=j.identity,A=j.slotVisible,L=ee(Object(i.useState)(!1),2),F=L[0],_=L[1],M=ee(Object(i.useState)(!1),2),B=M[0],U=M[1],W={status:"",count:0,errorMsg:"",file:{name:"",url:""},currentExportId:void 0},Y=ee(Object(i.useState)(),2),H=Y[0],V=Y[1],G=ee(Object(i.useState)(W),2),K=G[0],z=G[1],q=Object(i.useContext)(v.b).state,J=q.activeFilterContent,te=(q.customParams.tableView||{}).tableViewType,ae=s.DEFECT===n.MODULE_SWITCH.OPENED&&E([{function:D.ProjectPermissionFunction.PROJECT_ISSUE,action:D.ProjectPermissionAction.CREATE}]),ne=function(e){H&&clearTimeout(H),Object(x.B)(e).then((function(t){var a=t.data;if("PROCESSING"===a.status){var n=setTimeout((function(){return ne(e)}),1e3);V(n)}else z({errorMsg:a.error_message,count:a.succeed_rows,status:a.succeed?"success":"error",file:{name:a.file_name,url:"/external/dm/api/issues/export/".concat(e,"/download")},currentExportId:void 0})}))};return r.a.createElement(r.a.Fragment,null,r.a.createElement(l.a,{projectPath:t,currentProject:a,currentProjectCooperateSettings:s},p===g.ISSUE_TYPE.REQUIREMENT?r.a.createElement(m.a,{currentProject:a,handleClick:function(e){f.default.emit(f.EventBusType.Filter,f.EventBusKeys.filterCreateIssue,e)},currentProjectCooperateSettings:s}):null,p===g.ISSUE_TYPE.PRD_REQUIREMENT?r.a.createElement(w.CurrentUserResourcePermission,{resourceType:"project",resourceId:a.id,action:O.RelationRequirementPermissionAction.CREATE,noPermissibleRender:r.a.createElement(I.Button,{type:"primary",size:"small",icon:r.a.createElement(C.Add,null),disabled:!0},Object(T.t)("\u5feb\u6377\u65b0\u5efa\u4ea7\u54c1\u9700\u6c42"))},r.a.createElement(I.Button,{type:"primary",size:"small",icon:r.a.createElement(C.Add,null),onClick:function(){Object(P.fetchSystemsByProjectId)(null===a||void 0===a?void 0:a.id,"").then((function(e){var t,a;1===e.data.length?Object(P.getGroupSystemId)(null===(a=null===(t=e.data)||void 0===t?void 0:t[0])||void 0===a?void 0:a.systemId).then((function(e){var t=e.data,a=t.product_group,n=t.systems,i=t.product_system_groups;window.open("/requiremanage?type=SELF&autoCreateType=prd_requirement&systems_id=".concat(null===n||void 0===n?void 0:n.refId,"&systems_name=").concat(null===n||void 0===n?void 0:n.name,"&product_group_id=").concat(null===a||void 0===a?void 0:a.refId,"&product_system_groups_id=").concat(null===i||void 0===i?void 0:i.refId),"_blank")})):window.open("/requiremanage?type=SELF&autoCreateType=prd_requirement","_blank")}))}},Object(T.t)("\u5feb\u6377\u65b0\u5efa\u4ea7\u54c1\u9700\u6c42"))):null,p===g.ISSUE_TYPE.PRD_REQUIREMENT?r.a.createElement(I.Button,{type:"primary",size:"small",style:{marginLeft:"8px"},onClick:function(){return _(!0)}},Object(T.t)("\u5bfc\u51fa\u9700\u6c42")):null,p===g.ISSUE_TYPE.ASSIGNMENT?r.a.createElement(b.a,{currentProject:a,handleClick:function(e){f.default.emit(f.EventBusType.Filter,f.EventBusKeys.filterCreateIssue,e)},currentProjectCooperateSettings:s}):null," ",p===g.ISSUE_TYPE.DEFECT?r.a.createElement(I.Button,{type:"primary",size:"small",icon:r.a.createElement(C.Add,null),disabled:!ae,onClick:function(){ae&&f.default.emit(f.EventBusType.Filter,f.EventBusKeys.filterCreateIssue)}},Object(T.t)("\u521b\u5efa\u7f3a\u9677")):null,"ALL"===p?r.a.createElement(S.a,{currentProject:a,handleClick:function(e){f.default.emit(f.EventBusType.Filter,f.EventBusKeys.filterCreateIssue,e)},currentProjectCooperateSettings:s}):null,"ALL"!==p&&p!==g.ISSUE_TYPE.PRD_REQUIREMENT?r.a.createElement(c.ThemeConsumer,null,(function(e){var t=e.hiddenFolderDirs;return r.a.createElement(d.a,{tableViewType:te,activeFilterContent:J,type:p,currentProject:a,currentProjectCooperateSettings:s,callback:function(){f.default.emit(f.EventBusType.Filter,f.EventBusKeys.filterReloadTable)},slotCallback:function(e){return k({identity:e,slotVisible:!0})},userId:u.id,dir:t&&t[n.HIDDEN_FILE_TYPE.REQUIREMENTS]&&t[n.HIDDEN_FILE_TYPE.REQUIREMENTS].file_id})})):null),r.a.createElement(h.default,{slotVisible:A,context:{projectId:a.id},identity:N,onClose:function(){return k({slotVisible:!1})}}),F&&r.a.createElement(Z,{show:F,onClose:function(){return _(!1)},onShowResult:function(e){U(!0),ne(e)},slotProps:y}),r.a.createElement(X.a,$({type:"REQUIREMENT"},K,{show:B,onHide:function(){U(!1),z(W)}})))},ae=function(){return(ae=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},ne=[n.ISSUE_TYPE.REQUIREMENT,n.ISSUE_TYPE.ASSIGNMENT,n.ISSUE_TYPE.DEFECT,n.ISSUE_TYPE.PRD_REQUIREMENT,"ALL"];t.b=function(e){var t=e.issueType;return ne.includes(t)?r.a.createElement(te,ae({},e)):r.a.createElement(r.a.Fragment,null)}},vUV6:function(e,t,a){"use strict";a("I5cv"),a("RW0V"),a("ioFf"),a("0l/t"),a("mYba"),a("jm62"),a("EK0E"),a("XfO3"),a("Btvt"),a("yt8O"),a("rGqo");var n=a("TqRt"),i=a("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("f3/d"),a("pIFo");var r,o,s,l=n(a("lSNA")),c=n(a("lwsE")),u=n(a("W8MJ")),d=n(a("PJYZ")),f=n(a("7W2i")),p=n(a("a1gu")),m=n(a("Nsbk")),h=a("mVeg"),v=L(a("cDcd")),g=n(a("17x9")),E=n(a("O9Lt")),b=n(a("jxzD")),y=n(a("9Aei")),S=n(a("LD9k")),I=n(a("G0so")),T=n(a("K2gz")),C=a("dtw8"),P=a("xgZS"),w=a("nuIr"),D=a("Z4vw"),O=a("TJpk"),R=L(a("v3Uf")),j=a("w3Wo"),k=a("17N+"),N=n(a("TT2u"));function A(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(A=function(e){return e?a:t})(e)}function L(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!==typeof e)return{default:e};var a=A(t);if(a&&a.has(e))return a.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=r?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}return n.default=e,a&&a.set(e,n),n}function F(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function _(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?F(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):F(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function M(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,m.default)(e);if(t){var i=(0,m.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,p.default)(this,a)}}var x=(0,R.default)(r=(0,N.default)((s=o=function(e){(0,f.default)(a,e);var t=M(a);function a(e){var n;return(0,c.default)(this,a),(n=t.call(this,e)).getSubIssueCode=function(){return n.props.params.subIssueCode},n.handleFullScreenChange=function(e){n.setState({isFullScreen:e})},n.state={detailInfo:void 0,issueType:void 0,isFullScreen:(0,k.getIsSlideFullScreen)()},n.updateCallback=n.updateCallback.bind((0,d.default)(n)),n.refreshCallback=n.refreshCallback.bind((0,d.default)(n)),n.getSpec=n.getSpec.bind((0,d.default)(n)),n}return(0,u.default)(a,[{key:"getSpec",value:function(){var e,t=this.state,a=t.detailInfo,n=t.issueType,i=this.props,r=i.params,o=i.issueList,s=i.largeSize;switch(n){case w.ISSUE_TYPE.REQUIREMENT:e=v.default.createElement("div",{id:"wm-spec",className:I.default.detailRoot},v.default.createElement(b.default,{updateCallback:this.updateCallback,refreshCallback:this.refreshCallback,expanded:s,params:r,detailInfo:a,requirementList:o,issueCode:this.getSubIssueCode(),issueTypeDetail:a.issueTypeDetail,onFullScreenChange:this.handleFullScreenChange,onCodeChange:this.props.onCodeChange,targetData:this.props.targetData}));break;case w.ISSUE_TYPE.DEFECT:e=v.default.createElement("div",{id:"wm-spec",className:I.default.detailRoot},v.default.createElement(y.default,{updateCallback:this.updateCallback,refreshCallback:this.refreshCallback,expanded:s,params:r,detailInfo:a,issueList:o,issueCode:this.getSubIssueCode(),issueTypeDetail:a.issueTypeDetail,onFullScreenChange:this.handleFullScreenChange,onCodeChange:this.props.onCodeChange,targetData:this.props.targetData}));break;case w.ISSUE_TYPE.ASSIGNMENT:e=v.default.createElement("div",{id:"wm-spec",className:I.default.detailRoot},v.default.createElement(S.default,{updateCallback:this.updateCallback,refreshCallback:this.refreshCallback,expanded:s,params:r,detailInfo:a,assignmentList:o,issueCode:this.getSubIssueCode(),issueTypeDetail:a.issueTypeDetail,onFullScreenChange:this.handleFullScreenChange,onCodeChange:this.props.onCodeChange,targetData:this.props.targetData}));break;default:return null}return e}},{key:"render",value:function(){var e=this.state,t=e.detailInfo,a=e.issueType,n=e.isFullScreen,i=this.props,r=i.currentProject,o=i.enterpriseName,s=i.projectPath,l=i.params,c=w.ISSUE_NAME[a],u="".concat(s,"/epics/issues/").concat(l.epicCode,"/detail"),d=n;return v.default.createElement(v.default.Fragment,null,d&&v.default.createElement("div",{className:I.default.fullScreenMask}),v.default.createElement("div",{className:(0,T.default)(I.default.root,I.default.subtaskRoot,"full-screen-style",d&&I.default.fullScreen)},t&&v.default.createElement(O.Helmet,null,v.default.createElement("title",null,"".concat(t.name," - ").concat(c).concat((0,h.t)("\u8be6\u60c5 - ")).concat(r.display_name," - ").concat(o))),v.default.createElement(C.Link,{className:(0,T.default)(I.default.closeButton,d&&I.default.closeButtonFullScreen),to:u}),v.default.createElement("div",{className:I.default.detailRoot},t?this.getSpec():v.default.createElement(E.default,{show:!0}))))}},{key:"componentDidMount",value:function(){this.getDetailInfo()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.params,a=e.currentProject,n=this.props,i=n.params,r=n.currentProject;(a&&a.id!==r.id||t.subIssueCode!==i.subIssueCode)&&this.setState({detailInfo:void 0})}},{key:"componentDidUpdate",value:function(e){var t=e.params,a=e.currentProject,n=this.props,i=n.params,r=n.currentProject;(r&&r.id!==a.id||t.subIssueCode!==i.subIssueCode)&&this.getDetailInfo()}},{key:"getDetailInfo",value:function(){var e=this,t=this.props,a=t.params,n=t.currentProject,i=t.projectPath,r=t.closeSlideslip,o=t.browserRouter,s="".concat(i,"/epics/issues/").concat(a.epicCode,"/detail"),l=this.getSubIssueCode();n.id&&l&&(0,j.fetchIssueDetailByCode)(n.id,l,{withDescriptionMarkup:!0}).then((function(t){var a=t.data;e.setState({detailInfo:a,issueType:a.type})}),(function(e){var t=e.code,a=e.msg;1400===t?((0,P.danger)((0,D.getErrorMessage)(a)),o.replace(i)):((0,P.danger)((0,D.getErrorMessage)(a)),r(),o.replace(s))}))}},{key:"updateCallback",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this.props.getList;n&&n(!0),e&&!a?this.setState({detailInfo:e}):this.getDetailInfo()}},{key:"refreshCallback",value:function(){var e=this.props.getList;e&&e(!0)}}]),a}(v.Component),o.propTypes=_(_({params:g.default.object,projectPath:g.default.string,enterpriseName:g.default.string,currentProject:g.default.object,closeSlideslip:g.default.func,issueList:g.default.array,getList:g.default.func},R.sizeProps),{},{currentProjectCooperateSettings:g.default.object,browserRouter:g.default.object,code:g.default.number,onCodeChange:g.default.func,targetData:g.default.object}),r=s))||r)||r;t.default=x},vi3I:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetchAffairs=t.createSubtask=t.fetchSubtasksActitvites=t.deleteComment=t.addComment=t.updateSubtaskDescription=t.fetchSubtaskDescription=t.deleteSubtask=t.updateSubtaskDetail=t.fetchSubtaskDetail=void 0;var n=a("Z4vw");t.fetchSubtaskDetail=function(e,t,a){return(0,n.get)("/external/collaboration/api/project/".concat(e,"/issues/sub-tasks/").concat(t,"?").concat((0,n.buildParams)(a)))};t.updateSubtaskDetail=function(e,t,a){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return(0,n.patchJSON)("/external/collaboration/api/project/".concat(e,"/issues/sub-tasks/").concat(t,"/fields"),a,i)};t.deleteSubtask=function(e,t){return(0,n.del)("/external/collaboration/api/project/".concat(e,"/issues/sub-tasks/").concat(t))};t.fetchSubtaskDescription=function(e,t){return(0,n.get)("/api/project/".concat(e,"/issues/sub-tasks/").concat(t,"/description"))};t.updateSubtaskDescription=function(e,t,a){return(0,n.put)("/api/project/".concat(e,"/issues/sub-tasks/").concat(t,"/description"),a)};t.addComment=function(e){var t=e.projectID,a=e.subtaskCode,i=e.content,r=e.parentID;return(0,n.post)("/external/collaboration/api/project/".concat(t,"/issues/sub-tasks/").concat(a,"/comments"),{content:i,parentId:r})};t.deleteComment=function(e,t,a){return(0,n.del)("/api/project/".concat(e,"/issues/sub-tasks/").concat(t,"/comments/").concat(a))};t.fetchSubtasksActitvites=function(e,t){return(0,n.get)("/external/collaboration/api/project/".concat(e,"/issues/sub-tasks/").concat(t,"/activities"))};t.createSubtask=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,n.postJSON)("/external/collaboration/api/project/".concat(e,"/issues/sub-tasks"),t,a)};t.fetchAffairs=function(e,t,a){return(0,n.get)("/api/project/".concat(e,"/issues/search-sub-task-parents?subtaskCode=").concat(t,"&keyword=").concat(a))}},w2Sj:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n,i,r,o=a("cDcd"),s=a.n(o),l=a("nuIr"),c=a("1YQb"),u=a("TLfn"),d=a("fmVk"),f=function(){return(f=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},p=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},m=function(e,t,a){if(a||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},h=function(){var e={projectPath:"",currentProject:void 0,user:void 0,requirementStatus:[],prdRequirementStatus:[],subtaskStatus:[],moduleSchemes:[],requirementTypes:[],bugTypes:[],assignmentStatus:[],simpleIterations:[],labels:[],currentProjectCooperateSettings:void 0,allIssueStatus:[],issueStatus:[],allSystemList:[],groupTeamList:[],defectSources:[],allMilestonesList:[],defectPhases:[],defectKinds:[],prdRequirementList:[],ordRequirementList:[],editionList:[],productGroupList:[],productGroupLabelList:[],RBLSJXGList:[],RBLKHXGList:[]};return function(){for(var t,a,n,i,r,o,s,l,c,u,f,p,m,h,v,g,E,b,y,S,I,T,C,P=[],w=0;w<arguments.length;w++)P[w]=arguments[w];var D=d.store.getState();return D.APP.projectPath===e.projectPath&&-1===P.findIndex((function(t){return!e[t]||0===e[t].length}))||Object.assign(e,{projectPath:D.APP.projectPath,currentProject:D.APP.currentProject,user:D.APP.user,requirementStatus:null===(t=D.REQUIREMENTS)||void 0===t?void 0:t.requirementStatus,prdRequirementStatus:null===(a=D.REQUIREMENTS)||void 0===a?void 0:a.prdRequirementStatus,subtaskStatus:null===(n=D.SUBTASKS)||void 0===n?void 0:n.subtaskStatus,moduleSchemes:null===(i=D.ISSUE)||void 0===i?void 0:i.moduleSchemes,requirementTypes:null===(r=D.ISSUE)||void 0===r?void 0:r.requirementTypes,bugTypes:null===(o=D.ISSUE)||void 0===o?void 0:o.bugTypes,assignmentStatus:null===(s=D.ASSIGNMENTS)||void 0===s?void 0:s.assignmentStatus,simpleIterations:null===(l=D.ISSUE)||void 0===l?void 0:l.simpleIterations,labels:D.PROJECT.common.labels,currentProjectCooperateSettings:D.APP.currentProjectCooperateSettings,allIssueStatus:null===(c=D.ISSUE)||void 0===c?void 0:c.allIssueStatus,issueStatus:null===(u=D.BUG_TRACKING)||void 0===u?void 0:u.bugStatus,issueTypeList:D.APP.currentProjectCooperateSettings.ISSUE_TYPES,allSystemList:null===(f=D.ISSUE)||void 0===f?void 0:f.allSystemList,groupTeamList:null===(p=D.ISSUE)||void 0===p?void 0:p.groupTeamList,defectSources:null===(m=D.ISSUE)||void 0===m?void 0:m.defectSources,allMilestonesList:null===(h=D.ISSUE)||void 0===h?void 0:h.allMilestonesList,RBLSJXGList:null===(v=D.ISSUE)||void 0===v?void 0:v.RBLSJXGList,RBLKHXGList:null===(g=D.ISSUE)||void 0===g?void 0:g.RBLKHXGList,defectPhases:null===(E=D.ISSUE)||void 0===E?void 0:E.defectPhases,defectKinds:null===(b=D.ISSUE)||void 0===b?void 0:b.defectKinds,prdRequirementList:null===(y=D.ISSUE)||void 0===y?void 0:y.prdRequirementList,ordRequirementList:null===(S=D.ISSUE)||void 0===S?void 0:S.ordRequirementList,editionList:null===(I=D.ISSUE)||void 0===I?void 0:I.editionList,productGroupList:null===(T=D.ISSUE)||void 0===T?void 0:T.productGroupList,productGroupLabelList:null===(C=D.ISSUE)||void 0===C?void 0:C.productGroupLabelList}),e}}(),v=function(e,t){var a=m(m([],p(e),!1),p(t),!1).filter((function(e){return e})).reduce((function(e,t){return e.find((function(e){return t.id===e.id}))?m([],p(e),!1):m(m([],p(e),!1),[t],!1)}),[]),n=a.filter((function(e){return"TODO"===e.type})),i=a.filter((function(e){return"PROCESSING"===e.type})),r=a.filter((function(e){return"COMPLETED"===e.type}));return m(m(m([],p(n),!1),p(i),!1),p(r),!1).map((function(e){return f(f({},e),{value:e.id,text:e.name})}))},g=a("mVeg"),E=a("r3Yi"),b=a("B7Ya"),y=a("iTKN"),S=a("6Mal"),I=a("L8Eh"),T=a("h74D"),C=a("qPyV"),P=a.n(C),w=a("V0lW"),D=a("BKNj"),O=a("np+F"),R=a("zLEI"),j=a("jM0q"),k=a("qW+5"),N=a("Sz3w"),A=a("ApPF"),L=a("n584"),F=a("hL64"),_=a("iNpo"),M=a("qo78"),x=a("necX"),B=a.n(x),U=a("VaZk"),W=function(){return(W=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Y=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(a[n[i]]=e[n[i]])}return a},H=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},V=function(e){return e.map((function(e){return{id:e.id,value:e.id,text:e.name,name:e.name,media:e.avatar,avatar:e.avatar,pinyin:e.name_pinyin,isProjectMember:!0}}))},G=function(e,t){return void 0===t&&(t=!1),e.map((function(e){return{id:e.id,value:e.id,text:e.name,name:e.name,media:e.avatar,avatar:e.avatar,pinyin:e.namePinyin,isProjectMember:!!e.isProjectMember||t}}))},K=function(e,t){switch(e){case y.ComponentType.TABLE_CELL:return R.a;case y.ComponentType.FORM:return t?k.a:j.a;case y.ComponentType.ICON:return N.a;case y.ComponentType.FILTER:return L.a;case y.ComponentType.FLAT_TYPE:return F.a;case y.ComponentType.SIMPLE:return A.a;default:return O.a}},z=Object(T.connect)((function(e){var t=e.APP;return{globalKey:t.enterprise.key,currentUserInfo:t.user}}))((function(e){e.globalKey;var t=e.currentUserInfo,a=e.componentType,n=e.isBatch,i=e.isMultiple,r=e.show,l=e.useUnspecificItem,c=e.inProject,u=void 0!==c&&c,d=e.projectID,f=e.triggerExtraProps,p=e.itemExtraProps,m=e.Trigger,h=e.allUsers,v=void 0!==h&&h,g=Y(e,["globalKey","currentUserInfo","componentType","isBatch","isMultiple","show","useUnspecificItem","inProject","projectID","triggerExtraProps","itemExtraProps","Trigger","allUsers"]),E=H(Object(o.useState)(!1),2),b=E[0],S=E[1],I=H(Object(o.useState)(!1),2),T=I[0],C=I[1],O=H(Object(o.useState)(l?[y.UNSPECIFIC_ITEM]:[]),2),R=O[0],j=O[1],k=H(Object(o.useState)(1),2),N=k[0],A=k[1],L=H(Object(o.useState)(!0),2),F=L[0],x=L[1],z=H(Object(o.useState)(""),2),q=z[0],Z=z[1],J=H(Object(o.useState)([]),2),X=J[0],Q=J[1],$=H(Object(o.useState)(1),2),ee=$[0],te=$[1],ae=H(Object(o.useState)(!0),2),ne=ae[0],ie=ae[1],re=H(Object(o.useState)(!1),2),oe=re[0],se=re[1],le=function(e,t){(void 0===t&&(t=!1),!t&&!ne||T)||(C(!0),(u?Object(w.fetchTeamMembers)(d,t?1:ee,20,e,!v,v):Object(w.getProposerMembers)(t?1:ee,20,e,!0,!0)).then((function(e){var a=e.data,n=a.list,i=a.totalPage,r=u?G(n):V(n),o=t?1:ee,s=t?[]:X;if(Q(P()(s.concat(r),"id")),ee>=i)return ie(!1);te(o+1),ie(!0)})).finally((function(){C(!1)})))},ce=function(){return q?le(q):void(F&&!T&&(C(!0),(u?Object(w.getProjectMembers)(d,N,20):Object(w.getProposerMembers)(N,20,"",!0,!0)).then((function(e){var a=e.data,n=a.list,i=a.totalPage,r=u?function(e){return e.map((function(e){return{id:e.user_id,value:e.user_id,text:e.name,name:e.name,media:e.avatar,avatar:e.avatar,pinyin:e.name_pinyin,isProjectMember:!0}}))}(n):V(n),o={id:t.id,value:t.id,text:t.name,name:t.name,media:t.avatar,avatar:t.avatar,pinyin:t.name_pinyin,isProjectMember:!0},s=R.concat(r).filter((function(e){return e.id!==o.id}));return s.unshift(o),j(s),S(!0),N<i?A(N+1):x(!1)})).finally((function(){C(!1)}))))},ue=function(e){Z(e)};if(Object(o.useEffect)((function(){if(q)return le(q,!0);Q([]),te(1),ie(!0)}),[q]),Object(o.useEffect)((function(){S(!1),C(!1),j(l?[y.UNSPECIFIC_ITEM]:[]),A(1),x(!0),Z(""),Q([]),te(1),ie(!0)}),[d]),Object(o.useEffect)((function(){se(r)}),[]),Object(o.useEffect)((function(){if(!T&&oe&&f&&f.initialSelectedItem&&Array.isArray(f.initialSelectedItem)){var e=G(f.initialSelectedItem,!0);if(!q)return j(P()(e.concat(R),"id"));var t=X.filter((function(t){return e.some((function(e){return e.id===t.id}))}));Q(P()(t.concat(X),"id"))}}),[T,oe,q]),g.pingPuObj){var de=g.itemInfo;return s.a.createElement("div",{className:B.a.dropdwonMargin1},s.a.createElement(U.a,W({},g.pingPuObj,{conditions:de})),s.a.createElement(D.default,W({},g,{isMultiple:i,items:q?X:R,tableCell:a===y.ComponentType.TABLE_CELL,largeSize:a===y.ComponentType.FORM&&!n,smallSize:n,isFilter:a===y.ComponentType.FILTER,isSimple:a===y.ComponentType.ICON||a===y.ComponentType.SIMPLE,dataInited:b,dataFetching:T,onReachBottom:function(e){e&&ce()},isLocalSearch:!1,onSearch:ue,disableArrowUp:!0,showPanel:r,Trigger:m||K(a,i),triggerExtraProps:f,CustomPanel:u?M.a:void 0,Item:_.a,itemExtraProps:p,disabledBottomSpace:g.disabledBottomSpace,onExpandChange:function(e){se(e)}})))}return s.a.createElement(D.default,W({},g,{isMultiple:i,items:q?X:R,tableCell:a===y.ComponentType.TABLE_CELL,largeSize:a===y.ComponentType.FORM&&!n,smallSize:n,isFilter:a===y.ComponentType.FILTER,isSimple:a===y.ComponentType.ICON||a===y.ComponentType.SIMPLE,dataInited:b,dataFetching:T,onReachBottom:function(e){e&&ce()},isLocalSearch:!1,onSearch:ue,disableArrowUp:!0,showPanel:r,Trigger:m||K(a,i),triggerExtraProps:f,CustomPanel:u?M.a:void 0,Item:_.a,itemExtraProps:p,disabledBottomSpace:g.disabledBottomSpace,onExpandChange:function(e){se(e)}}))})),q=a("HDqR"),Z=a("G0SF"),J=a("tchc"),X=a("V2rr"),Q=a.n(X),$=a("5JFE"),ee=a("ZcJI"),te=a("QEh4"),ae=a("bRS7"),ne=a("Rwbr"),ie=a("O9Lt"),re=a.n(ie),oe=a("UGd4"),se=a("K2gz"),le=a.n(se),ce=a("xwLU"),ue=a.n(ce),de=a("psb5"),fe=a("7HzJ"),pe=function(){return(pe=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},me=function(e,t,a,n){return new(a||(a=Promise))((function(i,r){function o(e){try{l(n.next(e))}catch(t){r(t)}}function s(e){try{l(n.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,s)}l((n=n.apply(e,t||[])).next())}))},he=function(e,t){var a,n,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(l){return function(s){if(a)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(a=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(l){s=[6,l],n=0}finally{a=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},ve=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(a[n[i]]=e[n[i]])}return a},ge=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},Ee=function(e,t,a){if(a||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},be=Object(o.forwardRef)((function(e,t){var a=e.dataFetching,n=e.items,i=e.value,r=e.isMultiple,o=e.changeFocusIndex,l=e.mouseFocusEnable,c=e.setMouseFocusEnable,u=e.onListScroll,d=e.onSelect,f=e.focusIndex;return s.a.createElement("div",{className:le()(ue.a.list),onScroll:u,ref:t,onMouseMove:function(){c(!0)},onMouseLeave:function(){c(!1),o(void 0)}},!a&&n.length<1&&s.a.createElement("div",{className:ue.a.noSearchResult},Object(g.t)("\u65e0\u5339\u914d\u7684\u7248\u672c")),n.map((function(e,t){return s.a.createElement("div",{key:e.id,onMouseEnter:function(){return l&&o(t)}},s.a.createElement(fe.a,{item:e,value:i,isMultiple:r,onSelect:d,focused:f===t}))})),a&&s.a.createElement(re.a,{show:!0}))})),ye=Object(o.memo)((function(e){var t=e.projectId,a=e.triggerExtraProps,n=e.value,i=ve(e,["projectId","triggerExtraProps","value"]),r=ge(Object(o.useState)(!1),2),l=r[0],c=r[1],u=ge(Object(o.useState)(!1),2),d=u[0],f=u[1],p=ge(Object(o.useState)(!1),2),m=p[0],h=p[1],v=ge(Object(o.useState)([y.UNSPECIFIC_ITEM]),2),g=v[0],E=v[1],b=ge(Object(o.useState)(1),2),S=b[0],I=b[1],T=ge(Object(o.useState)(!0),2),C=T[0],w=T[1],O=ge(Object(o.useState)(""),2),R=O[0],j=O[1],k=ge(Object(o.useState)([]),2),N=k[0],A=k[1],L=ge(Object(o.useState)(1),2),F=L[0],_=L[1],M=ge(Object(o.useState)(!0),2),x=M[0],B=M[1];Object(o.useEffect)((function(){R?W(R,!0):(A([]),_(1),B(!0))}),[R]);var U=function(e,a){return Object(oe.getReleasePageList)(t,{page:e,pageSize:20,content:{conditions:[{key:"KEYWORD",value:a}],sort:{key:"RELEASE_DATE",value:"DESC"}}})},W=function(e,t){return void 0===t&&(t=!1),me(void 0,void 0,void 0,(function(){var a,n,i,r,o,s,l;return he(this,(function(c){switch(c.label){case 0:if(!t&&!x||d)return[3,5];f(!0),c.label=1;case 1:return c.trys.push([1,3,4,5]),[4,U(a=t?1:F,e)];case 2:return n=c.sent(),i=n.data,r=i.list,o=i.totalPage,s=i.page,l=t?[]:N,A(P()(Ee(Ee([],ge(l),!1),ge(H(r)),!1),"id")),s<o&&_(a+1),B(s<o),[3,5];case 3:return c.sent(),[3,5];case 4:return f(!1),[7];case 5:return[2]}}))}))},Y=function(){return me(void 0,void 0,void 0,(function(){var e,t,a,n,i;return he(this,(function(r){switch(r.label){case 0:if(!C||d)return[2];f(!0),r.label=1;case 1:return r.trys.push([1,3,4,5]),[4,U(S,"")];case 2:return e=r.sent(),t=e.data,a=t.list,n=t.totalPage,i=t.page,c(!0),E(P()(Ee(Ee([],ge(g),!1),ge(H(a)),!1),"id")),i<n&&I(i+1),w(i<n),[3,5];case 3:return r.sent(),[3,5];case 4:return f(!1),[7];case 5:return[2]}}))}))};Object(o.useEffect)((function(){E([y.UNSPECIFIC_ITEM]),Y(),c(!1),h(!1),I(1),j(""),A([]),_(1),B(!1)}),[t]),Object(o.useEffect)((function(){if(!d&&m&&a&&a.initialSelectedItem&&Array.isArray(a.initialSelectedItem)){var e=a.initialSelectedItem;E(P()(Ee(Ee([],ge(e),!1),ge(g),!1),"id"))}}),[m,d]);var H=function(e){return e.map((function(e){var t,a,n;return{id:null!==(t=null===e||void 0===e?void 0:e.code)&&void 0!==t?t:0,value:null!==(a=null===e||void 0===e?void 0:e.code)&&void 0!==a?a:0,text:null!==(n=null===e||void 0===e?void 0:e.name)&&void 0!==n?n:""}}))};return s.a.createElement(D.default,pe({value:n,items:R?N:g,isMultiple:!0,isFilter:!0,dataInited:l,dataFetching:d,isLocalSearch:!1,onReachBottom:function(e){e&&(R?W(R):Y())},onSearch:function(e){j(e)},Trigger:de.a,CustomPanel:be,onExpandChange:function(e){h(e)},triggerExtraProps:a},i))})),Se=function(){return(Se=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Ie=function(e,t,a,n){return new(a||(a=Promise))((function(i,r){function o(e){try{l(n.next(e))}catch(t){r(t)}}function s(e){try{l(n.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,s)}l((n=n.apply(e,t||[])).next())}))},Te=function(e,t){var a,n,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(l){return function(s){if(a)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(a=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(l){s=[6,l],n=0}finally{a=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},Ce=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(a[n[i]]=e[n[i]])}return a},Pe=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},we=function(e,t,a){if(a||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},De=Object(o.forwardRef)((function(e,t){var a=e.dataFetching,n=e.items,i=e.value,r=e.isMultiple,o=e.changeFocusIndex,l=e.mouseFocusEnable,c=e.setMouseFocusEnable,u=e.onListScroll,d=e.onSelect,f=e.focusIndex;return s.a.createElement("div",{className:le()(ue.a.list),onScroll:u,ref:t,onMouseMove:function(){c(!0)},onMouseLeave:function(){c(!1),o(void 0)}},!a&&n.length<1&&s.a.createElement("div",{className:ue.a.noSearchResult},Object(g.t)("\u65e0\u5339\u914d\u7684\u9879\u76ee\u96c6")),n.map((function(e,t){return s.a.createElement("div",{key:e.id,onMouseEnter:function(){return l&&o(t)}},s.a.createElement(fe.a,{item:e,value:i,isMultiple:r,onSelect:d,focused:f===t}))})),a&&s.a.createElement(re.a,{show:!0}))})),Oe=Object(o.memo)((function(e){var t=e.projectId,a=e.triggerExtraProps,n=e.value,i=Ce(e,["projectId","triggerExtraProps","value"]),r=Pe(Object(o.useState)(!1),2),l=r[0],c=r[1],u=Pe(Object(o.useState)(!1),2),d=u[0],f=u[1],p=Pe(Object(o.useState)(!1),2),m=p[0],h=p[1],v=Pe(Object(o.useState)([y.UNSPECIFIC_ITEM]),2),g=v[0],E=v[1],b=Pe(Object(o.useState)(1),2),S=b[0],I=b[1],T=Pe(Object(o.useState)(!0),2),C=T[0],O=T[1],R=Pe(Object(o.useState)(""),2),j=R[0],k=R[1],N=Pe(Object(o.useState)([]),2),A=N[0],L=N[1],F=Pe(Object(o.useState)(1),2),_=F[0],M=F[1],x=Pe(Object(o.useState)(!0),2),B=x[0],U=x[1];Object(o.useEffect)((function(){j?Y(j,!0):(L([]),M(1),U(!0))}),[j]);var W=function(e,t){return Object(w.fetchPrograms)({type:"ALL",sort:"CREATE",order:"DESC",archived:!1,keyword:t,page:e,pageSize:20})},Y=function(e,t){return void 0===t&&(t=!1),Ie(void 0,void 0,void 0,(function(){var a,n,i,r,o,s,l;return Te(this,(function(c){switch(c.label){case 0:if(!t&&!B||d)return[3,5];f(!0),c.label=1;case 1:return c.trys.push([1,3,4,5]),[4,W(a=t?1:_,e)];case 2:return n=c.sent(),i=n.data,r=i.list,o=i.totalPage,s=i.page,l=t?[]:A,L(P()(we(we([],Pe(l),!1),Pe(V(r)),!1),"value")),s<o&&M(a+1),U(s<o),[3,5];case 3:return c.sent(),[3,5];case 4:return f(!1),[7];case 5:return[2]}}))}))},H=function(){return Ie(void 0,void 0,void 0,(function(){var e,t,a,n,i;return Te(this,(function(r){switch(r.label){case 0:if(!C||d)return[2];f(!0),r.label=1;case 1:return r.trys.push([1,3,4,5]),[4,W(S,"")];case 2:return e=r.sent(),t=e.data,a=t.list,n=t.totalPage,i=t.page,E(P()(we(we([],Pe(g),!1),Pe(V(a)),!1),"id")),i<n&&I(i+1),O(i<n),[3,5];case 3:return r.sent(),[3,5];case 4:return c(!0),f(!1),[7];case 5:return[2]}}))}))};Object(o.useEffect)((function(){E([y.UNSPECIFIC_ITEM]),H(),h(!1),I(1),k(""),L([]),M(1),U(!1)}),[t]),Object(o.useEffect)((function(){if(!d&&m&&a&&a.initialSelectedItem&&Array.isArray(a.initialSelectedItem)){var e=a.initialSelectedItem;E(P()(we(we([],Pe(e),!1),Pe(g),!1),"id"))}}),[m,d]);var V=function(e){return e.map((function(e){var t,a,n;return{id:null!==(t=null===e||void 0===e?void 0:e.id)&&void 0!==t?t:0,value:null!==(a=null===e||void 0===e?void 0:e.id)&&void 0!==a?a:0,text:null!==(n=null===e||void 0===e?void 0:e.displayName)&&void 0!==n?n:""}}))};return s.a.createElement(D.default,Se({value:n,items:j?A:g,isMultiple:!0,isFilter:!0,dataInited:l,dataFetching:d,isLocalSearch:!1,onReachBottom:function(e){e&&(j?Y(j):H())},onSearch:function(e){k(e)},Trigger:de.a,CustomPanel:De,onExpandChange:function(e){h(e)},triggerExtraProps:a},i))})),Re=a("7FZc"),je=a("IuC+"),ke=a.n(je),Ne=a("vih4"),Ae=a.n(Ne),Le=function(){return(Le=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Fe=function(e,t,a,n){return new(a||(a=Promise))((function(i,r){function o(e){try{l(n.next(e))}catch(t){r(t)}}function s(e){try{l(n.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,s)}l((n=n.apply(e,t||[])).next())}))},_e=function(e,t){var a,n,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(l){return function(s){if(a)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(a=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(l){s=[6,l],n=0}finally{a=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},Me=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(a[n[i]]=e[n[i]])}return a},xe=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},Be=function(e,t,a){if(a||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},Ue=Object(o.forwardRef)((function(e,t){var a=e.dataFetching,n=e.items,i=e.value,r=e.isMultiple,o=e.changeFocusIndex,l=e.mouseFocusEnable,c=e.setMouseFocusEnable,u=e.onListScroll,d=e.onSelect,f=e.focusIndex;return s.a.createElement("div",{className:le()(ue.a.list),onScroll:u,ref:t,onMouseMove:function(){c(!0)},onMouseLeave:function(){c(!1),o(void 0)}},!a&&n.length<1&&s.a.createElement("div",{className:ue.a.noSearchResult},Object(g.t)("\u65e0\u5339\u914d\u7684\u9700\u6c42")),n.map((function(e,t){return s.a.createElement("div",{key:e.id,onMouseEnter:function(){return l&&o(t)}},s.a.createElement(We,{item:e,value:i,isMultiple:r,onSelect:d,focused:f===t}))})),a&&s.a.createElement(re.a,{show:!0}))})),We=Object(o.memo)((function(e){var t=e.item,a=e.value,n=e.isMultiple,i=e.focused,r=e.onSelect,o=function(){return n?a.some((function(e){return e===t.value})):t.value===a};return s.a.createElement("div",{className:le()(ke.a.item,o()&&ke.a.checked,i&&ke.a.focus),title:t.text,onClick:function(){return r(t)}},t.id!==y.UNSPECIFIC&&t.value&&s.a.createElement("span",{className:le()(ke.a.requirementCode)},"#"+t.value),s.a.createElement("span",{className:le()(ke.a.content),style:{color:t.id===y.UNSPECIFIC?"#8592a6":"#202d40"}},t.text),o()&&s.a.createElement("span",{className:le()(ke.a.checked)}))})),Ye=function(e){var t=e.value,a=e.items,n=e.initialSelectedItem,i=e.active,r=e.disabled,l=e.label,c=e.removable,u=e.onRemove,d=e.valueChanged,f=e.noMatched,p=e.toolTipText,m=Object(o.useCallback)((function(){if(f)return Object(g.t)("\u672a\u5339\u914d");var e=P()(null===t||void 0===t?void 0:t.map((function(e){return(n||a).find((function(t){return Array.isArray(null===t||void 0===t?void 0:t.value)?t.value.some((function(t){return t===e})):(null===t||void 0===t?void 0:t.value)===e}))})),"id")||[],i=((null===e||void 0===e?void 0:e.map((function(e){var t;return null!==(t=null===e||void 0===e?void 0:e.text)&&void 0!==t?t:""})))||[]).join(",")||Object(g.t)("\u5168\u90e8");return[((null===e||void 0===e?void 0:e.map((function(e){return(null===e||void 0===e?void 0:e.value)===y.UNSPECIFIC?null===e||void 0===e?void 0:e.text:"#"+(null===e||void 0===e?void 0:e.value)})))||[]).join(",")||Object(g.t)("\u5168\u90e8"),i]}),[f,t,n,a]),h=xe(m(),2),v=h[0],E=h[1];return s.a.createElement("div",{className:"newfilter-trigger ".concat(le()(Ae.a.trigger,Ae.a.filterTrigger,i&&Ae.a.active,r&&Ae.a.disabled)),title:E},l&&s.a.createElement("div",{className:"newfilter-hidden ".concat(le()(Ae.a.label))},l),s.a.createElement("div",{className:le()(Ae.a.content)},v),s.a.createElement("span",{className:le()(Ae.a.caret)}),c&&s.a.createElement("span",{className:le()(Ae.a.removeButton,i&&Ae.a.show),onClick:u}),!!d&&s.a.createElement(Re.TooltipTrigger,{title:p},s.a.createElement("div",{className:Ae.a.configError})))},He=Object(o.memo)((function(e){var t=e.projectId,a=(e.projectName,e.triggerExtraProps),n=e.value,i=Me(e,["projectId","projectName","triggerExtraProps","value"]),r=xe(Object(o.useState)(!1),2),l=r[0],c=r[1],u=xe(Object(o.useState)(!1),2),d=u[0],f=u[1],p=xe(Object(o.useState)(!1),2),m=p[0],h=p[1],v=xe(Object(o.useState)([y.UNSPECIFIC_ITEM]),2),g=v[0],E=v[1],b=xe(Object(o.useState)(1),2),S=b[0],I=b[1],T=xe(Object(o.useState)(!0),2),C=T[0],O=T[1],R=xe(Object(o.useState)(""),2),j=R[0],k=R[1],N=xe(Object(o.useState)([]),2),A=N[0],L=N[1],F=xe(Object(o.useState)(1),2),_=F[0],M=F[1],x=xe(Object(o.useState)(!0),2),B=x[0],U=x[1];Object(o.useEffect)((function(){c(!1),f(!1),h(!1),E([y.UNSPECIFIC_ITEM]),I(1),O(!1),k(""),L([]),M(1),U(!1)}),[t]),Object(o.useEffect)((function(){j?Y(j,!0):(L([]),M(1),U(!0),l||H())}),[j]);var W=function(e,a){return Object(w.fetchRequirementsWithPage)(t,e,20,a)},Y=function(e,t){return void 0===t&&(t=!1),Fe(void 0,void 0,void 0,(function(){var a,n,i,r,o,s,l;return _e(this,(function(c){switch(c.label){case 0:if(!t&&!B||d)return[3,5];f(!0),c.label=1;case 1:return c.trys.push([1,3,4,5]),[4,W(a=t?1:_,e)];case 2:return n=c.sent(),i=n.data,r=i.list,o=i.totalPage,s=i.page,l=t?[]:A,L(P()(Be(Be([],xe(l),!1),xe(V(r)),!1),"id")),s<o&&M(a+1),U(s<o),[3,5];case 3:return c.sent(),[3,5];case 4:return f(!1),[7];case 5:return[2]}}))}))},H=function(){return Fe(void 0,void 0,void 0,(function(){var e,t,a,n,i;return _e(this,(function(r){switch(r.label){case 0:if(!C||d)return[2];f(!0),r.label=1;case 1:return r.trys.push([1,3,4,5]),[4,W(S,"")];case 2:return e=r.sent(),t=e.data,a=t.list,n=t.totalPage,i=t.page,c(!0),E(P()(Be(Be([],xe(g),!1),xe(V(a)),!1),"id")),i<n&&I(i+1),O(i<n),[3,5];case 3:return r.sent(),[3,5];case 4:return f(!1),[7];case 5:return[2]}}))}))};Object(o.useEffect)((function(){if(!d&&m&&a&&a.initialSelectedItem&&Array.isArray(a.initialSelectedItem)){var e=a.initialSelectedItem;E(P()(Be(Be([],xe(e),!1),xe(g),!1),"id"))}}),[m,d]);var V=function(e){return e.map((function(e){var t,a,n;return{id:null!==(t=null===e||void 0===e?void 0:e.code)&&void 0!==t?t:0,value:null!==(a=null===e||void 0===e?void 0:e.code)&&void 0!==a?a:0,text:null!==(n=null===e||void 0===e?void 0:e.name)&&void 0!==n?n:""}}))};return s.a.createElement(D.default,Le({value:n,items:j?A:g,isMultiple:!0,isFilter:!0,dataInited:l,dataFetching:d,isLocalSearch:!1,onReachBottom:function(e){e&&(j?Y(j):H())},onSearch:function(e){k(e)},Trigger:Ye,CustomPanel:Ue,onExpandChange:function(e){h(e)},triggerExtraProps:a},i))})),Ve=a("DTVk"),Ge=a("mTYr"),Ke=a("XXMN"),ze=a("TGxl"),qe=a("DbF1"),Ze=a("te0o"),Je=a("G4bb"),Xe=a("MYKk"),Qe=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},$e=function(e){return e.map((function(e){return{id:e.id,value:e.id,name:e.name,status:e.status,projectName:e.projectName}}))},et=s.a.createContext({}),tt=function(e){var t=e.children,a=Qe(Object(o.useState)([]),2),n=a[0],i=a[1],r=Qe(Object(o.useState)(1),2),l=r[0],c=r[1],u=Qe(Object(o.useState)(!0),2),d=u[0],f=u[1],p=Qe(Object(o.useState)(""),2),m=p[0],h=p[1],v=function(e){d&&Object(qe.b)(l,20,e).then((function(e){var t=e.data,a=t.list,r=t.totalPage,o=$e(a);i(P()(n.concat(o),"id")),l<r?c(l+1):f(!1)}))};return Object(o.useEffect)((function(){v()}),[]),s.a.createElement(et.Provider,{value:{iterations:n,loadMore:function(){v(m)},onSearch:function(e){""===e?(c(1),h(""),f(!0),Object(qe.b)(1,20,e).then((function(e){var t=e.data.list,a=$e(t);i(a)}))):(c(1),h(e),f(!0),Object(qe.b)(l,20,e).then((function(e){var t=e.data.list,a=$e(t);i(a)})))}}},t)},at=function(){return(at=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},nt=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},it=function(e){var t=e.unit,a=e.ride,n=void 0===a?1:a,i=e.onChange,r=e.min,l=void 0===r?0:r,c=e.max,u=void 0===c?999999999:c,d=e.isInteger,f=void 0!==d&&d,p=e.valueStart&&Number(e.valueStart)/n,m=e.valueEnd&&Number(e.valueEnd)/n,h={};t&&(h.addonAfter=s.a.createElement("span",null,t));var v=nt(Object(o.useState)(p),2),g=v[0],E=v[1],b=nt(Object(o.useState)(m),2),y=b[0],S=b[1],I=function(e){return Number(f?e.toFixed():Number(e).toFixed(2))};return s.a.createElement("div",{className:Q.a.flexBetween,style:{width:"100%"},datatype:"noborder"},s.a.createElement($.InputNumber,at({className:Q.a.flex1,value:g,max:u,min:l,controls:!1,onBlur:function(e){var t=g||0;i&&(m&&(t=t>m?m:t),g!==t&&E(t),i({start:Number(t)*n,end:Number(m)*n}))},onChange:function(e){E(I(e))}},h)),s.a.createElement("span",{className:Q.a.space}),s.a.createElement($.InputNumber,at({className:Q.a.flex1,value:y,max:u,min:l,controls:!1,onBlur:function(e){var t=y||0;i&&(p&&(t=t<p?p:t),y!==t&&S(t),i({start:Number(p)*n,end:t?Number(t)*n:""}))},onChange:function(e){S(I(e))}},h)))},rt=a("7bn+"),ot=a("J8KE"),st=a("WEK+"),lt=a("ibk3"),ct=function(){return(ct=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},ut=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},dt=function(e){var t=e.list,a=e.children,n=ut(Object(o.useState)(t),2),i=n[0],r=n[1],l=Object(o.useRef)("");return Object(o.useEffect)((function(){Object(lt.onSelectReference)(l.current)}),[t]),s.a.createElement(ee.a,ct({},e,{onSearch:function(e){l.current=e;var a=t.filter((function(t){return-1!==t.name.indexOf(e)}));r(a)},list:i}),a)},ft=a("ZC3d"),pt=a("1bIq"),mt=a("DlAp"),ht=a("LvDl"),vt=a("jgPD"),gt=a("xgZS"),Et=a("w3Wo"),bt=function(){return(bt=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},yt=function(e,t,a,n){return new(a||(a=Promise))((function(i,r){function o(e){try{l(n.next(e))}catch(t){r(t)}}function s(e){try{l(n.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,s)}l((n=n.apply(e,t||[])).next())}))},St=function(e,t){var a,n,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(l){return function(s){if(a)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(a=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(l){s=[6,l],n=0}finally{a=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},It=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(a[n[i]]=e[n[i]])}return a},Tt=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},Ct=function(e,t,a){if(a||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},Pt=((n={})[u.FilterIssueTypes.WATCHER]=Object(g.t)("\u5173\u6ce8\u4eba"),n[u.FilterIssueTypes.CREATOR]=Object(g.t)("\u521b\u5efa\u4eba"),n[u.FilterIssueTypes.PARTICIPANT]=Object(g.t)("\u53c2\u4e0e\u4eba"),n[u.FilterIssueTypes.ASSIGNEE]=Object(g.t)("\u5904\u7406\u4eba"),n[u.FilterIssueTypes.ASSOCIATE_RELEASE]=Object(g.t)("\u7248\u672c"),n[u.FilterIssueTypes.ASSOCIATE_PROGRAM]=Object(g.t)("\u5173\u8054\u9879\u76ee\u96c6"),n[u.FilterIssueTypes.ASSOCIATE_REQUIREMENT]=Object(g.t)("\u5173\u8054\u9700\u6c42"),n[u.FilterIssueTypes.PROPOSER]=Object(g.t)("\u9700\u6c42\u63d0\u51fa\u4eba"),n),wt=((i={})[u.FilterIssueTypes.CREATED_AT]=Object(g.t)("\u521b\u5efa\u65e5\u671f"),i[u.FilterIssueTypes.UPDATED_AT]=Object(g.t)("\u66f4\u65b0\u65e5\u671f"),i[u.FilterIssueTypes.START_DATE]=Object(g.t)("\u5f00\u59cb\u65e5\u671f"),i[u.FilterIssueTypes.DUE_DATE]=Object(g.t)("\u622a\u6b62\u65e5\u671f"),i),Dt=function(e){var t,a,n,i,d=e.value,f=e.attrType,p=e.modeType,m=e.issueType,T=e.onSelect,C=e.onInvertSelect,P=e.onRemove,w=e.itemInfo,D=e.onChange,O=e.fieldInfo,R=e.getPopupContainer,j=e.rootContainerId,k=e.projectID,N=e.isPro,A=e.isSpread,L=Tt(Object(o.useState)([]),2),F=L[0],_=L[1],M=Tt(Object(o.useState)(!0),2),x=M[0],W=M[1],Y=Object(o.useContext)(mt.b),H=Y.state.activeFilterContent,V=Y.dispatch,G={},K={},X={},ie=R&&R(),re=Object(o.useMemo)((function(){return Me?Xe.b.get(Xe.a.groupTeamList):h("groupTeamList").groupTeamList}),[]),oe=Tt(Object(o.useState)(re),2),se=oe[0],ce=oe[1],ue=function(){return m===u.PAGE_TYPE.TEAM_VIEW?Object(Et.getAllGroupTeam)({keyword:"",page:1,pageSize:99999}).then((function(e){var t;ce(null!==(t=null===e||void 0===e?void 0:e.data)&&void 0!==t?t:[])}),(function(e){e.code&&Object(gt.danger)(Object(g.t)("\u83b7\u53d6\u8d1f\u8d23\u5c0f\u961f\u5217\u8868\u5931\u8d25"))})):Object(vt.getGroupTeamList)(k,m,!0).then((function(e){var t;ce(null!==(t=e.data.list)&&void 0!==t?t:[])}))},de=Object(o.useMemo)((function(){return Me?Xe.b.get(Xe.a.editionList):h("editionList").editionList}),[]),fe=Tt(Object(o.useState)(de),2),pe=fe[0],me=fe[1],he=function(){return m===u.PAGE_TYPE.TEAM_VIEW?Object(Et.allEditIssueseDition)({keyword:"",page:1,pageSize:99999}).then((function(e){var t=e.data.list.map((function(e){return bt(bt({},e),{id:e.editionId,value:e.editionId,text:e.name})}));me(t)}),(function(e){e.code&&Object(gt.danger)(Object(g.t)("\u83b7\u53d6\u7248\u672c\u5217\u8868\u5931\u8d25"))})):Object(vt.getEditionList)(k,!0).then((function(e){var t,a,n=null===(a=null===(t=e.data)||void 0===t?void 0:t.list)||void 0===a?void 0:a.map((function(e){return bt(bt({},e),{id:e.editionId,value:e.editionId,text:e.name})}));me(n)}))},ve=Object(o.useMemo)((function(){return Me?Xe.b.get(Xe.a.allSystemList):h("allSystemList").allSystemList}),[]),ge=Tt(Object(o.useState)(ve),2),Ee=ge[0],be=ge[1],Se=Tt(Object(o.useState)(""),2),Ie=Se[0],Te=Se[1],Ce=Tt(Object(o.useState)(1),2),Pe=Ce[0],we=Ce[1],De=Tt(Object(o.useState)(1),2),Re=De[0],je=De[1],ke=Tt(Object(o.useState)(!1),2),Ne=ke[0],Ae=ke[1],Le=function(){return m===u.PAGE_TYPE.TEAM_VIEW||m===u.PAGE_TYPE.PRD_REQUIREMENT?(we(1),Te(""),Ae(!0),Object(Et.getSysteminfoList)("").then((function(e){var t,a,n=e.data;be(null!==(a=null===(t=null===n||void 0===n?void 0:n.list)||void 0===t?void 0:t.map((function(e){return bt(bt({},e),{systemId:e.id})})))&&void 0!==a?a:[]),je(null===n||void 0===n?void 0:n.totalPage)}),(function(e){e.code&&Object(gt.danger)(Object(g.t)("\u83b7\u53d6\u6240\u5c5e\u7cfb\u7edf\u5217\u8868\u5931\u8d25"))})).finally((function(){Ae(!1)}))):Object(vt.getAllSystemList)(k,m,!0).then((function(e){be(e.data.list)}))};Object(o.useEffect)((function(){f===u.FilterIssueTypes.GROUP_TEAM?ue():f===u.FilterIssueTypes.SYSTEM?Le():f===u.FilterIssueTypes.EDITION&&he()}),[]);var Fe=function(e){var t=Object(ht.cloneDeep)(H);"CUSTOM"===(null===O||void 0===O?void 0:O.key)?t.conditions=t.conditions.map((function(t){return t.customFieldId&&t.customFieldId===e.customFieldId&&(e.isAllSelect?(t.pingPuValue=w.value,w.constValue&&"UNSPECIFIC"===w.constValue[0]&&(t.pingPuConstValue=w.constValue)):(t.pingPuConstValue=e.constValue,t.pingPuValue=e.value)),t})):t.conditions=t.conditions.map((function(t){return t.key===w.key&&(e.isAllSelect?(t.pingPuValue=w.value,w.constValue&&"UNSPECIFIC"===w.constValue[0]&&(t.pingPuConstValue=w.constValue)):(t.pingPuConstValue=e.constValue,t.pingPuValue=e.value)),t})),V({type:mt.a.setActiveFilterContent,value:bt(bt({},t),{pingPuChange:!0})})},_e=p===r.select?{isPortal:!0,portalProps:{toLeft:!0,portalWrapStyle:{zIndex:2099,width:"280px",marginTop:"3px"},portalContainer:ie||document.body}}:{},Me=m===u.PAGE_TYPE.TEAM_VIEW;if(Object(ze.c)((function(){return yt(void 0,void 0,void 0,(function(){var e;return St(this,(function(t){switch(t.label){case 0:return Object(Je.d)(m)?f!==u.FilterIssueTypes.PARTICIPATED_PROJECT?[3,2]:[4,Object(qe.d)(k)]:[3,4];case 1:e=t.sent().data,_(e.filter((function(e){return!e.archived}))),t.label=2;case 2:return f!==u.FilterIssueTypes.STATUS?[3,4]:[4,Object(Ze.j)(k,m)];case 3:e=t.sent().data,_(e.map((function(e){return e.issueStatus}))),t.label=4;case 4:return W(!1),[2]}}))}))})),x)return s.a.createElement(s.a.Fragment,null);if(Pt[f]){var xe={};w.userMap&&w.selectedItems?xe=Object.keys(w.userMap).length>=Object.keys(w.selectedItems).length?w.userMap:w.selectedItems:w.userMap?xe=w.userMap:w.selectedItems&&(xe=w.selectedItems),G.triggerExtraProps={label:Pt[f],removable:!1,onRemove:function(){P&&P()},initialSelectedItem:Ct(Ct([],Tt(w.constValue&&w.constValue.length?[y.UNSPECIFIC_ITEM]:[]),!1),Tt(w.value.map((function(e){return xe[e]}))),!1)}}if(Me)K.inProject=!1,K.isInProject=!1;else{var Be=h("currentProject").currentProject;K.projectID=Be.id}if(wt[f])return s.a.createElement(q.default,bt({label:p===r.filter?wt[f]:void 0,from:(null===d||void 0===d?void 0:d.startDate)||"",to:(null===d||void 0===d?void 0:d.endDate)||"",onChange:function(e,t){D&&D({startDate:e||"",endDate:t||""})}},X,_e,{expanded:!1}));if("CUSTOM"===(null===O||void 0===O?void 0:O.key)){var Ue=((t={})[O.issueField.id]=w,t);if(-1!==O.componentType.indexOf("_LINE")&&p===r.select)return s.a.createElement($.Input,{className:Q.a.flex1,value:d,onChange:function(e){D&&D(e.target.value)}});var We=[rt.PROPERTY_TYPE_CONSTANTS.TEXT_INTEGER,rt.PROPERTY_TYPE_CONSTANTS.TEXT_DECIMAL];return p===r.select&&We.includes(O.componentType)?s.a.createElement(it,{valueStart:null===d||void 0===d?void 0:d.start,valueEnd:null===d||void 0===d?void 0:d.end,isInteger:O.componentType===rt.PROPERTY_TYPE_CONSTANTS.TEXT_INTEGER,onChange:function(t){e.onCustomChange&&e.onCustomChange({value:t})}}):s.a.createElement(ae.default,bt({issueField:O.issueField,value:Ue,onChange:function(t){var a=t[O.issueField.id];e.onCustomChange&&e.onCustomChange(a)},rootContainerId:j},X,K,_e,{handleChangeCustomSchemeContent:Fe,isSpread:p===r.filter&&w.fixed&&A,modeType:p}))}switch(f){case u.FilterIssueTypes.REQUIREMENT_TYPE:var Ye=void 0;Ye=Me?Xe.b.get(Xe.a.requirementTypes):h("requirementTypes").requirementTypes,console.log("99999999",e);var Qe=null;return p===r.filter&&(G.triggerExtraProps={label:Object(g.t)("\u9700\u6c42\u7c7b\u578b"),removable:!1,onRemove:function(){P&&P()}},Qe={items:Ct([y.UNSPECIFIC_ITEM],Tt(Ye&&Ye.length?Ye.map((function(e){return{id:e.id,value:e.id,text:e.name}})):[]),!1)||[],value:Ct(Ct([],Tt(w.constValue&&w.constValue.length?[y.UNSPECIFIC]:[]),!1),Tt(w.value),!1)||[],label:"\u9700\u6c42\u7c7b\u578b",handleChangeCustomSchemeContent:Fe,fieldKey:ft.FIELD_TYPE.REQUIREMENT_TYPE}),s.a.createElement(b.default,bt({},e,{items:Ct([y.UNSPECIFIC_ITEM],Tt(Ye&&Ye.length?Ye.map((function(e){return{id:e.id,value:e.id,text:e.name}})):[]),!1)||[],onSelect:function(e){T&&T({value:e.id})},isMultiple:!0},G,{pingPuObj:A&&w.fixed&&Qe}));case u.FilterIssueTypes.BASE_ISSUE_TYPE:var $e=[{value:Ve.IssueType.requirement,text:Object(g.t)("\u7528\u6237\u6545\u4e8b"),label:Object(g.t)("\u7528\u6237\u6545\u4e8b"),name:Object(g.t)("\u7528\u6237\u6545\u4e8b"),id:Ve.IssueType.requirement},{value:Ve.IssueType.assignment,text:Object(g.t)("\u4efb\u52a1"),label:Object(g.t)("\u4efb\u52a1"),name:Object(g.t)("\u7528\u6237\u6545\u4e8b"),id:Ve.IssueType.assignment},{value:Ve.IssueType.bug,text:Object(g.t)("\u7f3a\u9677"),label:Object(g.t)("\u7f3a\u9677"),name:Object(g.t)("\u7528\u6237\u6545\u4e8b"),id:Ve.IssueType.bug}];Qe={items:$e,value:Array.isArray(d)?d:[d],label:"\u57fa\u7840\u4e8b\u9879\u7c7b\u578b",handleChangeCustomSchemeContent:Fe,fieldKey:ft.FIELD_TYPE.BASE_ISSUE_TYPE};return w.fixed&&A?s.a.createElement(b.default,bt({},e,{items:$e,onSelect:function(e){D&&D(e.id)}},G,{isMultiple:!0,value:Array.isArray(d)?d:[d],pingPuObj:A&&w.fixed&&Qe})):s.a.createElement(Ge.default,{value:d,className:"filter-select",defaultValue:"ALL",getPopupContainer:R,allowClear:!0,onChange:function(e){D&&D(e)},options:$e},s.a.createElement("span",{style:{cursor:"pointer"},className:"".concat(Q.a.flexBetween,"  ").concat(Q.a.selectTrigger," newfilter-dropdown newfilter-trigger")},s.a.createElement("span",{className:"newfilter-hidden ".concat(Q.a.title),style:{marginRight:"4px"}},Object(g.t)("\u57fa\u7840\u4e8b\u9879\u7c7b\u578b")),(null===(a=$e.find((function(e){return e.value===d})))||void 0===a?void 0:a.label)||Object(g.t)("\u5168\u90e8"),s.a.createElement(Ke.TriangleDown,{className:Q.a.downIcon})));case u.FilterIssueTypes.ASSIGNEE:Qe={items:Ct(Ct([],Tt(w.constValue&&w.constValue.length?[y.UNSPECIFIC_ITEM]:[]),!1),Tt(w.value.map((function(e){return w.userMap[e]}))),!1)||[],value:Ct(Ct([],Tt(w.constValue&&w.constValue.length?[y.UNSPECIFIC]:[]),!1),Tt(w.value),!1)||[],label:"\u5904\u7406\u4eba",handleChangeCustomSchemeContent:Fe,fieldKey:ft.FIELD_TYPE.ASSIGNEE};return s.a.createElement(I.default,bt({},G,e,K,{isMultiple:!0,useUnspecificItem:!0,onSelect:function(e){T&&T(e)},pingPuObj:A&&w.fixed&&Qe,dropdownStyle:w.fixed&&A&&B.a.flatTrigger,componentType:A&&w.fixed?y.ComponentType.FLAT_TYPE:y.ComponentType.FILTER,allUsers:!0}));case u.FilterIssueTypes.ISSUE_TYPE_ID:var at=void 0;if(Me)at=Xe.b.get(Xe.a.IssueTypes);else{var nt=h("issueTypeList").issueTypeList,lt=[Ve.IssueType.requirement,Ve.IssueType.assignment,Ve.IssueType.bug];at=nt.filter((function(e){return e.issueType!==Ve.IssueType.task})),lt.includes(m)?at=at.filter((function(e){return e.issueType===m})):m===Ve.IssueType.iteration_issue&&(at=at.filter((function(e){return lt.includes(e.issueType)})))}return s.a.createElement("div",{className:A&&w.fixed?B.a.dropdwonMargin1:B.a.dropdwonMargin},A&&w.fixed&&s.a.createElement(U.a,{label:"\u4e8b\u9879\u7c7b\u578b",conditions:w,fieldKey:ft.FIELD_TYPE.ISSUE_TYPE_ID,items:at,value:w?w.value:[],handleChangeCustomSchemeContent:Fe}),s.a.createElement(c.default,bt({},e,{list:at,customMenuItem:function(e){var t=e.index,a=e.item,n=e.selected,i=e.onSelect;return s.a.createElement(ne.default,bt({},{index:t,item:a,selected:n,onSelect:i}))},onSelect:function(e){T&&T({value:e})}},X,{multiple:!0,dropdownStyle:w.fixed&&A&&B.a.flatTrigger}),w.fixed&&A?s.a.createElement(pt.a,null):s.a.createElement(ne.IssueTypeTrigger,{list:at||[],label:Object(g.t)("\u4e8b\u9879\u7c7b\u578b"),toolTipText:Object(g.t)("\u53f2\u8bd7\u672a\u5f00\u542f"),noMatched:!1})));case u.FilterIssueTypes.STATUS_TYPE:var ct=Object.keys(l.STATUS_TYPE).map((function(e){return{text:l.STATUS_TYPE[e],name:l.STATUS_TYPE[e],value:e,id:e,iconType:e.toLocaleLowerCase()}}));return s.a.createElement("div",{className:A&&w.fixed?B.a.dropdwonMargin1:B.a.dropdwonMargin},A&&w.fixed&&s.a.createElement(U.a,{label:"\u72b6\u6001\u7c7b\u578b",conditions:w,fieldKey:ft.FIELD_TYPE.STATUS_TYPE,items:ct||[],value:w?w.value:[],handleChangeCustomSchemeContent:Fe}),s.a.createElement(c.default,bt({},e,{list:ct||[],customMenuItem:function(e){var t=e.index,a=e.item,n=e.selected,i=e.onSelect;return s.a.createElement(ne.default,bt({},{index:t,item:a,selected:n,onSelect:i},{key:"".concat(a.value,"-").concat(t)}))},onSelect:function(e){T&&T({value:e})},multiple:!0,dropdownStyle:w.fixed&&A&&B.a.flatTrigger}),A&&w.fixed?s.a.createElement(pt.a,null):s.a.createElement(ne.IssueTypeTrigger,{label:Object(g.t)("\u72b6\u6001\u7c7b\u578b")})));case u.FilterIssueTypes.STATUS:ct=[];return ct=Me?v(Xe.b.get(Xe.a.Status),[]):Object(Je.d)(m)?v(F,[]):function(e){var t=h("subtaskStatus","requirementStatus","prdRequirementStatus","assignmentStatus","issueStatus","allIssueStatus"),a=t.subtaskStatus,n=t.requirementStatus,i=t.prdRequirementStatus,r=t.assignmentStatus,o=t.issueStatus,s=t.allIssueStatus,l=[];return(l=e===u.PAGE_TYPE.REQUIREMENT?n:e===u.PAGE_TYPE.PRD_REQUIREMENT?i:e===u.PAGE_TYPE.ASSIGNMENT?r:e===u.PAGE_TYPE.DEFECT?o:s)&&a?v(l,a):[]}(m),s.a.createElement("div",{className:A&&w.fixed?B.a.dropdwonMargin1:B.a.dropdwonMargin},A&&w.fixed&&s.a.createElement(U.a,{label:"\u72b6\u6001",conditions:w,fieldKey:ft.FIELD_TYPE.STATUS,items:ct||[],value:w?w.value:[],handleChangeCustomSchemeContent:Fe}),s.a.createElement(c.default,bt({},e,{list:ct,customMenuItem:function(e){var t=e.index,a=e.item,n=e.selected,i=e.onSelect;return s.a.createElement(E.default,bt({},{index:t,item:a,selected:n,onSelect:i},{key:"".concat(a.value,"-").concat(t)}))},multiple:!0,searchable:!0,onSelect:function(e){T&&T({value:e})},onInvertSelect:function(e){C&&C(e)}},X,{invertabled:!0,dropdownStyle:w.fixed&&A&&B.a.flatTrigger}),A&&w.fixed?s.a.createElement(pt.a,null):s.a.createElement(ne.IssueTypeTrigger,{label:p===r.filter?Object(g.t)("\u72b6\u6001"):""})));case u.FilterIssueTypes.DEFECT_KIND:var ut=h("defectKinds").defectKinds;Qe=null;return p===r.filter&&(G.triggerExtraProps={label:Object(g.t)("\u7f3a\u9677\u7c7b\u578b"),removable:!1,onRemove:function(){P&&P()}},Qe={items:Ct([y.UNSPECIFIC_ITEM],Tt(ut&&ut.length?ut.map((function(e){return{id:e.id,value:e.id,text:e.name}})):[]),!1)||[],value:e.value,label:"\u7f3a\u9677\u7c7b\u578b",handleChangeCustomSchemeContent:Fe,fieldKey:ft.FIELD_TYPE.DEFECT_KIND}),s.a.createElement(b.default,bt({},e,{items:Ct([y.UNSPECIFIC_ITEM],Tt(ut&&ut.length?ut.map((function(e){return{id:e.id,value:e.id,text:e.name}})):[]),!1)||[],onSelect:function(e){T&&T({value:e.id})},pingPuObj:A&&w.fixed&&Qe,isMultiple:!0},G));case u.FilterIssueTypes.PRIORITY:return s.a.createElement("div",{className:A&&w.fixed?B.a.dropdwonMargin1:B.a.dropdwonMargin},A&&w.fixed&&s.a.createElement(U.a,{label:"\u4f18\u5148\u7ea7",conditions:w,fieldKey:ft.FIELD_TYPE.PRIORITY,applyFilter:function(){},items:y.PRIORITIES,value:e.value,handleChangeCustomSchemeContent:Fe}),s.a.createElement(S.default,bt({},e,{componentType:y.ComponentType.FILTER,onSelect:function(e){T&&T({value:e.id})},isSpread:w.fixed&&A,dropdownStyle:le()(w.fixed&&A&&B.a.flatTrigger),isMultiple:!0},p===r.filter?{triggerExtraProps:{label:Object(g.t)("\u4f18\u5148\u7ea7"),removable:!1,onRemove:function(){P&&P()}}}:{})));case u.FilterIssueTypes.CREATOR:Qe={items:Ct(Ct([],Tt(w.constValue&&w.constValue.length?[y.UNSPECIFIC_ITEM]:[]),!1),Tt(w.value.map((function(e){return w.userMap[e]}))),!1)||[],value:Ct(Ct([],Tt(w.constValue&&w.constValue.length?[y.UNSPECIFIC]:[]),!1),Tt(w.value),!1)||[],label:"\u521b\u5efa\u4eba",handleChangeCustomSchemeContent:Fe,fieldKey:ft.FIELD_TYPE.CREATOR};return s.a.createElement(I.default,bt({},G,e,K,{dropdownStyle:w.fixed&&A&&B.a.flatTrigger,componentType:A&&w.fixed?y.ComponentType.FLAT_TYPE:y.ComponentType.FILTER,isMultiple:!0,onSelect:function(e){T&&T(e)},pingPuObj:A&&w.fixed&&Qe,allUsers:!0}));case u.FilterIssueTypes.WATCHER:Qe={items:Ct(Ct([],Tt(w.constValue&&w.constValue.length?[y.UNSPECIFIC_ITEM]:[]),!1),Tt(w.value.map((function(e){return w.userMap[e]}))),!1)||[],value:Ct(Ct([],Tt(w.constValue&&w.constValue.length?[y.UNSPECIFIC]:[]),!1),Tt(w.value),!1)||[],label:"\u5173\u6ce8\u4eba",handleChangeCustomSchemeContent:Fe,fieldKey:ft.FIELD_TYPE.WATCHER};return s.a.createElement(I.default,bt({},G,e,K,{useUnspecificItem:!0,dropdownStyle:w.fixed&&A&&B.a.flatTrigger,componentType:w.fixed&&A?y.ComponentType.FLAT_TYPE:y.ComponentType.FILTER,isMultiple:!0,onSelect:function(e){T&&T(e)},pingPuObj:A&&w.fixed&&Qe,allUsers:!0}));case u.FilterIssueTypes.PARTICIPANT:Qe={items:Ct(Ct([],Tt(w.constValue&&w.constValue.length?[y.UNSPECIFIC_ITEM]:[]),!1),Tt(w.value.map((function(e){return w.userMap[e]}))),!1)||[],value:Ct(Ct([],Tt(w.constValue&&w.constValue.length?[y.UNSPECIFIC]:[]),!1),Tt(w.value),!1)||[],label:"\u53c2\u4e0e\u4eba",handleChangeCustomSchemeContent:Fe,fieldKey:ft.FIELD_TYPE.PARTICIPANT};return s.a.createElement(I.default,bt({},G,e,K,{useUnspecificItem:!0,isMultiple:!0,onSelect:function(e){T&&T(e)},dropdownStyle:w.fixed&&A&&B.a.flatTrigger,componentType:A&&w.fixed?y.ComponentType.FLAT_TYPE:y.ComponentType.FILTER,pingPuObj:A&&w.fixed&&Qe,allUsers:!0}));case u.FilterIssueTypes.MODULE:var Dt=h("moduleSchemes").moduleSchemes;Qe=null;return p===r.filter&&(G.triggerExtraProps={label:Object(g.t)("\u6a21\u5757"),removable:!1,onRemove:function(){P&&P()}},Qe={items:Ct([y.UNSPECIFIC_ITEM],Tt(Dt&&Dt.length?Dt.map((function(e){return{id:e.id,value:e.id,text:e.name}})):[]),!1)||[],value:w?Ct(Ct([],Tt(w.constValue&&w.constValue.length?[y.UNSPECIFIC]:[]),!1),Tt(w.value),!1):[],label:"\u6a21\u5757",handleChangeCustomSchemeContent:Fe,fieldKey:ft.FIELD_TYPE.MODULE}),s.a.createElement(b.default,bt({},e,{items:Ct([y.UNSPECIFIC_ITEM],Tt(Dt&&Dt.length?Dt.map((function(e){return{id:e.id,value:e.id,text:e.name}})):[]),!1)||[],onSelect:function(e){T&&T({value:e.id})},pingPuObj:A&&w.fixed&&Qe,isMultiple:!0},G));case u.FilterIssueTypes.LABEL:var Ot=void 0;return Ot=Me?Xe.b.get(Xe.a.Labels):m===u.PAGE_TYPE.PRD_REQUIREMENT?h("productGroupLabelList").productGroupLabelList:h("labels").labels,s.a.createElement("div",{className:A&&w.fixed?B.a.dropdwonMargin1:B.a.dropdwonMargin},A&&w.fixed&&s.a.createElement(U.a,{label:"\u6807\u7b7e",conditions:w,fieldKey:ft.FIELD_TYPE.LABEL,items:Ct([y.UNSPECIFIC_ITEM],Tt(Ot.length?Ot.map((function(e){return bt(bt({},e),{value:e.id,text:e.name})})):[]),!1),value:w?Ct(Ct([],Tt(w.constValue&&w.constValue.length?[y.UNSPECIFIC]:[]),!1),Tt(w.value),!1):[],handleChangeCustomSchemeContent:Fe}),s.a.createElement(c.default,bt({},e,{list:Ct([y.UNSPECIFIC_ITEM],Tt(Ot.length?Ot.map((function(e){return bt(bt({},e),{value:e.id,text:e.name})})):[]),!1),searchable:!0,customMenuItem:function(e){var t=e.index,a=e.item,n=e.selected,i=e.onSelect;return s.a.createElement(Z.default,bt({},{index:t,item:a,selected:n,onSelect:i},{key:"label-".concat(t)}))},multiple:!0,onSelect:function(e){T&&T({value:e})}},X,{dropdownStyle:w.fixed&&A&&B.a.flatTrigger}),A&&w.fixed?s.a.createElement(pt.a,null):s.a.createElement(Z.LabelTrigger,{label:p===r.filter?Object(g.t)("\u6807\u7b7e"):""})));case u.FilterIssueTypes.WORKING_HOURS:return p===r.select?s.a.createElement(it,{unit:Object(g.t)("\u5929"),ride:8,valueStart:null===d||void 0===d?void 0:d.start,valueEnd:null===d||void 0===d?void 0:d.end,onChange:function(e){return D(e)}}):s.a.createElement(J.default,bt({onChange:function(e,t){D&&D({start:e||null,end:t||null})},label:Object(g.t)("\u9884\u4f30\u5de5\u65f6"),unit:Object(g.t)("\u5929"),ride:8,maxValue:999999999,minValue:0,from:(null===d||void 0===d?void 0:d.start)||"",to:(null===d||void 0===d?void 0:d.end)||""},X,{isInteger:!1,expanded:!1}));case u.FilterIssueTypes.SYSTEM:Qe=null;p===r.filter&&(G.triggerExtraProps={label:Object(g.t)("\u6240\u5c5e\u7cfb\u7edf"),removable:!1,onRemove:function(){P&&P()}},Qe={items:Ct([y.UNSPECIFIC_ITEM],Tt(Ee.map((function(e){var t=e.systemId;return{id:t,value:t,text:e.systemName}}))),!1),value:w?Ct(Ct([],Tt(w.constValue&&w.constValue.length?[y.UNSPECIFIC]:[]),!1),Tt(w.value),!1):[],label:"\u6240\u5c5e\u7cfb\u7edf",handleChangeCustomSchemeContent:Fe,fieldKey:ft.FIELD_TYPE.SYSTEM});var Rt=Ie?[]:Object.keys((null===w||void 0===w?void 0:w.selectedItems)||{}).map((function(e){return null===w||void 0===w?void 0:w.selectedItems[e]}));return s.a.createElement(b.default,bt({},e,{items:Object(ht.uniqBy)(Ct(Ct([y.UNSPECIFIC_ITEM],Tt(Ee.map((function(e){var t=e.systemId;return{id:t,value:t,text:e.systemName}}))),!1),Tt(Rt.map((function(e){var t=e.systemId;return{id:t,value:t,text:e.systemName}}))),!1),(function(e){return e.id})),onSelect:function(e){T&&T({value:e.id,systemId:e.value,systemName:e.text})},isMultiple:!0},G,{pingPuObj:A&&w.fixed&&Qe,onExpandOpen:Le,onSearch:m===u.PAGE_TYPE.TEAM_VIEW||m===u.PAGE_TYPE.PRD_REQUIREMENT?function(e){return Te(e),we(1),Ae(!0),Object(Et.getSysteminfoList)(e).then((function(e){var t,a,n=e.data;be(null!==(a=null===(t=null===n||void 0===n?void 0:n.list)||void 0===t?void 0:t.map((function(e){return bt(bt({},e),{systemId:e.id})})))&&void 0!==a?a:[]),je(null===n||void 0===n?void 0:n.totalPage)}),(function(e){e.code&&Object(gt.danger)(Object(g.t)("\u83b7\u53d6\u6240\u5c5e\u7cfb\u7edf\u5217\u8868\u5931\u8d25"))})).finally((function(){Ae(!1)}))}:void 0,triggerExtraProps:{label:Object(g.t)("\u6240\u5c5e\u7cfb\u7edf"),initialSelectedItem:w&&(null===w||void 0===w?void 0:w.selectedItems)?Object.keys((null===w||void 0===w?void 0:w.selectedItems)||{}).map((function(e){return null===w||void 0===w?void 0:w.selectedItems[e]})).map((function(e){return bt(bt({},e),{id:e.systemId,value:e.systemId,text:e.systemName})})):void 0,removable:!1,onRemove:function(){P&&P()}},dataInited:!0,onReachBottom:function(e){e&&function(){if(!Ne&&Re>Pe){var e=Pe+1,t=Ee;Ae(!0),Object(Et.getSysteminfoList)(Ie,e).then((function(a){var n,i,r=a.data;we(e),je(null===r||void 0===r?void 0:r.totalPage),be(null!==(i=t.concat(null===(n=null===r||void 0===r?void 0:r.list)||void 0===n?void 0:n.map((function(e){return bt(bt({},e),{systemId:e.id})}))))&&void 0!==i?i:[])})).finally((function(){Ae(!1)}))}}()}}));case u.FilterIssueTypes.GROUP_TEAM:Qe=null;return p===r.filter&&(G.triggerExtraProps={label:Object(g.t)("\u8d1f\u8d23\u5c0f\u961f"),removable:!1,onRemove:function(){P&&P()}},Qe={items:Ct([y.UNSPECIFIC_ITEM],Tt(se.map((function(e){var t=e.id;return{id:t,value:t,text:e.groupTeamName}}))),!1),value:d,label:"\u8d1f\u8d23\u5c0f\u961f",handleChangeCustomSchemeContent:Fe,fieldKey:ft.FIELD_TYPE.GROUP_TEAM}),s.a.createElement(b.default,bt({},e,{items:Ct([y.UNSPECIFIC_ITEM],Tt(se.map((function(e){var t=e.id;return{id:t,value:t,text:e.groupTeamName}}))),!1),onSelect:function(e){T&&T({value:e.id})},isMultiple:!0},G,{pingPuObj:A&&w.fixed&&Qe,onExpandOpen:ue}));case u.FilterIssueTypes.PRODUCT_GROUP_ID:var jt=h("productGroupList").productGroupList||[];return p===r.filter&&(G.triggerExtraProps={label:Object(g.t)("\u4ea7\u54c1\u7ec4"),removable:!1,onRemove:function(){P&&P()}}),s.a.createElement(b.default,bt({},e,{items:Ct([y.UNSPECIFIC_ITEM],Tt(jt.map((function(e){var t=e.id;return{id:t,value:t,text:e.text}}))),!1),onSelect:function(e){T&&T({value:e.id})},isMultiple:!0},G));case u.FilterIssueTypes.PROPOSER:Qe={items:Ct(Ct([],Tt(w.constValue&&w.constValue.length?[y.UNSPECIFIC_ITEM]:[]),!1),Tt(w.value.map((function(e){return w.userMap[e]}))),!1)||[],value:Ct(Ct([],Tt(w.constValue&&w.constValue.length?[y.UNSPECIFIC]:[]),!1),Tt(w.value),!1)||[],label:"\u9700\u6c42\u63d0\u51fa\u4eba",handleChangeCustomSchemeContent:Fe,fieldKey:ft.FIELD_TYPE.PROPOSER};return s.a.createElement(z,bt({},G,e,K,{componentType:y.ComponentType.FILTER,onSelect:function(e){T&&T(e)},isMultiple:!0,dropdownStyle:w.fixed&&A&&B.a.flatTrigger,pingPuObj:A&&w.fixed&&Qe,inProject:!0,allUsers:!0}));case u.FilterIssueTypes.DEFECT_SOURCE:var kt=void 0;kt=Me?Xe.b.get(Xe.a.defectSources):h("defectSources").defectSources,p===r.filter&&(G.triggerExtraProps={label:Object(g.t)("\u7f3a\u9677\u53d1\u73b0\u9636\u6bb5"),removable:!1,onRemove:function(){P&&P()}});Qe={items:Ct([y.UNSPECIFIC_ITEM],Tt(kt),!1),value:w?Ct(Ct([],Tt(w.constValue&&w.constValue.length?[y.UNSPECIFIC]:[]),!1),Tt(w.value),!1):[],label:"\u7f3a\u9677\u53d1\u73b0\u9636\u6bb5",handleChangeCustomSchemeContent:Fe,fieldKey:ft.FIELD_TYPE.DEFECT_SOURCE};return s.a.createElement(b.default,bt({},e,{items:Ct([y.UNSPECIFIC_ITEM],Tt(kt),!1),onSelect:function(e){T&&T({value:e.id})},isMultiple:!0},G,{pingPuObj:A&&w.fixed&&Qe}));case u.FilterIssueTypes.INPROGRAM:e.issueType;var Nt=It(e,["issueType"]);return s.a.createElement(st.default,bt({},Nt,{componentType:y.ComponentType.FILTER,isMultiple:!0,onSelect:function(e){T&&T(e)},triggerExtraProps:{label:Object(g.t)("\u6240\u5c5e\u9879\u76ee"),initialSelectedItem:w&&(null===(n=w.validInfo)||void 0===n?void 0:n.length)>0?w.validInfo.map((function(e){return bt(bt({},e),{text:e.name})})):void 0,removable:!0,onRemove:function(){P&&P()}}}));case u.FilterIssueTypes.MILESTONE:var At=h("allMilestonesList").allMilestonesList;Qe=null;return p===r.filter&&(G.triggerExtraProps={label:Object(g.t)("\u6240\u5c5e\u91cc\u7a0b\u7891"),removable:!1,onRemove:function(){P&&P()}},Qe={items:[At],value:w?Ct(Ct([],Tt(w.constValue&&w.constValue.length?[y.UNSPECIFIC]:[]),!1),Tt(w.value),!1):[],label:"\u7f3a\u9677\u53d1\u73b0\u9636\u6bb5",handleChangeCustomSchemeContent:Fe,fieldKey:ft.FIELD_TYPE.MILESTONE}),s.a.createElement(b.default,bt({},e,{items:At,onSelect:function(e){T&&T({value:e.id})},isMultiple:!0},G,{pingPuObj:A&&w.fixed&&Qe}));case u.FilterIssueTypes.RBLKHXG:var Lt=h("RBLKHXGList").RBLKHXGList;Qe=null;return p===r.filter&&(G.triggerExtraProps={label:Object(g.t)("\u662f\u5426\u4e0e\u5ba2\u6237\u76f8\u5173"),removable:!1,onRemove:function(){P&&P()}},Qe={items:[Lt],value:w?Ct(Ct([],Tt(w.constValue&&w.constValue.length?[y.UNSPECIFIC]:[]),!1),Tt(w.value),!1):[],label:"\u662f\u5426\u4e0e\u5ba2\u6237\u76f8\u5173",handleChangeCustomSchemeContent:Fe,fieldKey:ft.FIELD_TYPE.RBLKHXG}),s.a.createElement(b.default,bt({},e,{items:Lt,onSelect:function(e){T&&T({value:e.id})},isMultiple:!0},G,{pingPuObj:A&&w.fixed&&Qe}));case u.FilterIssueTypes.RBLSJXG:var Ft=h("RBLSJXGList").RBLSJXGList;Qe=null;return p===r.filter&&(G.triggerExtraProps={label:Object(g.t)("\u662f\u5426\u4e0e\u6570\u636e\u76f8\u5173"),removable:!1,onRemove:function(){P&&P()}},Qe={items:[Ft],value:w?Ct(Ct([],Tt(w.constValue&&w.constValue.length?[y.UNSPECIFIC]:[]),!1),Tt(w.value),!1):[],label:"\u662f\u5426\u4e0e\u6570\u636e\u76f8\u5173",handleChangeCustomSchemeContent:Fe,fieldKey:ft.FIELD_TYPE.RBLSJXG}),s.a.createElement(b.default,bt({},e,{items:Ft,onSelect:function(e){T&&T({value:e.id})},isMultiple:!0},G,{pingPuObj:A&&w.fixed&&Qe}));case u.FilterIssueTypes.DEFECT_PHASE:var _t=h("defectPhases").defectPhases;Qe=null;return p===r.filter&&(G.triggerExtraProps={label:Object(g.t)("\u5f15\u5165\u7f3a\u9677\u9636\u6bb5"),removable:!1,onRemove:function(){P&&P()}},Qe={items:Ct([y.UNSPECIFIC_ITEM],Tt(_t),!1),value:e.value,label:"\u5f15\u5165\u7f3a\u9677\u9636\u6bb5",handleChangeCustomSchemeContent:Fe,fieldKey:ft.FIELD_TYPE.DEFECT_PHASE}),s.a.createElement(b.default,bt({},e,{items:Ct([y.UNSPECIFIC_ITEM],Tt(_t),!1),onSelect:function(e){T&&T({value:e.id})},isMultiple:!0},G,{pingPuObj:A&&w.fixed&&Qe}));case u.FilterIssueTypes.PRD_REQUIREMENT:var Mt=h("prdRequirementList").prdRequirementList;Qe=null;return p===r.filter&&(G.triggerExtraProps={label:Object(g.t)("\u5173\u8054\u4ea7\u54c1\u9700\u6c42"),removable:!1,onRemove:function(){P&&P()}},Qe={items:Mt,value:e.value,label:"\u5173\u8054\u4ea7\u54c1\u9700\u6c42",handleChangeCustomSchemeContent:Fe,fieldKey:ft.FIELD_TYPE.PRD_REQUIREMENT}),s.a.createElement(b.default,bt({},e,{items:Mt,onSelect:function(e){T&&T({value:e.id})},isMultiple:!0},G,{pingPuObj:A&&w.fixed&&Qe}));case u.FilterIssueTypes.ORD_REQUIREMENT:var xt=h("ordRequirementList").ordRequirementList;Qe=null;return p===r.filter&&(G.triggerExtraProps={label:Object(g.t)("\u5173\u8054\u8fd0\u8425\u9700\u6c42"),removable:!1,onRemove:function(){P&&P()}},Qe={items:xt,value:e.value,label:"\u5173\u8054\u8fd0\u8425\u9700\u6c42",handleChangeCustomSchemeContent:Fe,fieldKey:ft.FIELD_TYPE.ORD_REQUIREMENT}),s.a.createElement(b.default,bt({},e,{items:xt,onSelect:function(e){T&&T({value:e.id})},isMultiple:!0},G,{pingPuObj:A&&w.fixed&&Qe}));case u.FilterIssueTypes.IS_RISK:p===r.filter&&(G.triggerExtraProps={label:Object(g.t)("\u662f\u5426\u6709\u98ce\u9669"),removable:!1,onRemove:function(){P&&P()}});Qe={items:l.IS_RISK_LIST,value:Array.isArray(d)?d:[d],label:"\u662f\u5426\u6709\u98ce\u9669",handleChangeCustomSchemeContent:Fe,fieldKey:ft.FIELD_TYPE.IS_RISK};return s.a.createElement(b.default,bt({},e,{items:l.IS_RISK_LIST,onSelect:function(e){T&&T({value:e.id})},isMultiple:!0},G,{pingPuObj:A&&w.fixed&&Qe}));case u.FilterIssueTypes.EDITION:p===r.filter&&(G.triggerExtraProps={label:Object(g.t)("\u7248\u672c"),removable:!1,onRemove:function(){P&&P()}});Qe={items:Ct([y.UNSPECIFIC_ITEM],Tt(pe||[]),!1),value:d,label:"\u7248\u672c",handleChangeCustomSchemeContent:Fe,fieldKey:ft.FIELD_TYPE.EDITION};return s.a.createElement(b.default,bt({},e,{items:Ct([y.UNSPECIFIC_ITEM],Tt(pe||[]),!1),onSelect:function(e){T&&T({value:e.id})},isMultiple:!0},G,{pingPuObj:A&&w.fixed&&Qe,onExpandOpen:he}));case u.FilterIssueTypes.PROGRESS:return p===r.select?s.a.createElement(it,{max:100,unit:"%",valueStart:null===d||void 0===d?void 0:d.start,valueEnd:null===d||void 0===d?void 0:d.end,onChange:function(e){return D(e)}}):s.a.createElement(J.default,bt({onChange:function(e,t){D&&D({start:e||null,end:t||null})},label:Object(g.t)("\u8fdb\u5ea6"),unit:Object(g.t)("%"),maxValue:100,minValue:0,from:(null===d||void 0===d?void 0:d.start)||"",to:(null===d||void 0===d?void 0:d.end)||""},X,{isInteger:!0,expanded:!1}));case u.FilterIssueTypes.ITERATION:if(Me)return s.a.createElement(tt,null,s.a.createElement(et.Consumer,null,(function(t){var a=t.iterations,n=t.onSearch,i=t.loadMore;return s.a.createElement(ee.a,bt({},e,{whichIs:"ITERATION",list:a,multiple:!0,iteration:!0,onSearch:n,value:d.length?a.filter((function(e){return d.includes(e.id)})):[],onSelect:function(e){D&&D(e.map((function(e){return e.id})))}},X,{onReachBottom:function(e){e&&i()},useUndefined:!0,onUndefined:function(){T&&T({value:"UNSPECIFIC"})},undefinedConst:!(!w||!w.constValue)&&w.constValue.length>0}),s.a.createElement(te.IterationTrigger,{title:Object(g.t)("\u8fed\u4ee3"),valueChanged:w&&w.valueChanged,noMatched:w&&w.status&&"NONE"===w.status}))})));var Bt=h("simpleIterations").simpleIterations;if(w.fixed&&A){Qe={items:Ct([y.UNSPECIFIC_ITERATION],Tt(Object(te.formatIterationItemInPM)(Bt)),!1),value:Ct(Ct([],Tt(w.constValue&&w.constValue.length?[y.UNSPECIFIC]:[]),!1),Tt(w.value),!1)||[],label:"\u8fed\u4ee3",handleChangeCustomSchemeContent:Fe,fieldKey:ft.FIELD_TYPE.SYSTEM};return s.a.createElement(b.default,bt({},e,{items:Ct([y.UNSPECIFIC_ITERATION],Tt(Object(te.formatIterationItemInPM)(Bt)),!1),onSelect:function(e){T&&T({value:e.id})},isMultiple:!0},G,{pingPuObj:A&&w.fixed&&Qe}))}return s.a.createElement(dt,bt({},e,{whichIs:"ITERATION",className:"newfilter-dropdown",list:Object(te.formatIterationItemInPM)(Bt),multiple:!0,fat:!0,value:w?Object(te.formatIterationItemInPM)(Bt).filter((function(e){return w.value.includes(e.id)})):[],singleReturn:!0,onSelect:function(e){T&&T(e[0])}},X,{useUndefined:!0,onUndefined:function(){T&&T({value:"UNSPECIFIC"})},undefinedConst:!(!w||!w.constValue)&&w.constValue.length>0,dropdownStyle:w.fixed&&A&&B.a.flatTrigger}),w.fixed&&A?s.a.createElement(pt.a,null):s.a.createElement(te.IterationTrigger,{title:p===r.filter?Object(g.t)("\u8fed\u4ee3"):""}));case u.FilterIssueTypes.ASSOCIATE_RELEASE:Be=h("currentProject").currentProject;return s.a.createElement(ye,bt({},e,{projectId:Be.id,onSelect:function(e){T&&T(e)}},G,{isSpread:!1}));case u.FilterIssueTypes.ASSOCIATE_PROGRAM:Be=h("currentProject").currentProject;return s.a.createElement(Oe,bt({},e,{projectId:Be.id,onSelect:function(e){T&&T(e)}},G,{isSpread:!1}));case u.FilterIssueTypes.ASSOCIATE_REQUIREMENT:Be=h("currentProject").currentProject;return s.a.createElement(He,bt({},e,{projectId:Be.id,projectName:Be.name,onSelect:function(e){T&&T(e)}},G,{isSpread:!1}));case u.FilterIssueTypes.PARTICIPATED_PROJECT:return s.a.createElement(b.default,bt({},e,{items:Ct([],Tt(F&&F.length?F.map((function(e){return{id:e.id,value:e.id,text:e.display_name}})):[]),!1)||[],onSelect:function(e){T&&T({value:e.id})},isMultiple:!0,triggerExtraProps:{label:Object(g.t)("\u53c2\u4e0e\u9879\u76ee"),removable:!1,onRemove:function(){P&&P()}},isSpread:!1}));case u.FilterIssueTypes.PROJECT:return s.a.createElement(ot.b,bt({},e,{isPro:N,componentType:y.ComponentType.FILTER,dataType:ot.a.PROJECT,isMultiple:!0,onSelect:function(e){T&&T(e)},triggerExtraProps:{label:Object(g.t)("\u7814\u53d1\u7a7a\u95f4"),initialSelectedItem:w&&(null===(i=w.validInfo)||void 0===i?void 0:i.length)>0?w.validInfo.map((function(e){return bt(bt({},e),{text:e.name})})):void 0,valueChanged:w&&w.valueChanged,noMatched:w&&w.status&&"NONE"===w.status},isSpread:!1}));default:return s.a.createElement(s.a.Fragment,null)}};!function(e){e.filter="Filter",e.select="Select"}(r||(r={}));t.b=Dt},wCj3:function(e,t,a){"use strict";a("I5cv"),a("ioFf"),a("mYba"),a("jm62"),a("EK0E");var n=a("TqRt"),i=a("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(a("o0o1"));a("dRSK"),a("f3/d"),a("Btvt"),a("VRzm"),a("Z2Ku"),a("bWfx"),a("0l/t"),a("CX2u"),a("XfO3"),a("yt8O"),a("rGqo"),a("INYr"),a("RW0V");var o,s,l,c=n(a("RIqP")),u=n(a("lSNA")),d=n(a("yXPU")),f=n(a("lwsE")),p=n(a("W8MJ")),m=n(a("PJYZ")),h=n(a("7W2i")),v=n(a("a1gu")),g=n(a("Nsbk")),E=a("mVeg"),b=re(a("cDcd")),y=n(a("17x9")),S=n(a("V/h/")),I=n(a("Zsd2")),T=n(a("E+oP")),C=n(a("Y+p1")),P=n(a("zqxM")),w=n(a("NIJN")),D=a("79W0"),O=a("7bn+"),R=a("nuIr"),j=a("DgMC"),k=a("DgMC"),N=a("xgZS"),A=a("Z4vw"),L=a("vi3I"),F=a("w3Wo"),_=a("aHEs"),M=a("82Y3"),x=a("h74D"),B=n(a("mSbZ")),U=n(a("htee")),W=n(a("4Fdf")),Y=n(a("sftu")),H=n(a("KUqB")),V=n(a("Th6D")),G=re(a("NI22")),K=n(a("SLo4")),z=n(a("z0hg")),q=n(a("SUhN")),Z=n(a("QPj7")),J=a("885C"),X=n(a("T8xO")),Q=n(a("L8Eh")),$=n(a("XLbL")),ee=a("LC46"),te=n(a("K2gz")),ae=n(a("1hCk")),ne=n(a("246l"));function ie(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(ie=function(e){return e?a:t})(e)}function re(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!==typeof e)return{default:e};var a=ie(t);if(a&&a.has(e))return a.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=r?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}return n.default=e,a&&a.set(e,n),n}function oe(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function se(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(a),!0).forEach((function(t){(0,u.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):oe(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function le(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,g.default)(e);if(t){var i=(0,g.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,v.default)(this,a)}}var ce=(0,x.connect)((function(e){var t=e.APP,a=t.enterprise;return{user:t.user,enterpriseGlobalKey:a.key}}))(o=(0,B.default)(o=(0,U.default)(o=(0,W.default)((l=s=function(e){(0,h.default)(a,e);var t=le(a);function a(e){var n;return(0,f.default)(this,a),(n=t.call(this,e)).getAssigneeFieldWhetherRequired=function(e,t,a){if(!e||!t.length||!a)return!1;var n=t.find((function(t){return e[t].issueField.type===a}));return!!n&&e[n].required},n.initCreatePage=function(){var e=n.props,t=e.currentProject,a=e.issueTypeDetail,i=n.state,r=i.name,o=i.editorType;return(0,G.isBlockType)(o)?(0,_.fetchMarkdownTemplate)(t.name,a.id).then((function(e){var t=e.data;n.setState({initEditorData:{pageId:t.pageId,pageDraftId:t.draftId,historyId:t.historyId},editorAutoFocus:!!r,showDescriptionPlaceholder:!1})})):Promise.resolve()},n.copyCreatePage=function(){var e=(0,d.default)(r.default.mark((function e(t){var a,i,o,s;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.props.currentProject,i=n.state.editorType,(0,G.isBlockType)(i)){e.next=4;break}return e.abrupt("return",Promise.resolve());case 4:return e.next=6,(0,F.copyMarkdownTemplate)(a.id,t);case 6:return o=e.sent,s=o.data,n.setState({initEditorData:{pageId:s.pageId,pageDraftId:s.draftId,historyId:s.historyId}}),e.abrupt("return",Promise.resolve());case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleAttentionChange=function(e){n.changeAttributes({type:"watchers",value:e})},n.onDescriptionChange=function(e){if(!e.isEmpty){var t="".concat(n.props.currentProject.name,"_").concat(n.props.issueTypeDetail.issueType,"_").concat(n.props.issueTypeDetail.id,"_CREATOR");(0,G.setIssueDescriptionDraft)(t,n.state.initEditorData)}},n.onDescriptionScroll=function(){n.getAttachmentsStickyState()},n.onUpdateStateAndStorage=function(e,t){n.setState({autoNext:e,autoCopyNext:t},(function(){localStorage.setItem("SUBTASK_CREATION_AUTO_NEXT",e),localStorage.setItem("SUBTASK_CREATION_AUTO_COPY_NEXT",t)}))},n.onEditorTypeChange=function(e){if((0,M.setPreferEditorType)(e),n.setState({editorType:e}),(0,G.isBlockType)(e))return n.removeDraft(),void n.initCreatePage();var t="".concat(n.props.currentProject.name,"_").concat(n.props.issueTypeDetail.issueType,"_").concat(n.props.issueTypeDetail.id,"_CREATOR");(0,G.setIssueDescriptionDraft)(t);var a={pageId:n.state.initEditorData.pageId,pageDraftId:n.state.initEditorData.pageDraftId,module:"collaboration",function:"description",scopeType:"project",scopeId:n.props.currentProject.id};(0,G.delPageDraft)(a).then((function(){return n.setState({initEditorData:null})}))},n.onCancel=function(){n.props.closeHandle()},n.removeDraft=function(){var e,t;null!==(e=n.editorRef)&&void 0!==e&&null!==(t=e.current)&&void 0!==t&&t.removeDraft&&n.editorRef.current.removeDraft()},n.onAttrScroll=function(){n.setState({isElemScroll:!0})},n.validateDefect=function(e,t){var a,i=n.state.attributes,r=null===(a=n.props.subtaskSchemeFieldArchives[e])||void 0===a?void 0:a.issueField,o=["\u81f4\u547d","\u4e25\u91cd"],s=!!r&&r.options.find((function(e){return e.value===t&&o.includes(e.name)}));return!(!r||"\u7f3a\u9677\u4e25\u91cd\u7a0b\u5ea6"!==r.name||!s||i.defectKindIds.length&&i.defectPhaseId)&&((0,N.warning)((0,E.t)("\u8bf7\u5148\u586b\u5199\u201c\u5f15\u5165\u7f3a\u9677\u9636\u6bb5\u201d\u548c\u201c\u7f3a\u9677\u7c7b\u578b\u201d")),!0)},n.quickSave=function(e){n.state.isMac?e.metaKey&&"Enter"===e.key&&n.onSubmit():e.ctrlKey&&"Enter"===e.key&&n.onSubmit()},n.startEditing=function(e){n.state.isMac?e.metaKey||"Enter"!==e.key||n.setState({showDescriptionPlaceholder:!1}):e.ctrlKey||"Enter"!==e.key||n.setState({showDescriptionPlaceholder:!1})},n.getAssigneeFieldWhetherRequired=function(e,t){if(!e||!t.length)return!1;var a=t.find((function(t){return"ASSIGNEE"===e[t].issueField.type}));return e[a].required},n.getHeights=function(){var e=Math.max(320,Math.min(680,document.body.clientHeight-120-300)),t=Math.max(320,Math.min(460,document.body.clientHeight-120-300));n.setState({maxMainBodyHeight:e,editorMinHeight:t},n.getAttachmentsStickyState)},n.getAttachmentsStickyState=function(){var e,t=null===(e=n.bodyRef)||void 0===e?void 0:e.current;n.setState({attachmentsSticky:t&&t.scrollTop+t.offsetHeight<t.scrollHeight&&t.scrollHeight>t.clientHeight})},n.titleInputFocus=function(){var e,t;null===(e=n.inputRef)||void 0===e||null===(t=e.current)||void 0===t||t.focus()},n.combineThirdLinks=function(){var e=n.state,t=e.attachments,a=e.thirdLinks;if(a){var i=a.map((function(e){if(e.name)return e;var t=e.isModao,a=e.isCodesign,n="";return t&&(n=e.modao.title||(0,E.t)("\u58a8\u5200\u9644\u4ef6")),a&&(n=e.codesign.title),se(se({},e),{},{noUpload:!0,isModao:t,isCodesign:a,name:n,createdAt:e.timestamp})})),r=[].concat((0,c.default)(t),(0,c.default)(i));n.setState({allAttachments:n.sortAttachments(r)})}else n.setState({allAttachments:n.sortAttachments(t)})},n.sortAttachments=function(e){var t=(0,c.default)(e);return t.sort((function(e,t){return e.timestamp-t.timestamp})),t},n.onAddThirdLink=function(e){n.hideImportOutResourcePicker(),n.setState({thirdLinks:[].concat((0,c.default)(n.state.thirdLinks),(0,c.default)(e))},n.combineThirdLinks)},n.showImportOutResourcePicker=function(){n.setState({isShowImportOutResourcePicker:!0})},n.hideImportOutResourcePicker=function(){n.setState({isShowImportOutResourcePicker:!1})},n.state={name:e.title,autoNext:"true"===localStorage.getItem("SUBTASK_CREATION_AUTO_NEXT"),autoCopyNext:"true"===localStorage.getItem("SUBTASK_CREATION_AUTO_COPY_NEXT"),isPending:!1,isLoading:!0,attributes:{assignee:void 0,priority:void 0,requirementType:void 0,startDate:void 0,dueDate:void 0,workingHours:void 0,projectModule:void 0,defectType:void 0,labels:[],watchers:[],fields:{},progress:void 0,estimatedWorkHour:void 0,defectKindIds:[],defectPhaseId:void 0,defectSourceId:void 0,wuKongReloadId:void 0,serialNum:void 0,rblkhxgProperty:void 0,rblsjxgProperty:void 0,systemsId:void 0,participants:[]},isReloading:!1,isElemScroll:!1,isMac:(0,j.isMac)(),initEditorData:null,showDescriptionPlaceholder:!0,editorAutoFocus:!0,attachmentsSticky:!1,maxMainBodyHeight:0,editorMinHeight:0,editorType:(0,M.getPreferEditorType)(),fullscreen:!1,allAttachments:[],attachments:[],isShowImportOutResourcePicker:!1,thirdLinks:[],showButton:!1,toLeft:0},n.inputRef=b.default.createRef(),n.bodyRef=b.default.createRef(),n.editorRef=b.default.createRef(),n.sideRef=b.default.createRef(),n.setDefaultValues=n.setDefaultValues.bind((0,m.default)(n)),n.onTitleChange=n.onTitleChange.bind((0,m.default)(n)),n.onSubmit=n.onSubmit.bind((0,m.default)(n)),n.resetFormData=n.resetFormData.bind((0,m.default)(n)),n.resetPartialFormData=n.resetPartialFormData.bind((0,m.default)(n)),n.onAutoFlagChange=n.onAutoFlagChange.bind((0,m.default)(n)),n.onAutoCopyFlagChange=n.onAutoCopyFlagChange.bind((0,m.default)(n)),n.onUpdateStateAndStorage=n.onUpdateStateAndStorage.bind((0,m.default)(n)),n.changeAttributes=n.changeAttributes.bind((0,m.default)(n)),n.wrapperRef=b.default.createRef(),n.listRef=b.default.createRef(),n.moveContent=n.moveContent.bind((0,m.default)(n)),n.handleDeleteAttachment=n.handleDeleteAttachment.bind((0,m.default)(n)),n.onFileDropSuccess=n.onFileDropSuccess.bind((0,m.default)(n)),n.onFileDropFail=n.onFileDropFail.bind((0,m.default)(n)),n.onFileDropDelete=n.onFileDropDelete.bind((0,m.default)(n)),n.onFileDropCancel=n.onFileDropCancel.bind((0,m.default)(n)),n.fileUpload=n.fileUpload.bind((0,m.default)(n)),n}return(0,p.default)(a,[{key:"renderAttachmentSection",value:function(){var e=this,t=this.state,a=t.attachments,n=t.allAttachments,i=t.isShowImportOutResourcePicker,r=t.showButton,o=t.toLeft,s=this.props,l=s.enterpriseGlobalKey,c=s.currentProject,u=s.user,d=c.name,f=c.id;return b.default.createElement("div",{className:ae.default.attachementSectionContainer},b.default.createElement("div",{className:ae.default.sectionHeader},b.default.createElement("span",{className:ae.default.title},(0,E.t)("\u9644\u4ef6")),b.default.createElement("span",{className:ae.default.dividerLine}),b.default.createElement(K.default,{onHandleAttachments:this.fileUpload,currentAttachmentNum:a.length,attachmentLimit:n.length>=20},b.default.createElement("a",{className:ae.default.uploadButton},(0,E.t)("\u672c\u5730\u4e0a\u4f20"))),b.default.createElement("div",{className:ae.default.importOutResourceWrap},b.default.createElement(q.default,{onHandleAttachments:this.onAddThirdLink,isShowPicker:i,onShow:this.showImportOutResourcePicker,onHide:this.hideImportOutResourcePicker,attachmentLimit:n.length>=20}))),b.default.createElement("div",{className:ae.default.attachmentSection},n.length?b.default.createElement("div",{className:(0,te.default)(ae.default.attachmentWrapper,r&&ae.default.rightBorder,o<0&&ae.default.leftBorder),ref:this.wrapperRef},b.default.createElement("div",{className:ae.default.attachmentList,ref:this.listRef,style:{left:"".concat(o,"px")}},!!n.length&&b.default.createElement(J.ThemeConsumer,null,(function(t){var a=t.hiddenFolderDirs;return n.map((function(t){return b.default.createElement("div",{className:ae.default.attachmentItem,key:t.fileId},b.default.createElement(z.default,{attachment:t,enterpriseGlobalKey:l,currentProjectName:d,currentProjectId:f,dir:a[R.HIDDEN_FILE_TYPE.SUB_TASK].file_id,uploadFileSuccess:e.onFileDropSuccess,uploadFileFailed:e.onFileDropFail,uploadFileDelete:e.onFileDropDelete,uploadFileCancel:e.onFileDropCancel,allowPreview:!1,userId:u.id}))}))})))):b.default.createElement("div",{className:ae.default.sectionPlaceholder},(0,E.t)("\u5c1a\u672a\u6dfb\u52a0\u9644\u4ef6")),r&&b.default.createElement("a",{className:ae.default.next,onClick:this.moveContent}),o<0&&b.default.createElement("a",{className:ae.default.pre,onClick:function(){return e.moveContent(!1)}})))}},{key:"render",value:function(){var e=this,t=this.state,a=t.name,n=t.autoNext,i=t.autoCopyNext,r=t.isLoading,o=t.attributes,s=t.isReloading,l=t.isMac,c=t.initEditorData,u=t.showDescriptionPlaceholder,d=t.editorAutoFocus,f=t.attachmentsSticky,p=t.maxMainBodyHeight,m=t.editorMinHeight,h=t.isPending,v=this.props,g=v.currentProject,y=v.show,S=v.isShowCreateNext,I=v.subtaskSchemeFieldArchives,T=v.subtaskCreationFieldIDs,C=v.user,P=v.labels,O=v.requirementTypes,R=v.bugTypes,j=v.sourceTypes,k=v.moduleSchemes,N=v.addLabel,A=v.isPermissible,L=v.issueTypeDetail,F={id:C.id,value:C.id,text:C.name,name:C.name,name_pinyin:C.name_pinyin,avatar:C.avatar,media:C.avatar},_=this.getAssigneeFieldWhetherRequired(I,T,D.FIELD_TYPE.ASSIGNEE),M=this.getAssigneeFieldWhetherRequired(I,T,D.FIELD_TYPE.PARTICIPANT);return b.default.createElement(Y.default,{className:(0,te.default)(ae.default.wrapper),show:y,outsideClickCloseable:!1,keyboard:!1,enforceFocus:!1},b.default.createElement("span",{className:(0,te.default)(ae.default.closeButton),onClick:this.onCancel}),r&&b.default.createElement("div",{className:ae.default.modalLoading}),!r&&b.default.createElement("div",{className:ae.default.main},b.default.createElement("div",{className:ae.default.mainHeader},b.default.createElement("div",{className:ae.default.headerInfoSection},b.default.createElement("span",{style:{marginRight:"8px"}},(0,E.t)("\u521b\u5efa")),b.default.createElement(H.default,{type:"sub_task"}),b.default.createElement("span",null,(0,E.t)("\u5b50\u5de5\u4f5c\u9879")),b.default.createElement("div",{className:ae.default.attentionWrapper},b.default.createElement(V.default,{type:"SUBTASK",projectID:g.id,watchers:o.watchers||[],onChange:this.handleAttentionChange,user:F,action:"create",suffixText:(0,E.t)("\u4eba\u5173\u6ce8\u4e2d"),showTooltip:!0}))),b.default.createElement("div",{className:ae.default.headerTitleSection},b.default.createElement("input",{className:ae.default.titleInput,ref:this.inputRef,autoFocus:!0,placeholder:"".concat((0,E.t)("\u8f93\u5165\u4e8b\u9879\u6807\u9898\uff08")).concat(l?"\u2318":"Ctrl").concat((0,E.t)(" + Enter \u53ef\u5feb\u901f\u521b\u5efa\uff09")),value:a,onChange:this.onTitleChange}))),b.default.createElement("div",{className:ae.default.mainBody,style:{maxHeight:"".concat(p,"px")},ref:this.bodyRef,onScroll:this.onDescriptionScroll},u?b.default.createElement("div",{className:ae.default.descriptionPlaceholder,style:{height:"".concat(m,"px")},onClick:function(){return e.setState({showDescriptionPlaceholder:!1})}},(0,E.t)("\u6309\u56de\u8f66\u6216\u70b9\u6b64\u5f00\u59cb\u7f16\u8f91\u63cf\u8ff0")):b.default.createElement("div",{className:ae.default.editorContainer},b.default.createElement(G.default,{type:this.state.editorType,readOnly:this.state.isPending,isEditing:!0,autofocus:d,container:this.bodyRef.current,currentProject:g,initEditorData:c,richClientSaveUuid:"SUB_TASKS_EDITOR_CREATOR",onEditorChange:this.onDescriptionChange,isDisabled:h,canChangeType:!0,onEditorTypeChangeCallback:function(t){return e.onEditorTypeChange(t)},onFullScreenCallback:function(t){return e.setState({fullscreen:t})},onLoad:function(t){if(t.isError){if((0,G.isBlockType)(e.state.editorType)&&t.isDraftIdNotExist){var a="".concat(g.name,"_").concat(L.issueType,"_").concat(L.id,"_CREATOR");(0,G.setIssueDescriptionDraft)(a),e.setState({initEditorData:null},e.initCreatePage)}}else e.getAttachmentsStickyState()},className:(0,te.default)(ae.default.customSectionZindex,!this.state.fullscreen&&ae.default.editorHeight),ref:this.editorRef}))),b.default.createElement("div",{className:(0,te.default)(ae.default.mainFooter,f&&ae.default.sticky)},this.renderAttachmentSection(),b.default.createElement("div",{className:ae.default.operationsWrapper},b.default.createElement("div",{disabled:s,className:(0,te.default)(ae.default.operationButton,!l&&ae.default.wider,ne.default.newButton,ne.default.primary,ne.default.h32,s&&ne.default.disabled),"data-container":!0,"data-title":"\u521b\u5efa".concat(L.name,"-\u786e\u5b9a"),onClick:this.onSubmit},(0,E.t)("\u521b\u5efa"),b.default.createElement("span",{className:ae.default.key},l?"\u2318":"Ctrl"),b.default.createElement("span",{className:(0,te.default)(ae.default.key,ae.default.enter)})),b.default.createElement("div",{className:(0,te.default)(ae.default.operationButton,ne.default.newButton,ne.default.default,ne.default.h32),"data-container":!0,"data-title":"\u521b\u5efa".concat(L.name,"-\u53d6\u6d88"),onClick:this.onCancel},(0,E.t)("\u53d6\u6d88")),S&&b.default.createElement(b.default.Fragment,null,b.default.createElement("span",{className:ae.default.switch},b.default.createElement(X.default,{checked:n,onChange:this.onAutoFlagChange}),b.default.createElement("span",{className:ae.default.switchText},(0,E.t)("\u7ee7\u7eed\u521b\u5efa\u4e0b\u4e00\u4e2a"))),b.default.createElement("span",{className:ae.default.switch},b.default.createElement(X.default,{checked:i,onChange:this.onAutoCopyFlagChange}),b.default.createElement("span",{className:ae.default.switchText},(0,E.t)("\u590d\u5236\u5e76\u65b0\u5efa\u4e0b\u4e00\u4e2a"))))))),!r&&b.default.createElement("div",{className:ae.default.aside,onScroll:this.onAttrScroll,ref:this.sideRef},b.default.createElement("div",{className:ae.default.asideContent},b.default.createElement("div",{className:ae.default.issuePropertyContainer},b.default.createElement("div",{className:ae.default.issuePropertySection},b.default.createElement("label",null,(0,E.t)("\u5904\u7406\u4eba"),_&&b.default.createElement("span",{className:ae.default.highlight},"*")),b.default.createElement(Q.default,{inProject:!0,projectID:g.id,value:o.assignee||null,clearable:!_,onSelect:function(t){e.changeAttributes({type:"assignee",value:t});var a=o.participants;a.some((function(e){return e.id===t.id}))||setTimeout((function(){e.changeAttributes({type:"participants",value:(0,w.default)(a,t)})}))},onClear:function(){return e.changeAttributes({type:"assignee"})},triggerExtraProps:{initialSelectedItem:(null===o||void 0===o?void 0:o.defaultAssignee)||null},dropdownStyle:ae.default.dropdownStyle,triggerStyle:ae.default.triggerStyle,panelCustomStyle:ae.default.panelCustomStyle})),b.default.createElement("div",{className:ae.default.issuePropertySection},b.default.createElement("label",null,(0,E.t)("\u53c2\u4e0e\u4eba"),M&&b.default.createElement("span",{className:ae.default.highlight},"*")),b.default.createElement(Q.default,{inProject:!0,projectID:g.id,value:o.participants.map((function(e){return e.id})),clearable:!M,isMultiple:!0,onSelect:function(t){var a=o.participants,n=[];n=a.find((function(e){return e.id===t.id}))?a.filter((function(e){return t.id!==e.id})):(0,w.default)(a,t),e.changeAttributes({type:"participants",value:n})},onClear:function(){return e.changeAttributes({type:"participants"})},triggerExtraProps:{initialSelectedItem:o.participants||[]},dropdownStyle:ae.default.dropdownStyle,triggerStyle:ae.default.triggerStyle,panelCustomStyle:ae.default.panelCustomStyle}))),b.default.createElement("div",{className:(0,te.default)([ae.default.issuePropertyContainer,ae.default.hasNoBorder])},b.default.createElement($.default,{isCreate:!0,schemeFieldArchives:I,fieldIds:T,issueType:"REQUIREMENT",onChange:this.changeAttributes,customAttributes:o,labels:P,requirementTypes:O,bugTypes:R,sourceTypes:j,moduleSchemes:k,addLabel:N,projectID:g.id,currentProject:g,isPermissible:A,portalProps:{toRight:!0,portalWrapStyle:{zIndex:1099},isScroll:this.state.isElemScroll,resetIsScroll:function(){e.setState({isElemScroll:!1})}},parentRef:this.sideRef})))))}},{key:"componentDidMount",value:function(){var e=this,t=this.props,a=t.currentProject,n=t.issueTypeDetail,i=this.state,r=i.name,o=i.editorType;document.addEventListener("keydown",this.quickSave),document.addEventListener("keydown",this.startEditing),window.addEventListener("resize",this.getHeights),this.getBasicInfo().then((function(){var t=e.props,a=t.subtaskCreationFieldIDs,n=t.subtaskSchemeFieldArchives;e.setDefaultValues(n,a),e.getHeights()})).finally((function(){if((0,G.isBlockType)(o)){var t=(0,G.getIssueDescriptionDraft)("".concat(a.name,"_").concat(n.issueType,"_").concat(n.id,"_CREATOR"));t?e.setState({isLoading:!1,initEditorData:{pageId:t.pageId,pageDraftId:t.pageDraftId,historyId:t.historyId},editorAutoFocus:!!r,showDescriptionPlaceholder:!1}):e.initCreatePage().then((function(){e.setState({isLoading:!1})}))}else e.setState({isLoading:!1,editorAutoFocus:!!r,showDescriptionPlaceholder:!1})}))}},{key:"componentDidUpdate",value:function(e,t){if(t.isReloading!==this.state.isReloading){var a=this.props,n=a.subtaskSchemeFieldArchives,i=a.subtaskCreationFieldIDs,r=e.subtaskSchemeFieldArchives,o=e.subtaskCreationFieldIDs;if(!(0,C.default)(n,r)&&!(0,C.default)(i,o)){var s=(0,P.default)(i,o);this.setDefaultValues(n,s)}}t.allAttachments.length!==this.state.allAttachments.length&&this.whetherShowMoveButton(),t.editorType!==this.state.editorType&&(0,G.isBlockType)(this.state.editorType)&&!this.state.initEditorData&&this.initCreatePage()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.quickSave),document.removeEventListener("keydown",this.startEditing),window.removeEventListener("resize",this.getHeights)}},{key:"getBasicInfo",value:function(){return Promise.all([this.props.getBugTypes(),this.props.getRequirementTypes(),this.props.getModuleSchemes(),this.props.getSubtaskScheme(!0),this.props.getSourceTypes()])}},{key:"onTitleChange",value:function(e){this.setState({name:e.target.value})}},{key:"onAutoFlagChange",value:function(e){this.onUpdateStateAndStorage(e,!e&&this.state.autoCopyNext)}},{key:"onAutoCopyFlagChange",value:function(e){this.onUpdateStateAndStorage(!e&&this.state.autoNext,e)}},{key:"onSubmit",value:function(){var e=(0,d.default)(r.default.mark((function e(){var t,a,n,i,o,s,l,c,u,d,f,p,m,h,v,g,b,y,S,C,P,w,R,j,F,_,M,x,B,U,W,Y,H,V,K,z,q,J,X,Q,$,te,ae,ne,ie,re,oe,le,ce,ue,de,fe,pe,me,he=this;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=this.props.currentProject,l=s.id,c=s.name,u=this.props,d=u.isShowCreateNext,f=u.subtaskSchemeFieldArchives,p=u.subtaskCreationFieldIDs,m=u.closeHandle,h=u.callback,v=u.parentCode,g=u.issueTypeDetail,b=this.state,y=b.name,S=b.autoNext,C=b.autoCopyNext,P=b.isPending,w=b.allAttachments,R=b.attachments,j=b.attributes,F=j.assignee,_=j.priority,M=j.requirementType,x=j.startDate,B=j.dueDate,U=j.workingHours,W=j.labels,Y=j.watchers,H=j.fields,V=j.defectType,K=j.projectModule,z=j.progress,q=j.estimatedWorkHour,J=j.defectKindIds,X=j.defectPhaseId,Q=j.defectSourceId,$=j.wuKongReloadId,te=j.serialNum,ae=j.rblkhxgProperty,ne=j.rblsjxgProperty,ie=j.systemsId,re=j.participants,oe=b.thirdLinks,le=b.initEditorData,ce=b.editorType,null===(t=this.editorRef)||void 0===t||!t.current||!(0,G.isBlockType)(ce)){e.next=12;break}return e.prev=4,e.next=7,(0,ee.getBlockEditorFinished)(this.editorRef.current);case 7:e.next=12;break;case 9:return e.prev=9,e.t0=e.catch(4),e.abrupt("return",(0,N.warning)((0,E.t)("\u66f4\u65b0\u63cf\u8ff0\u8d85\u65f6")));case 12:if(!P){e.next=14;break}return e.abrupt("return");case 14:if(!(0,T.default)((0,I.default)(y))){e.next=17;break}return(0,N.warning)((0,E.t)("\u5b50\u5de5\u4f5c\u9879\u6807\u9898\u4e0d\u80fd\u4e3a\u7a7a")),e.abrupt("return");case 17:if(128,!((0,I.default)(y).length>128)){e.next=21;break}return(0,N.warning)((0,E.t)("\u5b50\u5de5\u4f5c\u9879\u540d\u79f0\u6700\u591a\u652f\u6301 {{count}} \u4f4d",{count:128})),e.abrupt("return");case 21:if(!(ue=p.find((function(e){var t=f[e],a=t.required,n=t.issueField.type;if(a){var i;switch(n){case D.FIELD_TYPE.ASSIGNEE:i=F;break;case D.FIELD_TYPE.PRIORITY:i=_;break;case D.FIELD_TYPE.START_DATE:i=x;break;case D.FIELD_TYPE.REQUIREMENT_TYPE:i=M;break;case D.FIELD_TYPE.DUE_DATE:i=B;break;case D.FIELD_TYPE.WORKING_HOURS:i=U;break;case D.FIELD_TYPE.LABEL:i=W;break;case D.FIELD_TYPE.WATCHER:i=Y;break;case D.FIELD_TYPE.MODULE:i=K;break;case D.FIELD_TYPE.PROGRESS:i=z;break;case D.FIELD_TYPE.DEFECT_SOURCE:i=Q;break;case D.FIELD_TYPE.WUKONG_RELOAD:i=$;break;case D.FIELD_TYPE.SERIAL_NUM:i=te;break;case D.FIELD_TYPE.RBLKHXG:i=ae;break;case D.FIELD_TYPE.RBLSJXG:i=ne;break;case D.FIELD_TYPE.SYSTEM:i=ie;break;case D.FIELD_TYPE.PARTICIPANT:i=re;break;default:i=H[e]}return!(Array.isArray(i)?i.length:null!==i&&void 0!==i)}return!1})))){e.next=25;break}return(0,N.warning)("".concat((0,E.t)("\u8bf7\u586b\u5199")).concat(f[ue].issueField.name)),e.abrupt("return");case 25:if(!(de=p.find((function(e){return"\u7f3a\u9677\u4e25\u91cd\u7a0b\u5ea6"===f[e].issueField.name})))||!this.validateDefect(de,H[de])){e.next=28;break}return e.abrupt("return");case 28:if(!(R.length&&R.findIndex((function(e){return e.fileId<0}))>-1)){e.next=31;break}return(0,N.warning)((0,E.t)("\u6709\u9644\u4ef6\u6b63\u5728\u4e0a\u4f20\uff0c\u8bf7\u7a0d\u540e\u63d0\u4ea4")),e.abrupt("return");case 31:this.setState({isPending:!0}),fe=Object.keys(H).filter((function(e){return void 0!==H[e]})).map((function(e){var t=f[e].issueField.componentType;return t===O.PROPERTY_TYPE_CONSTANTS.SELECT_ITERATION_MULTI||t===O.PROPERTY_TYPE_CONSTANTS.SELECT_MEMBER_MULTI?{id:e,content:H[e].map((function(e){return e.id}))}:t===O.PROPERTY_TYPE_CONSTANTS.SELECT_ITERATION_SINGLE||t===O.PROPERTY_TYPE_CONSTANTS.SELECT_MEMBER_SINGLE?{id:e,content:H[e].id}:{id:e,content:H[e]}})),pe=(0,Z.default)(w,oe).map((function(e){return se(se({createdAt:e.createdAt},e.modao),e.codesign)})),me=(0,G.isBlockType)(ce)?se(se({},le),{},{descriptionType:G.EditorType.BLOCK}):{content:(null===(a=this.editorRef)||void 0===a||null===(n=a.current)||void 0===n?void 0:n.getRichContent())||"",slateRaw:(null===(i=this.editorRef)||void 0===i||null===(o=i.current)||void 0===o?void 0:o.getRichContent("raw"))||"",descriptionType:G.EditorType.MARKDOWN},(0,L.createSubtask)(l,{parentCode:v||0,name:(0,I.default)(y),fileIds:R.map((function(e){return e.fileId})),thirdLinks:pe,customFieldValueMap:fe.length?fe:null,assignee:F,priority:_,requirementTypeId:M,startDate:x,dueDate:B,workingHours:U,labelIds:W,watchers:Y.map((function(e){return e.id})),defectTypeId:V,projectModuleId:K,issueTypeId:g.id,progress:z,kmPage:me,estimatedWorkHour:q,defectKindIds:J,defectPhaseId:X,defectSourceId:Q,wuKongReloadId:$,serialNum:te,rblsjxg:ne,rblkhxg:ae,systemsId:ie,participants:re.map((function(e){return e.id}))},!0).then((function(e){var t=e.data,a="".concat(c,"_").concat(g.issueType,"_").concat(g.id,"_CREATOR");(0,G.setIssueDescriptionDraft)(a),(0,N.success)((0,E.t)("\u521b\u5efa\u6210\u529f")),he.removeDraft(),h&&h(null,t.issueStatusId),d&&S?he.resetFormData():d&&C?he.resetPartialFormData(t.id):m()}),(function(e){var t=e.code,a=e.msg;if(8026===t)(0,N.danger)((0,E.t)("\u521b\u5efa\u9875\u5c5e\u6027\u5df2\u53d8\u66f4\uff0c\u8bf7\u68c0\u67e5\u5fc5\u586b\u5c5e\u6027\u5e76\u518d\u6b21\u63d0\u4ea4\u3002")),he.setState({isReloading:!0},(function(){Promise.all([he.props.getSubtaskScheme(),he.props.getSubtaskScheme(!0)]).then((function(){he.setState({isReloading:!1})}))}));else{if((0,k.configPlanNotToastMsg)(t))return;(0,N.danger)((0,A.getErrorMessage)(a))}})).finally((function(){he.setState({isPending:!1})}));case 36:case"end":return e.stop()}}),e,this,[[4,9]])})));return function(){return e.apply(this,arguments)}}()},{key:"changeAttributes",value:function(e){var t=e.isCustom,a=e.type,n=e.value,i=e.issueFieldId,r=e.customValue,o=this.state.attributes;this.validateDefect(i,n)||this.setState({attributes:(0,S.default)(o,(function(e){switch(t&&(e.fields=se(se({},o.fields),{},(0,u.default)({},i,n))),a){case"assignee":e.assignee=n?n.value:null,e.defaultAssignee=n;break;case"participants":e.participants=n||[];break;case"proposer":e.proposerDept=void 0,e.proposer=n;break;case"defectKindIds":e.defectPhaseId=r,e.defectKindIds=n;break;case"defectPhaseId":e.defectPhaseId=n,e.defectKindIds=[];break;case"workingHours":e.workingHours=null===n||void 0===n?void 0:n.workingHours,e.estimatedWorkHour=n;break;default:e[a]=n}}))})}},{key:"setDefaultValues",value:function(e,t){var a=this.state.attributes,n=this.props.user,i={id:n.id,value:n.id,text:n.name,name:n.name,name_pinyin:n.name_pinyin,avatar:n.avatar,media:n.avatar};this.setState({attributes:(0,S.default)(a,(function(a){a.participants=[i],t&&t.forEach((function(t){var r=e[t],o=r.needDefault,s=r.value,l=r.userMap,u=r.iterationMap,d=r.issueField,f=d.type,p=d.componentType;if(o&&null!==s)switch(f){case D.FIELD_TYPE.ASSIGNEE:"VARIABLE"===s.type?(a.assignee=n.id,a.defaultAssignee=i):"CONSTANT"===s.type&&(a.assignee=s.value,a.defaultAssignee=l[s.value]);break;case D.FIELD_TYPE.PRIORITY:a.priority=s.value;break;case D.FIELD_TYPE.START_DATE:a.startDate=s.value;break;case D.FIELD_TYPE.REQUIREMENT_TYPE:a.requirementType=s.value;break;case D.FIELD_TYPE.DUE_DATE:a.dueDate=s.value;break;case D.FIELD_TYPE.MODULE:a.projectModule=s.value;break;case D.FIELD_TYPE.WORKING_HOURS:a.workingHours=s.value;break;case D.FIELD_TYPE.LABEL:a.labels=s.value;break;case D.FIELD_TYPE.WATCHER:"VARIABLE"===s.type?a.watchers=(0,c.default)("CREATOR"===s.value?[i]:[]):a.watchers=s.value.map((function(e){return l[e]}));break;case D.FIELD_TYPE.PROGRESS:a.progress=s.value;break;case D.FIELD_TYPE.DEFECT_KIND:a.defectKindIds=s.value;break;case D.FIELD_TYPE.DEFECT_PHASE:a.defectPhaseId=s.value;break;case D.FIELD_TYPE.WUKONG_RELOAD:a.wuKongReloadId=s.value;break;case D.FIELD_TYPE.RBLKHXG:a.rblkhxgProperty=s.value;break;case D.FIELD_TYPE.RBLSJXG:a.rblsjxgProperty=s.value;break;case D.FIELD_TYPE.PARTICIPANT:a.participants=s.value&&s.value.length?s.value.map((function(e){return l[e]})):[];break;default:p===O.PROPERTY_TYPE_CONSTANTS.SELECT_MEMBER_SINGLE||p===O.PROPERTY_TYPE_CONSTANTS.SELECT_MEMBER_MULTI?"VARIABLE"===s.type?a.fields[t]=i:Array.isArray(s.value)?a.fields[t]=s.value.map((function(e){return l[e]})):a.fields[t]=l[s.value]:p===O.PROPERTY_TYPE_CONSTANTS.SELECT_ITERATION_SINGLE||p===O.PROPERTY_TYPE_CONSTANTS.SELECT_ITERATION_MULTI?Array.isArray(s.value)?a.fields[t]=s.value.map((function(e){return u[e]})):a.fields[t]=u[s.value]:a.fields[t]=s.value}}))}))})}},{key:"resetFormData",value:function(){var e=this,t=this.props,a=t.subtaskCreationFieldIDs,n=t.subtaskSchemeFieldArchives,i=t.isShowCreateNext,r=this.state.autoNext;this.setState({name:"",attachments:[],thirdLinks:[],isPending:!1,attributes:{assignee:void 0,priority:void 0,requirementType:void 0,defectType:void 0,projectModule:void 0,startDate:void 0,dueDate:void 0,workingHours:void 0,labels:[],watchers:[],fields:{},defectSourceId:void 0,wuKongReloadId:void 0,serialNum:void 0,rblkhxgProperty:void 0,rblsjxgProperty:void 0,systemsId:void 0,participants:[],estimatedWorkHour:void 0,defectKindIds:[],defectPhaseId:void 0},initEditorData:null,editorAutoFocus:!0},(function(){e.setDefaultValues(n,a),e.combineThirdLinks(),i&&r&&(e.initCreatePage(),e.setState({showDescriptionPlaceholder:!0}),e.titleInputFocus())}))}},{key:"resetPartialFormData",value:function(e){var t=this,a=this.props.isShowCreateNext,n=this.state,i=n.autoCopyNext,r=n.attributes;this.setState({name:"",attachments:[],thirdLinks:[],isPending:!1,attributes:se(se({},r),{},{workingHours:void 0,estimatedWorkHour:void 0}),initEditorData:null},(function(){t.combineThirdLinks(),a&&i&&(t.copyCreatePage(e),t.titleInputFocus())}))}},{key:"fileUpload",value:function(e){this.setState({attachments:(0,S.default)(this.state.attachments,(function(t){t.splice.apply(t,[t.length,0].concat((0,c.default)(e)))}))},this.combineThirdLinks)}},{key:"handleDeleteAttachment",value:function(e,t){var a=this;(0,F.delAttachment)(e,t).then((function(){a.setState({attachments:(0,S.default)(a.state.attachments,(function(e){var a=e.findIndex((function(e){return e.fileId===t}));e.splice(a,1)}))},a.combineThirdLinks)}))}},{key:"onFileDropSuccess",value:function(e){var t=this;this.setState((function(t){return{attachments:(0,S.default)(t.attachments,(function(t){var a;if(t.find((function(t){return t.fileId===e.fileId}))){(0,N.success)("".concat(e.name).concat((0,E.t)(" \u6587\u4ef6\u5df2\u66f4\u65b0!")));var n=t.findIndex((function(t){return t.timestamp===e.timestamp}));t.splice(n,1),a=t.findIndex((function(t){return t.fileId===e.fileId}))}else a=t.findIndex((function(t){return t.timestamp===e.timestamp}));t[a]=se(se({},t[a]),e)}))}})),this.setState((function(){t.combineThirdLinks()}))}},{key:"onFileDropFail",value:function(e){var t=e.timestamp;this.setState({attachments:(0,S.default)(this.state.attachments,(function(e){var a=e.findIndex((function(e){return e.timestamp===t}));e.splice(a,1)}))})}},{key:"onFileDropDelete",value:function(e){var t=e.fileId,a=e.isModao,n=e.isCodesign,i=this.props.currentProject.id;a||n?this.setState({thirdLinks:this.state.thirdLinks.filter((function(e){return e.fileId!==t}))},this.combineThirdLinks):this.handleDeleteAttachment(i,t)}},{key:"onFileDropCancel",value:function(e){var t=e.timestamp,a=e.isModao,n=e.isCodesign;a||n?this.setState({thirdLinks:this.state.thirdLinks.filter((function(e){return e.timestamp!==t}))},this.combineThirdLinks):this.setState({attachments:(0,S.default)(this.state.attachments,(function(e){var a=e.findIndex((function(e){return e.timestamp===t}));e.splice(a,1)}))},this.combineThirdLinks)}},{key:"whetherShowMoveButton",value:function(){if(this.wrapperRef.current&&this.listRef.current){var e=this.wrapperRef.current.getBoundingClientRect().width,t=this.listRef.current.getBoundingClientRect().width;this.setState({showButton:t>e})}}},{key:"moveContent",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.wrapperRef.current&&this.listRef.current){var t=this.state.toLeft,a=this.wrapperRef.current.getBoundingClientRect(),n=a.width,i=this.listRef.current.getBoundingClientRect(),r=i.width,o=r+t-n;e?o<=n?this.setState({toLeft:t+-1*o,showButton:!1}):this.setState({toLeft:t-n}):o<=n?this.setState({toLeft:0,showButton:!0}):this.setState({toLeft:t+n})}}}]),a}(b.Component),s.propTypes={show:y.default.bool,isShowCreateNext:y.default.bool,closeHandle:y.default.func,callback:y.default.func,currentProject:y.default.shape({id:y.default.number.isRequired,name:y.default.string,owner_user_name:y.default.string,project_path:y.default.string}),user:y.default.object,labels:y.default.array,addLabel:y.default.func,parentCode:y.default.number,subtaskSchemeFieldArchives:y.default.object,subtaskCreationFieldIDs:y.default.array,getSubtaskScheme:y.default.func,getRequirementTypes:y.default.func,getBugTypes:y.default.func,isPermissible:y.default.func,enterpriseGlobalKey:y.default.string,customRouteKey:y.default.string,isDetail:y.default.bool,getModuleSchemes:y.default.func,title:y.default.string},s.defaultProps={isShowCreateNext:!0,isDetail:!1},o=l))||o)||o)||o)||o;t.default=ce},"x+BT":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sortIssue=t.fastCreateEpic=t.sortRoadmap=t.fetchRoadmapWithPage=t.fetchRoadmap=t.updateAffairsEpic=t.fetchAffairsEpic=t.checkInitialization=t.fetchRelationTests=t.fetchEpicActivityList=t.fetchIssueActitvites=t.deleteComment=t.addComment=t.deleteIssueFromEpic=t.deleteIssue=t.copyIssue=t.updateIssueStatus=t.modifyIssue=t.modifyIssueDescription=t.fetchIssueDescription=t.associateableIssues=t.joinEpic=t.fetchIssues=t.fetchIssueDetail=t.setEpicFilterDefault=t.fetchEpicFilterDefault=t.batchUpdateIssues=t.createIssue=void 0;var n=a("Z4vw");t.createIssue=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,n.postJSON)("/api/project/".concat(e,"/issues/epics"),t,a)};t.batchUpdateIssues=function(e,t){return(0,n.postJSON)("/api/project/".concat(e,"/issues/epics/batch/update"),t)};t.fetchEpicFilterDefault=function(e){return(0,n.get)("/api/project/".concat(e,"/issues/epics/filters/default"))};t.setEpicFilterDefault=function(e,t){return(0,n.patch)("/api/project/".concat(e,"/issues/EPIC/filters/").concat(t,"/default"))};t.fetchIssueDetail=function(e,t,a){return(0,n.get)("/api/project/".concat(e,"/issues/epics/").concat(t,"?").concat((0,n.buildParams)(a)))};t.fetchIssues=function(e,t){return(0,n.get)("/api/project/".concat(e,"/issues/epics/").concat(t,"/issues"))};t.joinEpic=function(e,t,a){return(0,n.post)("/api/project/".concat(e,"/issues/epics/").concat(t,"/associate-issues"),{epicCode:t,issueCode:a})};t.associateableIssues=function(e,t,a){return(0,n.get)("/api/project/".concat(e,"/issues/epics/").concat(t,"/associateable-issues?").concat((0,n.buildParams)(a)))};t.fetchIssueDescription=function(e,t){return(0,n.get)("/api/project/".concat(e,"/issues/epics/").concat(t,"/description"))};t.modifyIssueDescription=function(e,t,a){return(0,n.put)("/api/project/".concat(e,"/issues/epics/").concat(t,"/description"),a)};t.modifyIssue=function(e,t,a){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return(0,n.patchJSON)("/api/project/".concat(e,"/issues/epics/").concat(t,"/fields"),a,i)};t.updateIssueStatus=function(e,t,a){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return(0,n.putJSON)("/api/project/".concat(e,"/issues/epics/").concat(t,"/kanban/status"),a,i)};t.copyIssue=function(e,t,a){return(0,n.post)("/api/project/".concat(e,"/issues/epics/").concat(t,"/copy"),{name:a})};t.deleteIssue=function(e,t){return(0,n.del)("/api/project/".concat(e,"/issues/epics/").concat(t))};t.deleteIssueFromEpic=function(e,t,a){return(0,n.del)("/api/project/".concat(e,"/issues/epics/").concat(t,"/associate-issues/").concat(a))};t.addComment=function(e){var t=e.projectID,a=e.issueCode,i=e.content,r=e.parentID;return(0,n.post)("/api/project/".concat(t,"/issues/epics/").concat(a,"/comments"),{content:i,parentId:r})};t.deleteComment=function(e,t,a){return(0,n.del)("/api/project/".concat(e,"/issues/epics/").concat(t,"/comments/").concat(a))};t.fetchIssueActitvites=function(e,t){return(0,n.get)("/api/project/".concat(e,"/issues/epics/").concat(t,"/activities"))};t.fetchEpicActivityList=function(e,t,a){return(0,n.get)("/api/project/".concat(e,"/issues/epics/activities?").concat((0,n.buildParamsWithBrackets)(t)),a)};t.fetchRelationTests=function(e,t){return(0,n.get)("/api/project/".concat(e,"/testings/relations/epics/").concat(t))};t.checkInitialization=function(e){return(0,n.get)("/api/project/".concat(e,"/issues/epics/is-inited"),!0)};t.fetchAffairsEpic=function(e,t,a){return(0,n.get)("/api/project/".concat(e,"/issues/").concat(t,"/associateable-epics?keyword=").concat(a))};t.updateAffairsEpic=function(e,t,a){return(0,n.put)("/api/project/".concat(e,"/issues/").concat(t,"/associate-epic"),a)};t.fetchRoadmap=function(e,t){return(0,n.get)("/api/project/".concat(e,"/issues/epics/roadmap?").concat((0,n.buildParams)(t)))};t.fetchRoadmapWithPage=function(e,t){return(0,n.get)("/collaboration/api/project/".concat(e,"/issues/epics/roadmap/with-page?").concat((0,n.buildParams)(t)))};t.sortRoadmap=function(e,t){var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return(0,n.patch)("/api/project/".concat(e,"/issues/epics/roadmap/sort"),t,a)};t.fastCreateEpic=function(e,t){return(0,n.postJSON)("/api/project/".concat(e,"/issues/smart"),t)};t.sortIssue=function(e,t,a){return(0,n.putJSON)("/api/project/".concat(e,"/issues/epics/").concat(t,"/issues/sort"),a)}},x54Q:function(e,t,a){"use strict";a("I5cv"),a("mYba"),a("jm62"),a("EK0E");var n=a("TqRt"),i=a("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(a("o0o1")),o=n(a("RIqP")),s=n(a("yXPU")),l=n(a("lSNA")),c=n(a("lwsE")),u=n(a("W8MJ")),d=n(a("PJYZ")),f=n(a("7W2i")),p=n(a("a1gu")),m=n(a("Nsbk"));a("f3/d"),a("0l/t"),a("XfO3"),a("Btvt"),a("yt8O"),a("rGqo"),a("VRzm"),a("CX2u"),a("pIFo"),a("INYr"),a("0mN4"),a("hhXQ"),a("dRSK"),a("xfY5"),a("RW0V"),a("bWfx"),a("ioFf"),a("HEwt"),a("T39b"),a("L9s1"),a("Z2Ku"),a("OG14"),a("tUrg");var h,v,g,E,b=a("mVeg"),y=ze(a("cDcd")),S=a("h74D"),I=n(a("17x9")),T=a("dtw8"),C=a("7FZc"),P=n(a("qLOp")),w=n(a("TsYS")),D=n(a("qCZF")),O=n(a("WE/Q")),R=n(a("Yzhn")),j=a("nuIr"),k=n(a("QDR0")),N=n(a("AVuq")),A=n(a("wd/R")),L=a("FaIw"),F=a("AwMv"),_=a("w3Wo"),M=a("xgZS"),x=n(a("V/h/")),B=n(a("2KQ+")),U=n(a("Y+p1")),W=n(a("XLbL")),Y=n(a("8+Mu")),H=n(a("4qC0")),V=n(a("GoyQ")),G=n(a("UB5X")),K=n(a("Z0cm")),z=a("DKcV"),q=n(a("K2gz")),Z=(a("Z4vw"),a("FpRC")),J=n(a("2CT0")),X=n(a("L8Eh")),Q=n(a("Th6D")),$=a("DgMC"),ee=a("885C"),te=a("sWxF"),ae=n(a("TT2u")),ne=a("5DNL"),ie=a("3RH6"),re=a("IecL"),oe=n(a("1lUc")),se=n(a("mSbZ")),le=n(a("htee")),ce=n(a("4Fdf")),ue=n(a("xM8l")),de=n(a("begU")),fe=n(a("0Zwn")),pe=n(a("W0/N")),me=n(a("HtPo")),he=n(a("Qkhu")),ve=n(a("HwxY")),ge=n(a("AoGB")),Ee=n(a("KUqB")),be=a("7bn+"),ye=a("/HD1"),Se=n(a("rmFV")),Ie=n(a("Yfq4")),Te=n(a("q47l")),Ce=n(a("NdxU")),Pe=n(a("C8w1")),we=ze(a("mO/f")),De=a("uEQr"),Oe=n(a("CF/V")),Re=n(a("oIiO")),je=n(a("jOzQ")),ke=n(a("K2f3")),Ne=a("jzjO"),Ae=n(a("KIkv")),Le=a("17N+"),Fe=a("9+7+"),_e=a("9+7+"),Me=a("lGCG"),xe=n(a("WKBZ")),Be=n(a("cHah")),Ue=n(a("DDpV")),We=n(a("QWzU")),Ye=n(a("6yKH")),He=a("cUHt"),Ve=a("nuIr"),Ge=a("AMAM");function Ke(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(Ke=function(e){return e?a:t})(e)}function ze(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!==typeof e)return{default:e};var a=Ke(t);if(a&&a.has(e))return a.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=r?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}return n.default=e,a&&a.set(e,n),n}function qe(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Ze(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?qe(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):qe(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Je(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,m.default)(e);if(t){var i=(0,m.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,p.default)(this,a)}}var Xe=(0,$.isSupportsPlaintextEdit)()?"plaintext-only":"true";var Qe=(h=(0,S.connect)((function(e){return{enterpriseGlobalKey:e.APP.enterprise.globalKey,enterpriseName:e.APP.enterprise.name,watermark:e.APP.enterprise.watermark,payed:e.APP.enterprise.payed,user:e.APP.user,isSensitiveAdmin:(0,z.checkSensitiveAdmin)(e.CURRENT_USER_ENTERPRISE_PERMISSION_NAMESPACE_FOR_REDUX_STORE.currentEnterprisePermissionList,e.CURRENT_USER_PROJECT_PERMISSION_NAMESPACE_FOR_REDUX_STORE.currentProjectPermissionList),currentProjectCooperateSettings:e.APP.currentProjectCooperateSettings,closedMenuKeys:e.PROJECT_FUNCTIONS.closedMenuKeys}})),(0,T.withRouter)(v=h(v=(0,se.default)(v=(0,le.default)(v=(0,ue.default)(v=(0,ce.default)(v=(0,ae.default)(v=(0,ne.FlashAnchorDecorator)(v=(0,ge.default)((E=g=function(e){(0,f.default)(a,e);var t=Je(a);function a(e){var n;return(0,c.default)(this,a),(n=t.call(this,e)).isDeleteInFilePreview=!1,n.elemShow=function(){n.dataLoad=(0,pe.default)({elemInOrder:["subWorkItems","splittedIssues","reference","logs","comment"].filter((function(e){return e})),onRenderItem:function(e,t,a,i){n.setState({isRender:Ze({},i),isRenderAll:t},(function(){a(),t&&n.setState({controlCaculatePos:Date.now()})}))}}),n.dataLoad("comment")},n.titleInputRef=y.default.createRef(),n.scrollRef=y.default.createRef(),n.renderTitle=function(e,t,a){var i=n.state,r=i.detailInfoState,o=i.inputFocus;return y.default.createElement("div",{className:(0,q.default)(P.default.titleInputWrap,o&&t&&P.default.titleInputFocusWrap)},y.default.createElement("div",{className:(0,q.default)(P.default.titleInput,!e&&P.default.titleInputDisabled,t&&P.default.titleInputScrolled),ref:!a&&n.titleInputRef,onFocus:function(){n.setState({inputFocus:!0}),setTimeout((function(){(0,$.setFocus)(n.titleInputRef.current)}),0)},onBlur:function(){n.setState({inputFocus:!1}),n.handleInput(n.titleInputRef.current.innerText)},onKeyDown:function(e){"Enter"===e.key&&(e.preventDefault(),n.handleInput(n.titleInputRef.current.innerText))},contentEditable:e?Xe:"false",suppressContentEditableWarning:!0},r.name))},n.getParentDetail=function(){var e=n.state.detailInfoState,t=n.props.currentProject.id;(0,_.getParentIssues)(t,e.code).then((function(e){n.getCrumbs(e.data)}))},n.getCrumbs=function(e){var t=[];n.getNameList(t,e),n.setState({nameList:t,nameListLoaded:!0})},n.getNameList=function(e,t){e.unshift({code:t.code,name:t.name,type:t.type,issueTypeDetail:t.issueTypeDetail}),t.parent&&n.getNameList(e,t.parent)},n.toggleDropdown=function(){var e=n.state.showMoreCrumb;e?document.removeEventListener("click",n.hideDropdown):document.addEventListener("click",n.hideDropdown),n.setState({showMoreCrumb:!e})},n.hideDropdown=function(){n.setState({showMoreCrumb:!1}),document.removeEventListener("click",n.hideDropdown)},n.renderParentsInfo=function(){var e,t=n.state,a=t.detailInfoState,i=t.nameList,r=t.showMoreCrumb;return y.default.createElement(je.default,{issueType:null===a||void 0===a||null===(e=a.issueTypeDetail)||void 0===e?void 0:e.iconType,nameList:i,showMoreCrumb:r,toggleDropdown:n.toggleDropdown,projectPath:n.props.projectPath})},n.renderScrollTitle=function(e,t){var a=n.state,i=a.inputFocus,r=a.detailInfoState;return i?y.default.createElement(y.default.Fragment,null,n.renderTitle(e,!0,t)):y.default.createElement("div",{className:P.default.scrolledTitleWrap},y.default.createElement("div",{className:(0,q.default)(P.default.titleIconWrap,n.state.noHoverIcon&&P.default.noHoverIcon)},y.default.createElement(Ee.default,{type:r.issueTypeDetail.iconType}),y.default.createElement("div",{className:P.default.breadcrumb},n.renderParentsInfo())),n.renderTitle(e,!0,t))},n.onBtnClick=function(e){n["".concat(e.toLowerCase(),"BtnClicked")]&&n["".concat(e.toLowerCase(),"BtnClicked")]()},n.getEditComp=function(e){n.editComp=e},n.editStatusChanged=function(e,t){n.setState(Ze({isDesEditing:e,isShowItemPlaceholder:Ze(Ze({},n.state.isShowItemPlaceholder),{},{description:void 0!==t?t:!e})},e?{}:{isDescriptionBtnFixed:!1}),(function(){n.setState({controlCaculatePos:Date.now()})}))},n.scrollToAttechment=function(){var e,t,a;null!==(e=n.scrollRef)&&void 0!==e&&e.current&&null!==(t=n.attechmentRef)&&void 0!==t&&t.current&&null!==(a=n.headerRef)&&void 0!==a&&a.current&&(0,Z.scrollIntoView)(n.scrollRef.current,n.attechmentRef.current,-n.headerRef.current.offsetHeight)},n.handleReviewListChanged=function(){n.fetchIssueReviewList((function(e){0!==e.length?Z.scrollIntoView&&n.setState({activeLogTab:"approval"},(function(){(0,Z.scrollRelatedToTopMenu)("issue-review-list",0,n.scrollRef.current)})):n.setState({activeLogTab:"activity"})})),setTimeout((function(){n.getActivityList()}),1e3)},n.scrollToBottom=function(e){(0,Z.scrollRelatedToTopMenu)("bottom",0,n.scrollRef.current,e)},n.referencesBtnClicked=function(){"activity"===n.state.activeLogTab?n.changeActivityTabAndShow():n.setState({activeLogTab:"activity"},(function(){n.setCommentPosition((function(){setTimeout((function(){n.changeActivityTabAndShow()}),0)}))}))},n.changeActivityTabAndShow=function(){"WITHOUT_COMMENT"===n.state.activitiesTab?n.setState({activitiesTab:"ALL",isShowItemPlaceholder:Ze(Ze({},n.state.isShowItemPlaceholder),{},{reference:!0})},(function(){n.changeTabFn(["ALL"]),n.setCommentPosition((function(){n.doShowReference()}))})):n.doShowReference()},n.doShowReference=function(){n.props.autoToggleComment(n.state.detailInfoState.code,!0)},n.getNotUploadElems=function(){var e=n.state,t=e.isDesEditing,a=e.isCommentEditing;return[t&&n.editComp.containerRef.current,a&&n.commentEditorRef&&n.commentEditorRef.current]},n.dragEnterDes=function(e){n.dragEnter(e,"des")},n.dragEnterComment=function(e){n.dragEnter(e,"comment")},n.dragEnter=function(e,t){e.preventDefault(),e.stopPropagation(),n["des"===t?"intoDesCount":"intoCommentCount"]++},n.dragLeaveDes=function(e){n.dragLeave(e,"des")},n.dragLeaveComment=function(e){n.dragLeave(e,"comment")},n.dragLeave=function(e,t){e.preventDefault(),e.stopPropagation();var a="des"===t?"intoDesCount":"intoCommentCount";n[a]--,0===n[a]&&n.setState({notUpload:!1})},n.mouseLeaveDes=function(){n.mouseLeave("des")},n.mouseLeaveComment=function(){n.mouseLeave("comment")},n.showSubWorkItemCreationModal=function(){n.setState({showSubWorkItemCreationModalVisible:!0})},n.handleSubWorkItemCreationVisibleChange=function(e){n.setState({subWorkItemCreationVisible:e,isShowItemPlaceholder:Ze(Ze({},n.state.isShowItemPlaceholder),{},{subWorkItems:e})},(function(){(0,Z.scrollRelatedToTopMenu)("work-item-relation-input",200,n.scrollRef.current)}))},n.onSubWorkItemChanged=function(e){var t=n.state.clearSubWorkItemTitle;n.setState({subWorkItemTitle:"",clearSubWorkItemTitle:!t}),n.getSubWorkItems((function(t){var a;"full-create"===e&&null!==(a=n.props)&&void 0!==a&&a.onDetailChange&&n.props.onDetailChange({type:De.UpdateItemActionType.CREATE_SUB,payload:{code:n.state.detailInfoState.code,data:t[t.length-1]}})})),n.dataLoad("subWorkItems"),n.getActivityList(),n.props.refreshCallback&&n.props.refreshCallback(),n.callback()},n.handleSubWorkItemListChange=function(e){n.setState({subWorkItemList:e})},n.handleSubWorkItemTitleChange=function(e){n.setState({subWorkItemTitle:e,controlSubWorkItemFocus:Date.now()})},n.handleSplittedIssuesVisible=function(e){n.setState({isShowItemPlaceholder:Ze(Ze({},n.state.isShowItemPlaceholder),{},{splittedIssues:e}),splittedIssuesVisible:e},(function(){(0,Z.scrollRelatedToTopMenu)("work-item-splitted-issue",200,n.scrollRef.current)}))},n.fetchManHourRecords=function(){var e=n.props,t=e.currentProject.id,a=e.detailInfo.code;return(0,te.getManhourHistories)(t,a).then((function(e){var t=e.data;n.setState({manHourRecords:t})}))},n.fetchManHourRecordsAndFetchSpecData=(0,s.default)(r.default.mark((function e(){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.fetchManHourRecords();case 2:return e.next=4,n.changeAttributes({type:""});case 4:case"end":return e.stop()}}),e)}))),n.deleteManhourRecord=function(e,t){var a=n.props.currentProject.id;return(0,te.delManHourHistory)(a,e.id,t).then((0,s.default)(r.default.mark((function e(){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.fetchManHourRecordsAndFetchSpecData();case 1:case"end":return e.stop()}}),e)}))))},n.handleWorkItemSubOperation=function(e){var t=e.code,a=e.destCode,i=e.issue,r=e.beforeCode,o=e.moveCode,s=e.type,l=e.parentCode;if(n.props.onDetailChange){var c=n.state.detailInfoState;switch(s){case"onRemoveRelation":n.props.onDetailChange({type:De.UpdateItemActionType.CHANGE_PARENT,payload:{code:t,data:{destCode:0}}});break;case"onChangeParent":n.props.onDetailChange({type:De.UpdateItemActionType.CHANGE_PARENT,payload:{code:t,data:{destCode:a}}});break;case"onRemove":n.props.onDetailChange({type:De.UpdateItemActionType.DELETE,payload:{code:t,data:{notClose:!0}}});break;case"onCreate":n.props.onDetailChange({type:De.UpdateItemActionType.CREATE_SUB,payload:{code:c.code,data:i}});break;case"onSort":n.props.onDetailChange({type:De.UpdateItemActionType.SORT,payload:{code:c.code,data:{code:t,beforeCode:r}}});break;case"onRelated":n.props.onDetailChange({type:De.UpdateItemActionType.CHANGE_PARENT,payload:{code:o,data:{destCode:a}}});break;case"parentCodeChange":n.props.onDetailChange({type:De.UpdateItemActionType.CHANGE_PARENT,payload:{code:c.code,data:{destCode:l}}}),n.getParentDetail();break;default:return}n.callback()}},n.renderActivity=function(e){var t=n.state,a=t.isInited,i=t.activities,r=t.detailInfoState,o=t.activitiesTab,s=t.isCommentSticky,l=n.props,c=l.isDetail,u=l.currentProject,d=l.user,f=l.projectPath,p=l.domID;return y.default.createElement(N.default,{isInited:a,scrollRef:n.scrollRef,isDetail:c,currentProject:u,user:d,activities:i,projectPath:f,domID:p,flashAnchor:n.props.flashAnchor,itemType:"WORK_ITEM",code:r.code,onPublishChildComment:n.postComment,editCommentCallback:n.handleEditCommentCallback,onDeleteComment:n.deleteComment,handleViewRecord:n.viewRecord,activeTab:[o],changeTab:function(e){return n.setState({activitiesTab:e},n.setCommentPosition)},getChangeTabFn:function(e){n.changeTabFn=e},isCommentSticky:s,hideTitle:e,handleEditComment:function(e){return n.setState({isEdittingCommentModalVisible:e})}})},n.changeActivityLogTab=function(e){n.setState({activeLogTab:e.value},(function(){n.setCommentPosition(),"approval"===e.value&&n.fetchIssueReviewList((function(e){0===e.length&&n.setState({activeLogTab:"activity"})}))}))},n.getDropdownPortalToRight=function(){return!n.props.isDetail&&!n.state.isFullScreen},n.doScroll=function(){if(!n.state.inputFocus){var e=n.scrollRef.current.scrollTop,t=n.state.isScrolled;e>100&&!t?n.setState({isScrolled:!0}):e<=100&&n.setState({isScrolled:!1})}},n.onAttrScroll=function(){n.setState({isElemScroll:!0})},n.getSensitiveMessage=function(e,t){return(0,re.getSensitive)(e,t).then((function(e){return 0===e.code?(n.setState({isSensitive:e.data.isSensitive}),e.data.isSensitive):null}))},n.getBasicInfo=function(){Promise.all([n.props.getRequirementTypes(),n.props.getBugTypes(),n.props.getWorkItemScheme()].concat((0,o.default)(_e.enableIssueReview?[n.fetchIssueReviewList()]:[]))).then((function(){n.setState({isInited:!0})})),n.getActivityList(),n.getIssueStatusTransfers(),n.getSplittedIssues(),n.getSubWorkItems(),n.fetchManHourRecords(),n.getResourceReference().then((function(){n.dataLoad("reference")}))},n.getSplittedIssues=function(){var e=n.props.currentProject.name,t=n.state.detailInfoState.code;(0,ye.fetchWorkItemSplittedIssues)(e,t).then((function(e){var t=e.data;n.setState({splittedIssues:t})})).finally((function(){return n.dataLoad("splittedIssues")}))},n.getSubWorkItems=function(e){var t=n.props.currentProject.name,a=n.state.detailInfoState.code;(0,ye.fetchSubWorkItems)(t,a).then((function(t){var a=t.data;n.setState({subWorkItemList:a}),e&&e(a)})).finally((function(){return n.dataLoad("subWorkItems")}))},n.getTencentMeeting=function(){var e=n.props.currentProject.name,t=n.state.detailInfoState.code;(0,te.getTencentMeetingDetail)(e,t).then((function(e){n.setState({meeting:e.data})}))},n.caculateDetailEleHeight=function(){return new Promise((function(e){n.doCaculate(-1,e)}))},n.doCaculate=function(e,t){if(n.detailBodyRef.current){var a=n.detailBodyRef.current.offsetHeight;a!==e?setTimeout((function(){n.doCaculate(a,t)}),300):t(a)}},n.setCommentPosition=function(){var e=(0,s.default)(r.default.mark((function e(t){var a,i,o,s,l;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n.scrollRef&&n.scrollRef.current&&n.hiddenHeaderRef.current&&n.detailBodyRef.current)){e.next=7;break}return e.next=3,n.caculateDetailEleHeight();case 3:o=e.sent,s=n.scrollRef.current.offsetHeight-n.hiddenHeaderRef.current.offsetHeight,l=(null===(a=n.commentEditorRef)||void 0===a||null===(i=a.current)||void 0===i?void 0:i.offsetHeight)||140,n.setState(Ze({isCommentSticky:o+l>=s},o+l<s?{isDescriptionBtnFixed:!1,isCommentAbsBottom:!1}:{}),(function(){if(n.state.isCommentSticky&&(setTimeout((function(){var e=n.hiddenHeaderRef.current.offsetHeight+(n.detailBodyRef.current.offsetHeight<s?s:n.detailBodyRef.current.offsetHeight);n.setState({isCommentAbsBottom:n.scrollRef.current.offsetHeight-e>=0,minHeight:s})}),0),n.state.isDesEditing)){var e=n.editorRef.current.offsetHeight+24,a=n.scrollRef.current.offsetHeight-n.hiddenHeaderRef.current.offsetHeight-44;n.setState({isDescriptionBtnFixed:e>=a})}"function"===typeof t&&t()}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.actionCallback=function(){var e=n.props.isDetail;n.getActivityList(),e||n.props.updateCallback()},n.renewDescription=function(e){var t=e.historyId,a=e.issueLogId,i=e.description,r=n.props.currentProject,o=n.state.detailInfoState;return(0,_.rollbackDescription)(r.id,o.code,a).then((function(){n.setState({historyId:t,description:i,isDescriptionEmpty:!i.replace(/\n|\s/g,"")}),n.getActivityList(),n.getResourceReference()}))},n.sensitiveCtrl=function(){var e=n.state.isSensitive,t=n.props,a=t.detailInfo,i=t.currentProject;e?n.setState({showDeleteModal:!0}):(0,re.addSensitive)(a.code,i.name).then((function(e){0===e.code&&((0,M.success)((0,b.t)("\u6807\u8bb0\u6210\u529f\uff01")),n.getSensitiveMessage(a.code,i.name))}))},n.cancelMark=function(){var e=n.props,t=e.detailInfo,a=e.currentProject;(0,re.cancelSensitive)(t.code,a.name).then((function(e){n.setState({showDeleteModal:!1}),0===e.code&&((0,M.success)((0,b.t)("\u53d6\u6d88\u6807\u8bb0\u6210\u529f\uff01")),n.getSensitiveMessage(t.code,a.name))}))},n.handleAttentionChange=function(e){n.changeAttributes({type:"watchers",value:e})},n.handleSelfChange=function(e){var t=n.props,a=t.currentProject,i=t.user,r=n.state,s=r.detailInfoState,l=r.watchers;e?(0,ye.watchWorkItem)(a.name,s.code).then((function(){n.setState({watchers:[].concat((0,o.default)(l),[i])}),(0,M.success)((0,b.t)("\u66f4\u65b0\u6210\u529f")),n.callback(),n.getActivityList()})):(0,ye.unWatchWorkItem)(a.name,s.code).then((function(){n.setState({watchers:(0,o.default)(l.filter((function(e){return e.id!==i.id})))}),(0,M.success)((0,b.t)("\u66f4\u65b0\u6210\u529f")),n.callback(),n.getActivityList()}))},n.onIsFullWidthChange=function(e){n.setState({isFullWidth:e})},n.handleSearchParentVisible=function(e){return n.setState({searchParentVisible:e})},n.handleParentChange=function(){n.getActivityList(),n.props.refreshCallback&&n.props.refreshCallback()},n.toggleFullScreenStatus=function(){var e=!n.state.isFullScreen;n.setState({isFullScreen:e}),(0,Le.setIsSlideFullScreen)(e),n.props.onFullScreenChange&&n.props.onFullScreenChange(e)},n.handleFullScreenKey=function(e){n.state.isDesEditing||e.target===document.body&&"f"===e.key.toLowerCase()&&n.toggleFullScreenStatus()},n.state={tooltipTitle:(0,b.t)("\u590d\u5236\u94fe\u63a5"),noHoverIcon:!1,detailInfoState:e.detailInfo,activities:[],description:e.detailInfo.descriptionMarkup,isDescriptionEmpty:!e.detailInfo.description.replace(/\n|\s/g,""),markdown:e.detailInfo.description,slateRaw:e.detailInfo.slateRaw,showCopyModal:!1,attachmentsState:n.combineThirdLinks(e.detailInfo.files,e.detailInfo.thirdLinks),isFilePreviewVisible:void 0,previewFileID:void 0,attributes:{assignee:void 0,priority:void 0,requirementType:void 0,defectType:void 0,module:void 0,startDate:void 0,dueDate:void 0,workingHours:void 0,labels:[],watchers:[],fields:{},progress:void 0},assignee:e.detailInfo.assignee,watchers:e.detailInfo.watchers||[],workItemStatusTransfers:[],isInited:!1,isHistoryRecordVisible:!1,currentLogId:void 0,showSideslip:!1,isSensitive:!1,showDeleteModal:!1,activitiesTab:"ALL",activeLogTab:"activity",isCommentSticky:!1,isCommentAbsBottom:!1,isScrolled:!1,inputFocus:!1,isDesEditing:!1,isFullWidth:!0,isFullScreen:(0,Le.getIsSlideFullScreen)(),currSubIssueCode:null,isShowItemPlaceholder:{description:!0,subWorkItems:!1,splittedIssues:!1,reference:!1},isRender:{subWorkItems:!1,splittedIssues:!1,reference:!1,logs:!1,comment:!1},isRenderAll:!1,delFileId:void 0,showDeleteConfirmModal:!1,isElemScroll:!1,scrollControl:Date.now(),meeting:void 0,isEdittingCommentModalVisible:!1,splittedIssues:[],subWorkItemList:[],nameList:[],manHourRecords:[],controlHideButtonActionMore:0,controlHideOptionMore:0,isShowApproveCreate:!1,issueReviewList:[],pageId:e.detailInfo.pageId||void 0,historyId:void 0,controlCaculatePos:0,isDescriptionBtnFixed:!1,identity:"",slotVisible:!1},n.onVisibleChange=n.onVisibleChange.bind((0,d.default)(n)),n.onCopyClick=n.onCopyClick.bind((0,d.default)(n)),n.updateDescription=n.updateDescription.bind((0,d.default)(n)),n.onNameChange=n.onNameChange.bind((0,d.default)(n)),n.callback=n.callback.bind((0,d.default)(n)),n.deleteWorkItem=n.deleteWorkItem.bind((0,d.default)(n)),n.updateWorkItem=n.updateWorkItem.bind((0,d.default)(n)),n.postComment=n.postComment.bind((0,d.default)(n)),n.deleteComment=n.deleteComment.bind((0,d.default)(n)),n.fileUploadSpec=n.fileUploadSpec.bind((0,d.default)(n)),n.onFileDropSuccessSpec=n.onFileDropSuccessSpec.bind((0,d.default)(n)),n.onFileDropDeleteSpec=n.onFileDropDeleteSpec.bind((0,d.default)(n)),n.onFileDropCancelSpec=n.onFileDropCancelSpec.bind((0,d.default)(n)),n.onFileDropFailSpec=n.onFileDropFailSpec.bind((0,d.default)(n)),n.filePreviewHideSpec=n.filePreviewHideSpec.bind((0,d.default)(n)),n.previewItem=n.previewItem.bind((0,d.default)(n)),n.handleDelInPreviewFileSpec=n.handleDelInPreviewFileSpec.bind((0,d.default)(n)),n.onStatusChange=n.onStatusChange.bind((0,d.default)(n)),n.submitTitleChange=n.submitTitleChange.bind((0,d.default)(n)),n.changeAttributes=n.changeAttributes.bind((0,d.default)(n)),n.getIssueStatusTransfers=n.getIssueStatusTransfers.bind((0,d.default)(n)),n.getResourceReference=n.getResourceReference.bind((0,d.default)(n)),n.onRemoveReference=n.onRemoveReference.bind((0,d.default)(n)),n.toggleRecord=n.toggleRecord.bind((0,d.default)(n)),n.viewRecord=n.viewRecord.bind((0,d.default)(n)),n.openSlideslip=n.openSlideslip.bind((0,d.default)(n)),n.closeSlideslip=n.closeSlideslip.bind((0,d.default)(n)),n.handleDeleteAttachmentConfirm=n.handleDeleteAttachmentConfirm.bind((0,d.default)(n)),n.handleEditCommentCallback=n.handleEditCommentCallback.bind((0,d.default)(n)),n.commentEditorRef=null,n.intoDesCount=0,n.intoCommentCount=0,n.commentStickyContainerRef=null,n.onScroll=n.onScroll.bind((0,d.default)(n)),n.desComp=null,n.headerRef=y.default.createRef(),n.hiddenHeaderRef=y.default.createRef(),n.detailBodyRef=y.default.createRef(),n.desComp=null,n.attechmentRef=y.default.createRef(),n.changeTabFn=null,n.editorRef=y.default.createRef(),n.elemShow(),n}return(0,u.default)(a,[{key:"headerRender",value:function(e){var t=this,a=this.state,n=a.detailInfoState,i=a.watchers,r=a.isSensitive,o=a.showDeleteModal,s=a.isDesEditing,l=a.isFullWidth,c=a.inputFocus,u=a.nameList,d=a.isFullScreen,f=!e&&this.state.isScrolled,p=this.props,m=p.projectPath,h=p.isDetail,v=p.workItemList,g=p.isPermissible,E=p.user,S=p.location.query,I=p.currentProject,T=p.currentProjectCooperateSettings,w=p.browserRouter,D=p.isSensitiveAdmin,O=p.payed,R=p.callFrom,N=p.detailInfo,A="outer"===R,L=I.name,F=v.findIndex((function(e){return e.code===n.code}))>-1,_=v&&v.findIndex((function(e){return e.code===n.code}))+1,M=1===_,x=_===(v&&v.length),B=g([{function:z.ProjectPermissionFunction.PROJECT_ISSUE,action:z.ProjectPermissionAction.UPDATE}]),U=w.params.subIssueCode?"".concat(m,"/program/plan/work-items/").concat(w.params.workItemCode,"/detail/subissues/"):"".concat(m,"/program/plan/"),W=(0,Fe.getAuidtPaymentState)(),Y={DESCRIPTION:B,UPLOAD:B,DECOMPOSE_WORK_ITEM:B,LINK_ISSUES:B,REFERENCES:!0,ISSUE_REVIEW:_e.enableIssueReview&&B},H=Ze(Ze({},s?{DESCRIPTION:""}:{}),5===u.length?{DECOMPOSE_WORK_ITEM:(0,b.t)("\u65e0\u6cd5\u7ee7\u7eed\u5206\u89e3\uff0c\u6700\u591a\u652f\u63015\u5c42")}:{}),V={};e&&(V.position="static",V.visibility="hidden");var G=(0,He.getSlotContext)(N,I.id);return y.default.createElement("div",{className:(0,q.default)(P.default.specHeader,h&&P.default.detail,this.state.inputFocus&&f&&P.default.scrollFocus,f&&!s&&P.default.fixed,f&&P.default.noBorder),ref:e?this.hiddenHeaderRef:this.headerRef,style:V},y.default.createElement("div",{className:(0,q.default)(P.default.main,f?P.default.fixed:"",d?P.default.fullScreenMain:"",h?P.default.detail:"")},y.default.createElement("div",{className:(0,q.default)(P.default.headerPanelMenuWrapper,c&&P.default.focus)},f?y.default.createElement("div",{className:P.default.scrolledTitleInnerWrap,style:{marginRight:c?0:"15px"}},this.renderScrollTitle(B,e)):this.renderParentsInfo(),y.default.createElement("div",{className:(0,q.default)(P.default.menus,f&&c&&P.default.hide)},y.default.createElement(Q.default,{type:"WORK_ITEM",projectID:I.id,watchers:i||[],onChange:this.handleAttentionChange,user:E,showTooltip:!0,readOnly:!B,handleSelfChange:this.handleSelfChange}),!h&&v&&!A&&F&&y.default.createElement("div",{className:P.default.divideLine}),!h&&v&&!A&&F&&y.default.createElement("div",{className:"".concat(P.default.preButton," ").concat(M&&P.default.disabled),onClick:function(){if(!M){var e=v[_-2].code;w.push({pathname:"".concat(U).concat(e),query:Ze({},S)})}}}),!h&&v&&!A&&F&&y.default.createElement("div",{className:"".concat(P.default.nextButton," ").concat(x&&P.default.disabled),onClick:function(){if(!x){var e=v[_].code;w.push({pathname:"".concat(U).concat(e),query:Ze({},S)})}}}),y.default.createElement("div",{className:P.default.divideLine}),!h&&y.default.createElement(C.TooltipTrigger,{title:this.state.isFullScreen?(0,b.t)("\u5207\u6362\u5230\u4fa7\u680f(F)"):(0,b.t)("\u5168\u5c4f(F)")},y.default.createElement("div",{className:this.state.isFullScreen?P.default.cancelFullScreenBtn:P.default.toFullScreenBtn,onClick:this.toggleFullScreenStatus})),!h&&y.default.createElement(C.TooltipTrigger,{title:(0,b.t)("\u5728\u65b0\u6807\u7b7e\u9875\u6253\u5f00")},y.default.createElement("div",{className:P.default.openNewLink,onClick:function(){window.open("".concat(m,"/program/plan/work-items/").concat(n.code,"/detail"),"_blank")}})),y.default.createElement(k.default,{deleteFunction:this.deleteWorkItem,hasParent:!!n.parent,hasEpic:!!n.epic,currentProject:I,currentProjectCooperateSettings:T,premiumVersion:!W||O,isSensitiveAdmin:D,isSensitive:r,sensitiveCtrlFunction:this.sensitiveCtrl,isShowFullWidthOption:h||!h&&this.state.isFullScreen,isPermissible:g,viewDescriptionVersion:function(){return t.setState({isHistoryRecordVisible:!0})},copyTitle:n.name,copyLink:"".concat(window.location.origin).concat(m,"/program/plan/work-items/").concat(n.code,"/detail"),isFullWidth:l,onIsFullWidthChange:this.onIsFullWidthChange,type:"WORK_ITEM",issueTypeDetail:n.issueTypeDetail,showSearchParent:function(){return t.setState({searchParentVisible:!0})},customTip:this.state.subWorkItemList.length>0?(0,b.t)("".concat(n.issueTypeDetail.name,"\u4e0b\u542b\u6709\u5b50\u5de5\u4f5c\u9879\uff0c").concat(n.issueTypeDetail.name,"\u5220\u9664\u540e\u5b50\u5de5\u4f5c\u9879\u5c06\u4e00\u5e76\u5220\u9664\uff0c\u786e\u8ba4\u5220\u9664\u5417\uff1f")):"",controlHideMore:this.state.controlHideOptionMore,onClickTrigger:function(){t.setState({controlHideButtonActionMore:Date.now()})},slotCallback:function(e){return t.setState({identity:e,slotVisible:!0})}}),y.default.createElement(oe.default,{title:(0,b.t)("\u786e\u5b9a\u8981\u53d6\u6d88\u6807\u8bb0"),show:o,onConfirm:this.cancelMark,onClose:function(){t.setState({showDeleteModal:!1})}}))),!f&&this.renderTitle(B,!1,e),(!f||f&&!c)&&y.default.createElement(de.default,{issueType:j.ISSUE_TYPE.WORK_ITEM,isShow:Y,isDisabled:H,onBtnClick:this.onBtnClick,uploadProps:{disabled:!B,currentAttachmentNum:this.state.attachmentsState.length,onHandleAttachments:this.fileUploadSpec},issueStatus:n.issueStatus.type,issueCode:n.code,projectName:L,userId:E.id,projectPath:m,posType:f,isLoaded:!0,canSplitWorkItem:!0,canSplitProject:!0,controlHideMore:this.state.controlHideButtonActionMore,slotContext:G,onClickTrigger:function(){t.setState({controlHideOptionMore:Date.now()})}})))}},{key:"descriptionBtnClicked",value:function(){var e=this,t=this.editComp;t.show().then((function(){e.setState({isShowItemPlaceholder:Ze(Ze({},e.state.isShowItemPlaceholder),{},{description:!1})},(function(){var a,n,i;null!==(a=e.scrollRef)&&void 0!==a&&a.current&&null!==(n=t.containerRef)&&void 0!==n&&n.current&&null!==(i=e.headerRef)&&void 0!==i&&i.current&&(0,Z.scrollIntoView)(e.scrollRef.current,t.containerRef.current,-e.headerRef.current.offsetHeight-26),t.onHandle()}))}))}},{key:"fetchIssueReviewList",value:function(e){var t=this,a=this.props,n=a.currentProject,i=a.detailInfo;(0,Me.fetchIssueReviewList)(n.id,i.code).then((function(a){var n=a.data;t.setState({issueReviewList:n},(function(){e&&e(n)}))}))}},{key:"issue_reviewBtnClicked",value:function(){this.setState({isShowApproveCreate:!0})}},{key:"mouseLeave",value:function(e){this["des"===e?"intoDesCount":"intoCommentCount"]=0,this.setState({notUpload:!1})}},{key:"decompose_work_itemBtnClicked",value:function(){var e=this;this.setState({subWorkItemCreationVisible:!0,controlSubWorkItemFocus:Date.now(),isShowItemPlaceholder:Ze(Ze({},this.state.isShowItemPlaceholder),{},{subWorkItems:!0})},(function(){(0,Z.scrollRelatedToTopMenu)("work-item-relation-input",200,e.scrollRef.current)}))}},{key:"link_issuesBtnClicked",value:function(){var e=this;this.setState({isShowItemPlaceholder:Ze(Ze({},this.state.isShowItemPlaceholder),{},{splittedIssues:!0}),splittedIssuesVisible:!0},(function(){(0,Z.scrollRelatedToTopMenu)("work-item-splitted-issue",200,e.scrollRef.current)}))}},{key:"render",value:function(){var e=this,t=this.state,a=t.detailInfoState,n=t.markdown,i=t.slateRaw,r=t.description,o=t.citedSources,s=t.citingSources,l=t.activities,c=t.attachmentsState,u=t.isFilePreviewVisible,d=t.previewFileID,f=t.isInited,p=t.isHistoryRecordVisible,m=t.currentLogId,h=t.showSideslip,v=t.activitiesTab,g=t.isCommentSticky,E=t.isFullWidth,S=t.isShowItemPlaceholder,I=t.isRender,T=t.isRenderAll,C=t.activeLogTab,w=t.showDeleteConfirmModal,k=t.isEdittingCommentModalVisible,N=t.subWorkItemList,A=t.showSubWorkItemCreationModalVisible,L=t.isShowAssociateModal,F=t.manHourRecords,_=t.searchParentVisible,M=t.pageId,x=t.historyId,U=t.isDescriptionEmpty,W=t.minHeight,H=t.isDescriptionBtnFixed,V=t.identity,G=t.slotVisible,K=this.props,Z=K.expanded,X=K.isDetail,Q=K.currentProject,$=K.user,te=K.enterpriseGlobalKey,ae=K.isPermissible,ne=K.autoshowComment,ie=K.domID,re=K.location,oe=K.currentProjectCooperateSettings,se=K.params,le=K.workItemSchemeFieldArchives,ce=K.targetData,ue=K.detailInfo,de=Q.name,pe=Q.id,ge=(0,He.getSlotContext)(ue,pe),Ee=void 0!==le&&Object.values(le).filter((function(e){return"HOUR_RECORD"===e.issueField.type})).length>0,be=ae([{function:z.ProjectPermissionFunction.PROJECT_ISSUE,action:z.ProjectPermissionAction.UPDATE}]),ye=this.state.notUpload&&(this.state.isDesEditing||this.state.isCommentEditing)||k||h,je=oe.ISSUE_TYPES.find((function(e){return e.issueType===j.ISSUE_TYPE.WORK_ITEM}))||{},Ne=g?{minHeight:"".concat(W,"px"),position:"relative"}:{position:"relative"},Ae=_e.enableIssueReview&&this.state.issueReviewList.length>0,Le=[];I.logs&&Le.push({text:(0,b.t)("\u6d3b\u52a8\u65e5\u5fd7"),value:Ve.MATTER_TABS_TYPE.ACTIVITY}),Ee&&Le.push({text:(0,b.t)("\u5de5\u65f6\u65e5\u5fd7"),value:Ve.MATTER_TABS_TYPE.WORK}),Ae&&Le.push({text:(0,b.t)("\u5ba1\u6279"),value:Ve.MATTER_TABS_TYPE.APPROVAL});var Fe=I.comment&&C!==Ve.MATTER_TABS_TYPE.WORK&&C!==Ve.MATTER_TABS_TYPE.APPROVAL&&l.length>0&&v!==Ve.ACTIVITIES_TAB.WITHOUT_COMMENT;return y.default.createElement(fe.default,{currentAttachmentNum:c.length,onHandleAttachments:this.fileUploadSpec,notUpload:ye,notUploadElems:this.getNotUploadElems(),onIntoUploadElems:function(){return e.setState({notUpload:!0})}},y.default.createElement(ve.default.Provider,{value:{scrollControl:this.state.scrollControl}},y.default.createElement("div",{className:P.default.specWrapper,onScroll:this.onAttrScroll,id:"scroll-attr-wrap"},y.default.createElement("div",{className:(0,q.default)(P.default.specDetail,X?P.default.isDetail:"",E&&P.default.isFullWidth)},this.headerRender(),this.headerRender(!0),y.default.createElement("div",{className:P.default.specMain,ref:this.scrollRef},y.default.createElement("div",{style:Ne,className:(0,q.default)(P.default.detailWrapper,X&&P.default.isDetail)},y.default.createElement("div",{className:"".concat(P.default.detailBody," ").concat(!Z&&X&&P.default.isDetail," ").concat(E&&P.default.isFullWidth),ref:this.detailBodyRef,onClick:function(){return e.setState({controlHideButtonActionMore:Date.now()})}},y.default.createElement("div",{className:"".concat(P.default.mainWrapper," ").concat(Z&&P.default.mainExpanded)},y.default.createElement("div",{onDragEnter:this.dragEnterDes,onDragLeave:this.dragLeaveDes,onMouseLeave:this.mouseLeaveDes,ref:this.editorRef},y.default.createElement(D.default,{editorType:ue.issueDescriptionType,issueId:ue.id,isInited:f,scrollRef:this.scrollRef,readOnly:!be,code:a.code,autoSaveKey:"".concat(de,"_WORK_ITEM_DETAIL_DESCRIPTION-").concat(a.code),updateDescription:this.updateDescription,refreshActivity:function(){return e.getActivityList()},updatePageId:function(t){return e.setState({pageId:t})},historyId:x,currentProject:Q,markdown:n,slateRaw:i,description:r,flashAnchor:this.props.flashAnchor,domID:ie,enterpriseGlobalKey:te,getThis:this.getEditComp,editStatusChanged:this.editStatusChanged,isShowPlaceholder:U&&S.description,location:re,userId:$.id,pageId:M,setCommentPosition:this.setCommentPosition,onLoad:function(t){e.dataLoad("description"),t&&e.setState({isDescriptionEmpty:t.isEmpty})},isDescriptionBtnFixed:H})),c.length>0&&y.default.createElement("div",{className:P.default.sectionWrapper,ref:this.attechmentRef},y.default.createElement(ee.ThemeConsumer,null,(function(t){var n=t.hiddenFolderDirs;return y.default.createElement(Y.default,{expanded:Z,disabled:!be,attachments:c,enterpriseGlobalKey:te,currentProjectName:de,currentProjectID:pe,currentAttachmentNum:c.length,issueCode:a.code,onHandleAttachments:e.fileUploadSpec,uploadFileSuccess:e.onFileDropSuccessSpec,uploadFileFailed:e.onFileDropFailSpec,uploadFileDelete:e.onFileDropDeleteSpec,uploadFileCancel:e.onFileDropCancelSpec,dir:n&&n[j.HIDDEN_FILE_TYPE.WORK_ITEM]&&n[j.HIDDEN_FILE_TYPE.WORK_ITEM].file_id,previewItemHandle:e.previewItem,userID:$.id})}))),(S.subWorkItems||N.length>0)&&I.subWorkItems&&y.default.createElement("div",{className:P.default.sectionWrapper},y.default.createElement(Ie.default,{parentCode:a.code,currentCode:!X&&this.state.isFullScreen&&h?this.state.currSubIssueCode:Number(se.subIssueCode),isDetail:X,scrollTargetId:"work-item-relation-input",createVisible:this.state.subWorkItemCreationVisible,onCreateVisibleChange:this.handleSubWorkItemCreationVisibleChange,controlFocus:this.state.controlSubWorkItemFocus,list:N,callback:this.onSubWorkItemChanged,isPermissible:ae,onFullCreate:this.showSubWorkItemCreationModal,onListChange:this.handleSubWorkItemListChange,onTitleChange:this.handleSubWorkItemTitleChange,clearTitle:this.state.clearSubWorkItemTitle,canSplit:!0,project:Q,issueTypeDetail:je,onRemoveRelation:function(t){return e.handleWorkItemSubOperation({code:t,type:"onRemoveRelation"})},onChangeParent:function(t,a){return e.handleWorkItemSubOperation({code:t,destCode:a,type:"onChangeParent"})},onRemove:function(t){return e.handleWorkItemSubOperation({code:t,type:"onRemove"})},onCreate:function(t){return e.handleWorkItemSubOperation({issue:t,type:"onCreate"})},onSort:function(t,a){return e.handleWorkItemSubOperation({code:t,beforeCode:a,type:"onSort"})},onRelated:function(t,a){return e.handleWorkItemSubOperation({destCode:t,moveCode:a,type:"onRelated"})},onChange:function(t,a){e.handleDetailChange({type:De.UpdateItemActionType.ATTR_CHANGE,payload:{code:t,data:a}}),e.callback()},isFullScreen:!X&&this.state.isFullScreen})),A&&y.default.createElement(Ce.default,{targetData:ce,name:this.state.subWorkItemTitle,show:A,closeHandle:function(){return e.setState({showSubWorkItemCreationModalVisible:!1})},callback:function(){e.onSubWorkItemChanged("full-create")},parentCode:a.code,issueTypeDetail:je}),(S.splittedIssues||this.state.splittedIssues.length>0)&&I.splittedIssues&&y.default.createElement("div",{className:P.default.sectionWrapper},y.default.createElement(Se.default,{allowUpdate:be,enterpriseGlobalKey:te,currentProject:Q,user:$,list:this.state.splittedIssues,currentIssue:this.state.detailInfoState,onSplittingIssue:function(){e.getSplittedIssues(),e.getActivityList(),e.callback()},isDetail:this.props.isDetail,browserRouter:this.props.browserRouter,onRefresh:function(){e.getSplittedIssues(),e.getActivityList(),e.callback()},onOpenAssociateIssuesModal:function(){return e.setState({isShowAssociateModal:!0})},scrollTargetId:"work-item-splitted-issue",splittedIssuesVisible:this.state.splittedIssuesVisible,onSplittedIssuesVisible:this.handleSplittedIssuesVisible,isFullScreen:!X&&this.state.isFullScreen})),L&&y.default.createElement(we.default,{programID:Q.id},y.default.createElement(we.ProgramProjectListCtx.Consumer,null,(function(t){var n=t.results;return y.default.createElement(Pe.default,{isShown:L,onHide:function(){return e.setState({isShowAssociateModal:!1})},handleAssociateCb:function(){e.getSplittedIssues(),e.getActivityList()},program:Q,itemCode:a.code,projects:n,splittedIssues:e.state.splittedIssues})}))),I.reference&&(Object.keys(o).length>0||Object.keys(s).length>0||S.reference)&&y.default.createElement("div",{className:P.default.sectionWrapper},y.default.createElement(O.default,{flashAnchor:function(t){e.setState({activeLogTab:"activity"},(function(){e.props.flashAnchor(t)}))},currentProject:Q,citedSources:o,citingSources:s,markdown:n,autoToggleComment:this.referencesBtnClicked,code:a.code,onRemoveReference:this.onRemoveReference})),Le.length>=2&&y.default.createElement(y.default.Fragment,null,y.default.createElement("div",{id:"activity-log-tab"}),y.default.createElement(Oe.default,{tabs:Le,activeTab:C,onChange:this.changeActivityLogTab})),I.logs&&y.default.createElement(y.default.Fragment,null,"activity"===C&&this.renderActivity(Ee),Ee&&"work"===C&&y.default.createElement(Re.default,{detailInfo:a,records:F,onDelete:this.deleteManhourRecord,reloadData:this.fetchManHourRecordsAndFetchSpecData,allowUpdate:be})),Ae&&"approval"===C&&y.default.createElement("div",{id:"issue-review-list"},y.default.createElement(xe.default,{isDetail:X,list:this.state.issueReviewList,onItemChange:this.handleReviewListChanged,onShowCreate:function(){e.setState({isShowApproveCreate:!0})},onShowDetail:function(t){e.setState({issueReviewCode:t})},allowUpdate:be})))))),u&&y.default.createElement(B.default,{isShown:u,previewFiles:c,onFileViewerHide:this.filePreviewHideSpec,enterpriseGlobalKey:te,currentId:pe,currentProjectName:de,currentFileId:d,onHandleDelAttachment:this.handleDeleteAttachmentConfirm}),_&&y.default.createElement(Te.default,{onVisibleChange:this.handleSearchParentVisible,issueCode:a.code,fetchList:this.handleParentChange,project:Q,parentCodeChange:function(t){return e.handleWorkItemSubOperation({parentCode:t,type:"parentCodeChange"})}}),p&&y.default.createElement(J.default,{show:p,closeHandle:this.toggleRecord,enterpriseGlobalKey:te,currentProject:Q,issueType:j.HISTORY_RESCORDS[a.type],issueCode:a.code,pageId:M,currentLogId:m,handleUpdate:this.renewDescription,allowUpdate:be}),h&&y.default.createElement(ke.default,{params:se,currentProject:Q,projectPath:Q.project_path,closeSlideslip:this.closeSlideslip,workItemList:N,onDetailChange:function(){e.getActivityList(),e.getResourceReference()},getWorkItems:this.getSubWorkItems,code:this.state.currSubIssueCode,onCodeChange:function(t){e.setState({currSubIssueCode:t})},targetData:ce,enterpriseName:this.props.enterpriseName}),this.state.isShowApproveCreate&&y.default.createElement(Be.default,{fromIssueId:this.props.detailInfo.id,onItemChange:function(){return e.handleReviewListChanged(!0)},onCancel:function(){return e.setState({isShowApproveCreate:!1})}}),this.state.issueReviewCode&&y.default.createElement(Ue.default,{allowUpdate:be,detailCode:this.state.issueReviewCode,onDetailCodeChange:function(t){e.setState({issueReviewCode:t})},onCancel:function(){e.setState({issueReviewCode:void 0},(function(){e.handleReviewListChanged()}))}}),y.default.createElement(We.default,{slotVisible:G,identity:V,context:ge,onClose:function(){return e.setState({slotVisible:!1})}}),!T&&y.default.createElement(me.default,null),y.default.createElement("div",{id:"bottom"}),Fe&&y.default.createElement(R.default,{issueType:"WORK_ITEM",autoToggleComment:this.props.autoToggleComment,autoshowComment:!!ne[a.code],expanded:Z,currentProject:Q,avatar:$.avatar,issueCode:a.code,onPostComment:this.postComment,isCommentSticky:g,isCommentAbsBottom:this.state.isCommentAbsBottom,onEditStatusChanged:function(t,a){e.commentEditorRef=a,e.setState({isCommentEditing:t})},onDragEnterEditor:this.dragEnterComment,onDragLeaveEditor:this.dragLeaveComment,onMouseLeaveEditor:this.mouseLeaveComment,isDetail:X,userID:$.id,isDescriptionBtnFixed:H,onRef:function(t){return e.commentStickyContainerRef=t}})),h?y.default.createElement("div",{className:(0,q.default)(P.default.specAttribute,X||!X&&this.state.isFullScreen?P.default.isDetail:P.default.isSpec,E&&P.default.isFullWidth)}):this.renderAttributes(),y.default.createElement(he.default,{show:w,type:"ATTACHMENT",text:(0,b.t)("\u786e\u5b9a\u8981\u5220\u9664\u5417\uff1f"),onConfirm:function(){e.handleDelInPreviewFileSpec()},onClose:function(){e.setState({showDeleteConfirmModal:!1})}}))))}},{key:"isAssignAttrRequired",value:function(e){if(!e)return!1;var t=!1;return Object.keys(e).forEach((function(a){var n=e[a]&&e[a].issueField;n&&"ASSIGNEE"===n.type&&(t=e[a].required)})),t}},{key:"renderAttributes",value:function(){var e=this,t=this.props,a=t.isDetail,n=t.isPermissible,i=t.expanded,r=t.workItemSchemeFieldArchives,o=t.workItemUpdateFieldIDs,s=t.currentProject,l=t.bugTypes,c=t.requirementTypes,u=t.moduleSchemes,d=t.labels,f=t.addLabel,p=t.detailInfo,m=t.issueCode,h=this.state,v=h.detailInfoState,g=h.attributes,E=h.assignee,S=h.watchers,I=h.isFullWidth,T=h.isInited,C=h.meeting,D=(0,He.getSlotContext)(p,s.id),O=n([{function:z.ProjectPermissionFunction.PROJECT_ISSUE,action:z.ProjectPermissionAction.UPDATE}]);return y.default.createElement("div",{className:(0,q.default)(P.default.specAttribute,a||!a&&this.state.isFullScreen?P.default.isDetail:P.default.isSpec,I&&P.default.isFullWidth)},"outer"===this.props.callFrom&&y.default.createElement("div",{className:(0,q.default)(P.default.issueProperty,a&&P.default.isDetail)},y.default.createElement("div",{className:(0,q.default)(P.default.label,a&&P.default.isDetail)},(0,b.t)("\u9879\u76ee\u96c6")),y.default.createElement("div",{className:(0,q.default)(P.default.customBar,a&&P.default.isDetail)},y.default.createElement(Ae.default,{name:this.props.currentProject.display_name,icon:this.props.currentProject.icon,jumpUrl:this.props.currentProject.project_path}))),void 0!==C&&y.default.createElement("div",{className:(0,q.default)(P.default.meetingNotify,C.status===j.MEETING_STATUS.processing?P.default.processing:P.default.waiting)},y.default.createElement("div",{className:P.default.title},"QUICK"===C.type?"".concat(C.creator.name).concat((0,b.t)("\u7684\u5feb\u901f\u4f1a\u8bae")):C.subject),y.default.createElement("div",{className:P.default.desc},(0,L.timeFormat)(C.startTime,"MM\u6708DD\u65e5"),y.default.createElement("span",{className:P.default.time},(0,L.timeFormat)(C.startTime,"HH:mm"),y.default.createElement("span",{className:P.default.line},"-"),(0,L.timeFormat)(C.endTime,"HH:mm")),y.default.createElement("div",{className:(0,q.default)(P.default.enterMeeting,a?P.default.isDetail:""),onClick:function(){window.open(C.joinUrl,"_blank")}},(0,b.t)("\u8fdb\u5165\u4f1a\u8bae")))),y.default.createElement("div",{className:(0,q.default)(P.default.issueProperty,a&&P.default.isDetail)},y.default.createElement("div",{className:(0,q.default)(P.default.label,a&&P.default.isDetail)},(0,b.t)("\u72b6\u6001")),y.default.createElement(w.default,{className:(0,q.default)(P.default.step,P.default.customBar,a&&P.default.isDetail),value:v.issueStatus,onSelect:this.onStatusChange,disabled:!O,isDetail:a,hoverControlArrow:!0,labelSize:"default",projectID:s.id,project:s,issueCode:m})),y.default.createElement("div",{className:(0,q.default)(P.default.issueProperty,a&&P.default.isDetail)},y.default.createElement("div",{className:(0,q.default)(P.default.label,a&&P.default.isDetail,this.isAssignAttrRequired(r)&&P.default.required)},(0,b.t)("\u5904\u7406\u4eba")),y.default.createElement("div",{className:(0,q.default)(P.default.customBar,a&&P.default.isDetail)},y.default.createElement(X.default,{disabled:!O,value:g.assignee||null,inProject:!0,projectID:s.id,onSelect:function(t){return e.changeAttributes({type:"assignee",value:t.value})},onClear:function(){return e.changeAttributes({type:"assignee"})},triggerExtraProps:{initialSelectedItem:E}}))),y.default.createElement("div",{className:P.default.splitLine,style:{marginTop:"16px"}}),T&&y.default.createElement(W.default,{user:this.props.user,expanded:i,className:P.default.issueProperties,isCreate:!1,schemeFieldArchives:r,fieldIds:o,issueType:"WORK_ITEM",onChange:this.changeAttributes,customAttributes:g,assignee:E,watchers:S,isFromDetailPage:a||i,isDetailPage:a,permissionFunction:z.ProjectPermissionFunction.PROJECT_ISSUE,isPermissible:n,projectID:s.id,currentProject:s,bugTypes:l,requirementTypes:c,moduleSchemes:u,labels:d,addLabel:f,detailInfo:p,subRequirements:this.state.subWorkItemList,activities:this.state.activities,onManHourUpdate:function(){e.fetchManHourRecords().then((function(){e.changeAttributes({type:""})}))},onForwardLogs:function(){(0,Z.scrollRelatedToTopMenu)("activity-log-tab",200,e.scrollRef.current),e.setState({activeLogTab:"work"})},portalProps:{toRight:this.getDropdownPortalToRight(),portalWrapStyle:{zIndex:1099},isScroll:this.state.isElemScroll,resetIsScroll:function(){e.setState({isElemScroll:!1})}},meetingCallback:function(t){e.setState({meeting:t}),e.getActivityList()}}),y.default.createElement("div",{className:(0,q.default)(P.default.createTime,P.default.creatorInfo),title:"".concat(v.creator.name).concat((0,b.t)(" \u521b\u5efa\u4e8e ")).concat((0,A.default)((0,L.timeFormat)(v.createdAt,"YYYY-MM-DD HH:mm:ss")).fromNow())},v.creator.name," ",(0,b.t)("\u521b\u5efa\u4e8e")," ",(0,A.default)((0,L.timeFormat)(v.createdAt,"YYYY-MM-DD HH:mm:ss")).fromNow()),y.default.createElement(Ye.default,{context:D}))}},{key:"onScroll",value:function(e){var t=this.state,a=t.isDesEditing,n=t.isDescriptionBtnFixed;if(a){var i,r,o,s,l=this.scrollRef.current.scrollTop,c=this.scrollRef.current.getBoundingClientRect().height,u=this.editorRef.current.getBoundingClientRect().height,d=(null===(i=this.commentStickyContainerRef)||void 0===i||null===(r=i.current)||void 0===r?void 0:r.offsetHeight)||0;n=u>=c+l-(null===(o=this.headerRef)||void 0===o||null===(s=o.current)||void 0===s?void 0:s.offsetHeight)-d}this.setState({scrollControl:Date.now(),isDescriptionBtnFixed:n}),clearTimeout(this.scrollRunId),e.stopPropagation(),this.scrollRunId=setTimeout(this.doScroll,50)}},{key:"componentDidMount",value:function(){var e=this.props,t=e.user,a=e.watermark,n=e.payed,i=e.isDetail,r=e.params.subIssueCode,o=e.detailInfo,s=e.getLabels,l=e.isSensitiveAdmin,c=this.state.detailInfoState;this.scrollRef.current&&this.scrollRef.current.addEventListener("scroll",this.onScroll,!1);var u=(0,Fe.getAuidtPaymentState)(),d=(0,Fe.getWatermarkPaymentState)();if(s&&s(),i&&r&&this.openSlideslip(),this.initAttributesData(o),this.getBasicInfo(),o.pageId?this.state.isDescriptionEmpty&&this.dataLoad("description"):this.dataLoad("description"),this.getParentDetail(),!d||n){var f=(0,ie.getText)(t);(0,ie.watermarkService)(a,f,i)}u&&!n||(l&&this.getSensitiveMessage(o.code,this.props.currentProject.name),(0,re.track)({projectName:this.props.currentProject.name,pageIdentifier:"WORK_ITEM_DETAIL",code:c.code})),document.addEventListener("keyup",this.handleFullScreenKey)}},{key:"handleInput",value:function(e){var t=(0,x.default)(this.state.detailInfoState,(function(t){t.name=e}));this.setState({detailInfoState:t},this.submitTitleChange)}},{key:"componentWillUnmount",value:function(){var e=this.props,t=e.payed,a=e.isDetail;(0,Fe.getWatermarkPaymentState)()&&!t||(0,ie.removeWatermark)(a),document.removeEventListener("keyup",this.handleFullScreenKey)}},{key:"componentDidUpdate",value:function(e,t){var a=this.props,n=a.params,i=a.detailInfo,r=a.issueCode,o=a.isDetail,s=a.controlUpdateSubWorkItems,l=e.params,c=e.detailInfo;t.controlCaculatePos,this.state.controlCaculatePos;(0,U.default)(l,n)||(l.workItemCode!==n.workItemCode&&(this.getIssueStatusTransfers(),this.props.getWorkItemScheme()),o&&n.subIssueCode?this.openSlideslip():this.closeSlideslip()),(0,U.default)(i,c)||this.updateDetailInfo(r,i),s&&s!==e.controlUpdateSubWorkItems&&this.getSubWorkItems()}},{key:"updateDetailInfo",value:function(e,t){var a=this;this.setState(Ze({detailInfoState:t,attachmentsState:(0,o.default)(t.files)},this.isDeleteInFilePreview?{isFilePreviewVisible:!1}:null),(function(){a.isDeleteInFilePreview=!1,a.initAttributesData(t)}))}},{key:"initAttributesData",value:function(e){this.setState({attributes:{assignee:e.assignee&&e.assignee.id||void 0,priority:void 0!==e.priority?e.priority:void 0,defectType:e.defectType&&e.defectType.id||void 0,projectModule:e.projectModule&&e.projectModule.id||void 0,requirementType:e.requirementType&&e.requirementType.id||void 0,dueDate:e.dueDate||void 0,startDate:e.startDate||void 0,labels:e.labels&&!!e.labels.length&&e.labels.map((function(e){return e.id}))||[],watchers:e.watchers&&!!e.watchers.length&&e.watchers.map((function(e){return e.id}))||[],workingHours:e.workingHours,fields:e.issueSchemeFields||{},progress:e.progress},assignee:e.assignee,watchers:e.watchers||[]})}},{key:"changeAttributes",value:function(e){var t,a=e.isCustom,n=e.type,i=e.value,r=e.issueFieldId,o=this.state.attributes,s=this.props.workItemSchemeFieldArchives;if(a){var c=o.fields,u=i;!i&&(0,K.default)(c[r])?u=[]:!i&&((0,V.default)(c[r])||(0,G.default)(c[r])||(0,H.default)(c[r]))&&(u=null),s[r].issueField.componentType!==be.PROPERTY_TYPE_CONSTANTS.SELECT_MEMBER_SINGLE&&s[r].issueField.componentType!==be.PROPERTY_TYPE_CONSTANTS.SELECT_ITERATION_SINGLE||(u=i?i.id:null),s[r].issueField.componentType!==be.PROPERTY_TYPE_CONSTANTS.SELECT_MEMBER_MULTI&&s[r].issueField.componentType!==be.PROPERTY_TYPE_CONSTANTS.SELECT_ITERATION_MULTI||(u=i?i.map((function(e){return e.id})):[]),t={customFieldValueMap:[{id:r,content:u}]}}else switch(n){case"defectType":t={defectTypeId:i||0};break;case"requirementType":case"priority":case"assignee":t=Ze({},"requirementType"===n?{requirementTypeId:i||0}:(0,l.default)({},n,i||0));break;case"labels":case"watchers":var d=o.labels,f=o.watchers,p="labels"===n?"labelIds":"watchers",m="labels"===n?"delLabelIds":"delWatchers",h="labels"===n?d:f,v=Array.from(new Set(h.concat(i)));if(i)if(v.length===h.length){var g=h.findIndex((function(e){return!i.includes(e)}));t=(0,l.default)({},m,[h[g]])}else t=(0,l.default)({},p,[i[i.length-1]]),"watchers"===n&&(i=v);else t=(0,l.default)({},m,h);break;case"workingHours":t={workingHours:i||0};break;case"projectModule":t={projectModuleId:i||0};break;case"progress":t={progress:i||0};break;default:t=(0,l.default)({},n,i)}this.setState({attributes:Ze(Ze({},o),a?{fields:Ze(Ze({},o.fields),{},(0,l.default)({},r,i))}:(0,l.default)({},n,i))}),this.updateWorkItem(t,void 0,"progress"===n)}},{key:"getIssueStatusTransfers",value:function(){var e=this,t=this.props,a=t.issueCode,n=t.currentProject;return(0,_.fetchIssueStatusTransfers)(n.id,a).then((function(t){var a=t.data;e.setState({workItemStatusTransfers:a})}))}},{key:"callback",value:function(e,t){var a=this.props.updateCallback;a&&a(e,t)}},{key:"handleDetailChange",value:function(e){var t=this.props.onDetailChange;t&&t(e)}},{key:"onNameChange",value:function(e){var t=(0,x.default)(this.state.detailInfoState,(function(t){t.name=e.target.value}));this.setState({detailInfoState:t})}},{key:"submitTitleChange",value:function(){var e=this,t=this.state.detailInfoState,a=this.props.detailInfo;t.name&&t.name.length<=128?t.name!==a.name&&this.updateWorkItem({name:t.name.trim()},(function(){e.titleInputRef&&e.titleInputRef.current&&(e.titleInputRef.current.blur(),e.setState({noHoverIcon:!0},(function(){setTimeout((function(){e.setState({noHoverIcon:!1})}),0)}))),e.setState({detailInfoState:Ze(Ze({},t),{},{name:t.name.trim()})})})):(0,M.warning)((0,b.t)("\u8bf7\u8f93\u5165\u4e0d\u8d85\u8fc7128\u4f4d\u7684\u5de5\u4f5c\u9879\u540d\u79f0"))}},{key:"onStatusChange",value:function(e){return this.updateWorkItem(e)}},{key:"onVisibleChange",value:function(){this.setState({tooltipTitle:(0,b.t)("\u590d\u5236\u94fe\u63a5")})}},{key:"onCopyClick",value:function(){this.setState({tooltipTitle:(0,b.t)("\u5df2\u590d\u5236")})}},{key:"updateDescription",value:function(e){var t=this,a=this.props,n=a.currentProject,i=a.issueCode;return(0,_.modifyIssueDescription)(n.id,i,Ze({},e)).then((function(e){return(0,Ge.clearLocalStorage)(t.props),t.getResourceReference(),e}))}},{key:"deleteWorkItem",value:function(){var e=this,t=this.props,a=t.currentProject,n=t.projectPath,i=t.refreshCallback,r=t.location,o=r.search,s=r.pathname,l=t.browserRouter,c=t.callFrom,u=this.state.detailInfoState;(0,ye.deleteWorkItem)(a.name,u.code).then((function(){(0,M.success)((0,b.t)("\u5220\u9664\u6210\u529f")),"outer"===c?(0,Ne.emitFromPM)({type:"closeSlide"}):/detail\/subissues/.test(s)?l.push("".concat(n,"/program/plan/work-items/").concat(u.parentCode,"/detail")):(e.handleDetailChange({type:De.UpdateItemActionType.DELETE,payload:{code:u.code}}),l.push("".concat(n,"/program/plan").concat(o))),e.setState({isFilePreviewVisible:!1}),i(!0)}))}},{key:"updateWorkItem",value:function(e,t,a){var n=this,i=this.props.currentProject,r=this.state.detailInfoState;return(0,ye.updateWorkItem)(i.name,r.code,e).then((function(t){var i=t.data;return i.files=n.combineThirdLinks(i.files,i.thirdLinks),n.callback(i,e.statusId),n.handleDetailChange({type:De.UpdateItemActionType.ATTR_CHANGE,payload:{code:r.code,data:i},isUpdateParent:a}),n.getActivityList(),n.fetchManHourRecords(),(0,M.success)((0,b.t)("\u66f4\u65b0\u6210\u529f")),t}),(function(t){var a=t.code,i=t.data,s=(t.msg,n.state.attachmentsState);return 8015===a?i.issue_status_id===e.statusId?(n.callback(null,e.statusId),n.getActivityList(),(0,M.success)((0,b.t)("\u66f4\u65b0\u6210\u529f"))):((0,M.danger)((0,b.t)("\u66f4\u65b0\u5931\u8d25\uff0c\u5f53\u524d\u72b6\u6001\u4e0d\u6b63\u786e\u3002")),n.callback(null,i.issue_status_id),n.getActivityList()):n.setState({detailInfoState:r,attachmentsState:(0,o.default)(s.filter((function(e){return e.fileId>0})))},(function(){n.initAttributesData(r)})),t})).finally((function(){"function"===typeof t&&t()}))}},{key:"handleEditCommentCallback",value:function(e){var t=this;this.getActivityList((function(){setTimeout((function(){(0,Z.scrollRelatedToTopMenu)("comment-".concat(e),0,t.scrollRef.current)}))})),this.getResourceReference()}},{key:"postComment",value:function(e,t,a,n,i){var r=this,o=this.props.currentProject;return(0,ye.addWorkItemComment)({projectName:o.name,workItemCode:t,content:a,parentID:n}).then((function(e){i&&i(),r.getActivityList((function(){setTimeout((function(){(0,Z.scrollRelatedToTopMenu)("comment-".concat(e.data.id),0,r.scrollRef.current)}))})),r.getResourceReference()}))}},{key:"deleteComment",value:function(e,t,a,n){var i=this,r=this.props.currentProject;(0,ye.deleteWorkItemComment)(r.name,t,a).then((function(){n&&n(),i.getActivityList(),i.getResourceReference()}))}},{key:"getActivityList",value:function(e){var t=this,a=this.props.issueCode,n=this.props.currentProject.name;return(0,ye.fetchWorkItemActitvites)(n,a).then((function(a){t.setState({activities:a.data},(function(){e&&e()}))})).finally((function(){return t.dataLoad("logs")}))}},{key:"getResourceReference",value:function(){var e=this,t=this.state.detailInfoState,a=this.props.currentProject;return Promise.all([(0,_.fetchCitedResourceReference)(a.id,t.code),(0,_.fetchCitingResourceReference)(a.id,t.code)]).then((function(t){e.setState({citedSources:t[0].data,citingSources:t[1].data})}))}},{key:"onRemoveReference",value:function(){(0,M.success)((0,b.t)("\u53d6\u6d88\u5173\u8054\u6210\u529f")),this.getResourceReference(),this.getActivityList()}},{key:"combineThirdLinks",value:function(e,t){if(!t)return e;var a=t.map((function(e){var t="MODAO"===e.thirdType,a="CODESIGN"===e.thirdType,n="";return t&&(n=e.title||(0,b.t)("\u58a8\u5200\u9644\u4ef6")),a&&(n=e.title),Ze(Ze({},e),{},{isModao:t,isCodesign:a,fileId:e.id,name:n,preview:t&&e.link})})),n=[].concat((0,o.default)(e),(0,o.default)(a));return n.sort((function(e,t){return(e.createdAt||e.created_at)-(t.createdAt||t.created_at)})),n}},{key:"fileUploadSpec",value:function(e){var t=this.state.attachmentsState;this.setState({attachmentsState:[].concat((0,o.default)(t),(0,o.default)(e))})}},{key:"handleDeleteAttachment",value:function(e,t){t?this.handleDeleteModao(e):this.updateWorkItem({delFileIds:[e]})}},{key:"handleDeleteModao",value:function(e){var t=this,a=this.props,n=a.currentProject.id,i=a.issueCode;(0,F.deleteModao)(n,i,e).then((function(){(0,M.success)((0,b.t)("\u5220\u9664\u6210\u529f")),t.setState({attachmentsState:t.state.attachmentsState.filter((function(t){return t.fileId!==e}))}),t.getActivityList()}))}},{key:"onFileDropSuccessSpec",value:function(e){var t=this;if(e.isCanceled)this.setState({attachmentsState:(0,x.default)(this.state.attachmentsState,(function(t){var a=t.findIndex((function(t){return t.timestamp===e.timestamp}));t.splice(a,1)}))});else if(e.isModao||e.isCodesign){(0,M.success)((0,b.t)("\u66f4\u65b0\u6210\u529f"));var a=this.props,n=a.currentProject.name,i=a.issueCode;(0,ye.fetchWorkItemDetail)(n,i,{withDescriptionMarkup:!0}).then((function(e){var a=e.data;t.setState({attachmentsState:t.combineThirdLinks(a.files,a.thirdLinks)},(function(){t.scrollToAttechment()}))})),this.getActivityList()}else this.updateWorkItem({fileIds:[e.fileId]},(function(){t.scrollToAttechment()}))}},{key:"onFileDropFailSpec",value:function(e){var t=e.timestamp;this.setState({attachmentsState:(0,x.default)(this.state.attachmentsState,(function(e){var a=e.findIndex((function(e){return e.timestamp===t}));e.splice(a,1)}))})}},{key:"onFileDropDeleteSpec",value:function(e){var t=e.fileId,a=e.isModao,n=e.isCodesign;this.handleDeleteAttachment(t,a||n)}},{key:"onFileDropCancelSpec",value:function(e){var t=e.timestamp;this.setState({attachmentsState:(0,x.default)(this.state.attachmentsState,(function(e){var a=e.findIndex((function(e){return e.timestamp===t}));e[a].isCanceled=!0}))})}},{key:"filePreviewHideSpec",value:function(e){this.setState({isFilePreviewVisible:e})}},{key:"previewItem",value:function(e){this.setState({previewFileID:e,isFilePreviewVisible:!0})}},{key:"handleDelInPreviewFileSpec",value:function(){var e=this,t=this.state.deleteFileId;this.isDeleteInFilePreview=!0,this.updateWorkItem({delFileIds:[t]},(function(){e.setState({showDeleteConfirmModal:!1,deleteFileId:void 0})}))}},{key:"handleDeleteAttachmentConfirm",value:function(e,t){this.setState({showDeleteConfirmModal:!0,deleteFileId:t})}},{key:"toggleRecord",value:function(){var e=this.state.isHistoryRecordVisible;this.setState({isHistoryRecordVisible:!e})}},{key:"viewRecord",value:function(e){var t=e.currentId;this.setState({isHistoryRecordVisible:!0,currentLogId:t})}},{key:"openSlideslip",value:function(){this.setState({showSideslip:!0})}},{key:"closeSlideslip",value:function(){this.setState({showSideslip:!1})}}]),a}(y.Component),g.propTypes=Ze(Ze({detailInfo:I.default.object,workItemList:I.default.array,projectPath:I.default.string,params:I.default.object,expanded:I.default.bool,isDetail:I.default.bool,currentProject:I.default.object,labels:I.default.array,user:I.default.object,workItemSchemeFieldArchives:I.default.object,workItemUpdateFieldIDs:I.default.array,requirementTypes:I.default.array,getWorkItemScheme:I.default.func,getRequirementTypes:I.default.func,updateCallback:I.default.func,onDetailChange:I.default.func,refreshCallback:I.default.func,controlUpdateSubWorkItems:I.default.number,enterpriseGlobalKey:I.default.string,enterpriseName:I.default.string,watermark:I.default.string,payed:I.default.bool,location:I.default.object,issueCode:I.default.oneOfType([I.default.number,I.default.string]),iterationCode:I.default.oneOfType([I.default.number,I.default.string]),autoshowComment:I.default.object,autoToggleComment:I.default.func,domID:I.default.string,flashAnchor:I.default.func},z.WithProjectPermissionProps),{},{currentProjectCooperateSettings:I.default.object,browserRouter:I.default.object,getLabels:I.default.func,targetData:I.default.object}),g.defaultProps={expanded:!0,workItemList:[],isDetail:!1},v=E))||v)||v)||v)||v)||v)||v)||v)||v)||v);t.default=Qe},xM8l:function(e,t,a){"use strict";a.r(t);var n=a("cDcd"),i=a.n(n),r=a("h74D"),o=a("es6E"),s=a("O9Lt"),l=a.n(s),c=a("w3Wo"),u=a("TNCg"),d=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(t,a)};return function(t,a){if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),f=function(){return(f=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},p=function(e,t,a,n){var i,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,a,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(r<3?i(o):r>3?i(t,a,o):i(t,a))||o);return r>3&&o&&Object.defineProperty(t,a,o),o},m=function(e,t,a,n){return new(a||(a=Promise))((function(i,r){function o(e){try{l(n.next(e))}catch(t){r(t)}}function s(e){try{l(n.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,s)}l((n=n.apply(e,t||[])).next())}))},h=function(e,t){var a,n,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(l){return function(s){if(a)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(a=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(l){s=[6,l],n=0}finally{a=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},v=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},g=Object(r.connect)(null,{updateCollaborationSettings:u.updateCurrentProjectCooperateSettings});t.default=function(e){var t=function(t){function a(e){var a=t.call(this,e)||this;return a.getCooperateSettings=function(){return m(a,void 0,void 0,(function(){var e,t,a,n,i;return h(this,(function(r){switch(r.label){case 0:e=this.props.updateCollaborationSettings,t=this.getProjectKey(this.props.targetData),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Promise.all([Object(c.fetchCollaborationSettings)(t,!0),Object(c.fetchIssueTypes)(t,!0)])];case 2:return a=v.apply(void 0,[r.sent(),2]),n=a[0].data,i=a[1].data,/^\/p\/[^/]+\//.test(location.pathname)&&e(f(f({},n),{ISSUE_TYPES:i})),Object(o.getStore)(o.StoreName.ISSUES).updateCooperateSettings(t,f(f({},n),{ISSUE_TYPES:i})),[3,4];case 3:return r.sent(),[3,4];case 4:return[2]}}))}))},a.getProjectKey=function(e){var t=location.pathname.match(/\/p\/([^/]+)/);return t?t[1]:null===e||void 0===e?void 0:e.projectName},a.getCurrentProjectCooperateSettings=function(){var e=a.getProjectKey(a.props.targetData);return o.StoreMobxApi.toJS(Object(o.getStore)(o.StoreName.ISSUES).cooperateSettings[e])},a}return d(a,t),a.prototype.render=function(){var t=this.getCurrentProjectCooperateSettings();return t?i.a.createElement(e,f({},this.props,{currentProjectCooperateSettings:t})):i.a.createElement(l.a,{show:!0})},a.prototype.componentDidMount=function(){var e=this.getCurrentProjectCooperateSettings();e&&Object.keys(e).length||this.getCooperateSettings()},a=p([o.StoreMobxReactApi.observer],a)}(i.a.Component);return g(t)}},xMGB:function(e,t,a){"use strict";a.r(t);var n=a("mVeg"),i=a("cDcd"),r=a.n(i),o=a("rtSv"),s=a.n(o),l=a("EyEP"),c=a.n(l),u=a("kGa7"),d=a.n(u),f=a("K2gz"),p=a.n(f),m=a("246l"),h=a.n(m),v=a("yZ+p"),g=a.n(v),E=a("J8KE"),b=a("sWxF"),y=a("KUqB"),S=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},I=Object(i.memo)((function(e){var t,a=e.onCancel,o=e.scrollTargetId,s=e.controlFocus,l=e.currentProject,c=e.issueCode,u=e.fetchList,f=S(Object(i.useState)(),2),m=f[0],v=f[1],I=S(Object(i.useState)(""),2),T=I[0],C=I[1],P=S(Object(i.useState)([]),2),w=P[0],D=P[1],O=function(e,t){var a={keyword:e};t&&(a.programId=t),Object(b.fetchAvailableWorkItems)(l.name,c,a).then((function(e){var t=e.data;D(t)}))},R=Object(i.useRef)(m),j=function(e){v(null===e||void 0===e?void 0:e.id),C(""),R.current=null===e||void 0===e?void 0:e.id,O("",null===e||void 0===e?void 0:e.id)},k=Object(i.useCallback)((function(e){var a=e.target.value;C(a),window.clearTimeout(t),t=window.setTimeout((function(){O(a,R.current)}),800)}),[]),N=Object(i.useRef)(null),A=function(){C(""),O("",m),N.current&&N.current.focus()};Object(i.useEffect)((function(){O(T)}),[]),Object(i.useEffect)((function(){N.current&&N.current.focus()}),[s]);var L=Object(i.useCallback)((function(e){27===e.keyCode&&a()}),[]);return r.a.createElement("div",{className:d.a.wrapper,id:o},r.a.createElement(g.a,{ref:N,autoFocus:!0,prefix:r.a.createElement("div",{className:d.a.inputBefore},r.a.createElement("div",{className:d.a.dropdownWrapper},r.a.createElement(E.b,{programByCurrentProject:!0,currentProjectID:l.id,dataType:E.a.PROGRAM,value:m,onSelect:j,onClear:j}))),suffix:r.a.createElement("div",{className:d.a.inputAfter},T&&r.a.createElement("div",{className:d.a.inputClear,onClick:A}),r.a.createElement("div",{onClick:a,className:p()(d.a.inputCancel,h.a.newButton,h.a.default,h.a.h24)},Object(n.t)("\u53d6\u6d88"))),placeholder:Object(n.t)("\u8f93\u5165\u5de5\u4f5c\u9879 ID \u6216\u6807\u9898\u5feb\u901f\u5173\u8054"),value:T,onChange:k,onKeyDown:L}),r.a.createElement("div",{className:d.a.panel,onScroll:function(e){e.stopPropagation()}},r.a.createElement("div",{className:d.a.panelContainer},w.map((function(e){return r.a.createElement("div",{key:e.id,className:d.a.item,onClick:function(){return t=e.id,void Object(b.associateWorkItem)(l.name,c,t).then((function(){O(T,m),u(),A()}));var t}},r.a.createElement(y.default,{type:e.issueTypeDetail.iconType}),r.a.createElement("div",{className:d.a.itemCode},"#",e.code),r.a.createElement("div",{className:d.a.itemName,title:e.name},e.name))}))),!w.length&&r.a.createElement("div",{className:d.a.itemEmpty},Object(n.t)("\u65e0\u641c\u7d22\u7ed3\u679c"))))})),T=a("OajT"),C=a.n(T),P=a("DCvS"),w=a.n(P),D=a("dtw8"),O=a("ZTlW"),R=a("BXnm"),j=a("5kKY"),k=a("/HD1"),N=a("xgZS"),A=a("HwxY"),L=a("6Mal"),F=a("L8Eh"),_=a("iTKN"),M=a("+QRC"),x=a.n(M),B=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},U=function(e,t,a){if(a||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},W=function(e){var t=e.data,a=e.style,o=e.fetchList,s=e.allowUpdate,l=e.className,c=e.issueCode,u=(e.isPortal,e.isScroll),d=e.resetIsScroll,f=e.onIssueChange,m=(e.isDetail,e.currentProject),h=e.disabledBottomSpace,v=B(Object(i.useState)(),2),g=v[0],E=v[1];Object(i.useEffect)((function(){(null===t||void 0===t?void 0:t.dueDate)&&E(Math.ceil(((new Date).getTime()-t.dueDate)/864e5))}),[t]);var S=function(e){return Object(k.updateWorkItem)(t.project.name,t.code,e).then((function(e){return Object(N.success)(Object(n.t)("\u66f4\u65b0\u6210\u529f")),o(),f&&f(e.data.code),e}))},I=function(){return document.querySelector('div[data-frontend-module-container="coding-project-management-frontend"]')},T=U([{id:"detail",name:Object(n.t)("\u65b0\u7a97\u53e3\u6253\u5f00"),link:{path:"/p/".concat(t.project.name,"/program/plan/work-items/").concat(t.code,"/detail")}},{id:"copy",name:Object(n.t)("\u590d\u5236\u94fe\u63a5")}],B(s?[{id:"remove",name:Object(n.t)("\u53d6\u6d88\u5173\u8054")}]:[]),!1),C=Object(i.useCallback)((function(e){switch(e.id){case"detail":window.open("".concat(window.location.origin,"/p/").concat(t.project.name,"/program/plan/work-items/").concat(t.code,"/detail"));break;case"copy":x()("".concat(window.location.origin,"/p/").concat(t.project.name,"/program/plan/work-items/").concat(t.code,"/detail")),Object(N.success)(Object(n.t)("\u6210\u529f\u590d\u5236\u5230\u526a\u5207\u677f"));break;case"remove":Object(b.cancelAssociateWorkItem)(m.name,c,t.id).then((function(){Object(N.success)(Object(n.t)("\u53d6\u6d88\u5173\u8054\u6210\u529f")),o(),f&&f(t.code,c)}))}}),[]),P=t.status&&t.status.type&&"COMPLETED"===t.status.type;return r.a.createElement(A.default.Consumer,null,(function(e){var i,o;return r.a.createElement("div",{className:p()(w.a.item,l),style:a},r.a.createElement("div",{className:w.a.itemIcon},r.a.createElement(y.default,{type:null===(i=null===t||void 0===t?void 0:t.issueTypeDetail)||void 0===i?void 0:i.iconType})),t.project.archived?r.a.createElement("div",{onClick:function(){Object(N.warning)(Object(n.t)("\u9879\u76ee\u96c6\u5df2\u88ab\u5f52\u6863\uff0c\u5982\u9700\u67e5\u770b\u4e8b\u9879\u5185\u5bb9\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u89e3\u9664\u5f52\u6863\u3002"))},style:{flex:1}},r.a.createElement("span",{className:w.a.itemCode},"#",t.code),r.a.createElement("span",{className:w.a.itemName},t.name)):r.a.createElement(r.a.Fragment,null,r.a.createElement(D.Link,{to:"/p/".concat(t.project.name,"/program/plan/work-items/").concat(t.code,"/detail"),target:"_blank",className:w.a.itemCode},"#",t.code),r.a.createElement(D.Link,{to:"/p/".concat(t.project.name,"/program/plan/work-items/").concat(t.code,"/detail"),target:"_blank",className:w.a.itemName,title:t.name},t.name)),r.a.createElement("div",{className:w.a.itemProgram},r.a.createElement("img",{className:w.a.icon,src:t.project.icon}),r.a.createElement("span",{className:w.a.name,title:t.project.displayName},t.project.displayName)),!!g&&g>0&&!P&&r.a.createElement("span",{className:w.a.itemDelay},Object(n.t)("\u903e\u671f {{delay}} \u5929",{delay:g})),t.dueDate&&!(g&&g>0)&&r.a.createElement("div",{className:w.a.itemDate},r.a.createElement(O.a,{date:t.dueDate,isCompleted:P})),r.a.createElement("div",{className:w.a.itemPriority},r.a.createElement(L.default,{componentType:_.ComponentType.ICON,value:t.priority,disabled:!t.allowUpdate||t.project.archived,onSelect:function(e){var t=e.id;return S({priority:t})},isPortal:!0,portalProps:{portalContainer:I(),toRight:!0,scrollControl:e.scrollControl},disabledBottomSpace:h})),r.a.createElement("div",{className:w.a.itemStatus},r.a.createElement(R.StatusSelect,{value:t.issueStatus,projectID:t.project.id,project:t.project,issueCode:t.code,disabled:!t.allowUpdate||t.project.archived,onSelect:function(e){return S(e)},portalContainer:I,portalAlign:{top:21,toRight:!0},disabledBottomSpace:h})),r.a.createElement("div",{className:w.a.itemAssignee},r.a.createElement(F.default,{componentType:_.ComponentType.ICON,disabled:!t.allowUpdate||t.project.archived,inProject:!0,projectID:t.project.id,value:null===(o=t.assignee)||void 0===o?void 0:o.id,onSelect:function(e){S({assignee:e.id})},onClear:function(){S({assignee:0})},triggerExtraProps:{initialSelectedItem:t.assignee},isPortal:!0,portalProps:{portalContainer:I(),portalWrapStyle:{zIndex:1055},isScroll:u,resetIsScroll:d,toRight:!0,scrollControl:e.scrollControl},disabledBottomSpace:h})),!t.project.archived&&r.a.createElement("div",null,r.a.createElement(j.ItemDropdown,{options:T,onSelect:C,popupStyle:{width:160},isPortal:!0,portalProps:{portalContainer:I(),portalWrapStyle:{zIndex:1055},isScroll:u,resetIsScroll:d,toRight:!0,scrollControl:e.scrollControl}})))}))},Y=a("iR1w"),H=a("nuIr");t.default=C()((function(e){var t,a=e.sectionExpanded,o=e.SectionToggletrigger,l=e.list,u=e.createVisible,d=e.onCreateVisibleChange,f=e.scrollTargetId,p=e.controlFocus,m=e.projectID,h=e.issueCode,v=e.callback,g=e.projectPath,E=e.currentProject,b=e.allowUpdate,y=e.isDetail,S=e.isFullScreen?H.FULL_SCREEN.disabledBottomSpace:0,T=Object(i.useCallback)((function(e){var t=e.index,a=e.style,n=e.data,i=n.list[t];return r.a.createElement(W,{data:i,key:i.code,projectID:m,projectPath:g,currentProject:E,fetchList:v,allowUpdate:b,issueCode:h,style:a,isDetail:y,disabledBottomSpace:n.disabledBottomSpace})}),[]);return r.a.createElement("div",{className:s.a.wrapper},r.a.createElement("div",{className:c.a.header},r.a.createElement(o,null),r.a.createElement("div",{className:c.a.text},Object(n.t)("\u9879\u76ee\u96c6\u5de5\u4f5c\u9879")),b&&r.a.createElement("div",{className:c.a.divider}),b&&r.a.createElement("div",{className:c.a.add,onClick:function(){return d(!0)}})),r.a.createElement("div",{className:s.a.body},!!l.length&&a&&r.a.createElement("div",{className:s.a.list},r.a.createElement(Y.FixedSizeList,{itemCount:l.length,itemSize:36,width:"100%",height:(t=l.length,Math.min(345,36*t)),itemData:{list:l,disabledBottomSpace:S}},T))),u&&r.a.createElement(I,{scrollTargetId:f,issueCode:h,currentProject:E,controlFocus:p,onCancel:function(){return d(!1)},fetchList:v}))}))},xnf3:function(e,t,a){e.exports={isRiskBorder1:"isRiskBorder1-3dfkOJoQGd",isRiskBg1:"isRiskBg1-2QftMkdQlr",riskContent1:"riskContent1-10K0-Nf8rS",riskMonitoring1:"riskMonitoring1-1AHlYqtYvm",isRiskBorder2:"isRiskBorder2-3e1VzjDdtB",isRiskBg2:"isRiskBg2-KxyFfJvVgO",riskContent2:"riskContent2-2MX_UykPZC",riskMonitoring2:"riskMonitoring2-1W19W-L3V3",isRiskBorder3:"isRiskBorder3-1afF2Yqymn",isRiskBg3:"isRiskBg3-2ZnlutBNdh",riskContent3:"riskContent3-2onmpMhCWQ",riskMonitoring3:"riskMonitoring3-1qfxWfbDk_"}},yIOK:function(e,t,a){e.exports=a.p+"7cb591232f38a28ff70f94cc135a494d.svg"},yt2Q:function(e,t,a){"use strict";a.r(t);var n,i=a("cDcd"),r=a.n(i),o=a("mVeg"),s=a("Ybq+"),l=a.n(s),c=a("K2gz"),u=a.n(c),d=a("sftu"),f=a.n(d),p=a("Zsd2"),m=a.n(p),h=a("E+oP"),v=a.n(h),g=a("7bn+"),E=a("nuIr"),b=a("V/h/");a("iTKN");!function(e){e[e.EPIC=0]="EPIC",e[e.REQUIREMENT=1]="REQUIREMENT",e[e.MISSION=2]="MISSION",e[e.DEFECT=3]="DEFECT",e[e.SUB_TASK=4]="SUB_TASK"}(n||(n={}));var y=function(){return(y=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},S=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},I=function(e,t,a){if(a||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},T=function(e,t,a,n,i,r){var o={id:t.id,value:t.id,text:t.name,name:t.name,name_pinyin:t.name_pinyin,avatar:t.avatar,media:t.avatar};return Object(b.default)(e,(function(e){e.defaultParticipants=[o],e.participants=[o.id],n&&n.forEach((function(n){var s=a[n],l=s.needDefault,c=s.value,u=s.userMap,d=s.iterationMap,f=s.issueField,p=f.type,m=f.componentType;if(p===E.BASE_FIELD_TYPE.ASSIGNEE&&(void 0!==r?(e.assignee=r.id,e.defaultAssignee=r):c&&("VARIABLE"===c.type?(e.assignee=t.id,e.defaultAssignee=o):"CONSTANT"===c.type&&(e.assignee=c.value,e.defaultAssignee=u[c.value]))),l&&null!==c)switch(p){case E.BASE_FIELD_TYPE.PRIORITY:e.priority=void 0!==i?i:c.value;break;case E.BASE_FIELD_TYPE.REQUIREMENT_TYPE:e.requirementType=c.value;break;case E.BASE_FIELD_TYPE.START_DATE:e.startDate=c.value;break;case E.BASE_FIELD_TYPE.DUE_DATE:e.dueDate=c.value;break;case E.BASE_FIELD_TYPE.MODULE:e.projectModule=c.value;break;case E.BASE_FIELD_TYPE.WORKING_HOURS:e.workingHours=c.value;break;case E.BASE_FIELD_TYPE.LABEL:e.labels=c.value;break;case E.BASE_FIELD_TYPE.WATCHER:"VARIABLE"===c.type?e.watchers=I([],S("CREATOR"===c.value?[o]:[]),!1):e.watchers=c.value.map((function(e){return u[e]}));break;case E.BASE_FIELD_TYPE.PROGRESS:e.progress=c.value;break;case E.BASE_FIELD_TYPE.DEFECT_KIND:e.defectKindIds=c.value;break;case E.BASE_FIELD_TYPE.DEFECT_PHASE:e.defectPhaseId=c.value;break;case E.BASE_FIELD_TYPE.WUKONG_RELOAD:e.wuKongReloadId=c.value;break;case E.BASE_FIELD_TYPE.PARTICIPANT:e.defaultParticipants=c.value&&c.value.length?c.value.map((function(e){return u[e]})):[],e.participants=c.value&&c.value.length?c.value:[];break;default:m===g.PROPERTY_TYPE_CONSTANTS.SELECT_MEMBER_SINGLE||m===g.PROPERTY_TYPE_CONSTANTS.SELECT_MEMBER_MULTI?"VARIABLE"===c.type?e.fields[n]=o:Array.isArray(c.value)?e.fields[n]=c.value.map((function(e){return u[e]})):e.fields[n]=u[c.value]:m===g.PROPERTY_TYPE_CONSTANTS.SELECT_ITERATION_SINGLE||m===g.PROPERTY_TYPE_CONSTANTS.SELECT_ITERATION_MULTI?Array.isArray(c.value)?e.fields[n]=c.value.map((function(e){return d[e]})):e.fields[n]=d[c.value]:e.fields[n]=c.value}}))}))},C=function(e,t){var a=t.isCustom,n=t.type,i=t.value,r=t.issueFieldId,o=t.customValue;return Object(b.default)(e,(function(t){var s;switch(a&&(t.fields=y(y({},e.fields),((s={})[r]=i,s))),n){case"programId":t.programId=i.id?i.id:i;break;case"assignee":t.assignee=i?i.value:null,t.defaultAssignee=i;break;case"participants":t.participants=i?i.value:[],t.defaultParticipants=i;break;case"defectKindIds":t.defectPhaseId=o,t.defectKindIds=i;break;case"defectPhaseId":t.defectPhaseId=i,t.defectKindIds=[];break;case"workingHours":t.workingHours=null===i||void 0===i?void 0:i.workingHours,t.estimatedWorkHour=i;break;default:t[n]=i}}))},P=a("xgZS"),w=a("w3Wo"),D=a("VJLA"),O=a.n(D),R=function(){return(R=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},j=function(e,t,a,n){return new(a||(a=Promise))((function(i,r){function o(e){try{l(n.next(e))}catch(t){r(t)}}function s(e){try{l(n.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,s)}l((n=n.apply(e,t||[])).next())}))},k=function(e,t){var a,n,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(l){return function(s){if(a)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(a=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(l){s=[6,l],n=0}finally{a=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},N=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},A=function(e,t,a){if(a||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},L=function(e){var t=N(Object(i.useState)(e),2),a=t[0],n=t[1];return[a,Object(i.useMemo)((function(){return{onChange:function(e){n(e.target.value)},reset:function(){n("")}}}),[])]},F={assignee:void 0,priority:1,requirementType:void 0,startDate:void 0,dueDate:void 0,workingHours:void 0,projectModule:void 0,labels:[],watchers:[],fields:{},progress:void 0,storyPoint:void 0,defaultAssignee:void 0,defectKindIds:[],defectPhaseId:void 0,defectSourceId:void 0,systemsId:void 0,participants:[],defaultParticipants:[],groupTeamId:void 0,editionId:void 0,wuKongReloadId:void 0},_=function(e){void 0===e&&(e=void 0);var t=N(Object(i.useState)(e),2),a=t[0],n=t[1],r=N(Object(i.useState)([]),2),o=r[0],s=r[1],l=Object(i.useCallback)((function(){return j(void 0,void 0,void 0,(function(){var e;return k(this,(function(t){switch(t.label){case 0:return a?[4,Object(w.fetchIssueTypes)(a.name)]:[3,2];case 1:return e=t.sent().data,s(e.filter((function(e){return E.KA_DEFECT_EDIT_ENTRY_DISABLE?"SUB_TASK"!==e.issueType&&"REQUIREMENT"!==e.issueType&&"MISSION"!==e.issueType:"SUB_TASK"!==e.issueType}))),[3,3];case 2:s([]),t.label=3;case 3:return[2]}}))}))}),[a]);return Object(i.useEffect)((function(){l()}),[l]),[o,Object(i.useMemo)((function(){return{onSelectProject:function(e){n(e)}}}),[])]},M=a("Z4vw"),x=a("DKcV"),B=a("sWxF"),U=a("aHEs"),W=a("4Fdf"),Y=a("uk0h"),H=a("htee"),V=a("BKNj"),G=a("+STs"),K=a.n(G),z=a("KUqB"),q=function(e){var t=e.value,a=e.item,n=e.onSelect,i=e.focused,o=e.withText,s=function(){return a.id===(null===t||void 0===t?void 0:t.id)};return r.a.createElement("div",{className:u()(K.a.item,s()&&K.a.checked,i&&K.a.focus,o&&K.a.withText),title:a.text,onClick:function(){return n(a)}},r.a.createElement("span",{className:K.a.icon},r.a.createElement(z.default,{type:a.iconType})),r.a.createElement("div",{className:u()(K.a.content)},a.name),s()&&r.a.createElement("span",{className:u()(K.a.checked)}))},Z=function(e){var t=e.value,a=e.active;return r.a.createElement("div",{className:a?u()(K.a.issueTypeTriggerWithText,K.a.active):K.a.issueTypeTriggerWithText},r.a.createElement("span",{className:K.a.icon},void 0!==t&&r.a.createElement(z.default,{type:t.iconType})),r.a.createElement("span",{className:K.a.text},null===t||void 0===t?void 0:t.name),r.a.createElement("span",{className:K.a.caret}))},J=function(e){var t=e.value;return r.a.createElement("div",{className:K.a.issueTypeTrigger},r.a.createElement("span",{className:K.a.icon},void 0!==t&&r.a.createElement(z.default,{type:t.iconType})),r.a.createElement("span",{className:K.a.caret}))},X=a("Mukx"),Q=a.n(X),$=function(){return($=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},ee=function(e){var t=e.withText,a=e.items;return r.a.createElement(V.default,$({},e,{items:a,searchable:!1,clearable:!!e.isMultiple,showPanel:e.show,Trigger:t?Z:J,triggerExtraProps:e.triggerExtraProps,Item:q,itemExtraProps:e.itemExtraProps,isSimple:!0,panelCustomStyle:t?Q.a.issueTypeFatItems:Q.a.issueTypeItems,isLocalSearch:!1}))},te=a("aWB4"),ae=a("Th6D"),ne=a.n(ae),ie=a("NI22"),re=a("82Y3"),oe=a("SLo4"),se=a.n(oe),le=a("z0hg"),ce=a("SUhN"),ue=a.n(ce),de=a("Hmmi"),fe=a.n(de),pe=a("T8xO"),me=a.n(pe),he=a("L8Eh"),ve=a("ai0/"),ge=a("OTim"),Ee=a("XLbL"),be=a.n(Ee),ye=a("LC46"),Se=a("1hCk"),Ie=a.n(Se),Te=a("246l"),Ce=a.n(Te),Pe=a("DgMC"),we=a("LvDl"),De=a("q18W"),Oe=function(){return(Oe=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Re=function(e,t,a,n){return new(a||(a=Promise))((function(i,r){function o(e){try{l(n.next(e))}catch(t){r(t)}}function s(e){try{l(n.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,s)}l((n=n.apply(e,t||[])).next())}))},je=function(e,t){var a,n,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(l){return function(s){if(a)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(a=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(l){s=[6,l],n=0}finally{a=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},ke=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o},Ne=function(e,t,a){if(a||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))};var Ae=Object(Y.default)(Object(H.default)(Object(W.default)(fe()((function(e){var t,a=e.show,n=e.isModal,s=e.name,l=e.onHide,c=e.isMac,d=e.projectID,p=e.issueType,h=e.enterpriseGlobalKey,y=e.currentProject,S=e.getRequirementTypes,I=e.getBugTypes,D=e.getModuleSchemes,j=e.labels,k=e.requirementTypes,W=e.moduleSchemes,Y=e.bugTypes,H=e.addLabel,V=e.currentProjectCooperateSettings,G=e.isPermissible,K=e.user,z=e.onSubmit,q=e.portalContainer,Z=e.priority,J=e.assigneeItem,X=e.sourceTypes,Q=e.getSourceTypes,$=e.projectType,ae=ke(Object(i.useState)(!0),2),oe=ae[0],ce=ae[1],fe=ke(Object(i.useState)(!1),2),pe=fe[0],Ee=fe[1],Se=ke(L(s),2),Te=Se[0],Ae=Se[1],Le=Ae.reset,Fe=Ae.onChange,_e=ke(Object(i.useState)(null),2),Me=_e[0],xe=_e[1],Be=ke(Object(i.useState)(!1),2),Ue=Be[0],We=Be[1],Ye=ke(_(y),1)[0],He=ke(function(e,t,a,n,r){var o=N(Object(i.useState)(0),2),s=o[0],l=o[1],c=N(Object(i.useState)(F),2),u=c[0],d=c[1],f=N(Object(i.useState)(e),2),p=f[0],m=f[1],h=N(Object(i.useState)({}),2),v=h[0],g=h[1],E=N(Object(i.useState)([]),2),b=E[0],y=E[1],S=function(){return Object(w.fetchIssueTypesScheme)(t.name,p.id).then((function(e){var t=e.data.schemeFields,i=t.map((function(e){return e.issueFieldId})),o=O()(i,t);g(o),y(i),d((function(){return 0===s?T(F,a,o,i,n,r):T(F,a,o,i,void 0,void 0)}))})).catch((function(){g({}),y([])}))};Object(i.useEffect)((function(){S()}),[p]);var I=Object(i.useMemo)((function(){return{setCurrentIssueType:function(e){m(e),l(1)},reload:function(){S()},commonSet:function(e){d(e)}}}),[]);return[p,v,b,I,u]}(p,y,K,Z,J),5),Ve=He[0],Ge=He[1],Ke=He[2],ze=He[3],qe=ze.setCurrentIssueType,Ze=ze.reload,Je=ze.commonSet,Xe=He[4],Qe=ke(function(e){var t="true"===localStorage.getItem("".concat(e,"_CREATION_AUTO_NEXT")),a="true"===localStorage.getItem("".concat(e,"_CREATION_AUTO_COPY_NEXT")),n=N(Object(i.useState)(t),2),r=n[0],o=n[1],s=N(Object(i.useState)(a),2),l=s[0],c=s[1],u=Object(i.useCallback)((function(){o((function(t){var a=!t;return localStorage.setItem("".concat(e,"_CREATION_AUTO_NEXT"),"".concat(a)),a&&l&&(c(!1),localStorage.setItem("".concat(e,"_CREATION_AUTO_COPY_NEXT"),"false")),a}))}),[l,e]),d=Object(i.useCallback)((function(){c((function(t){var a=!t;return localStorage.setItem("".concat(e,"_CREATION_AUTO_COPY_NEXT"),"".concat(a)),a&&r&&(o(!1),localStorage.setItem("".concat(e,"_CREATION_AUTO_NEXT"),"false")),a}))}),[r,e]);return[r,l,{onChange:u,onCopyChange:d}]}(null===p||void 0===p?void 0:p.id),3),$e=Qe[0],et=Qe[1],tt=Qe[2],at=tt.onChange,nt=tt.onCopyChange,it=ke(function(e,t){var a=N(Object(i.useState)(t),2),n=a[0],r=a[1];return[n,Object(i.useMemo)((function(){return{commonSetAttachments:function(e){r(e)},commonUpload:function(e){r((function(t){return Object(b.default)(t,(function(t){t.splice.apply(t,A([t.length,0],N(e),!1))}))}))},modaoUpload:function(e){var t=e[0],a="";t.isModao&&(a=t.modao.title||Object(o.t)("\u58a8\u5200\u9644\u4ef6")),t.isCodesign&&(a=t.codesign.title);var n=R(R({},t),{noUpload:!0,isModao:t.isModao,isCodesign:t.isCodesign,name:a,createdAt:t.timestamp});r((function(e){return A(A([],N(e),!1),[n],!1)}))},uploadFileSuccess:function(e){r((function(t){return Object(b.default)(t,(function(t){var a;if("MODAO"===e.thirdType||"CODESIGN"===e.thirdType)Object(P.success)("".concat(Object(o.t)("\u5f15\u5165\u6210\u529f"))),a=t.findIndex((function(t){return t.timestamp===e.timestamp}));else if(t.find((function(t){return t.fileId===e.fileId}))){Object(P.success)("".concat(e.name).concat(Object(o.t)(" \u6587\u4ef6\u5df2\u66f4\u65b0!")));var n=t.findIndex((function(t){return t.timestamp===e.timestamp}));t.splice(n,1),a=t.findIndex((function(t){return t.fileId===e.fileId}))}else a=t.findIndex((function(t){return t.timestamp===e.timestamp}));t[a]=R(R({},t[a]),e)}))}))},uploadFileDelete:function(t){var a=t.fileId,n=t.isModao,i=t.isCodesign;n||i?r((function(e){return e.filter((function(e){return e.fileId!==a}))})):Object(w.delAttachment)(e,a).then((function(){r((function(e){return Object(b.default)(e,(function(e){var t=e.findIndex((function(e){return e.fileId===a}));e.splice(t,1)}))}))}))},uploadFileFailed:function(e){var t=e.timestamp;r((function(e){return Object(b.default)(e,(function(e){var a=e.findIndex((function(e){return e.timestamp===t}));e.splice(a,1)}))}))},uploadFileCancel:function(e){var t=e.timestamp,a=e.isModao,n=e.isCodesign;r(a||n?function(e){return e.filter((function(e){return e.timestamp!==t}))}:function(e){return Object(b.default)(e,(function(e){var a=e.findIndex((function(e){return e.timestamp===t}));e.splice(a,1)}))})}}}),[])]}(d,[]),2),rt=it[0],ot=it[1],st=ot.commonSetAttachments,lt=ot.commonUpload,ct=ot.modaoUpload,ut=ot.uploadFileSuccess,dt=ot.uploadFileDelete,ft=ot.uploadFileFailed,pt=ot.uploadFileCancel,mt=ke(Object(i.useState)(!1),2),ht=mt[0],vt=mt[1],gt=Object(i.useRef)(),Et=Object(i.useRef)(),bt=ke(Object(i.useState)(),2),yt=bt[0],St=bt[1],It=ke(Object(i.useState)(),2),Tt=It[0],Ct=It[1],Pt=ke(Object(i.useState)(),2),wt=Pt[0],Dt=Pt[1],Ot=ke(Object(i.useState)(!0),2),Rt=Ot[0],jt=Ot[1],kt=ke(Object(i.useState)(!0),2),Nt=kt[0],At=kt[1],Lt=ke(Object(i.useState)(Object(re.getPreferEditorType)()),2),Ft=Lt[0],_t=Lt[1],Mt=ke(Object(i.useState)(!1),2),xt=Mt[0],Bt=Mt[1],Ut=function(){var e=Math.max(320,Math.min(680,document.body.clientHeight-120-300)),t=Math.max(320,Math.min(460,document.body.clientHeight-120-300));St(e),Ct(t),Wt()},Wt=function(){var e=null===Et||void 0===Et?void 0:Et.current;Dt(e&&e.scrollTop+e.offsetHeight<e.scrollHeight&&e.scrollHeight>e.clientHeight)},Yt=function(){var e;null===(e=null===gt||void 0===gt?void 0:gt.current)||void 0===e||e.focus()},Ht=Object(i.useRef)(),Vt=Object(i.useRef)(),Gt=ke(Object(i.useState)(!1),2),Kt=Gt[0],zt=Gt[1],qt=ke(Object(i.useState)(0),2),Zt=qt[0],Jt=qt[1],Xt=function(e){if(void 0===e&&(e=!0),Ht.current&&Vt.current){var t=Ht.current.getBoundingClientRect().width,a=Vt.current.getBoundingClientRect().width+Zt-t;e?a<=t?(Jt(Zt+-1*a),zt(!1)):Jt(Zt-t):a<=t?(Jt(0),zt(!0)):Jt(Zt+t)}},Qt=V&&V.ITERATION&&V.ITERATION===E.MODULE_SWITCH.OPENED,$t=G([{function:x.ProjectPermissionFunction.PROJECT_ITERATION,action:x.ProjectPermissionAction.UPDATE}]),ea=V&&V.STORY_POINT===E.MODULE_SWITCH.OPENED,ta=V&&V.STORY_POINT_TYPE===E.STORY_POINT_TYPE.TSHIRT,aa=ke(Object(i.useState)([]),2),na=aa[0],ia=aa[1],ra=ke(Object(i.useState)(void 0),2),oa=ra[0],sa=ra[1],la=ke(Object(i.useState)(!1),2),ca=la[0],ua=la[1],da=ke(Object(i.useState)(!1),2),fa=da[0],pa=da[1],ma=ke(Object(i.useState)(!1),2),ha=ma[0],va=ma[1],ga=ke(Object(i.useState)(),2),Ea=ga[0],ba=ga[1],ya=ke(Object(i.useState)([]),2),Sa=ya[0],Ia=ya[1],Ta=ke(Object(i.useState)(),2),Ca=Ta[0],Pa=Ta[1],wa=ke(Object(i.useState)([]),2),Da=wa[0],Oa=wa[1],Ra=Object(i.useRef)(),ja=function(e){return Re(void 0,void 0,void 0,(function(){var t;return je(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,Object(w.fetchParentWithoutCode)(y.name,{keyword:e})];case 1:return t=a.sent(),Ia(t.data),[3,3];case 2:return a.sent(),Ia([]),[3,3];case 3:return[2]}}))}))},ka=function(e){return Re(void 0,void 0,void 0,(function(){var t;return je(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,Object(B.getAvailableRequirementsWithoutCode)(y.id,{keyword:e})];case 1:return t=a.sent(),Oa(t.data),[3,3];case 2:return a.sent(),Oa([]),[3,3];case 3:return[2]}}))}))},Na=Object(i.useCallback)((function(e){if(!e.isEmpty){var t="".concat(y.name,"_").concat(Ve.issueType,"_").concat(Ve.id,"_CREATOR");Object(ie.setIssueDescriptionDraft)(t,Me)}}),[y,Ve,Me]),Aa=ke(Object(i.useState)(void 0),2),La=Aa[0],Fa=Aa[1],_a=Object(i.useCallback)((function(e){void 0===e&&(e=!0),e&&Le(),xe(null),At(!0),st([]),Je(F),sa(void 0),Fa(void 0),Pa(void 0),ba(void 0)}),[]),Ma=function(){return Re(void 0,void 0,void 0,(function(){var e,t,a,n,i,r,s,c,u,f,p,h,b,S,I,T,C,D,O,R,j,k,N,A,L,F,_,x,B,U,W,Y,H,V,G,K,q,Z,J,X,Q;return je(this,(function($){switch($.label){case 0:if(Ue)return[2];if(e=Xe.assignee,t=Xe.progress,a=Xe.priority,n=Xe.requirementType,i=Xe.startDate,r=Xe.dueDate,s=Xe.workingHours,c=Xe.watchers,u=Xe.defectType,f=Xe.projectModule,p=Xe.fields,h=Xe.storyPoint,b=Xe.labels,S=Xe.editionId,I=Xe.defectKindIds,T=Xe.defectPhaseId,C=Xe.programId,D=Xe.estimatedWorkHour,O=Xe.defectSourceId,R=Xe.differenceOption,j=Xe.differenceType,k=Xe.systemsId,N=Xe.participants,A=Xe.groupTeamId,L=Xe.wuKongReloadId,v()(m()(Te)))return Object(P.warning)(Object(o.t)("\u4e8b\u9879\u6807\u9898\u4e0d\u80fd\u4e3a\u7a7a")),[2];if(128,m()(Te).length>128)return Object(P.warning)("".concat(Object(o.t)("\u4e8b\u9879\u540d\u79f0\u6700\u591a\u652f\u6301")).concat(128).concat(Object(o.t)("\u4f4d"))),[2];if(!(null===(J=null===Ra||void 0===Ra?void 0:Ra.current)||void 0===J?void 0:J.requestFinished)||!Object(ie.isBlockType)(Ft))return[3,4];$.label=1;case 1:return $.trys.push([1,3,,4]),[4,Object(ye.getBlockEditorFinished)(Ra.current)];case 2:return $.sent(),[3,4];case 3:return $.sent(),[2,Object(P.warning)(Object(o.t)("\u66f4\u65b0\u63cf\u8ff0\u8d85\u65f6"))];case 4:if(void 0!==Ke&&void 0!==Ge){if(F=Ke.find((function(o){var l=Ge[o],d=l.required,m=l.issueField.type;if(d){var h=void 0;switch(m){case E.BASE_FIELD_TYPE.ASSIGNEE:h=e;break;case E.BASE_FIELD_TYPE.PROGRESS:h=t;break;case E.BASE_FIELD_TYPE.PRIORITY:h=a;break;case E.BASE_FIELD_TYPE.REQUIREMENT_TYPE:h=n;break;case E.BASE_FIELD_TYPE.START_DATE:h=i;break;case E.BASE_FIELD_TYPE.DUE_DATE:h=r;break;case E.BASE_FIELD_TYPE.WORKING_HOURS:h=s;break;case E.BASE_FIELD_TYPE.LABEL:h=b;break;case E.BASE_FIELD_TYPE.WATCHER:h=c;break;case E.BASE_FIELD_TYPE.DEFECT_TYPE:h=u;break;case E.BASE_FIELD_TYPE.MODULE:h=f;break;case E.BASE_FIELD_TYPE.DEFECT_KIND:h=I;break;case E.BASE_FIELD_TYPE.DEFECT_PHASE:h=T;break;case E.BASE_FIELD_TYPE.DEFECT_SOURCE:h=O;break;case E.BASE_FIELD_TYPE.WUKONG_RELOAD:h=L;break;case E.BASE_FIELD_TYPE.PARTICIPANT:h=N;break;case E.BASE_FIELD_TYPE.SYSTEM:h=k;break;case E.BASE_FIELD_TYPE.GROUP_TEAM:h=A;break;default:h=p[o]}return!(Array.isArray(h)?h.length:null!==h&&void 0!==h)}return!1})))return _=Ge[F],Object(P.warning)("".concat(Object(o.t)("\u8bf7\u586b\u5199")).concat(_.issueField.name)),[2];if((x=Ke.find((function(e){return"\u7f3a\u9677\u4e25\u91cd\u7a0b\u5ea6"===Ge[e].issueField.name})))&&Ya(p[x]))return[2]}if(rt.length&&rt.findIndex((function(e){return e.fileId<0}))>-1)return Object(P.warning)(Object(o.t)("\u6709\u9644\u4ef6\u6b63\u5728\u4e0a\u4f20\uff0c\u8bf7\u7a0d\u540e\u63d0\u4ea4")),[2];We(!0),$.label=5;case 5:return $.trys.push([5,7,,8]),B=Object.keys(p).filter((function(e){return void 0!==p[e]})).map((function(e){var t=Ge[e].issueField.componentType;return t===g.PROPERTY_TYPE_CONSTANTS.SELECT_ITERATION_MULTI||t===g.PROPERTY_TYPE_CONSTANTS.SELECT_MEMBER_MULTI?{id:e,content:p[e].map((function(e){return e.id}))}:t===g.PROPERTY_TYPE_CONSTANTS.SELECT_ITERATION_SINGLE||t===g.PROPERTY_TYPE_CONSTANTS.SELECT_MEMBER_SINGLE?{id:e,content:p[e].id}:{id:e,content:p[e]}})),U=Object(ie.isBlockType)(Ft)?{pageId:Me.pageId,historyId:Me.historyId,pageDraftId:Me.pageDraftId,descriptionType:ie.EditorType.BLOCK}:{content:(null===(X=null===Ra||void 0===Ra?void 0:Ra.current)||void 0===X?void 0:X.getRichContent())||"",slateRaw:(null===(Q=null===Ra||void 0===Ra?void 0:Ra.current)||void 0===Q?void 0:Q.getRichContent("raw"))||"",descriptionType:ie.EditorType.MARKDOWN},W=Oe(Oe(Oe({iterationCode:oa,name:m()(Te),storyPoint:h,fileIds:rt.filter((function(e){return!e.isModao&&!e.isCodesign})).map((function(e){return e.fileId})),thirdLinks:"DEFECT"===Ve.issueType?[]:rt.filter((function(e){return e.isModao||e.isCodesign})).map((function(e){return e.isModao?e.modao:e.codesign})),customFieldValueMap:B.length?B:null,assignee:e,priority:a,requirementTypeId:n,dueDate:r,startDate:i,workingHours:s,labelIds:b,watchers:c.map((function(e){return e.id})),defectTypeId:u,projectModuleId:f,progress:t,epicCode:La&&La.code},"DEFECT"===Ve.issueType&&Ca?{relatedIssueCode:Ca.code}:{}),"MISSION"===Ve.issueType&&Ea?{parentCode:Ea.code}:{}),{kmPage:U,editionId:S,programId:C,estimatedWorkHour:D,defectKindIds:I,defectPhaseId:T,defectSourceId:O,differenceOption:R,differenceType:j,systemsId:k,participants:N,groupTeamId:A,wuKongReloadId:L}),[4,Object(w.createIssueWithType)(d,Ve,W,!0)];case 6:return Y=$.sent(),H=Y.data,V="".concat(y.name,"_").concat(Ve.issueType,"_").concat(Ve.id,"_CREATOR"),Object(ie.setIssueDescriptionDraft)(V),Object(P.success)(Object(o.t)("\u4e8b\u9879 #{{code}} \u521b\u5efa\u6210\u529f\uff01",{code:H.code})),We(!1),xa(),"function"===typeof z&&z(Y),$e?(_a(),Wa(),Yt(),zt(!1)):et?(Le(),xe(null),st([]),Ua(H.id),Je(Oe(Oe({},Xe),{workingHours:void 0,estimatedWorkHour:void 0})),Yt(),zt(!1)):l(),We(!1),[3,8];case 7:return G=$.sent(),K=G.code,q=G.data,Z=G.msg,Object(Pe.configPlanNotToastMsg)(K)?[2]:(8026===K?Ke.findIndex((function(e){return e===q.issueField.issueFieldId}))<0?(Object(P.danger)(Object(o.t)("\u521b\u5efa\u9875\u5c5e\u6027\u5df2\u53d8\u66f4\uff0c\u8bf7\u68c0\u67e5\u5fc5\u586b\u5c5e\u6027\u5e76\u518d\u6b21\u63d0\u4ea4\u3002")),Ee(!0),Ze(),Ee(!1)):Object(P.danger)(Object(M.getErrorMessage)(Z)):(console.log(G),Object(P.danger)(Object(M.getErrorMessage)(Z))),We(!1),[3,8]);case 8:return[2]}}))}))},xa=function(){var e;(null===(e=null===Ra||void 0===Ra?void 0:Ra.current)||void 0===e?void 0:e.removeDraft)&&Ra.current.removeDraft()},Ba=function(){return Re(void 0,void 0,void 0,(function(){var e,t,a;return je(this,(function(n){switch(n.label){case 0:if(!Object(ie.isBlockType)(Ft))return[2];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,Object(U.fetchMarkdownTemplate)(y.name,null===Ve||void 0===Ve?void 0:Ve.id)];case 2:return e=n.sent(),jt(!1),xe({pageId:e.data.pageId,pageDraftId:e.data.draftId,historyId:e.data.historyId}),[3,4];case 3:return t=n.sent(),a=t.msg,Object(P.danger)(Object(M.getErrorMessage)(a)),[3,4];case 4:return[2]}}))}))},Ua=function(e){return Re(void 0,void 0,void 0,(function(){var t;return je(this,(function(a){switch(a.label){case 0:return Object(ie.isBlockType)(Ft)?[4,Object(w.copyMarkdownTemplate)(y.id,e)]:[2];case 1:return t=a.sent().data,xe({pageId:t.pageId,pageDraftId:t.draftId,historyId:t.historyId}),[2]}}))}))},Wa=Object(i.useCallback)((function(){if(Object(ie.isBlockType)(Ft)){var e=Object(ie.getIssueDescriptionDraft)("".concat(y.name,"_").concat(Ve.issueType,"_").concat(Ve.id,"_CREATOR"));e?(xe({pageId:e.pageId,pageDraftId:e.pageDraftId,historyId:e.historyId}),jt(!1),At(!1)):Ba()}else jt(!1),At(!1)}),[y,Ve,Ft]),Ya=function(e){var t=null;Ke.forEach((function(e){"\u7f3a\u9677\u4e25\u91cd\u7a0b\u5ea6"===Ge[e].issueField.name&&(t=Ge[e].issueField)}));var a=["\u81f4\u547d","\u4e25\u91cd"],n=!!t&&t.options.find((function(t){return t.value===e&&a.includes(t.name)}));return!(!t||!n||Xe.defectKindIds.length&&Xe.defectPhaseId)&&(Object(P.warning)(Object(o.t)("\u8bf7\u5148\u586b\u5199\u201c\u5f15\u5165\u7f3a\u9677\u9636\u6bb5\u201d\u548c\u201c\u7f3a\u9677\u7c7b\u578b\u201d")),!0)};Object(i.useEffect)((function(){ce(!0),xe(null);var e=Ne(Ne([Re(void 0,void 0,void 0,(function(){var e;return je(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Object(w.fetchIterationList)(d)];case 1:return e=t.sent(),ia(e.data.map((function(e){return{value:e.code,text:e.name,progress:{finished:e.completedCount,processing:e.processingCount,unstart:e.waitProcessCount}}}))),[3,3];case 2:return t.sent(),ia([]),[3,3];case 3:return[2]}}))})),S(),I(),D(),Q()],ke(Ha()?[ka()]:[]),!1),ke(Va()?[ja()]:[]),!1);Promise.all(e).then((function(){Ut(),Wa(),sa(void 0),Pa(void 0),ba(void 0),ce(!1)})).catch((function(e){console.log(e),ce(!0)}))}),[Ve]),Object(i.useEffect)((function(){!function(){if(Ht.current&&Vt.current){var e=Ht.current.getBoundingClientRect().width,t=Vt.current.getBoundingClientRect().width;zt(t>e)}}()}),[rt]),Object(i.useEffect)((function(){var e=function(e,t){var a;if(!e||!t.length)return!1;var n=t.find((function(t){var a;return"ASSIGNEE"===(null===(a=e[t])||void 0===a?void 0:a.issueField.type)}));return null===(a=e[n])||void 0===a?void 0:a.required}(Ge,Ke);pa(e);var t=function(e,t){var a;if(!e||!t.length)return!1;var n=t.find((function(t){var a;return"PARTICIPANT"===(null===(a=e[t])||void 0===a?void 0:a.issueField.type)}));return null===(a=e[n])||void 0===a?void 0:a.required}(Ge,Ke);va(t)}),[Ge,Ke]),Object(i.useEffect)((function(){Object(ie.isBlockType)(Ft)&&!Me&&Wa()}),[Ft]),Object(i.useEffect)((function(){var e=function(e){c?e.metaKey&&"Enter"===e.key&&Ma():e.ctrlKey&&"Enter"===e.key&&Ma()},t=function(e){c?e.metaKey||"Enter"!==e.key||jt(!1):e.ctrlKey||"Enter"!==e.key||jt(!1)};return a&&(document.addEventListener("keydown",e),document.addEventListener("keydown",t),window.addEventListener("resize",Ut)),function(){document.removeEventListener("keydown",e),document.removeEventListener("keydown",t),window.removeEventListener("resize",Ut)}}),[Ve,Te,Xe,a,Ut]);var Ha=function(){return V&&V.REQUIREMENT===E.MODULE_SWITCH.OPENED&&"DEFECT"===Ve.issueType},Va=function(){return V&&V.REQUIREMENT===E.MODULE_SWITCH.OPENED&&"CLASSIC"===V.COOPERATE_MODE&&"MISSION"===Ve.issueType};return r.a.createElement(f.a,{className:u()(Ie.a.wrapper),show:a,backdrop:!n,outsideClickCloseable:!1,keyboard:!1,enforceFocus:!1},r.a.createElement("span",{className:u()(Ie.a.closeButton),onClick:l}),oe?r.a.createElement("div",{className:Ie.a.modalLoading}):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:Ie.a.main},r.a.createElement("div",{className:u()(Ie.a.mainHeader,Ie.a.hasProjectInfo)},r.a.createElement("div",{className:Ie.a.headerInfoSection},r.a.createElement("span",{style:{marginRight:"2px"}},Object(o.t)("\u521b\u5efa")),r.a.createElement(ee,{value:Ve,items:Ye,withText:!0,onSelect:function(e){qe(e),Fa(void 0)},disabled:!1}),V&&V.EPIC===E.MODULE_SWITCH.OPENED&&"SCRUM"===V.COOPERATE_MODE&&("REQUIREMENT"===Ve.issueType||"MISSION"===Ve.issueType||"DEFECT"===Ve.issueType)&&r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:Ie.a.dividerLine,style:{marginLeft:"4px"}}),r.a.createElement(te.default,{currentProject:y,value:La,onSelect:function(e){return Fa(e)}})),r.a.createElement("div",{className:Ie.a.attentionWrapper},r.a.createElement(ne.a,{type:Ve.issueType,projectID:y.id,watchers:Xe.watchers||[],onChange:function(e){Je((function(t){return Oe(Oe({},t),{watchers:e})}))},user:K,action:"create",suffixText:Object(o.t)("\u4eba\u5173\u6ce8\u4e2d"),showTooltip:!0}))),r.a.createElement("div",{className:Ie.a.projectInfo},Object(o.t)("\u5728\u7814\u53d1\u7a7a\u95f4 {{projectName}} \u4e0b\u521b\u5efa",{projectName:y.display_name})),r.a.createElement("div",{className:Ie.a.headerTitleSection},r.a.createElement("input",{className:Ie.a.titleInput,ref:gt,autoFocus:!0,placeholder:"".concat(Object(o.t)("\u8f93\u5165\u4e8b\u9879\u6807\u9898\uff08")).concat(c?"\u2318":"Ctrl").concat(Object(o.t)(" + Enter \u53ef\u5feb\u901f\u521b\u5efa\uff09")),value:Te,onChange:Fe}))),r.a.createElement("div",{className:Ie.a.mainBody,style:{maxHeight:"".concat(yt,"px")},ref:Et,onScroll:function(){Wt()}},Rt?r.a.createElement("div",{className:Ie.a.descriptionPlaceholder,style:{height:"".concat(Tt,"px")},onClick:function(){return jt(!1)}},Object(o.t)("\u6309\u56de\u8f66\u6216\u70b9\u6b64\u5f00\u59cb\u7f16\u8f91\u63cf\u8ff0")):r.a.createElement("div",{className:Ie.a.editorContainer},r.a.createElement(ie.default,{type:Ft,className:u()(Ie.a.customSectionZindex,!xt&&Ie.a.editorHeight),readOnly:Ue,isEditing:!0,autofocus:Nt,container:Et.current,currentProject:y,initEditorData:Me,richClientSaveUuid:"UNITED_EDITOR_CREATOR",onEditorChange:Na,onLoad:function(e){e.isError?e.isDraftIdNotExist&&Object(ie.isBlockType)(Ft)&&(xe(null),Ba(),jt(!0)):Wt()},ref:Ra,isDisabled:Ue,canChangeType:!0,onEditorTypeChangeCallback:function(e){if(Object(re.setPreferEditorType)(e),_t(e),Object(ie.isBlockType)(e))Ba();else{var t="".concat(y.name,"_").concat(Ve.issueType,"_").concat(Ve.id,"_CREATOR");Object(ie.setIssueDescriptionDraft)(t);var a={pageId:Me.pageId,pageDraftId:Me.pageDraftId,module:"collaboration",function:"description",scopeType:"project",scopeId:y.id};Object(ie.delPageDraft)(a).then((function(){return xe(null)}))}},onFullScreenCallback:Bt}))),r.a.createElement("div",{className:u()(Ie.a.mainFooter,wt&&Ie.a.sticky)},r.a.createElement("div",{className:Ie.a.attachementSectionContainer},r.a.createElement("div",{className:Ie.a.sectionHeader},r.a.createElement("span",{className:Ie.a.title},Object(o.t)("\u9644\u4ef6")),r.a.createElement("span",{className:Ie.a.dividerLine}),r.a.createElement(se.a,{onHandleAttachments:lt,currentAttachmentNum:rt.length,attachmentLimit:rt.length>=20},r.a.createElement("a",{className:Ie.a.uploadButton},Object(o.t)("\u4e0a\u4f20\u9644\u4ef6"))),"DEFECT"!==Ve.issueType&&r.a.createElement("div",{className:Ie.a.importOutResourceWrap},r.a.createElement(ue.a,{onHandleAttachments:function(e){vt(!1),ct(e)},isShowPicker:ht,onShow:function(){return vt(!0)},onHide:function(){return vt(!1)},attachmentLimit:rt.length>=20}))),r.a.createElement("div",{className:Ie.a.attachmentSection},rt.length?r.a.createElement("div",{className:u()(Ie.a.attachmentWrapper,Kt&&Ie.a.rightBorder,Zt<0&&Ie.a.leftBorder),ref:Ht},r.a.createElement("div",{className:Ie.a.attachmentList,ref:Vt,style:{left:"".concat(Zt,"px")}},r.a.createElement(de.ThemeConsumer,null,(function(e){var t=e.hiddenFolderDirs;return rt.filter((function(e){return"DEFECT"!==Ve.issueType||!e.isModao&&!e.isCodesign})).map((function(e){return r.a.createElement(le.default,{key:e.fileId,attachment:e,enterpriseGlobalKey:h,currentProjectName:y.name,currentProjectId:y.id,dir:t[E.HIDDEN_FILE_TYPE[Ve.issueType]].file_id,uploadFileSuccess:ut,uploadFileDelete:dt,uploadFileCancel:pt,uploadFileFailed:ft,allowPreview:!1,userId:K.id})}))})))):r.a.createElement("div",{className:Ie.a.sectionPlaceholder},Object(o.t)("\u5c1a\u672a\u6dfb\u52a0\u9644\u4ef6")),Kt&&r.a.createElement("a",{className:Ie.a.next,onClick:function(){return Xt(!0)}}),Zt<0&&r.a.createElement("a",{className:Ie.a.pre,onClick:function(){return Xt(!1)}}))),r.a.createElement("div",{className:Ie.a.operationsWrapper},r.a.createElement("div",{className:u()(Ie.a.operationButton,!c&&Ie.a.wider,Ce.a.newButton,Ce.a.primary,Ce.a.h32,pe&&Ce.a.disabled),"data-container":!0,"data-title":"\u521b\u5efa".concat(Ve.name,"-\u786e\u5b9a"),onClick:Ma},Object(o.t)("\u521b\u5efa"),r.a.createElement("span",{className:Ie.a.key},c?"\u2318":"Ctrl"),r.a.createElement("span",{className:u()(Ie.a.key,Ie.a.enter)})),r.a.createElement("div",{className:u()(Ie.a.operationButton,Ce.a.newButton,Ce.a.default,Ce.a.h32),onClick:l,"data-container":!0,"data-title":"\u521b\u5efa".concat(Ve.name,"-\u53d6\u6d88")},Object(o.t)("\u53d6\u6d88")),r.a.createElement("span",{className:Ie.a.switch},r.a.createElement(me.a,{checked:$e,onChange:at}),r.a.createElement("span",{className:Ie.a.switchText},Object(o.t)("\u7ee7\u7eed\u521b\u5efa\u4e0b\u4e00\u4e2a"))),r.a.createElement("span",{className:Ie.a.switch},r.a.createElement(me.a,{checked:et,onChange:nt}),r.a.createElement("span",{className:Ie.a.switchText},Object(o.t)("\u590d\u5236\u5e76\u65b0\u5efa\u4e0b\u4e00\u4e2a")))))),r.a.createElement("div",{className:Ie.a.aside,onScroll:function(){return ua(!0)}},r.a.createElement("div",{className:Ie.a.asideContent},r.a.createElement("div",{className:Ie.a.issuePropertyContainer},r.a.createElement("div",{className:Ie.a.issuePropertySection},r.a.createElement("label",null,Object(o.t)("\u5904\u7406\u4eba"),fa&&r.a.createElement("span",{className:Ie.a.highlight},"*")),r.a.createElement(he.default,{inProject:!0,projectID:y.id,value:Xe.assignee||null,clearable:!fa,onSelect:function(e){var t=Xe.participants,a=Xe.defaultParticipants;if(t.includes(e.id))Je((function(t){return Oe(Oe({},t),{assignee:e.id,defaultAssignee:e})}));else{var n=Object(we.concat)(a,e);Je((function(t){return Oe(Oe({},t),{assignee:e.id,defaultAssignee:e,participants:Object(we.map)(n,"id"),defaultParticipants:n})}))}},onClear:function(){return Je((function(e){return Oe(Oe({},e),{assignee:void 0})}))},triggerExtraProps:{initialSelectedItem:Xe.defaultAssignee||null,isScroll:ca,resetIsScroll:function(){ua(!1)}}})),r.a.createElement("div",{className:Ie.a.issuePropertySection},r.a.createElement("label",null,Object(o.t)("\u53c2\u4e0e\u4eba"),ha&&r.a.createElement("span",{className:Ie.a.highlight},"*")),r.a.createElement(he.default,{inProject:!0,projectID:y.id,value:Xe.participants||null,clearable:!ha,isMultiple:!0,onSelect:function(e){var t=Xe.participants,a=Xe.defaultParticipants,n=[];n=t.includes(e.id)?a.filter((function(t){return e.id!==t.id})):Object(we.concat)(a,e),Je((function(e){return Oe(Oe({},e),{participants:Object(we.map)(n,"id"),defaultParticipants:n})}))},onClear:function(){return Je((function(e){return Oe(Oe({},e),{participants:[],defaultParticipants:[]})}))},triggerExtraProps:{initialSelectedItem:Xe.defaultParticipants||[],isScroll:ca,resetIsScroll:function(){ua(!1)}}})),Va()&&r.a.createElement("div",{className:Ie.a.issuePropertySection},r.a.createElement("label",null,Object(o.t)("\u6240\u5c5e\u9700\u6c42")),r.a.createElement(ve.default,{disabled:!1,requireCode:!0,type:Ea&&Ea.issueTypeDetail||null,placeholder:Object(o.t)("\u672a\u5173\u8054\u9700\u6c42"),clearPlaceholder:Object(o.t)("\u6e05\u9664\u5df2\u9009"),projectPath:y.project_path,searchable:!0,value:Ea&&Ea.code||0,items:Sa,selectedItem:Ea,isBase:!0,onSearch:function(e){ja(e)},onSelect:function(e){var t;ba(e),sa(null===(t=e.iteration)||void 0===t?void 0:t.code)},onClear:function(){ba(void 0),sa(void 0)},portalProps:{toRight:!0,portalWrapStyle:{zIndex:1099,width:"280px"},portalContainer:document.body,isScroll:ca,resetIsScroll:function(){ua(!1)}}})),Qt&&r.a.createElement("div",{className:Ie.a.issuePropertySection},r.a.createElement("label",null,Object(o.t)("\u6240\u5c5e\u8fed\u4ee3")),r.a.createElement(ve.default,{searchable:!0,type:{issueType:"sprint",iconType:"sprint",text:"",value:""},placeholder:Object(o.t)("\u672a\u89c4\u5212\u8fdb\u8fed\u4ee3"),clearPlaceholder:Object(o.t)("\u79fb\u51fa\u8fed\u4ee3"),searchPlaceholder:Object(o.t)("\u5feb\u901f\u7b5b\u9009"),value:oa,items:na,isBase:!0,onSelect:function(e){sa(e?e.value:void 0)},onClear:function(){sa(void 0)},projectPath:y.project_path,disabled:!!Ea||!$t,portalProps:{toRight:!0,portalWrapStyle:{zIndex:1099,width:"280px"},portalContainer:document.body,isScroll:ca,resetIsScroll:function(){ua(!1)}}})),Ha()&&r.a.createElement("div",{className:Ie.a.issuePropertySection},r.a.createElement("label",null,Object(o.t)("\u5173\u8054\u9700\u6c42")),r.a.createElement(ve.default,{disabled:!1,requireCode:!0,type:Ca&&Ca.issueTypeDetail||null,placeholder:Object(o.t)("\u672a\u5173\u8054\u9700\u6c42"),clearPlaceholder:Object(o.t)("\u6e05\u9664\u5df2\u9009"),searchable:!0,projectPath:y.project_path,value:Ca?Ca.code:null,items:Da,selectedItem:Ca,onSearch:function(e){ka(e)},onSelect:function(e){Pa(e)},onClear:function(){Pa(void 0)},isBase:!0,portalProps:{toRight:!0,portalWrapStyle:{zIndex:1099,width:"280px"},portalContainer:document.body,isScroll:ca,resetIsScroll:function(){ua(!1)}}})),ea&&r.a.createElement("div",{className:Ie.a.issuePropertySection},r.a.createElement("label",null,Object(o.t)("\u6545\u4e8b\u70b9")),r.a.createElement(ge.default,{useSize:ta,value:Xe.storyPoint,onSelect:function(e){return Je((function(t){return Oe(Oe({},t),{storyPoint:e})}))},onClear:function(){return Je((function(e){return Oe(Oe({},e),{storyPoint:void 0})}))}})),(!p.type||"mission"===p.type||"defect"===p.type||"requirement"===p.type)&&r.a.createElement(De.default,{status:"isCreate",getVersion:function(e){Je((function(t){return Oe(Oe({},t),{editionId:e})}))},boxStyle:Ie.a.issuePropertySection,projectId:y.id,isSetDropdownPanelWidth:!0,planDateCustomID:null===(t=Object.values(Ge).find((function(e){var t;return"\u8ba1\u5212\u4e0a\u7ebf\u65e5\u671f"===(null===(t=e.issueField)||void 0===t?void 0:t.name)})))||void 0===t?void 0:t.issueFieldId,onChange:C})),r.a.createElement("div",{className:u()(Ie.a.issuePropertyContainer,Ie.a.hasNoBorder)},r.a.createElement(be.a,{isCreate:!0,schemeFieldArchives:Ge,fieldIds:Ke,issueType:Ve.issueType,onChange:function(e){var t=e.value;Ya(t)||Je((function(t){return C(t,e)}))},customAttributes:Xe,labels:j,requirementTypes:k,bugTypes:Y,sourceTypes:X,projectType:$,moduleSchemes:W,addLabel:H,projectID:y.id,currentProject:y,isPermissible:G,portalProps:q?{toRight:!0,portalWrapStyle:{zIndex:1099},portalContainer:document.querySelector(".cuk-modal-container"),isScroll:ca,resetIsScroll:function(){ua(!1)}}:{toRight:!0,portalWrapStyle:{zIndex:1099},isScroll:ca,resetIsScroll:function(){ua(!1)}},portalContainer:q}))))))}))))),Le=a("yZ+p"),Fe=a.n(Le),_e=a("dtw8"),Me=a("6Mal"),xe=a("8r0r"),Be=a("mO/f"),Ue=a("ZcJI"),We=a("fLoT"),Ye=a("LgIu"),He=a("Lnax"),Ve=a("9+7+"),Ge=a("YstK"),Ke=function(){return(Ke=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},ze=function(e,t,a,n){return new(a||(a=Promise))((function(i,r){function o(e){try{l(n.next(e))}catch(t){r(t)}}function s(e){try{l(n.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,s)}l((n=n.apply(e,t||[])).next())}))},qe=function(e,t){var a,n,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(l){return function(s){if(a)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(a=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(l){s=[6,l],n=0}finally{a=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},Ze=function(e,t){var a="function"===typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,i,r=a.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(i)throw i.error}}return o};t.default=function(e){var t=e.isModal,a=e.show,n=e.user,s=e.enterpriseGlobalKey,c=e.onHide,d=e.onSubmit,p=e.source,m=e.inProgram,h=e.programID,v=Ze(Object(i.useState)(void 0),2),g=v[0],E=v[1],b=Ze(Object(i.useState)(!1),2),y=b[0],S=b[1],I=Ze(Object(i.useState)(!1),2),T=I[0],C=I[1],D=Ze(Object(i.useState)(void 0),2),O=D[0],R=D[1],j=Ze(Object(i.useState)(void 0),2),k=j[0],N=j[1],A=Ze(Object(i.useState)(1),2),F=A[0],M=A[1],x=Ze(Object(i.useState)(void 0),2),B=x[0],U=x[1],W=Ze(L(""),2),Y=W[0],H=W[1],V=H.onChange,G=H.reset,K=Object(i.useRef)(null),z=Ze(Object(i.useState)(!1),2),q=z[0],Z=z[1],J=Ze(_(),2),X=J[0],Q=J[1],$=Ze(Object(i.useState)(!1),2),te=$[0],ae=$[1],ne=function(){E(void 0),R(void 0),N(void 0),M(1),U(void 0),G(),c(),Ve.windowStorage.removeItem("templateId"),Ve.windowStorage.removeItem("originTemplateId")},ie=Object(i.useCallback)((function(){void 0!==B?Z(!0):Object(P.warning)(Object(o.t)("\u8bf7\u9009\u62e9\u4e8b\u9879\u7c7b\u578b"))}),[B]),oe=Object(i.useCallback)(Object(we.debounce)((function(){return ze(void 0,void 0,void 0,(function(){var e,t,a,n;return qe(this,(function(i){switch(i.label){case 0:if(!y)return[2];if(!T)return[2];if(void 0===g)return Object(P.warning)(Object(o.t)("\u8bf7\u9009\u62e9\u7814\u53d1\u7a7a\u95f4")),[2];if(void 0===B)return Object(P.warning)(Object(o.t)("\u8bf7\u9009\u62e9\u4e8b\u9879\u7c7b\u578b")),[2];if(""===Y)return Object(P.warning)(Object(o.t)("\u8bf7\u8f93\u5165\u6807\u9898")),[2];if(B.issueType===Ge.ISSUE_TYPE.DEFECT)return Z(!0),[2];e={name:Y,priority:F,assignee:O},i.label=1;case 1:return i.trys.push([1,3,,4]),[4,Object(w.fastCreateIssue)(g.id,Ke(Ke({},e),{issueType:B.issueType,issueTypeId:B.id,issueDescriptionType:null!==(n=null===B||void 0===B?void 0:B.issueDescriptionType)&&void 0!==n?n:Object(re.getPreferEditorType)()}))];case 2:return t=i.sent(),Object(P.success)(Object(o.t)("\u521b\u5efa\u6210\u529f")),"function"===typeof d&&d(t),ne(),[3,4];case 3:return a=i.sent(),Object(Pe.configPlanNotToastMsg)(a.code)?[2]:("function"===typeof d&&d(a),8011!==a.code&&ie(),[3,4]);case 4:return[2]}}))}))}),300),[g,Y,F,O,B,y]),se=Object(i.useCallback)((function(e){return ze(void 0,void 0,void 0,(function(){var t,a,n,i,r;return qe(this,(function(o){switch(o.label){case 0:ae(!0),o.label=1;case 1:return o.trys.push([1,4,5,6]),t=e[0],E(t),[4,Object(w.checkProject)(t.id)];case 2:return a=o.sent(),[4,Object(Ye.g)(t.id)];case 3:return n=o.sent(),0===a.code&&a.data.enable?(0===n.code&&(null===(i=n.data.permissions)||void 0===i?void 0:i.length)&&(null===(r=n.data.permissions)||void 0===r?void 0:r.some((function(e){return"ProjectIssue"===e.function&&"Create"===e.action})))?C(!0):C(!1),S(!0)):S(!1),[3,6];case 4:return o.sent(),S(!1),[3,6];case 5:return ae(!1),[7];case 6:return[2]}}))}))}),[]),le=function(){var e=!(void 0!==g&&y&&T);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:l.a.header},m&&h&&r.a.createElement(Be.default,{programID:h},r.a.createElement(Be.ProgramProjectListCtx.Consumer,null,(function(e){var t=e.results,a=e.onSearch;return r.a.createElement(Ue.a,{whichIs:"PROJECT",singleReturn:!0,skipClass:!0,value:void 0===g?[]:[g],list:t,onSearch:a,onSelect:se,onClear:function(){return E(void 0)},onReachBottom:function(){}},r.a.createElement(We.a,null))}))),!m&&r.a.createElement(xe.b,null,r.a.createElement(xe.a.Consumer,null,(function(e){var t=e.projects,a=e.loadMore,n=e.onSearch;return r.a.createElement(Ue.a,{whichIs:"PROJECT",singleReturn:!0,skipClass:!0,value:void 0===g?[]:[g],list:t,onSearch:n,onSelect:se,onClear:function(){return E(void 0)},onReachBottom:function(e){e&&a()}},r.a.createElement(We.a,null))}))),void 0!==g&&!y&&T&&!te&&r.a.createElement("div",{className:l.a.warningSection},r.a.createElement("span",{className:l.a.warning}),r.a.createElement("span",{className:l.a.text},Object(o.t)("\u7814\u53d1\u534f\u540c\u5c1a\u672a\u521d\u59cb\u5316\u6216\u672a\u6253\u5f00\uff0c\u65e0\u6cd5\u521b\u5efa\u4e8b\u9879")),r.a.createElement("span",{className:l.a.gap}),r.a.createElement(_e.Link,{className:l.a.link,to:"/p/".concat(null===g||void 0===g?void 0:g.name,"/pm-initialize"),target:"_blank"},Object(o.t)("\u524d\u5f80\u521d\u59cb\u5316\u7814\u53d1\u534f\u540c"))),void 0!==g&&!T&&!te&&r.a.createElement("div",{className:l.a.warningSection},r.a.createElement("span",{className:l.a.warning}),r.a.createElement("span",{className:l.a.text},Object(o.t)("\u6ca1\u6709\u8be5\u7814\u53d1\u7a7a\u95f4\u4e8b\u9879\u521b\u5efa\u6743\u9650\uff0c\u65e0\u6cd5\u521b\u5efa\u4e8b\u9879"))),!e&&r.a.createElement("div",{className:l.a.zoom,onClick:ie},r.a.createElement("span",{className:l.a.img}))),r.a.createElement("div",{className:e?u()(l.a.body,l.a.disabled):l.a.body},r.a.createElement(ee,{value:B,items:X,onSelect:function(e){U(e)},disabled:e}),r.a.createElement("span",{className:l.a.seperator}),r.a.createElement(Fe.a,{ref:K,value:Y,onChange:V,placeholder:Object(o.t)("\u8f93\u5165\u6807\u9898\u5feb\u901f\u521b\u5efa"),className:l.a.input,disabled:!T})),r.a.createElement("div",{className:l.a.footer},r.a.createElement("div",{className:e?u()(l.a.left,l.a.disabled):l.a.left},r.a.createElement(he.default,{key:g?g.id:"",disabled:e,componentType:Me.ComponentType.SIMPLE,inProject:!0,projectID:g?g.id:"",value:O,clearable:!0,onSelect:function(e){R(e.id),N(e)},onClear:function(){R(void 0),N(void 0)},triggerExtraProps:{initialSelectedItem:k}}),r.a.createElement("div",{className:l.a.ml8},r.a.createElement(Me.default,{componentType:Me.ComponentType.BUTTON,disabled:e,value:F,onSelect:function(e){M(e.id)}}))),r.a.createElement("div",{className:l.a.right},r.a.createElement("div",{className:e?u()(l.a.createBtn,l.a.disabled):l.a.createBtn,onClick:oe},r.a.createElement("span",{className:l.a.text},Object(o.t)("\u521b\u5efa")),r.a.createElement("span",{className:l.a.icon})),r.a.createElement("div",{className:l.a.cancelBtn,onClick:ne},r.a.createElement("span",{className:l.a.text},Object(o.t)("\u53d6\u6d88")),r.a.createElement("span",{className:l.a.icon})))))};return Object(i.useEffect)((function(){function e(t){q?document.removeEventListener("keydown",e):(27===t.keyCode&&ne(),13===t.keyCode&&(t.shiftKey&&T?ie():oe()))}return a&&document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}),[g,Y,F,O,B,q,a,T]),Object(i.useEffect)((function(){R(void 0),N(void 0),Q.onSelectProject(g)}),[g]),Object(i.useEffect)((function(){U(X[0])}),[X]),r.a.createElement(r.a.Fragment,null,t?r.a.createElement(f.a,{show:a,onHide:ne,className:u()(l.a.unitedWrapper,l.a.center),keyboard:!0,outsideClickCloseable:!1},le()):r.a.createElement("div",{className:l.a.unitedWrapper},le()),q&&r.a.createElement(Ae,{isModal:t,isMac:Object(He.isMac)(),name:Y,user:n,show:q,projectID:g.id,enterpriseGlobalKey:s,currentProject:g,issueType:B,priority:F,assigneeItem:k,onHide:function(){Z(!1),ne()},targetData:{projectName:g.name,projectId:g.id,useOwnProjectName:!0},onSubmit:d,portalContainer:p,projectType:g.projectType}))}},z0hg:function(e,t,a){"use strict";a.r(t),a.d(t,"formatSize",(function(){return S}));var n=a("mVeg"),i=a("cDcd"),r=a.n(i),o=a("6ri6"),s=a.n(o),l=a("K2gz"),c=a.n(l),u=a("DxFu"),d=a("Z4vw"),f=a("KPKf"),p=a("TT2u"),m=a.n(p),h=a("AwMv"),v=a("Qkhu"),g=a.n(v),E=a("xgZS"),b=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(t,a)};return function(t,a){if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),y=function(){return(y=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},S=function(e){if(e){var t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+["B","KB","MB","GB","TB"][t]}return"0B"},I=function(e){function t(t){var a=e.call(this,t)||this;return a.isCanceled=!1,a.relateModao=function(e){var t=a.props,i=t.currentProjectId,r=t.attachment.timestamp,o=t.uploadFileSuccess,s=t.uploadFileFailed,l=t.issueCode;Object(h.relateModao)(i,l,y({},e)).then((function(e){var t=e.data;o(y(y({isModao:!0},t),{name:t.title||Object(n.t)("\u58a8\u5200\u539f\u578b"),fileId:t.id,timestamp:r,isCanceled:a.isCanceled}))})).catch((function(){s({timestamp:r})}))},a.relateCodesign=function(e){var t=a.props,n=t.currentProjectId,i=t.attachment.timestamp,r=t.uploadFileSuccess,o=t.uploadFileFailed,s=t.issueCode;Object(h.relateModao)(n,s,e).then((function(e){var t=e.data;r(y(y({isCodesign:!0},t),{name:t.title,fileId:t.id,timestamp:i,isCanceled:a.isCanceled}))})).catch((function(){o({timestamp:i})}))},a.state={progress:0,isImage:!1,imgSrc:"",previewLink:"",attachmentState:void 0,showModal:!1},a.handleClick=a.handleClick.bind(a),a.handleFilePreview=a.handleFilePreview.bind(a),a}return b(t,e),t.prototype.componentDidMount=function(){var e=this.props.attachment;e.isModao?e&&(e.id||e.noUpload)?this.getAttachmentItemUrl(e):this.relateModao(e.modao):e.isCodesign?e&&(e.id||e.noUpload)?this.getAttachmentItemUrl(e):this.relateCodesign(e.codesign):(this.setState({isImage:e&&e.fileType?e.type===f.TYPE.IMAGE:"string"===typeof e.type&&!/\.*\.svg$/.test(e.name)&&/^image/.test(e.type)}),e&&e.id?this.getAttachmentItemUrl(e):(this.createPreImage(),this.createUploadFile(e.file)))},t.prototype.render=function(){var e,t,a,i,o,l,u=this,d=this.props,f=d.attachment,p=d.classNames,m=this.state,h=m.isImage,v=m.imgSrc,E=m.progress,b=m.showModal,y=!(f&&f.id),S=y?{backgroundImage:"url("+v+")"}:{},I=f.isCodesign||f.isSummary||f.isVideo;return r.a.createElement("div",{className:c()(s.a.attachmentsItem,p,(e={},e[s.a.isImage]=h,e[s.a.isDisabled]=y,e))},r.a.createElement(g.a,{show:b,type:"ATTACHMENT",text:Object(n.t)("\u786e\u5b9a\u8981\u5220\u9664\u5417\uff1f"),onConfirm:function(){u.props.uploadFileDelete(f),u.setState({showModal:!1})},onClose:function(){u.setState({showModal:!1})}}),r.a.createElement("div",{className:c()(s.a.attachmentsItemCover,(t={},t[s.a.isImage]=h,t)),style:S},h&&!y&&this.renderImage(v),I&&r.a.createElement("a",{className:c()(s.a.attachmentsItemWrapper,(a={},a[s.a.isImage]=h,a)),href:f.link,target:"_blank"},r.a.createElement("div",{className:c()(s.a.attachmentsItemTitle,(i={},i[s.a.isImage]=h,i))},f.name),this.renderActionBar(h,y)),!I&&r.a.createElement("div",{className:c()(s.a.attachmentsItemWrapper,(o={},o[s.a.isImage]=h,o)),onClick:function(e){return u.handleFilePreview(e,y)},"data-src":this.state.previewLink},r.a.createElement("div",{className:c()(s.a.attachmentsItemTitle,(l={},l[s.a.isImage]=h,l))},f.name),this.renderActionBar(h,y)),y&&this.renderProgress(E)))},t.prototype.renderImage=function(e){return r.a.createElement("div",{className:s.a.attachmentsItemImg,style:{backgroundImage:"url("+e+")"}})},t.prototype.renderActionBar=function(e,t){var a,n,i=this,o=this.props,l=o.attachment,u=o.disabled;return r.a.createElement("div",{className:c()(s.a.attachmentsItemBar,(a={},a[s.a.isImage]=e,a))},l.isModao&&r.a.createElement("div",{className:s.a.attachmentsModaoLogo}),l.isCodesign&&r.a.createElement("div",{className:s.a.attachmentsCodesignLogo}),(l.isSummary||l.isVideo)&&r.a.createElement("div",{className:s.a.attachmentsTencentMeetingLogo}),!l.isModao&&!l.isCodesign&&!l.isSummary&&!l.isVideo&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:s.a.attachmentsItemLogo,style:{backgroundImage:"url("+this.getStaticFile(l.name)+")"}}),r.a.createElement("div",{className:s.a.attachmentsItemSize},S(l.size))),!u&&r.a.createElement("div",{className:c()(s.a.attachmentsItemAction,(n={},n[s.a.cancel]=!e&&t,n[s.a.isImage]=t&&e,n[s.a.del]=!t,n)),onClick:function(e){return i.handleClick(e,t)}}))},t.prototype.renderProgress=function(e){return r.a.createElement("div",{className:s.a.attachmentsItemProgress,style:{width:e+"%"}})},t.prototype.handleFilePreview=function(e,t){var a=this.props,n=a.allowPreview,i=a.previewItemHandle,r=a.attachment;n&&(t||r.id&&i(r.isModao?-r.fileId:r.fileId))},t.prototype.handleClick=function(e,t){e.preventDefault(),e.stopPropagation();var a=this.props.attachment;t?(this.isCanceled=!0,this.props.uploadFileCancel(a)):this.setState({showModal:!0})},t.prototype.getStaticFile=function(e){var t=e&&e.replace(/.+\./,"").toUpperCase(),n=u.FILE_TYPE_MAP.get(t)||"others";return a("9skM")("./".concat(n,".svg"))},t.prototype.createUploadFile=function(e){var t=this,a=this.props,n=a.enterpriseGlobalKey,i=a.currentProjectId,r=a.currentProjectName,o=a.dir,s=a.attachment.timestamp,l=a.userId,c=o,u={file:e,"x:dir":c,"x:projectId":i,"x:width":this.props.width,"x:height":this.props.height,"x:folderType":1,"x:userId":l,folderType:1};Object(d.uploadFile)("/api/user/".concat(n,"/project/").concat(r,"/files/upload"),u,{dir:c},(function(e,a){var n=a.loaded,i=a.total,r=parseFloat((100*n/i).toFixed(2));t.setState({progress:r===1/0?100:+r})})).then((function(e){var a=e.data,n=Object(d.toCamelCase)(a);t.props.uploadFileSuccess(y(y({},n),{timestamp:s,isCanceled:t.isCanceled}))})).catch((function(e){(null===e||void 0===e?void 0:e.message)&&Object(E.danger)(null===e||void 0===e?void 0:e.message),t.props.uploadFileFailed({timestamp:s})}))},t.prototype.setPreviewLink=function(e){var t=window.location,a=t.pathname,n=t.search;return a.replace(/\/preview\/-?(\d)*$/,"")+"/preview/".concat(e).concat(n)},t.prototype.createPreImage=function(){var e=this,t=this.props.attachment;if(t&&"string"===typeof t.type&&/^image/.test(t.type)){var a=new FileReader;a.onload=function(){var t=a.result;e.setState({imgSrc:t})},a.readAsDataURL(t.file)}},t.prototype.getAttachmentItemUrl=function(e){e.isModao?this.setState({previewLink:this.setPreviewLink(-e.fileId)}):this.setState({imgSrc:e.type===f.TYPE.IMAGE&&e.preview,previewLink:this.setPreviewLink(e.fileId)})},t.defaultProps={width:128,height:80,allowPreview:!0},t}(i.Component);t.default=m()(I)},z6Fr:function(e,t,a){"use strict";a.d(t,"c",(function(){return r})),a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return n})),a.d(t,"d",(function(){return i}));var n,i,r="TABLE_SETTINGS",o="SELECTOR";!function(e){e.gid="GID",e.id="ID",e.code="CODE",e.title="TITLE",e.priority="PRIORITY",e.assignee="ASSIGNEE",e.creator="CREATOR",e.dueDate="DUE_DATE",e.iteration="ITERATION",e.iterationsys="ITERATION_SYS",e.createdAt="CREATED_AT",e.updatedAt="UPDATED_AT",e.watcher="WATCHER",e.requirement_type="REQUIREMENT_TYPE",e.defectType="DEFECT_TYPE",e.defectKind="DEFECT_KIND",e.defectSource="DEFECT_SOURCE",e.defectPhase="DEFECT_PHASE",e.system="SYSTEM",e.inprogram="INPROGRAM",e.milestone="MILESTONE",e.GROUP_TEAM="GROUP_TEAM",e.EDITION="EDITION_SYS",e.plan_testing_date="PLAN_TESTING_DATE",e.planDate="PLAN_DATE",e.label="LABEL",e.startDate="START_DATE",e.hourRecord="HOUR_RECORD",e.workingHours="WORKING_HOURS",e.rigisteredHours="REGISTERED_HOURS",e.project="PROJECT",e.status="STATUS",e.module="MODULE",e.progress="PROGRESS",e.custom="CUSTOM",e.story_point="STORY_POINT",e.participant="PARTICIPANT",e.release="RELEASE",e.type="TYPE",e.edition_type="EDITION_TYPE",e.edition_status="EDITION_STATUS",e.edition_no="EDITION_NO",e.begin_at="BEGIN_AT",e.end_at="END_AT",e.plan_production_date="PLAN_PRODUCTION_DATE",e.audit_initiate_time="AUDIT_INITIATE_TIME",e.test_pass_rate="TEST_PASS_RATE",e.include_rounds="INCLUDE_ROUNDS",e.my_association="MY_ASSOCIATION",e.program="PROGRAM",e.stage="STAGE",e.approval_reviewer="APPROVAL/REVIEWER",e.approver="PROCESS_PROPOSER",e.initiate_time="INITIATE_TIME",e.issue_type="ISSUE_TYPE",e.process="PROCESS",e.audit_result="AUDITRESULT",e.plan_complete_time="PLANCOMPLETETIME",e.audit_end_time="AUDITENDTIME",e.relate_systems="RELATESYSTEMS",e.relate_editions="RELATEEDITIONS",e.plan_join_user="PLANJOINUSER",e.real_join_user="REALJOINUSER",e.promoter="PROMOTER",e.review_initiate_time="REVIEW_INITIATE_TIME",e.reviewer="REVIEWER",e.review_initiator="REVIEW_INITIATOR",e.review_commission_user="REVIEW_COMMISSION_USER",e.plan_reviewer_users="PLAN_REVIEWER_USERS",e.real_reviewer_users="REAL_REVIEWER_USERS",e.test_time="TEST_TIME",e.recent_test_time="RECENT_TEST_TIME",e.proposer="PROPOSER",e.proposer_dept="PROPOSER_DEPT",e.proposed_date="PROPOSED_DATE",e.host_team="HOST_TEAM",e.host_group_team="HOST_GROUP_TEAM",e.auxiliary_team="AUXILIARY_TEAM",e.auxiliary_group_team="AUXILIARY_GROUP_TEAM"}(n||(n={})),function(e){e.tight="tight",e.loose="easy"}(i||(i={}))},z6PH:function(e,t,a){e.exports={select:"select-1NI8wcPR78","select-arrow-wrapper":"select-arrow-wrapper-15nhMZEe-v",selectArrowWrapper:"select-arrow-wrapper-15nhMZEe-v","menu-top":"menu-top-2tOdavEvCj",menuTop:"menu-top-2tOdavEvCj","select-with-label":"select-with-label-2M8bBld583",selectWithLabel:"select-with-label-2M8bBld583","select-trigger":"select-trigger-1mZ9l7iGt2",selectTrigger:"select-trigger-1mZ9l7iGt2","has-border":"has-border-1QIMj5Uqnd",hasBorder:"has-border-1QIMj5Uqnd","is-block":"is-block-1mQ1nlLVlf",isBlock:"is-block-1mQ1nlLVlf","item-text":"item-text-bp0qHTFJYD",itemText:"item-text-bp0qHTFJYD","not-selected":"not-selected-1kAnBcua16",notSelected:"not-selected-1kAnBcua16","is-expanded":"is-expanded-3RusemhXdZ",isExpanded:"is-expanded-3RusemhXdZ","inline-dropdown":"inline-dropdown-3P0VOGR7MF",inlineDropdown:"inline-dropdown-3P0VOGR7MF","item-label":"item-label-1eXQqajYMO",itemLabel:"item-label-1eXQqajYMO","item-text-ellipsis":"item-text-ellipsis-3kCFfZu3w4",itemTextEllipsis:"item-text-ellipsis-3kCFfZu3w4","clear-button":"clear-button--r6Wf5Ryn1",clearButton:"clear-button--r6Wf5Ryn1","to-top":"to-top-2tVhSrymJk",toTop:"to-top-2tVhSrymJk","to-right":"to-right-H3DwNolK3X",toRight:"to-right-H3DwNolK3X","trigger-background":"trigger-background-1TyfFfOc2i",triggerBackground:"trigger-background-1TyfFfOc2i","clear-divider":"clear-divider-1CLXBnKQ9W",clearDivider:"clear-divider-1CLXBnKQ9W",show:"show-1IEXa2r1N4",clear:"clear-3aemfSCwYF","project-trigger-avatar":"project-trigger-avatar-3BP1uIWhKb",projectTriggerAvatar:"project-trigger-avatar-3BP1uIWhKb","project-placeholder":"project-placeholder-2SWVAv_J4O",projectPlaceholder:"project-placeholder-2SWVAv_J4O",list:"list-33hqeY8lPW",item:"item-NvCIsTc447","project-path-name":"project-path-name-1avg5ff2He",projectPathName:"project-path-name-1avg5ff2He","section-title":"section-title-3Xpf-tiNQk",sectionTitle:"section-title-3Xpf-tiNQk"}},zDls:function(e,t,a){e.exports={list:"list-2HxSOcQ0ak","sub-requirement-tree":"sub-requirement-tree-KpV-w9CaNA",subRequirementTree:"sub-requirement-tree-KpV-w9CaNA"}},zasr:function(e,t,a){e.exports={body:"body-Mxac_q7E1F",title:"title-2uPsXT68nz",list:"list-L0DgPxaDdf"}},zjUt:function(e,t,a){e.exports=a.p+"99960f25feb65dcd7aed877bcfb8c2a9.svg"},zoVt:function(e,t,a){e.exports={wrapper:"wrapper-1oDV0V613T",content:"content-1VP4reoiWV"}}}]);